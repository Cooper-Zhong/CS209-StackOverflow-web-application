[{"owner":{"profile_image":"https://lh3.googleusercontent.com/-bSeb0Nt8ym4/AAAAAAAAAAI/AAAAAAAAvhY/Q919jXhqOac/photo.jpg?sz=256","account_id":13179806,"user_type":"registered","user_id":21197077,"link":"https://stackoverflow.com/users/21197077/gneginskiy","reputation":91,"display_name":"gneginskiy"},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676277435,"comment_id":133097633,"body":"in &quot;implementing Runnable&quot;, &#39;classroom&#39; is a shared resource with syncrhonized non-static method run(). Which means that only one thread can access the method at a time for a given Runnable object.   On the contrary, In case of &quot;extending Thread&quot; you have 3 objects, and no concurrent access to this code happens. When annotating non-static method as &quot;syncrhonized&quot;, mutual exclusion happens per object. For static methods synchronized methods are locked per class."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676277148,"comment_id":133097549,"body":"&quot;<code>ie.getMessage();</code>&quot; does nothing. You should read up about how to handle exceptions, and specifically how to handle an <code>InterruptedException</code> (because it typically requires something different to other exception types)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":5,"post_id":75433400,"edited":false,"creation_date":1676276851,"comment_id":133097464,"body":"But the answer is that in your first example you have three instances of ClassRoom and in the second you only have one, so <code>synchronized</code> does nothing in the first case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676276712,"comment_id":133097425,"body":"Please explain what your code is meant to do -- what do you expect to happen? What is happening that you don&#39;t expect? That is, what is &quot;proper output&quot;? Perhaps leaving the newlines in your output examples would make your question easier to understand."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/97cbc5a26a5cfcdbb3fb718c3e066d87?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21083132,"user_type":"registered","user_id":15496965,"link":"https://stackoverflow.com/users/15496965/henning","reputation":3240,"display_name":"Henning"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1676136795,"comment_id":133078828,"body":"I don&#39;t think the issue is related to multi-threading. I think the problem is that <code>maxItemCount</code> should be set to a different value. See my answer below for details."},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":1,"post_id":73977101,"edited":false,"creation_date":1665074259,"comment_id":130619763,"body":"If you were testing this on x86 hardware, <a href=\"https://stackoverflow.com/q/63912669\">What does it mean that &quot;two store are seen in a consistent order by other processors&quot;?</a> is a duplicate that explains why you can&#39;t observe IRIW reordering on that system."},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":73977101,"edited":false,"creation_date":1665074073,"comment_id":130619698,"body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/27807118/will-two-atomic-writes-to-different-locations-in-different-threads-always-be-see\">Will two atomic writes to different locations in different threads always be seen in the same order by other threads?</a>  Also <a href=\"https://stackoverflow.com/q/48383867\">Acquire/release semantics with 4 threads</a>  And comments on <a href=\"https://stackoverflow.com/q/69003544\">Still can&#39;t get a true root cause explanation on IRIW scenario</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":1,"post_id":73977101,"edited":false,"creation_date":1665074040,"comment_id":130619689,"body":"This is the IRIW litmus test.  Unless you tested on a recent PowerPC server, all threads will agree on the order of stores, even if the stores are <code>relaxed</code> and the loads are just <code>acquire</code>.  ISO C++ doesn&#39;t guarantee it without <code>seq_cst</code>, but it also doesn&#39;t guarantee that every allowed ordering actually will be observed in practice.  Especially ones the hardware you choose doesn&#39;t do naturally.  (The loads do need to be <code>acquire</code> so it doesn&#39;t fail because of local load-load reordering on the readers, actually observing the global order of store visibility)"},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":73968499,"edited":false,"creation_date":1665068577,"comment_id":130617460,"body":"Yeah, &quot;hot&quot; waiting ... isn&#39;t a good idea."},{"owner":{"profile_image":"https://i.stack.imgur.com/Fp4Pm.jpg?s=256&g=1","account_id":1085259,"user_type":"registered","user_id":1081110,"link":"https://stackoverflow.com/users/1081110/dawood-ibn-kareem","reputation":78314,"display_name":"Dawood ibn Kareem"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968499,"edited":false,"creation_date":1665029459,"comment_id":130604631,"body":"I suspect what&#39;s happening is that your program is spending all its resources comparing <code>Ssytem.currentTimeMillis()</code> to <code>lastEdit</code>, and nothing else gets a chance to run.  You might need a <code>Thread.sleep</code> somewhere in there.  Also, make sure that <code>lastEdit</code> is declared <code>volatile</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":3,"post_id":73944324,"edited":false,"creation_date":1664889314,"comment_id":130569451,"body":"Recommended read <a href=\"https://stackoverflow.com/q/504103/2711488\">How do I write a correct micro-benchmark in Java?</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":4,"post_id":73944324,"edited":false,"creation_date":1664889198,"comment_id":130569393,"body":"You are not waiting for the completion of the threads, hence you’re only measuring how long it takes <i>to start the threads</i>, which boils down to how long it takes to convert a lambda expression into a <code>Runnable</code>. Which can be longer for the first lambda expression as explained in <a href=\"https://stackoverflow.com/a/34642063/2711488\">this answer</a>. However, if you fix the code to wait for the completion of the actual operation, you’re still not comparing similar operations. After the first replacement operation, there are no <code>E</code>s in the string."},{"owner":{"profile_image":"https://i.stack.imgur.com/Pzwgx.jpg?s=256&g=1","account_id":10777133,"user_type":"registered","user_id":7928721,"link":"https://stackoverflow.com/users/7928721/samabcde","reputation":7282,"display_name":"samabcde"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73944324,"edited":false,"creation_date":1664871514,"comment_id":130563723,"body":"Don&#39;t see much different in my machine, e.g. I see  <code>2 in t1</code>.  <code>1 in t2</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926124,"edited":false,"creation_date":1664717260,"comment_id":130531056,"body":"So, it&#39;s not about <code>Runnable</code> but it&#39;s about <i><code>run</code></i> method.. it&#39;s now clearer."},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926124,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"edited":false,"creation_date":1664716832,"comment_id":130530968,"body":"@GiorgiTsiklauri The standard <code>Runnable</code> that you can pass to <code>Thread</code>s constructor does not allow you to throw an <code>InterruptedException</code> from its <code>run</code> method because <code>InterruptedException</code> is a checked exception."},{"owner":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"content_license":"CC BY-SA 4.0","score":1,"post_id":73926124,"edited":false,"creation_date":1664716758,"comment_id":130530954,"body":"I really struggle to understand &quot;<i>Java Thread&#39;s doesn&#39;t accept a Runnable that allows throwing of InterruptedException</i>&quot;..."},{"owner":{"profile_image":"https://graph.facebook.com/1080827148618335/picture?type=large","account_id":7278875,"user_type":"registered","user_id":5549301,"link":"https://stackoverflow.com/users/5549301/udara-seneviratne","reputation":2373,"display_name":"Udara Seneviratne","accept_rate":38},"content_license":"CC BY-SA 4.0","score":0,"post_id":73920478,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Ln6Kz.png?s=256&g=1","account_id":12305345,"user_type":"registered","user_id":8978587,"link":"https://stackoverflow.com/users/8978587/shahart","reputation":450,"display_name":"ShaharT"},"edited":false,"creation_date":1664682081,"comment_id":130526204,"body":"@ShaharT When we have the issue, it&#39;s observable only the &quot;** SMS received from SMSC [{}]&quot;, &quot;Point 1: Active thread count : [{}]&quot; and &quot;Point 2: Active thread count : [{}]&quot;. If the problem is on the other end we could see at least &quot;Thread start &quot; which is inside the thread before the resttemplate call. Isn&#39;t it?"},{"owner":{"profile_image":"https://i.stack.imgur.com/Ln6Kz.png?s=256&g=1","account_id":12305345,"user_type":"registered","user_id":8978587,"link":"https://stackoverflow.com/users/8978587/shahart","reputation":450,"display_name":"ShaharT"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73920478,"edited":false,"creation_date":1664651302,"comment_id":130522424,"body":"well, if nothing was changed at your side, probably something got changed on the other end: the <code>smppMoSMS.getApplicationUrl()</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1654928765,"comment_id":128213757,"body":"@ThomasKl&#228;ger Updated in &quot;EDIT 1:&quot; with ThreadLocalRandom observations."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1654927939,"comment_id":128213662,"body":"Thanks @ThomasKl&#228;ger, will run with per thread random generator."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72582076,"edited":false,"creation_date":1654927764,"comment_id":128213640,"body":"<code>Random.nextDouble()</code> calls <code>Random.next()</code> twice. <code>Random.next()</code> uses an internal field <code>AtomicLong seed</code> with <code>seed.compareAndSet()</code> which is synchronization point between the threads (i.e. it is required that all threads see the same seed value). Replace the global <code>RANDOM</code> instance with a per-thread <code>Random</code> generator."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"edited":false,"creation_date":1654927762,"comment_id":128213638,"body":"Thanks for checking @StanislavBashkyrtsev  I invoked the same number of operations (numOperationsPerThread) in each thread.  I have updated the full code in the question under &quot;Complete runnable example&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"edited":false,"creation_date":1654927501,"comment_id":128213599,"body":"Please show a complete, runnable example."},{"owner":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"content_license":"CC BY-SA 4.0","score":2,"post_id":72580556,"edited":false,"creation_date":1654918017,"comment_id":128212684,"body":"What do you mean by &quot;performance sticks into a network&quot;?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 4.0","score":1,"post_id":72580556,"edited":false,"creation_date":1654905217,"comment_id":128211552,"body":"Have you read the documentation on <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadPoolExecutor.html\" rel=\"nofollow noreferrer\">ThreadPoolExecutor</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=256&d=identicon&r=PG","account_id":16878,"user_type":"registered","user_id":37213,"link":"https://stackoverflow.com/users/37213/duffymo","reputation":306143,"display_name":"duffymo","accept_rate":81},"content_license":"CC BY-SA 4.0","score":1,"post_id":72580556,"edited":false,"creation_date":1654902993,"comment_id":128211277,"body":"Not sure I&#39;m following your logic about changing the pool size.  The ones I&#39;m familiar with are fixed by configuration at runtime and don&#39;t change.  It&#39;s up to you to tune and monitor your app and determine thread size.  Something like Netty and its ring buffer can be a good way to manage high throughput.  It uses a single thread and non-blocking I/O.  Scales like mad.  Maybe you should look at it."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72567117,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1654873045,"comment_id":128203575,"body":"So what I did is created a bean ThreadManager class that creates, destroys, and changes the pool sizes. The specific class I use for the pools is ThreadPoolTaskExecutor which allows me to control everything regarding the pools it has created."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72567117,"edited":false,"creation_date":1654842588,"comment_id":128192881,"body":"I will add an answer to your questions, but just curious, how are you changing the thread pool size at runtime? Is it via JMX?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72557561,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=256&d=identicon&r=PG","account_id":111736,"user_type":"registered","user_id":295004,"link":"https://stackoverflow.com/users/295004/morrison-chang","reputation":11811,"display_name":"Morrison Chang"},"edited":false,"creation_date":1654766380,"comment_id":128172067,"body":"@MorrisonChang, its android java interop on C#"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=256&d=identicon&r=PG","account_id":111736,"user_type":"registered","user_id":295004,"link":"https://stackoverflow.com/users/295004/morrison-chang","reputation":11811,"display_name":"Morrison Chang"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72557561,"edited":false,"creation_date":1654766215,"comment_id":128172004,"body":"You added <code>java</code> as a tag but the code looks like C#. If you are using Xamarin please add/correct your question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72556212,"edited":false,"creation_date":1654765691,"comment_id":128171815,"body":"I have rolled back your last edit. If you want to ask a new question, then post a new question, do not change the scope of an existing question by changing or adding a question, especially if your original question has been answered already."},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72556212,"edited":false,"creation_date":1654759794,"comment_id":128169638,"body":"The <code>.get</code> call makes it blocking and not run in parallel. So while you run on a different thread it doesn&#39;t make any difference. Use a <code>CompletableFuture</code> instead then wrap all of them in another <code>CompleteableFuture.allOf</code> and get the results."},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72556212,"edited":false,"creation_date":1654759658,"comment_id":128169582,"body":"Calling <code>get()</code> on a <code>Future</code> will block, so your code has a parallelism of 1."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":0,"post_id":72556212,"edited":false,"creation_date":1654759478,"comment_id":128169528,"body":"Please don&#39;t use bold and italic in such a universal way - it makes it <i>harder</i> to read instead of easier."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1654713856,"comment_id":128160060,"body":"@SolomonSlow Well it might be the case. I just thought that the main thread gets stuck and unable to call <code>notifyAll()</code> hence a deadlock. I might be wrong."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"edited":false,"creation_date":1654711844,"comment_id":128159317,"body":"@Darkman, &quot;Deadlock&quot; means that two or more threads are all unable to make progress because each one of them is waiting for one of the others to do something. But, no thread will ever wait in a<code>notifyAll()</code> call. It always returns immediately. It wakes whatever threads are waiting at that moment, or it does absolutely nothing if no thread is waiting. When a thread gets stuck waiting for a notification that happened <i>before</i> the thread started to wait, that usually is called, &quot;lost notification.&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"edited":false,"creation_date":1654704426,"comment_id":128156671,"body":"It seems like a deadlock to me. One in <code>wait()</code> and another one <code>notifyAll()</code>. Move <code>notifyAll()</code> above the line <code>b.mb2();</code> should fix the problem."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/IIQJV.jpg?s=256&g=1","account_id":318670,"user_type":"registered","user_id":636009,"link":"https://stackoverflow.com/users/636009/david-conrad","reputation":15681,"display_name":"David Conrad"},"edited":false,"creation_date":1654703247,"comment_id":128156174,"body":"@DavidConrad Oh, right. Very rusty."},{"owner":{"profile_image":"https://i.stack.imgur.com/IIQJV.jpg?s=256&g=1","account_id":318670,"user_type":"registered","user_id":636009,"link":"https://stackoverflow.com/users/636009/david-conrad","reputation":15681,"display_name":"David Conrad"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654702019,"comment_id":128155631,"body":"@Tenfour04 The lock is not held by the the thread while it&#39;s waiting. <a href=\"https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait()\" rel=\"nofollow noreferrer\">&quot;The current thread must own this object&#39;s monitor. The thread releases ownership of this monitor and waits...&quot;</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654699961,"comment_id":128154552,"body":"I tried to do it as asked by the assignment (calling thread waiting for both threads to terminate <code>mb1()</code>), but if I do that the threads calls <code>notifyAll()</code> before the calling threads gets to call the <code>wait()</code>. This results again in a deadlock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"edited":false,"creation_date":1654699621,"comment_id":128154398,"body":"Based on the comment you just deleted, I could see that <code>join</code> would not be able to accomplish it. What you should describe in your question is that the calling thread should be waiting for <code>mb1()</code> to complete in both of the other threads before it continues. By the way, you&#39;re using wait backwards. You want the calling thread to wait on the other threads, not the other way around. The reason I&#39;m not writing a full answer is that I think I would get it wrong. Working with Java threads directly is very complicated, and there are libraries for simplifying it, so I&#39;m super rusty on it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654699441,"comment_id":128154309,"body":"After investigating more, yes, using <code>synchronization</code> and its <code>methods</code> is the way my teacher wants the assignment to be done."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654681397,"comment_id":128146887,"body":"From a cursory glance, I think I see the problem (improper synchronization). But I don&#39;t have time to properly look at it, or write a good answer, just yet. I&#39;ll try to get to give an answer tomorrow."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654675348,"comment_id":128144585,"body":"@Slaw Here&#39;s Spider.java, which extends RecursiveTask: pastebin.com/8eDsVNDg and here&#39;s SpiderUtils.java: pastebin.com/5NpjY79T"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654639491,"comment_id":128137868,"body":"Can you show your <code>ForkJoinTask</code> implementation?"},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654629613,"comment_id":128135050,"body":"@Slaw I&#39;m not quite sure what you mean by sharing the source of the stream between multiple instances, I just pass the urls to the new instances and that&#39;s it for the results of that method. The code I provided is the only place where the stream is used."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654582686,"comment_id":128118263,"body":"Hmm. The stack trace indicates the exception is being thrown from a stream pipeline. The only stream I see in your code is <code>crawForURLs(&quot;a&quot;, &quot;href&quot;).stream()</code>. Make sure that you are not sharing the <i>source</i> of the stream between multiple <code>ForkJoinTask</code> instances, at least not when that source can have read+write operations by multiple threads at the &quot;same time&quot; (without the proper synchronization)."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654572063,"comment_id":128116484,"body":"@Slaw I wish I could provide that example but I honestly don&#39;t know how to reproduce the error, it only happens sometimes and I haven&#39;t found a pattern yet. I will update the original question with the full stack trace."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654569877,"comment_id":128116154,"body":"Can you try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the problem, and the full stack trace of the error?"},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72429901,"edited":false,"creation_date":1653917585,"comment_id":127961830,"body":"That is why Spring has the <code>TaskExecutor</code> which you can give a task which will execute in the background (or just call a method annotated with <code>@Async</code>). Don&#39;t roll your own... In this case you even might want an <code>ASyncTaskScheduler</code> and schedule a task to do something each x seconds (3 seconds in this case)."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJxX9Iix5-V4Afy0vaosyCz1npCO7X3fhNOxSnIe=k-s256","account_id":25423725,"user_type":"registered","user_id":19229200,"link":"https://stackoverflow.com/users/19229200/scizora","reputation":21,"display_name":"Scizora"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72429901,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"edited":false,"creation_date":1653917216,"comment_id":127961703,"body":"@BasilBourque thanks for the recommendation! i will have a look at it!"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJxX9Iix5-V4Afy0vaosyCz1npCO7X3fhNOxSnIe=k-s256","account_id":25423725,"user_type":"registered","user_id":19229200,"link":"https://stackoverflow.com/users/19229200/scizora","reputation":21,"display_name":"Scizora"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72429901,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"edited":false,"creation_date":1653917163,"comment_id":127961683,"body":"@M.Deinum hello, i just edited in the related codes to the original question. and yes i understand that java threads can be a little finicky and i shouldnt create threads myself, however other then creating threads to execute this particular concurrent operation i am unsure of the other possible approaches."},{"owner":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"content_license":"CC BY-SA 4.0","score":1,"post_id":72429901,"edited":false,"creation_date":1653894963,"comment_id":127953849,"body":"The Executors framework is your friend here. Search to learn about <code>ExecutorService</code>. In modern Java, we rarely deal with <code>Thread</code> class directly."},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72429901,"edited":false,"creation_date":1653891734,"comment_id":127952961,"body":"Please add code, and you shouldn&#39;t be creating threads yourself."},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71817703,"edited":false,"creation_date":1649605273,"comment_id":126912708,"body":"Two semaphores and one unit?  When input, signal a semaphore and wait on the other."},{"owner":{"profile_image":"https://i.stack.imgur.com/g89TG.jpg?s=256&g=1","account_id":3428879,"user_type":"registered","user_id":2873896,"link":"https://stackoverflow.com/users/2873896/luke-briggs","reputation":3755,"display_name":"Luke Briggs"},"content_license":"CC BY-SA 4.0","score":2,"post_id":71817703,"edited":false,"creation_date":1649603509,"comment_id":126912314,"body":"Maybe approach it more like this: <a href=\"https://stackoverflow.com/questions/4044726/how-to-set-a-timer-in-java\">A timer</a> which ticks once a second. When it ticks, depending on if it is currently black or white&#39;s turn, you update their time counts accordingly. While/sleep loops have a tendancy to &#39;drift&#39; from true time, given it doesn&#39;t take exactly 1 second per iteration."},{"owner":{"profile_image":"https://i.stack.imgur.com/nc9J4.jpg?s=256&g=1","account_id":5055881,"user_type":"registered","user_id":15055605,"link":"https://stackoverflow.com/users/15055605/yamin","reputation":3266,"display_name":"YaMiN"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71817703,"edited":false,"creation_date":1649602883,"comment_id":126912176,"body":"You can use threads or <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html\" rel=\"nofollow noreferrer\">ExecutorService</a>."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1646308885,"comment_id":126093738,"body":"@NathanHughes I had intended to use this as a demonstration of wait() and notifyAll() methods in a scenario involving three threads. I do understand threads can have unexpected behavior and this is probably not very useful. Just meant it as a proof of concept."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":2,"post_id":71325131,"edited":false,"creation_date":1646292800,"comment_id":126088296,"body":"Depends on <code>getQueryExecutor()</code>. Normally, you would have a limit in executors. In fact, you could have a single threaded executor with a queue capacity of one, naturally preventing submitting a new job when there is a pending one. Besides that, I can’t tell for sure whether the first variant permits overlapping or not. That’s why I would use a single atomic integer for the state, to have far fewer state transitions and easy to understand code. That’s also the advantage of your variant, I can see immediately that concurrent calls of <code>computeFunction.call()</code> are possible."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646258109,"comment_id":126081745,"body":"This doesn&#39;t seem like a great way of demonstrating inter-thread communication. Maybe try using Actors?"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1646252056,"comment_id":126079968,"body":"@NathanHughes I wanted to use this as a demonstration of inter-thread communication between three threads for the learners. But the unexpected output is baffling me."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646251848,"comment_id":126079904,"body":"This seems very painful, and doesn&#39;t seem likely to teach you anything."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b31ee54d9d3789bf16fe971dbb4a2ef8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9760,"user_type":"registered","user_id":18157,"link":"https://stackoverflow.com/users/18157/jim-garrison","reputation":85860,"display_name":"Jim Garrison","accept_rate":100},"edited":false,"creation_date":1646251617,"comment_id":126079832,"body":"@JimGarrison I have edited the outputs to include the names of the threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b31ee54d9d3789bf16fe971dbb4a2ef8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9760,"user_type":"registered","user_id":18157,"link":"https://stackoverflow.com/users/18157/jim-garrison","reputation":85860,"display_name":"Jim Garrison","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646251093,"comment_id":126079657,"body":"You omitted the crucial bit... the actual output showing which thread printed which number."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246373,"comment_id":126078077,"body":"if it will spawn thousands of calls then I believe the first one may be preferred, but if the memory is enough to handle multiple threads or if the calls would not be that much, then I believe my option is a valid one, maybe I am looking for too much excuses to use my code lol."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246362,"comment_id":126078071,"body":"There is a definite advantage on the first code, and it is that it prevents the unnecessary creation of threads, which means the semaphore begins to work EVEN BEFORE the execution begins, that is what makes the task so complex, the problem is that it makes the task a lot more slow, so I believe we should also take into account what is the context of the code being used on, ..."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246007,"comment_id":126077952,"body":"Thanks for your response @Holger, I&#39;ve made a list of all the possible scenarios of the first code, if by &quot;overlapping&quot; you mean 2 consecutive calls with the different result, that also happens in the first one (under a special case). If you mean the same result computed twice, that happens also, it is just that the first computation is not dispatched the same computation is performed again and this time dispatched. If you mean asynchronously, then the first code is still in the need to perform the second call AFTER the first dispatch was cancelled (the computation was still performed)."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71325131,"edited":false,"creation_date":1646242210,"comment_id":126076652,"body":"What happens when the new action is scheduled right between <code>if (invalidationVersion != invalidationCount.get()) return;</code> and <code>T value = computeFunction.call();</code>? Then, you have overlapping computations. The logic of the first code snippet can be simplified though. Just by replacing the three <code>AtomicBoolean</code>s by a single <code>AtomicInteger</code> using three bits. Since there are several adjacent uses of the <code>AtomicBoolean</code>s (i.e. there’s no action with inter-thread semantics in-between), the single <code>AtomicInteger</code> allows to reduce the number of accesses."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fa54191534d8fd4ef49d9776f0749acb?s=256&d=identicon&r=PG","account_id":24290154,"user_type":"registered","user_id":18235332,"link":"https://stackoverflow.com/users/18235332/eric","reputation":41,"display_name":"eric"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71317154,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"edited":false,"creation_date":1646220964,"comment_id":126068032,"body":"Yes your are right, my mistake."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218967,"comment_id":126067379,"body":"i tried adding a sleep or wait after an objects was attempted to be read, but it doesn&#39;t unlock the inputstream. synchronized (ois) {                     System.out.println(&quot;t1: locked ois&quot;);                     o = ois.readObject();                     while(o == null){                         ois.wait(500);                         Thread.sleep(500);                     }                 }"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218416,"comment_id":126067213,"body":"how do I make t1 unlock ois if no objects come along, but only for a second to allow t2 to take lock (if t2 activated); otherwise, it just repeats the process (if t2 inactive -  waiting)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218254,"comment_id":126067161,"body":"I want t1 to run continuously, listening for objects from a server on another computer. I don&#39;t know if there is a more effective way to notify it only when the server wants to send data, because the server is not on the same computer so its only input is through this stream."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646217236,"comment_id":126066809,"body":"But while t1 is waiting for objects to come along it holds on to the lock, so t2 can&#39;t do its work in that case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d799a3f9fa2cfe1bcebe2c73cd5aa77d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7226774,"user_type":"registered","user_id":5515060,"link":"https://stackoverflow.com/users/5515060/lino","reputation":19717,"display_name":"Lino","accept_rate":100},"edited":false,"creation_date":1646216945,"comment_id":126066707,"body":"I added the buffer class. The print &quot;t2: waiting to lock ois&quot;  wouldn&#39;t run if it didn&#39;t receive any object. But i guess you&#39;re talking about t1 and in that case, yeah that is true that it doesn&#39;t receive any objects. I want t1 to run continuously despite not receiving anything, but when t2 is activated, I want them to synchronize on the usage of ObjectInputStream."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d799a3f9fa2cfe1bcebe2c73cd5aa77d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7226774,"user_type":"registered","user_id":5515060,"link":"https://stackoverflow.com/users/5515060/lino","reputation":19717,"display_name":"Lino","accept_rate":100},"content_license":"CC BY-SA 4.0","score":2,"post_id":71320990,"edited":false,"creation_date":1646216520,"comment_id":126066573,"body":"Because you never receive an object?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71311675,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"edited":false,"creation_date":1646201081,"comment_id":126061907,"body":"Hi Gray... I have updated above problem with code snippet."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 4.0","score":2,"post_id":71317154,"edited":false,"creation_date":1646192545,"comment_id":126060506,"body":"The constructor doesn&#39;t get called because you&#39;re not calling it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71311675,"edited":false,"creation_date":1646165231,"comment_id":126054861,"body":"Can you provide a small code snippet?"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71212008,"edited":false,"creation_date":1645532858,"comment_id":125891312,"body":"Your understanding was true before Java 5. And it still would be true when the field is modified after publication."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GiAodSydlQ6OSWarwkzr-_d2qQsh_c6dIkeK2PS=k-s256","account_id":23525175,"user_type":"registered","user_id":17571825,"link":"https://stackoverflow.com/users/17571825/nickthefreak97","reputation":33,"display_name":"NickTheFreak97"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71096361,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"edited":false,"creation_date":1644828672,"comment_id":125700092,"body":"@Darkman: The point would be that students can join mid class at any time. For a student joining when the class already started, the class ending time would be different than the others in the same classroom. Also it shouldn&#39;t be a student&#39;s responsibility to manage the beginning and end of classes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71096361,"edited":false,"creation_date":1644771041,"comment_id":125688926,"body":"It seems that you don&#39;t need to <code>synchronized</code> or <code>wait()</code> at all. Why not just using <code>Thread.sleep()</code>? Let the students <code>joinClass()</code> any time they want to, put them to <code>sleep(3000L)</code>, and voila <code>remove(0)</code> them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ebe86c740cbc6df07e23cf0109fae16?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9966483,"user_type":"registered","user_id":7374044,"link":"https://stackoverflow.com/users/7374044/user7374044","reputation":157,"display_name":"user7374044"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"edited":false,"creation_date":1637000807,"comment_id":123702891,"body":"@BrennenSprimont I&#39;m asking for now theoretically cause they biggest concern I have is that should it look like when developing microservices. I don&#39;t know if I should split microservice between readers-microservice and writers-microservice to be able to scale them independently. Also I don&#39;t know how I should do with the MySQL db. I will be using 2 tables not more. From time to time updates and inserts, mostry reads (simple selects with primary key)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973901,"comment_id":123692046,"body":"The other threads are NOT started. Before starting a new thread, you get stuck on the <code>serverSocket.accept()</code> call which is blocking forever, waiting for some client to connect on the socket. Move that call into the handlers, perhaps, or into a separate thread. Only then will the handler thread start. Still, you&#39;d never exit the loop and therefore never start any clients, so you still need to fix that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973551,"comment_id":123691920,"body":"To not to block the main thread which executes the infinite loop"},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"edited":false,"creation_date":1636973477,"comment_id":123691891,"body":"@kiner_shah I don&#39;t think it&#39;s relevant to the question.."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"edited":false,"creation_date":1636973442,"comment_id":123691876,"body":"@Antoniossss But why? That is my question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973366,"comment_id":123691851,"body":"@GoldCredential, where is <code>GameClient</code> defined?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973365,"comment_id":123691849,"body":"Start your server in a separate thread."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EOq0k.jpg?s=256&g=1","account_id":5989971,"user_type":"registered","user_id":6168139,"link":"https://stackoverflow.com/users/6168139/rushi","reputation":142,"display_name":"rushi"},"edited":false,"creation_date":1636973260,"comment_id":123691811,"body":"@rushi I meant the main thread could be paused and the program could go to one of the newly created threads."},{"owner":{"profile_image":"https://i.stack.imgur.com/EOq0k.jpg?s=256&g=1","account_id":5989971,"user_type":"registered","user_id":6168139,"link":"https://stackoverflow.com/users/6168139/rushi","reputation":142,"display_name":"rushi"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973217,"comment_id":123691792,"body":"Why would context switching cause the the while loop to break?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973072,"comment_id":123691724,"body":"Your question is unclear and is missing information. <code>GameClientHandler</code> where is this defined and what does it contain? What are you expecting to happen with your code?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJzLkOQelMMXYxAJxRKLvxqRtrmM6VXMlnw9PvD0=k-s256","account_id":23184907,"user_type":"registered","user_id":17282180,"link":"https://stackoverflow.com/users/17282180/iosiv","reputation":25,"display_name":"Iosiv"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967482,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"edited":false,"creation_date":1636927509,"comment_id":123682296,"body":"@BurakSerdar you are right. I was just experimenting and forgot to move it back to where it was originally (after the while loop). And yes, I&#39;m sure it is full of problems, like the fact that InterruptedExceptions are not being catched anywhere..."},{"owner":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"content_license":"CC BY-SA 4.0","score":1,"post_id":69967482,"edited":false,"creation_date":1636927312,"comment_id":123682245,"body":"You are printing &quot;Ball taken..&quot; before the ball is actually taken. That is only one of the problems though."},{"owner":{"profile_image":"https://i.stack.imgur.com/dVLIh.jpg?s=256&g=1","account_id":5281408,"user_type":"registered","user_id":4216641,"link":"https://stackoverflow.com/users/4216641/turing85","reputation":18797,"display_name":"Turing85"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967482,"edited":false,"creation_date":1636927240,"comment_id":123682225,"body":"Please <a href=\"https://stackoverflow.com/posts/69967482/edit\">edit</a> the post and show the class creating the <code>Payer</code>-instances, as well as the <code>Ball</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"edited":false,"creation_date":1636924724,"comment_id":123681722,"body":"These days, MySQL and just about every sql engine should be able to handle 3+ writer threads/processes without any problems. What do your insert statements look like? Are there any triggers? Are you manually locking in your insert statements or in a trigger? Have you made any major configuration changes from what came out of the box?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ebe86c740cbc6df07e23cf0109fae16?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9966483,"user_type":"registered","user_id":7374044,"link":"https://stackoverflow.com/users/7374044/user7374044","reputation":157,"display_name":"user7374044"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"edited":false,"creation_date":1636924289,"comment_id":123681617,"body":"@BrennenSprimont I know it&#39;s a wide topic but in your example: if I use the e.g. 3 writers threads how I will sync them to do not make a lock / deadlock on a mysql table? How should I syncronize them?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"edited":false,"creation_date":1636923276,"comment_id":123681364,"body":"I don&#39;t think there is a &quot;1 size fits all&quot; solution for these kind of systems. You&#39;ll need to describe the system more. As for your questions, you can have several threads or processes reading/writing to a database. Just make more database connections (a lot of this handled through connection pools in libraries these days). Queue&#39;s are really common for these kinds of systems, Kafka is a popular one, but again, it&#39;s hard to tell if queues/kafka is the right tool without knowing more. As for books, look for stuff on &quot;horizontal scaling&quot;, I think this is the term you are looking for."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":1,"post_id":69960082,"edited":false,"creation_date":1636898510,"comment_id":123675090,"body":"IMO, you are mixing up what &quot;fully constructed&quot; means. The <code>ArrayList</code> instance is <i>empty</i> when it is &quot;fully constructed.&quot; Then, the <code>Dummy</code> constructor <i>mutates</i> the list, <i>after</i> the list has been &quot;constructed.&quot; Your use of <code>final</code> prevents the other thread from seeing the <i>list</i> in an un-constructed state, but you allow the other thread to see the <code>Dummy</code> instance before the <code>Dummy</code> is fully constructed. You allow it to see the <code>Dummy</code> while its constructor still is mutating the list."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":2,"post_id":69960082,"edited":false,"creation_date":1636863083,"comment_id":123668830,"body":"What are you actually asking?  As far as I can see, this &quot;question&quot; doesn&#39;t actually contain any questions.  Just a statement of intent, and some assertions about how you believe this code should behave.  What do you actually want us to answer here?"},{"owner":{"profile_image":"https://i.stack.imgur.com/bCY3c.png?s=256&g=1","account_id":12206189,"user_type":"registered","user_id":8909235,"link":"https://stackoverflow.com/users/8909235/lkatiforis","reputation":5872,"display_name":"lkatiforis"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957844,"edited":false,"creation_date":1636834429,"comment_id":123664799,"body":"You forgot to add the code snippet."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636816390,"comment_id":123660674,"body":"...In Java, those special measures are called &quot;synchronization,&quot; and the literature talks about the &quot;happens before relationships&quot; that synchronization establishes. &quot;Java synchronization&quot; and &quot;Java happens before&quot; are good terms to search for in Google."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636816294,"comment_id":123660652,"body":"The compiler, the JRE, and even the hardware operate under the assumption that most code will not interact with other threads. That&#39;s the best strategy because allowing for interactions between threads slows things down, and in fact, <i>most</i> of our code does <i>not</i> depend on other threads. So, if some other thread happens to change the value of <code>server.lock</code>, there&#39;s no guarantee about when (or even, if <i>ever</i>) that the thread executing the loop in your example will &quot;see&quot; the change. If you want to ensure that the loop promptly sees it, then you&#39;ll have to take special measures..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636814473,"comment_id":123660252,"body":"This seems to be the same as <a href=\"https://stackoverflow.com/q/25425130/217324\">stackoverflow.com/q/25425130/217324</a>,  it means you have a memory visibility issue. Also using busy waiting is a really inefficient way to solve this."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJynPZiDBDs71AjXvsPBCToWWKmYqFbwB2ssAvX0=k-s256","account_id":23182000,"user_type":"registered","user_id":17279700,"link":"https://stackoverflow.com/users/17279700/darius-boengiu","reputation":21,"display_name":"Darius Boengiu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69954623,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0b74304b7f2b17bae10c78728f8b874b?s=256&d=identicon&r=PG","account_id":3042393,"user_type":"registered","user_id":2579066,"link":"https://stackoverflow.com/users/2579066/marvin","reputation":643,"display_name":"Marvin","accept_rate":50},"edited":false,"creation_date":1636810323,"comment_id":123659325,"body":"@Marvin if I don&#39;t use join not all types of tickets will be stored in the array"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0b74304b7f2b17bae10c78728f8b874b?s=256&d=identicon&r=PG","account_id":3042393,"user_type":"registered","user_id":2579066,"link":"https://stackoverflow.com/users/2579066/marvin","reputation":643,"display_name":"Marvin","accept_rate":50},"content_license":"CC BY-SA 4.0","score":1,"post_id":69954623,"edited":false,"creation_date":1636810242,"comment_id":123659312,"body":"Joining the Thread after start will stop executing for-loop until that thread is finished."},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636808651,"comment_id":123658938,"body":"Thinking more about it, it seems to me that, if you don&#39;t need notification of the completion of all downloads, all that would be needed is for the work threads to keep a private flag that indicates if it just queued up a retry request.  If it gets a null, (or other termination request), it requeues the termination request but only terminates itself if it has not just requeued a retry.  That ensures that there will alwsys be a thread to handle any last retries:)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/526bc371b11b45dc3a16ba95bc31b278?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7405785,"user_type":"registered","user_id":5634769,"link":"https://stackoverflow.com/users/5634769/gpasch","reputation":2672,"display_name":"gpasch"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636804937,"comment_id":123658113,"body":"My solution would be to use as much flags and things as possible. Right now you dont have a solution that works. As for calling for an &quot;elegant&quot; solution that is a qualitative statement so that leads me NOWHERE!!"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636796011,"comment_id":123656326,"body":"Maybe a priority queue with the killer-null as lowest priority?  That would seem to work?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636795635,"comment_id":123656232,"body":"Yes, there is still the issue of how the producer could determine when the last download has been successfully downloaded, ie. there can be no more download attempts to retry:("},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636794317,"comment_id":123655980,"body":"&#39;blocking queue has no mechanism for the producer to signal that it won&#39;t be putting more data to the queue&#39;.  That&#39;s easy, if you really need to do it - queue up a null reference instead of a valid URL object and have the work threads check the dequeued reference for null and, if it is, requeue the null and terminate.  Pretty soon after posting the null, all your work threads will have got the null and be gone:)"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636794052,"comment_id":123655933,"body":"&#39;The problem of notifying the worker threads that they could exit once the queue was empty&#39;..is that necessary?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636793995,"comment_id":123655920,"body":"&#39;once the producer was finished, it couldn&#39;t just complete its execution because it needed to hang around to put failed URLs back into the queue&#39;....why is that a problem?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/df5e4bae59e1c0f2e390095d2142fe1a?s=256&d=identicon&r=PG","account_id":22856176,"user_type":"registered","user_id":17001012,"link":"https://stackoverflow.com/users/17001012/riggel","reputation":11,"display_name":"Riggel"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69946372,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/31b41159edcc827d59913465cf571717?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13113788,"user_type":"registered","user_id":9473786,"link":"https://stackoverflow.com/users/9473786/tyler-v","reputation":10080,"display_name":"Tyler V"},"edited":false,"creation_date":1636790546,"comment_id":123655314,"body":"I added my Fragment."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31b41159edcc827d59913465cf571717?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13113788,"user_type":"registered","user_id":9473786,"link":"https://stackoverflow.com/users/9473786/tyler-v","reputation":10080,"display_name":"Tyler V"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69946372,"edited":false,"creation_date":1636766847,"comment_id":123652427,"body":"If your fragments are slow to create it likely means you are doing too much work in the Fragment itself. The solution is to fix the Fragment so it can load and display its own data asynchronously, not to create it like this in a handler (which is not implemented correctly anyway). You would have to post an actual Fragment that shows this issue if you wanted more specific answers..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629189117,"comment_id":121614344,"body":"@SolomonSlow I need to <code>CompleteableFuture</code> because I want to process in parallel everything, like read from DB in main thread, then process in the thread pools.  Actually You are right I didn&#39;t need to store the results, After removing <code>futures.add</code> and then just finally calling the <code>shutdown</code> method resolved the memory issue and it didnt even skipped the tasks pending in the thread pools, as I was thinking. <code>ExecutorService</code> FixedThreadPool create live thread and not daemon threads, so the program does not exits untill all tasks are finished. Thanks for the help."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68802148,"edited":false,"creation_date":1629129712,"comment_id":121599926,"body":"Actually, Why are you using <code>CompletableFuture</code> at all? You&#39;re building a list of 1,000,000 results, and then you want to create an array of those results, but where do you actually ever <i>use</i> the results? If I were trying to solve your problem, I would use a <code>ThreadPoolExecutor</code> that was constructed with a fixed-size <code>ArrayBlockingQueue</code> for its task queue, and I would submit plain <code>Runnable</code> tasks to it. Because the queue is bounded, that would prevent the database reader thread from out-pacing the worker threads, and it would limit your heap usage."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629127599,"comment_id":121599048,"body":"@SolomonSlow TotalData is 1Million whereas workerCount starts from 0 and then after each iteration 5k is added to it and it stops when it reaches to 1Million by that time alot of data is already processed by threads but I get heap memory error as I save results in a list. I do that to call the Completeable future join method to process any remaining tasks"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629126755,"comment_id":121598655,"body":"So, are you  saying that <code>totalData</code> is 5K, and not one million? <code>totalData</code> is how many results will be in memory at the same time, and it&#39;s the upper bound on how many records might be in memory at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629125047,"comment_id":121597710,"body":"@SolomonSlow No, I read data in batches lets say I read 5k records each time and then that array is  supplied to the &#39;supplyAsync&#39; method which will be processed in a thread pool.  The loop is working on the main thread as soon as the count reaches to totalData it exists goes to next code snippet where i call the shutDown methods of the executor services"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629124789,"comment_id":121597570,"body":"@SolomonSlow workerCount var is used as on offset for picking data from DB, I agree its poorly named.  The number of threads are set to 15 when the initial task is being sent, its result is processed in another thread pool  whose thread count is 10"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629124630,"comment_id":121597482,"body":"What is the point of &quot;reading data...in batches?&quot; Your loop doesn&#39;t appear to do the actual work in batches. It looks like you first submit the entire one million tasks to the pool, and then you wait for all of them to be completed. Depending on the relative speed of processing the records vs. retrieving the records, and depending on the structure of code you haven&#39;t shown to us, you may have up to the whole one million records in memory at the same time, and you certainly will have the whole one million results in memory at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629124400,"comment_id":121597360,"body":"Your <code>Worker</code> class looks like a <i>task</i>, and your <code>workerCount</code> looks like the number of tasks that have been submitted to the thread pool. A task is not the same thing as a worker. We usually say &quot;worker&quot; when we are talking about the threads that belong to the pool. Each worker performs many tasks in a typical thread pool use-case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a97334841a1e42ce096e1e220116af2?s=256&d=identicon&r=PG","account_id":931371,"user_type":"registered","user_id":961204,"link":"https://stackoverflow.com/users/961204/jobless91","reputation":33,"display_name":"jobless91"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68784557,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"edited":false,"creation_date":1629087870,"comment_id":121584354,"body":"Thanks @TomDibble, I had forgot to add sleep() or if (Thread.interrupted()) condition in my code sample."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"edited":false,"creation_date":1629076890,"comment_id":121583006,"body":"@BeUndead thanks, i will look up to the thread pool design, i think implementing your idea is a more viable task todo since resedesign the rfc6455 does take a week or so. Regarding the Spring Framework, do you have good tutorial on how to see Spring annotation works e.g. <code>@EnableWebSocketMessageBroker</code> which class the annotation create, so I can be better on how the server works step by step."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629076439,"comment_id":121582941,"body":"@chrylis-cautiouslyoptimistic- For the specific reason, I dont know how Spring dependency injection works, it&#39;s like a Black Box, use &#39;@SpringApplication` and couple of this that, suddenly you have websocket endpoint. But when I found a bug, reading the document is a hell to went through and when you want a specific feature, I am not sure how to implement it because Spring Framework actually dont tell you which class does that specific annotation use e.g. <code>@EnableWebSocketMessageBroker</code>. I spent weeks to debug and read the Spring Framework without progress."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629076424,"comment_id":121582940,"body":"@chrylis-cautiouslyoptimistic- &quot;handle&quot; in this case, how do the server receive incoming packet data and sending packet data, currently I put each WebSocket connection in 1 unique thread, but this mean I have to create thread pool of 100 threads to handle 100 alive connection unlike HTTP request/response. Environment? I still use it locally on my laptop, I have not push it, probably using graalvm. I have not finished with thr SSL context yet."},{"owner":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629075890,"comment_id":121582859,"body":"Ideally, make a threadpool (of whatever size your regular traffic is) and allow it to grow (and preferably shrink) to handle spikes, and let java+OS worry about the rest... But even more ideally, don’t do this yourself, use a library like @chrylis recommended above. These are ludicrously complicated topics, which take people years to figure out (I certainly haven’t) and even more years to implement well."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"edited":false,"creation_date":1629075664,"comment_id":121582833,"body":"@BeUndead assuming the concurrency concept and clever hardware design, <code>Executors.newFixedThreadPool(2000);</code> will not cause problem because 1. The OS will delegate each thread at a time <code>Thread A - &gt; Thread B - &gt; Thread A</code> and 2. CPU nowadays capable to execute 2 threads at the same time, assuming I have a 4 cores, the best thread pool size is 8 threads, I just have to redesign how to handle the WebSocket connections <code>e.g. 2000 keep alive connections</code> in 8 threads. Am I right?"},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"edited":false,"creation_date":1629074967,"comment_id":121582756,"body":"What exactly do you mean by &quot;handle&quot;, and what environment are you running your sockets in? Is there a specific reason you&#39;re not using an existing platform (such as Spring) to handle these matters for you automatically?"},{"owner":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68796254,"edited":false,"creation_date":1629074957,"comment_id":121582753,"body":"<a href=\"https://stackoverflow.com/a/34689857/2478398\">stackoverflow.com/a/34689857/2478398</a> Give this answer and the one below it a read. But in effect ‘it depends’, and on a lot of things such as how CPU intensive the tasks you’re giving each thread are."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68784557,"edited":false,"creation_date":1629059463,"comment_id":121580564,"body":"Added a Thread.sleep(5000); in Thread B so it compiles and sits there until threadA interrupts it. I think that was what was intended originally."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629031004,"comment_id":121573920,"body":"@tgdavies my code only works correctly in one thread"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629030933,"comment_id":121573900,"body":"@tgdavies synchronised my two account. Why not? i get a full fledged object from my database"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"edited":false,"creation_date":1629030445,"comment_id":121573804,"body":"(and for bonus points: if your code worked correctly, can you see how it can deadlock?)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":1,"post_id":68791080,"edited":false,"creation_date":1629030361,"comment_id":121573788,"body":"What does synchronised do exactly? What does that mean <code>findById</code> must guarantee for your code to work?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629030209,"comment_id":121573759,"body":"@tgdavies what&#39;s wrong with taking data from the database?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"edited":false,"creation_date":1629030115,"comment_id":121573737,"body":"@BoristheSpider I take these values ​​from the database and i lock monitor"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"edited":false,"creation_date":1629028202,"comment_id":121573279,"body":"What requirement does your synchronisation scheme place on <code>accountRepository.findById</code>?"},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":1,"post_id":68791080,"edited":false,"creation_date":1629026940,"comment_id":121573015,"body":"I also see <code>Account.numberTransaction++</code> which is not a thread safe call."},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":2,"post_id":68791080,"edited":false,"creation_date":1629026854,"comment_id":121572998,"body":"What do you think your synchronised blocks are doing here? Put another way, where does the instance of <code>Account</code> come from?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1628969048,"comment_id":121564662,"body":"@ThomasKl&#228;ger there is no synchronization point required for a sleep. <a href=\"https://docs.oracle.com/javase/specs/jls/se16/html/jls-17.html#jls-17.3\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/specs/jls/se16/html/jls-17.html#jls-1&zwnj;&#8203;7.3</a> &quot;It is important to note that neither Thread.sleep nor Thread.yield have any synchronization semantics.&quot;"},{"owner":{"profile_image":"https://i.stack.imgur.com/uAEcW.jpg?s=256&g=1","account_id":1689973,"user_type":"registered","user_id":1552534,"link":"https://stackoverflow.com/users/1552534/wjs","reputation":37330,"display_name":"WJS"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68786081,"edited":false,"creation_date":1628968522,"comment_id":121564550,"body":"I wonder if using a <code>record</code> type would help since records are inherently immutable?"},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":2,"post_id":68786081,"edited":false,"creation_date":1628968246,"comment_id":121564489,"body":"Note that if you are wanting the fields not to be modifiable, make them <code>final</code>. Also, the JVM is tuned to make creating lots of small objects <i>extremely</i> cheap; in a multithreaded scenario, your overhead is going to be collecting them all in one place."},{"owner":{"profile_image":"https://i.stack.imgur.com/uAEcW.jpg?s=256&g=1","account_id":1689973,"user_type":"registered","user_id":1552534,"link":"https://stackoverflow.com/users/1552534/wjs","reputation":37330,"display_name":"WJS"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628967573,"comment_id":121564347,"body":"Before considering significant performance improvements in threading, you may want to consider how many cores you have.  Unless you have multiple cores and lots of processing to do using multiple threads won&#39;t benefit you."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628966607,"comment_id":121564133,"body":"tl;dr; Add your code, and give us the bench mark times."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628966579,"comment_id":121564132,"body":"Possibly because you&#39;re not cpu bound. Possibly because you&#39;re doing the multi-threading wrong.  I would go with the first assumption since 1 million objects isn&#39;t that many, and to create 1 million objects with two fields, it would be pretty hard to improve with threads."},{"owner":{"profile_image":"https://i.stack.imgur.com/fL1rH.png?s=256&g=1","account_id":935202,"user_type":"registered","user_id":964243,"link":"https://stackoverflow.com/users/964243/boann","reputation":49046,"display_name":"Boann","accept_rate":66},"content_license":"CC BY-SA 4.0","score":1,"post_id":68785125,"edited":false,"creation_date":1628966203,"comment_id":121564039,"body":"<a href=\"https://stackoverflow.com/questions/25425130/loop-doesnt-see-value-changed-by-other-thread-without-a-print-statement\" title=\"loop doesnt see value changed by other thread without a print statement\">stackoverflow.com/questions/25425130/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 4.0","score":2,"post_id":68785125,"edited":false,"creation_date":1628959340,"comment_id":121562432,"body":"Without declaring the <code>flag</code> as <code>volatile</code> and without other statements that require synchronization points (<code>Thread.sleep()</code> and <code>System.out.println()</code> both require these) the JVM may assume that the main thread is the only thread accessing (reading and/or writing) the <code>flag</code> variable, i.e. it may move the read of the <code>flag</code> variable <b>before</b> the <code>while (true) {}</code> statement."},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":2,"post_id":68785125,"edited":false,"creation_date":1628959221,"comment_id":121562409,"body":"Yup, <code>PrintWriter</code> is <code>sychronized</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c4269e3a7210fb1a98b7de6f4ecd5336?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8446407,"user_type":"registered","user_id":6336910,"link":"https://stackoverflow.com/users/6336910/tom-chen","reputation":43,"display_name":"Tom Chen"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"edited":false,"creation_date":1628959107,"comment_id":121562380,"body":"But, when i replace the &quot;Thread.sleep(1);&quot;  to &quot;System.out.println(&quot;balabala&quot;);&quot; ,  it also fix the problem"},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"edited":false,"creation_date":1628958620,"comment_id":121562260,"body":"<code>sleep</code> (may) cause your thread to be descheduled so it’s caches would be flushed. To point 2; no. If it’s not written back to main memory then it’s moot in any case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ffbf4e85b8ffbae4e9039b9c0cf07bc8?s=256&d=identicon&r=PG","account_id":2496,"user_type":"registered","user_id":3474,"link":"https://stackoverflow.com/users/3474/erickson","reputation":266244,"display_name":"erickson","accept_rate":83},"content_license":"CC BY-SA 4.0","score":2,"post_id":68760729,"edited":false,"creation_date":1628785951,"comment_id":121520687,"body":"I understand this is an assignment, but it&#39;s a stupid one. The best tool for this job (or anything that requires alternation of tasks in perfect lockstep) is a single thread. Also global variables are terrible too."},{"owner":{"profile_image":"https://i.stack.imgur.com/zflGZ.png?s=256&g=1","account_id":440158,"user_type":"registered","user_id":829571,"link":"https://stackoverflow.com/users/829571/assylias","reputation":323231,"display_name":"assylias","accept_rate":94},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760729,"edited":false,"creation_date":1628784998,"comment_id":121520310,"body":"You need some form of synchronization between the two threads, otherwise how would they know when to run and when to wait? Using a boolean is one option."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68746177,"edited":false,"creation_date":1628712818,"comment_id":121498029,"body":"The best way is to use direct access to off-heap memory (see, for example, <a href=\"https://github.com/anatolygudkov/workshops/tree/master/offheap-memory\" rel=\"nofollow noreferrer\">github.com/anatolygudkov/workshops/tree/master/offheap-memor&zwnj;&#8203;y</a>) and make sure you address the memory in sequential manner (cache-friendly) if possible. Also, make sure you share between threads as less memory as possible and the sharing is correct in terms of JMM."},{"owner":{"profile_image":"https://i.stack.imgur.com/DaSIO.jpg?s=256&g=1","account_id":12191330,"user_type":"registered","user_id":8898704,"link":"https://stackoverflow.com/users/8898704/asad-ganiev","reputation":459,"display_name":"Asad Ganiev"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68746177,"edited":false,"creation_date":1628707067,"comment_id":121496058,"body":"How about allocating data to off-heap?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1623203402,"comment_id":120009585,"body":"@Holger do you mind posting an answer? I understood your point finally."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/113b0b46b3de42ce4dee28c6006a85c5?s=256&d=identicon&r=PG","account_id":63444,"user_type":"registered","user_id":187808,"link":"https://stackoverflow.com/users/187808/tamas-rev","reputation":7018,"display_name":"Tamas Rev","accept_rate":100},"edited":false,"creation_date":1622833684,"comment_id":119914556,"body":"@TamasRev no you can&#39;t use <code>get</code>. The comments and the initial questions I linked discuss that much broader."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/113b0b46b3de42ce4dee28c6006a85c5?s=256&d=identicon&r=PG","account_id":63444,"user_type":"registered","user_id":187808,"link":"https://stackoverflow.com/users/187808/tamas-rev","reputation":7018,"display_name":"Tamas Rev","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"edited":false,"creation_date":1622816357,"comment_id":119907973,"body":"Yes, it is good enough for visibility. I think it&#39;s a bit too much for visibility. For the <code>read()</code> method you can use <code>CHM.get()</code> and live happily ever after."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67825678,"edited":false,"creation_date":1622797003,"comment_id":119899831,"body":"You’re going back to the issue already <a href=\"https://stackoverflow.com/a/67822241/2711488\">explained here</a>. The problem is, what does the caller of <code>read</code> do? It will see “the result of the latest <code>write</code>”, but which write was the latest write? Without any defined order, none may have happen yet and all of them may be running just now, concurrently to the caller of the <code>read</code> method."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 4.0","score":1,"post_id":67825678,"edited":false,"creation_date":1622739725,"comment_id":119884905,"body":"I would consider this to be implied by the thread-safety guarantee."},{"owner":{"profile_image":"https://i.stack.imgur.com/zflGZ.png?s=256&g=1","account_id":440158,"user_type":"registered","user_id":829571,"link":"https://stackoverflow.com/users/829571/assylias","reputation":323231,"display_name":"assylias","accept_rate":94},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621335709,"comment_id":119459227,"body":"@Polcio The problem comes from parts of your code that you have not shown here, so it&#39;s a bit hard to guess what the cause could be. Can you try to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621334753,"comment_id":119458795,"body":"There&#39;s <i>probably</i> a race condition there (it should be an <code>AtomicInteger</code>), but I think it&#39;s unlikely that that causes the problem you describe."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-GLkF4bZir6M/AAAAAAAAAAI/AAAAAAAAAMQ/F902rk_Qd38/photo.jpg?sz=256","account_id":10496819,"user_type":"registered","user_id":7736755,"link":"https://stackoverflow.com/users/7736755/polcio","reputation":3,"display_name":"Polcio"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67584453,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"edited":false,"creation_date":1621334338,"comment_id":119458610,"body":"@JoachimSauer I do have a <code>static</code> field, but it&#39;s only an integer that keeps track of the number of people that have been updated. Every call to scrape() adds 1 to that static integer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621334045,"comment_id":119458456,"body":"Sounds like you have some <code>static</code> fields or maybe <code>ThreadLocal</code> values that get mixed up. Maybe a shared HTTP connection  object? Anything like that. But your question doesn&#39;t contain enough details to know for sure."},{"owner":{"profile_image":"https://i.stack.imgur.com/Losy8.jpg?s=256&g=1","account_id":17020749,"user_type":"registered","user_id":12313402,"link":"https://stackoverflow.com/users/12313402/vijay","reputation":1278,"display_name":"Vijay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64346783,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cH194.png?s=256&g=1","account_id":13960481,"user_type":"registered","user_id":10081874,"link":"https://stackoverflow.com/users/10081874/rishabh-ritweek","reputation":600,"display_name":"Rishabh Ritweek"},"edited":false,"creation_date":1621320757,"comment_id":119452527,"body":"Update from me (@Vijay), we should stop all threads in the onStop() override method. There is no need to run the process if the activity is closed because they are not going to make any changes now."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621285053,"comment_id":119444999,"body":"From the same site: <a href=\"https://www.baeldung.com/java-wait-and-sleep\" rel=\"nofollow noreferrer\">Wait and sleep</a> and <a href=\"https://www.baeldung.com/java-thread-safety\" rel=\"nofollow noreferrer\">Thread safety</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284956,"comment_id":119444961,"body":"@kidfrom read my comment above, wait() releases the lock, so it actually breaks the synchronized method in two parts, ergo it&#39;s no longer atomic and no longer thread safe. That&#39;s it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":3,"post_id":67576652,"edited":false,"creation_date":1621284827,"comment_id":119444915,"body":"I would say it&#39;s just a really bad example - or at least, a very poorly explained one. If they&#39;d used <code>Thread.sleep</code>, it would still be safe. To use <code>Object.wait</code> <i>without explaining that that effectively splits the synchronized method into two synchronized blocks</i> is really poor IMO :("},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"edited":false,"creation_date":1621284670,"comment_id":119444864,"body":"@Rocco I am refering to Baeldung.com, please kindly check the article I have attached above, it has a chance of thread interleaving, it demonstrate it by using <code>Object.wait(100)</code> without actually explaining further."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284525,"comment_id":119444831,"body":"@kidfrom the synchronized code without the wait <b>is</b> thread-safe, why do you say it&#39;s not?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"edited":false,"creation_date":1621284275,"comment_id":119444727,"body":"@akuzminykh My bad, I have updated the post. The expected result is 10 because the unit test execute the <code>Counter.increment()</code> 10 times."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"edited":false,"creation_date":1621284190,"comment_id":119444690,"body":"@JonSkeet I think Baeldung.com is trying to explain about synchronized keyword does not always mean thread safe method. Do you happen know how to explain why this code is not thread safe, without the <code>Object.wait()</code>?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284154,"comment_id":119444678,"body":"Why should the result be 2? What does &quot;fail&quot; mean to you?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"edited":false,"creation_date":1621284023,"comment_id":119444631,"body":"@JonSkeet from my understanding, updating the count value require 3 operations. <code>read</code>, <code>increment</code>, <code>write</code>. The <code>Object.wait()</code> and <code>Thread.sleep()</code> is to force the <code>increment</code> and <code>write</code> operations to be executed at a later time. Upon closer inspection, <code>Thread.sleep()</code> does not release the lock while <code>Object.wait()</code> does release the lock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621283673,"comment_id":119444537,"body":"Wait releases the monitor, so you read count first, then release the monitor, in the 100ms some other thread can enter the synchronized code and read count. Just to clarify, wait is not a pausing method."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":1,"post_id":67576652,"edited":false,"creation_date":1621283579,"comment_id":119444504,"body":"Can you describe what you understand <code>wait()</code> to do, exactly? In particular, have you thought about the difference between <code>Object.wait()</code> and <code>Thread.sleep</code>?"},{"owner":{"profile_image":"https://graph.facebook.com/1156441754401375/picture?type=large","account_id":9122040,"user_type":"registered","user_id":6787187,"link":"https://stackoverflow.com/users/6787187/alpit-anand","reputation":1213,"display_name":"Alpit Anand","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":67572673,"edited":false,"creation_date":1621265588,"comment_id":119437337,"body":"Got it. :-D, please do write in answer section."},{"owner":{"profile_image":"https://graph.facebook.com/1156441754401375/picture?type=large","account_id":9122040,"user_type":"registered","user_id":6787187,"link":"https://stackoverflow.com/users/6787187/alpit-anand","reputation":1213,"display_name":"Alpit Anand","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":67572673,"edited":false,"creation_date":1621265502,"comment_id":119437296,"body":"Ok, so you are suggesting, just a single object of arc would do the trick ?"},{"owner":{"profile_image":"https://i.stack.imgur.com/QT3fG.png?s=256&g=1","account_id":2709823,"user_type":"registered","user_id":2338547,"link":"https://stackoverflow.com/users/2338547/markspace","reputation":10716,"display_name":"markspace"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67572673,"edited":false,"creation_date":1621265496,"comment_id":119437292,"body":"These are different objects, so the lock is different and each thread acquires its own (different) lock.  You&#39;ll need to lock something in common if you want them to work sequentially."},{"owner":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"content_license":"CC BY-SA 4.0","score":4,"post_id":67572673,"edited":false,"creation_date":1621265465,"comment_id":119437281,"body":"A <code>synchronized</code> method will acquire the lock on the instance. You have two separate instances of <code>Arc</code>, so the two threads acquire locks on two separate objects."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"edited":false,"creation_date":1621254544,"comment_id":119431760,"body":"@MarkRotteveel Even if I don&#39;t run listenerThreadUDP and put it in the queue, the timing is wrong."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67566923,"edited":false,"creation_date":1621247849,"comment_id":119429003,"body":"Consider using a <code>LinkedBlockingQueue</code> or <code>ArrayBlockingQueue</code> instead, those allow you to block waiting for an element."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621247209,"comment_id":119428741,"body":"Processing objects in listeners takes quite a long time, and I need a very accurate arrival time of the object"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621246382,"comment_id":119428343,"body":"Why? Why not do it all in one thread? What benefit are you deriving from the second thread and the queue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ac0a06c961f3af17dca9b69fce42201?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8517137,"user_type":"registered","user_id":6385232,"link":"https://stackoverflow.com/users/6385232/geanakuch","reputation":835,"display_name":"geanakuch"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621244229,"comment_id":119427431,"body":"You probably shouldn&#39;t be using <code>Thread::sleep</code> at all. Try and use <code>wait</code> and <code>notify</code> instead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197514,"edited":false,"creation_date":1621226979,"comment_id":119421761,"body":"Your title doesn&#39;t agree with your question. Please clarify."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=256","account_id":15064163,"user_type":"registered","user_id":10871900,"link":"https://stackoverflow.com/users/10871900/dan1st-is-crying","reputation":13516,"display_name":"dan1st is crying"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67477822,"edited":false,"creation_date":1620731151,"comment_id":119281458,"body":"Also note that the <code>toString()</code> method might create a new String each time so using this for synchronisation is not safe."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2a352f3db748629d8bd227d825f89240?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11953108,"user_type":"registered","user_id":8746228,"link":"https://stackoverflow.com/users/8746228/adarsh","reputation":1423,"display_name":"adarsh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67477822,"edited":false,"creation_date":1620728492,"comment_id":119280272,"body":"<a href=\"https://dzone.com/articles/synchronized-by-the-value-of-the-object-in-java\" rel=\"nofollow noreferrer\">This</a> may help."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":2,"post_id":67477822,"edited":false,"creation_date":1620720297,"comment_id":119276845,"body":"If you have multiple machines accessing the same account id, you can&#39;t use synchronized because you can only synchronized within a single JVM. So it will not prevent different JVM&#39;s from accessing the same account."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":5,"post_id":67477822,"edited":false,"creation_date":1620684043,"comment_id":119268820,"body":"<code>synchronized</code> is useless in a server environment, because it only constrains a single copy of your application. Transactions are how you ensure consistency with multiple instances."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":2,"post_id":67477822,"edited":false,"creation_date":1620683274,"comment_id":119268590,"body":"What you <i>usually</i> need is <code>@Transactional</code>."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-hqwHmWigIJo/AAAAAAAAAAI/AAAAAAAAANk/Nt-fGNNCYUs/photo.jpg?sz=256","account_id":7326250,"user_type":"registered","user_id":5580567,"link":"https://stackoverflow.com/users/5580567/stanislav-orlov","reputation":234,"display_name":"Stanislav Orlov"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485755,"edited":false,"creation_date":1618169734,"comment_id":118515113,"body":"In JDK 11.0.10 this bug is now in httpserver, fix with jdk.tls.disabledAlgorithms=TLSv1.3 helps when server thread is stucked at doClosure() after each new client&#39;s request before previous request was finished"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a1012f8368ea61afa24e1f90ca65363c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20444761,"user_type":"registered","user_id":15000817,"link":"https://stackoverflow.com/users/15000817/george","reputation":116,"display_name":"George"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66472876,"edited":false,"creation_date":1614853940,"comment_id":117514469,"body":"This is a complex topic and it&#39;s easy to get lost. Here&#39;s how I would approach it: - read and understand the basic idea (your favorite documentation/example site) - write some code, play with something in a multi threaded way (here you&#39;ll most likely hit issues and that is  a good spot to start searching for answers and learning more) - once you have something running, read more about threads, issues with them and pitfalls By the time you get here you should have answered your question already.  Check out: <a href=\"https://docs.oracle.com/javase/specs/jls/se15/html/jls-17.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/specs/jls/se15/html/jls-17.html</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dd071a6a7c97ba637c558c5e71137c7b?s=256&d=identicon&r=PG","account_id":332245,"user_type":"registered","user_id":657427,"link":"https://stackoverflow.com/users/657427/christophe-roussy","reputation":16487,"display_name":"Christophe Roussy","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":66472876,"edited":false,"creation_date":1614852925,"comment_id":117513977,"body":"You mean how the JVM does it ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":1,"post_id":66472876,"edited":false,"creation_date":1614852781,"comment_id":117513918,"body":"I can&#39;t help but feel like you&#39;re worrying about the wood and not seeing the trees. Have you tried using them? What were the practical problems you encountered?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8887b6449cf1ee169bfafa91d8348110?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14554565,"user_type":"registered","user_id":12682179,"link":"https://stackoverflow.com/users/12682179/jon-b","reputation":61,"display_name":"Jon B"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614787300,"comment_id":117492851,"body":"Studying for an exam, so clearing the theoretical concepts"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=256&d=identicon&r=PG","account_id":1111280,"user_type":"registered","user_id":1101692,"link":"https://stackoverflow.com/users/1101692/shark","reputation":6531,"display_name":"Shark","accept_rate":89},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614787139,"comment_id":117492767,"body":"... what are you trying to achieve?"},{"owner":{"profile_image":"https://i.stack.imgur.com/oyNTO.jpg?s=256&g=1","account_id":5940172,"user_type":"registered","user_id":4671717,"link":"https://stackoverflow.com/users/4671717/chris-maggiulli","reputation":3457,"display_name":"Chris Maggiulli","accept_rate":25},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614786862,"comment_id":117492638,"body":"This question is better suited for software engineering stack exchange"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":66452567,"edited":false,"creation_date":1614778512,"comment_id":117488306,"body":"It’s not as simple as it looks on the first glance."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":66452567,"edited":false,"creation_date":1614759400,"comment_id":117479793,"body":"Why would it be finalized if you store it in the ThreadLocal? You&#39;ve stored it somewhere that is still reachable (because <code>Foo</code> is still loaded). If you store a string in the ThreadLocal, you&#39;re not storing the Bar, so it is unreachable and can be gc&#39;d."},{"owner":{"profile_image":"https://i.stack.imgur.com/49VtI.jpg?s=256&g=1","account_id":7926575,"user_type":"registered","user_id":5985853,"link":"https://stackoverflow.com/users/5985853/alexey-soshin","reputation":16936,"display_name":"Alexey Soshin"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65411185,"edited":false,"creation_date":1608824786,"comment_id":115695735,"body":"This is, in fact, a difficult problem to solve, since threads in JVM in general are cooperative."},{"owner":{"profile_image":"https://i.stack.imgur.com/RKSgV.png?s=256&g=1","account_id":2485939,"user_type":"registered","user_id":2164365,"link":"https://stackoverflow.com/users/2164365/abra","reputation":19426,"display_name":"Abra","accept_rate":40},"content_license":"CC BY-SA 4.0","score":1,"post_id":65407356,"edited":false,"creation_date":1608636528,"comment_id":115638234,"body":"Have you read <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html\" rel=\"nofollow noreferrer\">Concurrency in Swing</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608598197,"comment_id":115627784,"body":"Not necessarily related to your problem, but note the thread which actually performs the I/O is never stopped even when a timeout occurs."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/958fe700d57780eb1cc28b93796bbf69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13521732,"user_type":"registered","user_id":9754736,"link":"https://stackoverflow.com/users/9754736/scroll","reputation":158,"display_name":"Scroll"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608575807,"comment_id":115620674,"body":"After restarting the task I get new data in file that getting though the circuit board connected by usb. And sometimes circuit board does not fulfill the file with new bytes and file is empty that’s why I want to wait for 5 seconds."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=256&d=identicon&r=PG","account_id":36137,"user_type":"registered","user_id":102937,"link":"https://stackoverflow.com/users/102937/robert-harvey","reputation":178799,"display_name":"Robert Harvey","accept_rate":90},"content_license":"CC BY-SA 4.0","score":1,"post_id":65396228,"edited":false,"creation_date":1608573660,"comment_id":115619829,"body":"If you&#39;re just running threads in series, you don&#39;t need threads; you can just call each method and let them block."},{"owner":{"profile_image":"https://i.stack.imgur.com/QT3fG.png?s=256&g=1","account_id":2709823,"user_type":"registered","user_id":2338547,"link":"https://stackoverflow.com/users/2338547/markspace","reputation":10716,"display_name":"markspace"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65396228,"edited":false,"creation_date":1608568122,"comment_id":115617251,"body":"Yes, multiple cores help, but not if the entire process blocks and only one thread can execute at a time.  That obviously does nothing to complete faster.  What you are after is parallelism, and it&#39;s not automatic when using multiple threads.  Look up <a href=\"https://en.wikipedia.org/wiki/Amdahl%27s_law\" rel=\"nofollow noreferrer\">Amdahl&#39;s Law.</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65396228,"edited":false,"creation_date":1608567552,"comment_id":115616989,"body":"It helps in situations where several tasks can work independently without synchronization."},{"owner":{"profile_image":"https://i.stack.imgur.com/rkpYv.jpg?s=256&g=1","account_id":2819940,"user_type":"registered","user_id":2423906,"link":"https://stackoverflow.com/users/2423906/sedj601","reputation":12538,"display_name":"SedJ601","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608566854,"comment_id":115616649,"body":"Why would you want to restart reading a file if the complete file has not been read within five seconds? If the file read did not complete within five seconds of the first attempt, what are the chances of it completed in five seconds any attempt after that?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/958fe700d57780eb1cc28b93796bbf69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13521732,"user_type":"registered","user_id":9754736,"link":"https://stackoverflow.com/users/9754736/scroll","reputation":158,"display_name":"Scroll"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608564422,"comment_id":115615487,"body":"@Joe Thanks for your answer. May JavaFx has a better way to realize timeout for task without CompletableFuture?"},{"owner":{"profile_image":"https://i.stack.imgur.com/2VjzX.jpg?s=256&g=1","account_id":6696437,"user_type":"registered","user_id":5164318,"link":"https://stackoverflow.com/users/5164318/emandt","reputation":2557,"display_name":"emandt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393915,"edited":false,"creation_date":1608563271,"comment_id":115614952,"body":"You didn&#39;t post &quot;postRequest()&quot; code, so it&#39;s not easy to understand when you run &quot;notify()&quot;. Also there isn&#39;t any &quot;WHILE&quot; so where do you do the iteration? However your solution seems wrong because &quot;dialog&quot; seems an UI element and MUST BE NOT accessed from the &quot;doInBackground()&quot; directly. Please add &quot;postRequest()&quot; code"},{"owner":{"user_type":"does_not_exist","display_name":"user2670200"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65393125,"edited":false,"creation_date":1608561706,"comment_id":115614208,"body":"the word &quot;Future&quot; says literally IN THE FUTURE and NOT JET and that is the reason why &quot;it skips read data code and falls to try block right away&quot;. Maybe this thread here can help you out of the maze <a href=\"https://stackoverflow.com/questions/34233375/return-completablefuturevoid-or-completablefuture\" title=\"return completablefuturevoid or completablefuture\">stackoverflow.com/questions/34233375/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/ayujB.jpg?s=256&g=1","account_id":70123,"user_type":"registered","user_id":203657,"link":"https://stackoverflow.com/users/203657/kleopatra","reputation":51175,"display_name":"kleopatra","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608550508,"comment_id":115609370,"body":"a) use fx concurrency/animation support b) whatever you use, you <b>must not</b> update nodes (nor any of their properties) off the fx application thread c) when asking for debugging help, please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating what&#39;s not working as expected"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608548743,"comment_id":115608543,"body":"Also to avoid the exception when doing something from a different thread might be avoided if you put the changing code inside <code>Platform.runLater(new Runnable(){ &#47;* ... *&#47; });</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608548650,"comment_id":115608506,"body":"Welcome to SO. You might be able to use a stopwatch like <code>org.apache.commons.lang.time.StopWatch</code> (documentation: <a href=\"https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/StopWatch.html\" rel=\"nofollow noreferrer\">commons.apache.org/proper/commons-lang/apidocs/org/apache/&hellip;</a>)&zwnj;&#8203;. Start it when your application starts, and use getTime to get the time. I am not sure if there is a porperty to bind to or not."},{"owner":{"profile_image":"https://i.stack.imgur.com/ayujB.jpg?s=256&g=1","account_id":70123,"user_type":"registered","user_id":203657,"link":"https://stackoverflow.com/users/203657/kleopatra","reputation":51175,"display_name":"kleopatra","accept_rate":53},"content_license":"CC BY-SA 4.0","score":1,"post_id":65344341,"edited":false,"creation_date":1608247748,"comment_id":115532926,"body":"java naming conventions please"},{"owner":{"profile_image":"https://i.stack.imgur.com/cH194.png?s=256&g=1","account_id":13960481,"user_type":"registered","user_id":10081874,"link":"https://stackoverflow.com/users/10081874/rishabh-ritweek","reputation":600,"display_name":"Rishabh Ritweek"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64346783,"edited":false,"creation_date":1602652831,"comment_id":113784855,"body":"post the error stack trace"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601640199,"comment_id":113475855,"body":"Yes, just spinning off threads is bad. You would use an executor service of some sort and submit tasks. The problem with locks, is they don&#39;t offer any order. All of the threads get to the lock and wait. When it is free, any one of the threads grab it. The way I have set it up, it says, task A is ready, then it says taskB is ready. I don&#39;t using a queue changes your code that much. I rewrote it because it was easier for me, but you just need to apply the concept."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1601635627,"comment_id":113474126,"body":"@matt 1 code with tryLock is bad, I saw a lock there. I was told that it is better not to rewrite the code too much. There should be 2 streams to output AAGGGA. The option with a queue is interesting, but you have to rewrite everything, does not quite meet the requirements of the task. Or I misunderstood you?"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1601635611,"comment_id":113474120,"body":"@matt 10 threads I was trying to create a situation of increasing load to see if threads are blocked or not. I&#39;ve tried 10 to 10,000 to make sure threads are blocking correctly, but might this be a bad way?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601628642,"comment_id":113471481,"body":"Why are you starting 10 threads? You don&#39;t really have any flow control regarding who grabs the lock again when their free. Also note that your two lock loop, it is very likely that one thread will grab a lock, and then another thread will grab the other lock then they&#39;ll never break out of that loop. This has to do with the locking order."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ffbf4ec8b9cd473633dcd91ae792647?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12223265,"user_type":"registered","user_id":8921755,"link":"https://stackoverflow.com/users/8921755/ivan","reputation":8608,"display_name":"Ivan"},"edited":false,"creation_date":1601620924,"comment_id":113468651,"body":"@Ivan i tried tryLock with timeout but the problem remains in the loop. If I run it, everything will go to sleep. Apparently I do not quite understand how to implement this correctly"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d408dc90321b7207a17d46e0832b43df?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12458416,"user_type":"registered","user_id":9070798,"link":"https://stackoverflow.com/users/9070798/patrick","reputation":1488,"display_name":"Patrick"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601609432,"comment_id":113466324,"body":"Welcome to StackOverflow! &quot;if you call the threads, it will work, but if you call the threads into a loop, everything collapses&quot;.  Could you edit your question to include the code where you call threads into a loop? This would help us distinguish the situations that work/don&#39;t work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ffbf4ec8b9cd473633dcd91ae792647?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12223265,"user_type":"registered","user_id":8921755,"link":"https://stackoverflow.com/users/8921755/ivan","reputation":8608,"display_name":"Ivan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601607348,"comment_id":113466007,"body":"To avoid deadlocks you need to take locks on objects in the same order in all threads like first take lock on an object with smaller hashcode. Or you can use implementation of <code>Lock</code> interface and method <code>tryLock</code> with timeout"},{"owner":{"profile_image":"https://i.stack.imgur.com/vJbKg.jpg?s=256&g=1","account_id":288696,"user_type":"registered","user_id":589259,"link":"https://stackoverflow.com/users/589259/maarten-bodewes","reputation":91230,"display_name":"Maarten Bodewes","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601589889,"comment_id":113462751,"body":"The language barrier is one thing, but it would be nice if you could post a MCVE and indicate the exact errors / situations that you are encountering. &quot;everything collapses&quot; and &quot;we don&#39;t have what we need&quot; are not all that helpful."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-ASSuy8DNx_M/AAAAAAAAAAI/AAAAAAAAAFY/as99ZogPzR8/photo.jpg?sz=256","account_id":14766420,"user_type":"registered","user_id":10664313,"link":"https://stackoverflow.com/users/10664313/pourya-pourbagheri","reputation":11,"display_name":"Pourya Pourbagheri"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64147000,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/46c472a2ce6b7b2b680057df5143a62e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19382678,"user_type":"registered","user_id":14173556,"link":"https://stackoverflow.com/users/14173556/paladin","reputation":774,"display_name":"paladin"},"edited":false,"creation_date":1601551094,"comment_id":113445999,"body":"@paladin thanks, this made it a lot easier."},{"owner":{"profile_image":"https://i.stack.imgur.com/72UnO.png?s=256&g=1","account_id":5553464,"user_type":"registered","user_id":4405757,"link":"https://stackoverflow.com/users/4405757/thiyagu","reputation":17547,"display_name":"Thiyagu","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":64150330,"edited":false,"creation_date":1601536823,"comment_id":113439939,"body":"Why do you need both a semaphore and a fixed thread pool? Wouldn&#39;t having a thread pool of size <code>C</code> and submitting all tasks (<code>Q*N</code> tasks) be sufficient?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/46c472a2ce6b7b2b680057df5143a62e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19382678,"user_type":"registered","user_id":14173556,"link":"https://stackoverflow.com/users/14173556/paladin","reputation":774,"display_name":"paladin"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64147000,"edited":false,"creation_date":1601512417,"comment_id":113434533,"body":"Using &quot;sub images&quot; is indeed most times the best way to handle this. But instead of some real sub images, like 4 quarter images, you better use a &quot;scan-line interleave&quot; method, meaning each thread calculates another line of the image. For example, you have 4 threads, so thread 1 calculates line (1 + 4*n), thread 2 calculates line (2 + 4*n), thread 3 calculates line (3 + 4*n), thread 4 calculates line (4 + 4*n), where n is a natural number (inclusive zero). Java has a large number of image manipulating methods aiding in your task."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/16b7172bb346958c1b69e0229ba1ac4f?s=256&d=identicon&r=PG","account_id":1723085,"user_type":"registered","user_id":1578356,"link":"https://stackoverflow.com/users/1578356/newday","reputation":3842,"display_name":"newday","accept_rate":63},"content_license":"CC BY-SA 4.0","score":0,"post_id":64112611,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/GzStD.jpg?s=256&g=1","account_id":3666831,"user_type":"registered","user_id":3055036,"link":"https://stackoverflow.com/users/3055036/dukekosy","reputation":61,"display_name":"dukekosy"},"edited":false,"creation_date":1601501903,"comment_id":113432046,"body":"The test was done without the collector that uses the response."},{"owner":{"profile_image":"https://i.stack.imgur.com/GzStD.jpg?s=256&g=1","account_id":3666831,"user_type":"registered","user_id":3055036,"link":"https://stackoverflow.com/users/3055036/dukekosy","reputation":61,"display_name":"dukekosy"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64112611,"edited":false,"creation_date":1601498298,"comment_id":113430763,"body":"you&#39;re iterating the list twice. try removing the collector and streaming once."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bdfb4dab635798f20b7ab172df2b3f4e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12583055,"user_type":"registered","user_id":9732672,"link":"https://stackoverflow.com/users/9732672/nomadmaker","reputation":447,"display_name":"NomadMaker"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64141492,"edited":false,"creation_date":1601482607,"comment_id":113424256,"body":"The parent class or parent thread? These are different."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"edited":false,"creation_date":1601461073,"comment_id":113413364,"body":"@Conffusion I have updated the example in my question. Please look into that that is executing one by one not simultaneously"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601460784,"comment_id":113413229,"body":"yes, and the success of it will depend also on how thread safe <code>bulkMailSender</code> is because it is instantiated outside your method so can potentially be shared by .multiple threads."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"edited":false,"creation_date":1601460660,"comment_id":113413162,"body":"@Conffusion you mean if two requests comes to my method then it will execute both simultaneously?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64134839,"edited":false,"creation_date":1601460389,"comment_id":113413042,"body":"every application that wants to access this method will create a new thread. So you don&#39;t have to instantiate threads upfront. If you want to limit the number of parallel threads you need to setup a queue and a threadpool."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"edited":false,"creation_date":1601459686,"comment_id":113412709,"body":"@Henry Ok my issue is if we know how many threads are going to access my application then I can call directly with <code>Thread t1 = new Thread(new MagicTask());</code> t1.start();. If we dont know how to call that method with different threads?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601459547,"comment_id":113412636,"body":"I don&#39;t understand your problem. Just call <code>sendMail</code> from different threads and it will be executed in parallel."},{"owner":{"profile_image":"https://i.stack.imgur.com/7ghSp.jpg?s=256&g=1","account_id":238684,"user_type":"registered","user_id":507738,"link":"https://stackoverflow.com/users/507738/mc-emperor","reputation":22543,"display_name":"MC Emperor","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601459535,"comment_id":113412632,"body":"Regarding your question – what exactly is the issue you are facing? Is there something not working? Do you encounter exceptions thrown?"},{"owner":{"profile_image":"https://i.stack.imgur.com/7ghSp.jpg?s=256&g=1","account_id":238684,"user_type":"registered","user_id":507738,"link":"https://stackoverflow.com/users/507738/mc-emperor","reputation":22543,"display_name":"MC Emperor","accept_rate":71},"content_license":"CC BY-SA 4.0","score":1,"post_id":64134839,"edited":false,"creation_date":1601459351,"comment_id":113412523,"body":"Note that <code>if(!dto.isEmpty())</code> is unnecessary, because the enhanced <code>for</code> loop here already implies that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2024ec11c96392f88d503af55dcf6914?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19130937,"user_type":"registered","user_id":13972844,"link":"https://stackoverflow.com/users/13972844/hung-vu","reputation":483,"display_name":"Hung Vu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64001620,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"edited":false,"creation_date":1600794945,"comment_id":113198495,"body":"@Henry As you said, the standard seems to be 60 fps as in <a href=\"https://developer.android.com/topic/performance/vitals/render\" rel=\"nofollow noreferrer\">Android documentation</a>. However, the main point of my question is about determining the workload and threshold of main thread.   As my example shown, only the inclusion of two lines in <code>onBtnClick</code> is enough to make a change in rendering performance, even nothing is calling them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64001620,"edited":false,"creation_date":1600745802,"comment_id":113176801,"body":"Basically, everything that takes longer than 16ms (one frame) is too much."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597166396,"comment_id":112043282,"body":"use CompletableFuture.allOf(dependedentTasks).thenRunAsync()."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597150326,"comment_id":112034838,"body":"&quot;only after the dependent Task are executed&quot; - are you sure? Usually dependent Tasks are executed after independed."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597150077,"comment_id":112034706,"body":"if  Task-C dependends on task Task-B, then it probably wants to use some value computed by Task-B, right? Why don&#39;t you ask how to pass that value?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597138775,"comment_id":112029361,"body":"So before the root of the tree can be executed, its children have to be executed first? Or is it the other way around?"},{"owner":{"profile_image":"https://i.stack.imgur.com/qDozH.jpg?s=256&g=1","account_id":5126886,"user_type":"registered","user_id":4108590,"link":"https://stackoverflow.com/users/4108590/ravindra-ranwala","reputation":20904,"display_name":"Ravindra Ranwala","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597137411,"comment_id":112028771,"body":"Well, what is the question?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"edited":false,"creation_date":1589171547,"comment_id":109176709,"body":"As it is a <code>BufferedWriter</code> you also need to call <code>flush()</code> after the newline."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-kZ6I3Z1pZR4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb_NhR3Q7JgAnrbJvIajAMxUXMGTg/mo/photo.jpg?sz=256","account_id":15183229,"user_type":"registered","user_id":10955997,"link":"https://stackoverflow.com/users/10955997/siddharth-teli","reputation":107,"display_name":"Siddharth Teli"},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"edited":false,"creation_date":1589115672,"comment_id":109158946,"body":"@user207421 I have added write.newLine() but it still doesn&#39;t work ."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"edited":false,"creation_date":1589112411,"comment_id":109157693,"body":"As usual. You are reading lines but you aren&#39;t writing lines. Add a line terminator when sending the message."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197514,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VgOZI.png?s=256&g=1","account_id":85671,"user_type":"registered","user_id":238704,"link":"https://stackoverflow.com/users/238704/president-james-k-polk","reputation":40858,"display_name":"President James K. Polk"},"edited":false,"creation_date":1588322592,"comment_id":108857329,"body":"@PresidentJamesMoveonPolk Clearly not. You don&#39;t need anything more than a connecting client here. It doesn&#39;t have to do anything else. Telnet would do."},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553510233,"comment_id":97396818,"body":"@MahmoudBenHassine I&#180;ve opened the next ticket: <a href=\"https://jira.spring.io/browse/BATCH-2801\" rel=\"nofollow noreferrer\">jira.spring.io/browse/BATCH-2801</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1553005917,"comment_id":97219862,"body":"As mentioned, I&#39;m not sure neither. I tried to reproduce the case before answering but I don&#39;t know yet if this is s bug in spring batch or an issue with your configuration. I will try my best to dig deeper asap. In all cases, you can open an issue in JIRA so that we don&#39;t forget to tackle it :-)"},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553004976,"comment_id":97219205,"body":"@MahmoudBenHassine  It is very difficult to me to know if the problem is a Spring Batch bug or a problem that is causing the concurrency of threads. I dont have much experience debugging multi-thread. I think the multi-thread is well designed but I&#39;m not 100% sure. Could you give me your personal opinion about it?My apologies, but I need much more practice to be able to assess whether it is a Spring Batch bug or not. Thanks."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1553004274,"comment_id":97218718,"body":"Here is the JIRA instance for the project: <a href=\"https://jira.spring.io/projects/BATCH\" rel=\"nofollow noreferrer\">jira.spring.io/projects/BATCH</a>. You need to create an account then open a new issue. Please do open an issue only if you are sure it is actually a bug, in which case please provide a failing test. FYI, we are planning to migrate issues from JIRA to github later this year (but that&#39;s a plan, not a commitment), so you will be able at some point to open issues directly on github."},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553002918,"comment_id":97217839,"body":"@MahmoudBenHassine Thanks for answering. I have tried to find the reason why isnt respecting the maxitemcounter, but I cannot find it. In the meanwhile, I will try to use other ways to get partitioned, for example, sharing the large file into smaller ones and using multiresource. Could you tell me how I can open a Jira ticket to expose the problem? Thanks in advance."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1552987572,"comment_id":97208015,"body":"I was able to reproduce the case (see <a href=\"https://github.com/benas/sandbox/blob/master/so55227133/output.txt\" rel=\"nofollow noreferrer\">this repo</a>). However, I can&#39;t see why the second thread is not respecting the <code>maxItemCount</code>. I need to dig deeper to investigate what&#39;s happening behind the scene. In the meantime, if you didn&#39;t find an answer and believe it is a bug, please open a ticket in JIRA and we will plan if for a future release."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8554ce4e2c007be9ccebcc8389704470?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6241436,"user_type":"registered","user_id":4854931,"link":"https://stackoverflow.com/users/4854931/alex78191","reputation":2512,"display_name":"Alex78191","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":877096,"edited":false,"creation_date":1551120567,"comment_id":96515768,"body":"Now you can use <code>Consumer&lt;T&gt;</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7873b837674aa1eff075f26872c0eacd?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5762640,"user_type":"registered","user_id":4548520,"link":"https://stackoverflow.com/users/4548520/user25","reputation":2957,"display_name":"user25","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":37437037,"edited":false,"creation_date":1551043353,"comment_id":96484870,"body":"What is the point of using thread, service to load something later? You don&#39;t need all that stuff when user opens your app? This doesn&#39;t make sense. Just you splash screen and that&#39;s all. Even official Google apps do it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":2,"post_id":54485755,"edited":false,"creation_date":1550003912,"comment_id":96108063,"body":"see <a href=\"https://bugs.openjdk.java.net/browse/JDK-8217094\" rel=\"nofollow noreferrer\">bugs.openjdk.java.net/browse/JDK-8217094</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485755,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"edited":false,"creation_date":1549621520,"comment_id":95976971,"body":"@kantianethics any clue what exactly causes this issue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":5,"post_id":54485755,"edited":false,"creation_date":1549217280,"comment_id":95815494,"body":"This issue is fixed in JDK 13 b04; I was using an earlier build."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":1,"post_id":54485755,"edited":false,"creation_date":1549182587,"comment_id":95806630,"body":"I can reproduce this on Mac on JDK 13 with just a blocking HttpClient::send followed by a Thread.sleep(Long.MAX_VALUE). Changing TLS did nothing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"edited":false,"creation_date":1531715302,"comment_id":89681579,"body":"I&#39;m observing long running requests in a web application. Threaddumps point at native classloading methods.  My question in <a href=\"https://stackoverflow.com/questions/49507981/unsafe-defineclass-hangs-slow-reflection-calls\" title=\"unsafe defineclass hangs slow reflection calls\">stackoverflow.com/questions/49507981/&hellip;</a> lead to this tooling issue."},{"owner":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"edited":false,"creation_date":1531609619,"comment_id":89661366,"body":"Why do you want <code>-m</code> mode? If you are interested in non-Java stack, then <code>gdb</code> should be a better tool for this."},{"owner":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"edited":false,"creation_date":1531609518,"comment_id":89661351,"body":"This can be either a bug in HotSpot Serviceability Agent or an attempt to get a stacktrace while JVM is in inconsistent state. In both cases you can hardly do anything about it."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"edited":false,"creation_date":1530083786,"comment_id":89103809,"body":"@Seelenvirtuose Thank you, I&#39;ve already feared that it&#39;s not normal behaviour. I will <b>reinstall eclipse</b> and see what it brings."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51055780,"edited":false,"creation_date":1530083587,"comment_id":89103682,"body":"Ok. This is weird. Obviously both threads are terminated, but the application is still running. That might be an issue of Eclipse but it might also be an issue of the Java VM. Maybe a reinstall will help here. <i>This is not normal behavior and has nothing to do with your Java code.</i>"},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"edited":false,"creation_date":1530083051,"comment_id":89103410,"body":"@Seelenvirtuose The thing is, I ran it exactly like described with nothing going on in the <code>run()</code>-method and nothing else in the <code>main</code>-method and the issue still exists. I will edit my post and add a screenshot of the running thread, maybe it&#39;s better understandable afterwards."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51055780,"edited":false,"creation_date":1530082859,"comment_id":89103322,"body":"@DavidStuder In your example, no thread (neither the main thread nor the other started thread) is running. This program directly terminates. Maybe you simplfied your code too much. Look at my examples to get an idea. Otherwise please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5359684119625d3f23eca684d7f83f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11147483,"user_type":"registered","user_id":8181750,"link":"https://stackoverflow.com/users/8181750/l-spillner","reputation":1772,"display_name":"L.Spillner"},"edited":false,"creation_date":1530082508,"comment_id":89103146,"body":"@L.Spillner the state of the started thread is <b>terminated</b>, but the main thread (where the mentioned <code>exit()</code>-method is called on) is still <b>running</b>."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530082424,"comment_id":89103102,"body":"@daniu I tried it with <code>join()</code> as well as with <code>yield()</code>, did not change anything. But what would be the proper way to do it then?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5359684119625d3f23eca684d7f83f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11147483,"user_type":"registered","user_id":8181750,"link":"https://stackoverflow.com/users/8181750/l-spillner","reputation":1772,"display_name":"L.Spillner"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"edited":false,"creation_date":1530080815,"comment_id":89102325,"body":"Usually a thread is considered &#39;terminated&#39; when the <code>exit()</code>  method is run. Have you debugged the state of the thread after that point?"},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"edited":false,"creation_date":1530080544,"comment_id":89102206,"body":"Apart from &quot;this is not the proper way to do it&quot;: Did you try adding a <code>thread.join()</code> at the end of <code>main</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fb9385b7f1a792d5159eca8bbb2c34f8?s=256&d=identicon&r=PG","account_id":151394,"user_type":"registered","user_id":365237,"link":"https://stackoverflow.com/users/365237/eis","reputation":52351,"display_name":"eis","accept_rate":96},"content_license":"CC BY-SA 3.0","score":0,"post_id":45265777,"edited":false,"creation_date":1501103301,"comment_id":77636919,"body":"@AnsarSamad add it as an answer then"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/49c522ddb886ec08a37597bd38ef941d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11238865,"user_type":"registered","user_id":8243973,"link":"https://stackoverflow.com/users/8243973/ansar-samad","reputation":759,"display_name":"Ansar Samad","accept_rate":38},"content_license":"CC BY-SA 3.0","score":0,"post_id":45265777,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"edited":false,"creation_date":1500828586,"comment_id":77497900,"body":"Thank you Mark , it worked by associated the  map with session"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 3.0","score":2,"post_id":45265777,"edited":false,"creation_date":1500817764,"comment_id":77494476,"body":"You do realise that a servlet and its fields are shared by all requests, right? You need to associate the map with the request or user session."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b4128da626e5b0049cd4fb88033e3b3?s=256&d=identicon&r=PG","account_id":8546,"user_type":"registered","user_id":15472,"link":"https://stackoverflow.com/users/15472/tucuxi","reputation":17688,"display_name":"tucuxi","accept_rate":87},"content_license":"CC BY-SA 3.0","score":0,"post_id":43630406,"edited":false,"creation_date":1493222948,"comment_id":74327096,"body":"Use e.printStackTrace() (or better yet, logging) to know the cause of the error, in the probable case of a cascading exception."},{"owner":{"profile_image":"https://i.stack.imgur.com/LJRFQ.jpg?s=256&g=1","account_id":228170,"user_type":"registered","user_id":490315,"link":"https://stackoverflow.com/users/490315/whirlwin","reputation":16153,"display_name":"whirlwin","accept_rate":94},"content_license":"CC BY-SA 3.0","score":2,"post_id":817856,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/55f6773c05e270af85af74cd5faac83a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1861835,"user_type":"registered","user_id":1686291,"link":"https://stackoverflow.com/users/1686291/not-a-bug","reputation":4286,"display_name":"Not a bug","accept_rate":73},"edited":false,"creation_date":1490879935,"comment_id":73317327,"body":"@Notabug If you are explicit, you can name your variable so that it&#39;s it that you&#39;re dealing with a ThreadLocal value, e.g. <code>RequestUtils.getCurrentRequestThreadLocal()</code>. Not saying this is very elegant though, but this stems from the fact that ThreadLocal itself is not very elegant in most cases."},{"owner":{"profile_image":"https://i.stack.imgur.com/VgOZI.png?s=256&g=1","account_id":85671,"user_type":"registered","user_id":238704,"link":"https://stackoverflow.com/users/238704/president-james-k-polk","reputation":40858,"display_name":"President James K. Polk"},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197514,"edited":false,"creation_date":1477177546,"comment_id":67661564,"body":"Unless you show your client code your question will be difficult or impossible to answer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8f914b710648b6f4ec8c71f1ed25925b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5887937,"user_type":"registered","user_id":4635346,"link":"https://stackoverflow.com/users/4635346/vivek-pratap-singh","reputation":1604,"display_name":"Vivek Pratap Singh","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1472801177,"comment_id":65907218,"body":"i have not extended Application class but i am still getting the white screen"},{"owner":{"profile_image":"https://i.stack.imgur.com/w9jTN.jpg?s=256&g=1","account_id":3013228,"user_type":"registered","user_id":2587435,"link":"https://stackoverflow.com/users/2587435/paul-samsotha","reputation":205797,"display_name":"Paul Samsotha","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":38570732,"edited":false,"creation_date":1469667627,"comment_id":64636178,"body":"Looks like something that you may want to file as an issue with jersey. As an aside its recommended to reuse <code>Client</code> instances in an application as they are expensive to create"},{"owner":{"profile_image":"https://i.stack.imgur.com/PVlNj.jpg?s=256&g=1","account_id":3730535,"user_type":"registered","user_id":3103093,"link":"https://stackoverflow.com/users/3103093/tin-tran","reputation":2265,"display_name":"Tin Tran"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1465403038,"comment_id":62889861,"body":"What are the operations in Application#onCreate(). Is it IO?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ff48e8eb52418d733229f3dadee07967?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1576496,"user_type":"registered","user_id":1462770,"link":"https://stackoverflow.com/users/1462770/amir","reputation":16227,"display_name":"Amir","accept_rate":67},"edited":false,"creation_date":1464862645,"comment_id":62663091,"body":"@Amir: I think you may be mistaken about what I am asking. This has nothing to do with Instant Run. It is a long-running problem with Android applications. It happens irrespective of OS version and even with projects that are built with Eclipse."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/8muVa.png?s=256&g=1","account_id":2211999,"user_type":"registered","user_id":1953590,"link":"https://stackoverflow.com/users/1953590/kevin-krumwiede","reputation":9954,"display_name":"Kevin Krumwiede","accept_rate":74},"edited":false,"creation_date":1464862481,"comment_id":62662982,"body":"@KevinKrumwiede: yes, that is the case when the app is still in the background, and the app process is alive and well. If you dismiss the app, the process is killed, the <code>Application</code> instance is gone, and the white screen is back with a vengeance ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/8muVa.png?s=256&g=1","account_id":2211999,"user_type":"registered","user_id":1953590,"link":"https://stackoverflow.com/users/1953590/kevin-krumwiede","reputation":9954,"display_name":"Kevin Krumwiede","accept_rate":74},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464861493,"comment_id":62662268,"body":"Incidentally, are you aware that the <code>Application</code> instance may be retained even when all your activities have finished?  When that happens, <code>Application#onCreate()</code> will <i>not</i> be called again the next time your app is launched."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ff48e8eb52418d733229f3dadee07967?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1576496,"user_type":"registered","user_id":1462770,"link":"https://stackoverflow.com/users/1462770/amir","reputation":16227,"display_name":"Amir","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464861380,"comment_id":62662175,"body":"If you use android studio 2.0 disable instant run and this issue will fixed."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cbcf412e8fc60799c981f62a7c30e907?s=256&d=identicon&r=PG","account_id":974021,"user_type":"registered","user_id":995891,"link":"https://stackoverflow.com/users/995891/zapl","reputation":63348,"display_name":"zapl","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464180862,"comment_id":62378183,"body":"Wrt theme, the trick is not to set a NoActionBar theme, it&#39;s to adjust the initial activity&#39;s theme so that an empty themed screen looks like the fully initialized one."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e70b29205599416fa49cf0d2e41e8b97?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":473257,"user_type":"registered","user_id":882251,"link":"https://stackoverflow.com/users/882251/darwind","reputation":7312,"display_name":"Darwind","accept_rate":100},"edited":false,"creation_date":1464180569,"comment_id":62377950,"body":"@Darwind: wow ... cool idea! Looks neat. You should post this as an answer ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c94c6ea772afeeb297ec29eaa2cd00c6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5531638,"user_type":"registered","user_id":4391450,"link":"https://stackoverflow.com/users/4391450/axelh","reputation":14395,"display_name":"AxelH"},"edited":false,"creation_date":1464180526,"comment_id":62377911,"body":"@AxelH: please be more specific ... what should I use exactly? A Service? A Thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/sM42n.jpg?s=256&g=1","account_id":4061727,"user_type":"registered","user_id":5699956,"link":"https://stackoverflow.com/users/5699956/atiq","reputation":14535,"display_name":"Atiq","accept_rate":70},"edited":false,"creation_date":1464180487,"comment_id":62377871,"body":"@Anders: interesting idea ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"edited":false,"creation_date":1464180468,"comment_id":62377858,"body":"@BeshoyHanna: So I should use an <code>IntentService</code> then?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e70b29205599416fa49cf0d2e41e8b97?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":473257,"user_type":"registered","user_id":882251,"link":"https://stackoverflow.com/users/882251/darwind","reputation":7312,"display_name":"Darwind","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464180015,"comment_id":62377486,"body":"You might find that this is still an issue after you&#39;ve moved all initialisationcode out of the <code>Application</code> class. This is due to newer versions of Android&#39;s way of &quot;cold-starting&quot; the apps. Google actually addressed the launchtimes at Google I/O this year and it will be fixed in N from what I remember. In the meantime, you should look at what Google calls a &quot;branded launchscreen&quot;. Here&#39;s an example on how to create it: <a href=\"http://antonioleiva.com/branded-launch-screen/\" rel=\"nofollow noreferrer\">antonioleiva.com/branded-launch-screen</a> - no more white screen in the beginning ;-) And please don&#39;t use splashscreens - it&#39;s annoying to the user."},{"owner":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464179968,"comment_id":62377452,"body":"Ideally, an application would offload processing and not use the main thread for long operations. This is a well accepted practice. If the operations need to happen before the app loads, then it should an least not share a thread with the UI."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"edited":false,"creation_date":1464179736,"comment_id":62377235,"body":"@BeshoyHanna: please explain how we would use that here ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464179666,"comment_id":62377185,"body":"Have you looked into lazy loading? I believe you are on the right track with services not on the main thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/sM42n.jpg?s=256&g=1","account_id":4061727,"user_type":"registered","user_id":5699956,"link":"https://stackoverflow.com/users/5699956/atiq","reputation":14535,"display_name":"Atiq","accept_rate":70},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464179305,"comment_id":62376889,"body":"<a href=\"http://stackoverflow.com/questions/35054872/how-to-pre-load-mainactivity-in-splashactivity-so-there-would-be-no-delay-when-l\">This</a> might help"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c94c6ea772afeeb297ec29eaa2cd00c6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5531638,"user_type":"registered","user_id":4391450,"link":"https://stackoverflow.com/users/4391450/axelh","reputation":14395,"display_name":"AxelH"},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464179169,"comment_id":62376789,"body":"You found the problem yourself, you are doing to many init in in the application context, blocking the loading of the activity, try to asynchronized this, letting a loading activity to show up until some thread ends."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cbfaeb8d0e2ee5da976331d2cb13d0ec?s=256&d=identicon&r=PG","account_id":21279,"user_type":"registered","user_id":51577,"link":"https://stackoverflow.com/users/51577/tddmonkey","reputation":20918,"display_name":"tddmonkey","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":33097230,"edited":false,"creation_date":1458491935,"comment_id":59873372,"body":"Possible duplicate of <a href=\"http://stackoverflow.com/questions/24700798/is-jax-rs-client-thread-safe\">Is JAX-RS Client Thread Safe</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b0def851c1fc8d0b28aa35e7cc8c3fa?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7927394,"user_type":"registered","user_id":5986438,"link":"https://stackoverflow.com/users/5986438/yanozai","reputation":143,"display_name":"yanozai","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"edited":false,"creation_date":1457491052,"comment_id":59426713,"body":"Also how can I identify the runnables?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b0def851c1fc8d0b28aa35e7cc8c3fa?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7927394,"user_type":"registered","user_id":5986438,"link":"https://stackoverflow.com/users/5986438/yanozai","reputation":143,"display_name":"yanozai","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"edited":false,"creation_date":1457490857,"comment_id":59426661,"body":"on the same handler object?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"edited":false,"creation_date":1457490656,"comment_id":59426602,"body":"You could use the removeCallback methods."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/55f6773c05e270af85af74cd5faac83a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1861835,"user_type":"registered","user_id":1686291,"link":"https://stackoverflow.com/users/1686291/not-a-bug","reputation":4286,"display_name":"Not a bug","accept_rate":73},"content_license":"CC BY-SA 3.0","score":13,"post_id":817856,"edited":false,"creation_date":1455192376,"comment_id":58384994,"body":"If you are using ThreadLocal, never write a wrapper over it !!! Each and every developer who wants to use the variable must know it is &#39;ThreadLocal&#39;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bb5a57aef64da898ac42004c1b4054a5?s=256&d=identicon&r=PG","account_id":430718,"user_type":"registered","user_id":814304,"link":"https://stackoverflow.com/users/814304/imysak","reputation":2188,"display_name":"iMysak","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":28626848,"edited":false,"creation_date":1424429351,"comment_id":45554819,"body":"just to remind: You should be very accurate when you open same file simultaniously! Extremelly whith modify operation!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4b61245891a940650109f1b308ccf54d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5503425,"user_type":"registered","user_id":4372063,"link":"https://stackoverflow.com/users/4372063/astra-bear","reputation":2646,"display_name":"Astra Bear","accept_rate":38},"content_license":"CC BY-SA 3.0","score":0,"post_id":28626848,"edited":false,"creation_date":1424428676,"comment_id":45554457,"body":"It looks like a file format problem. I would test it with a single thread first."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a8397ff2192e8da580a986bc316794da?s=256&d=identicon&r=PG","account_id":2526737,"user_type":"registered","user_id":2195963,"link":"https://stackoverflow.com/users/2195963/awani","reputation":394,"display_name":"Awani","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798073,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VjxwC.jpg?s=256&g=1","account_id":1101161,"user_type":"registered","user_id":1093528,"link":"https://stackoverflow.com/users/1093528/fge","reputation":119804,"display_name":"fge","accept_rate":65},"edited":false,"creation_date":1415353288,"comment_id":42170428,"body":"So aren&#39;t they both doing the same task - waiting so that other threads can execute? Also, when using yield(), how will the thread come back to runnable state?"},{"owner":{"profile_image":"https://i.stack.imgur.com/VjxwC.jpg?s=256&g=1","account_id":1101161,"user_type":"registered","user_id":1093528,"link":"https://stackoverflow.com/users/1093528/fge","reputation":119804,"display_name":"fge","accept_rate":65},"content_license":"CC BY-SA 3.0","score":2,"post_id":26798073,"edited":false,"creation_date":1415352843,"comment_id":42170191,"body":"Well, if you <code>.wait()</code>, another thread has to <code>.notify()</code> you -- on the exact same object reference. <code>.yield()</code> is simply a hint to the JVM that &quot;if you ant to schedule me out, you can for the moment&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"edited":false,"creation_date":1405272793,"comment_id":38352117,"body":"@WarrenDew said, &quot;there are a few other issues...&quot;  Here&#39;s one:  You wrote <code>new Thread(this)</code> in your constructors.  That may not be causing any problem for you in this code, but google for &quot;leaking this in constructor&quot; if you want to know why it&#39;s generally a Bad Idea."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"edited":false,"creation_date":1405243207,"comment_id":38344236,"body":"Your immediate issue is that both threads go into a wait on the lock, and then they never get notified.  There are a few other issues with this code as well, though."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=256&d=identicon&r=PG","account_id":48693,"user_type":"registered","user_id":144746,"link":"https://stackoverflow.com/users/144746/voo","reputation":29189,"display_name":"Voo","accept_rate":93},"content_license":"CC BY-SA 3.0","score":10,"post_id":24720849,"edited":false,"creation_date":1405242134,"comment_id":38343992,"body":"So I guess this means somewhere a new semester just started? <i>sigh</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/42011fbeea421853b43ae8679f065267?s=256&d=identicon&r=PG","account_id":2655538,"user_type":"registered","user_id":2296325,"link":"https://stackoverflow.com/users/2296325/adrian-olar","reputation":2893,"display_name":"Adrian Olar","accept_rate":87},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"edited":false,"creation_date":1405240326,"comment_id":38343600,"body":"Take a look here: <a href=\"http://stackoverflow.com/questions/6017281/odd-even-number-printing-using-thread\" title=\"odd even number printing using thread\">stackoverflow.com/questions/6017281/&hellip;</a>    It seems to be exactly what you need."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2374e43485f6caeb3302e66c327608e2?s=256&d=identicon&r=PG","account_id":200481,"user_type":"registered","user_id":446357,"link":"https://stackoverflow.com/users/446357/mtilsted","reputation":5196,"display_name":"MTilsted","accept_rate":64},"content_license":"CC BY-SA 3.0","score":0,"post_id":14072940,"edited":false,"creation_date":1356715437,"comment_id":19455785,"body":"You are not allowed to do painting outside of the Gui thread. You can&#39;t redirect drawing to a secondary thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/KiIon.png?s=256&g=1","account_id":36493,"user_type":"registered","user_id":104117,"link":"https://stackoverflow.com/users/104117/valentin-rocher","reputation":11667,"display_name":"Valentin Rocher","accept_rate":89},"content_license":"CC BY-SA 2.5","score":4,"post_id":877096,"edited":false,"creation_date":1242643405,"comment_id":684341,"body":"Do you mean passing a parameter to an already running thread ? Because all the current answers are about passing parameters to new threads..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=256&d=identicon&r=PG","account_id":36459,"user_type":"registered","user_id":104014,"link":"https://stackoverflow.com/users/104014/artem-barger","reputation":40877,"display_name":"Artem Barger","accept_rate":89},"content_license":"CC BY-SA 2.5","score":6,"post_id":877096,"edited":false,"creation_date":1242643218,"comment_id":684332,"body":"Would you mind to add some extra explanation of that exactly you trying to do? There are a lot of several techniques to it, but all of them depend on the final goal."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b2307ec2e0242d08e7b7236223a47fe7?s=256&d=identicon&r=PG","account_id":22836830,"user_type":"registered","user_id":16984466,"link":"https://stackoverflow.com/users/16984466/lucas-grugru","reputation":1684,"display_name":"Lucas Grugru"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676557170,"comment_id":133163825,"body":"Who is Paul Samsotha ? What answer ?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AEdFTp61CUpQI3VbC_PLq34lGLauPTVC9VC23rZkIOSpZw=k-s256","account_id":27772393,"user_type":"registered","user_id":21202467,"link":"https://stackoverflow.com/users/21202467/nasir-mushtaq","reputation":1,"display_name":"Nasir Mushtaq"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676279155,"comment_id":133098101,"body":"Create only one client and reuse that"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676124260,"comment_id":133076706,"body":"Ah, ok. Interesting. I stumbled across this question while researching a related issue and thought I would add this piece of information for future readers. Did not consider it might not have been true at the time the question was asked."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676123885,"comment_id":133076652,"body":"Hmm ... yes I see it.  But it is not in Java 8.  It is only implemented in Java 9+.  Prior to that the Linux implementation of <code>os::set_native_thread_name</code> is a noop."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122544,"comment_id":133076447,"body":"My java version: <code>$ java -version openjdk version &quot;11.0.11&quot; 2021-04-20 OpenJDK Runtime Environment AdoptOpenJDK-11.0.11+9 (build 11.0.11+9) OpenJDK 64-Bit Server VM AdoptOpenJDK-11.0.11+9 (build 11.0.11+9, mixed mode) </code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122525,"comment_id":133076445,"body":"I assume the libc function is <code>pthread_setname_np</code> which is used quite often in jdk code. This seems to call prctl: <a href=\"https://android.googlesource.com/platform/bionic/+/master/libc/bionic/pthread_setname_np.cpp#94\" rel=\"nofollow noreferrer\">android.googlesource.com/platform/bionic/+/master/libc/bioni&zwnj;&#8203;c/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122346,"comment_id":133076411,"body":"Which version of Java are you testing?  Which vendor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122085,"comment_id":133076378,"body":"@StephenC Evidence is Strace output. I created a runnable jar with the line <code>Thread.currentThread().setName(&quot;test-name-123456789&quot;);</code> and ran it under strace <code>strace -e &#39;trace=!futex&#39; -tt -r -f -o name-trial.txt java -jar run.jar</code>. Output contains this line <code>948729 14:22:19.789325 (+     0.000238) prctl(PR_SET_NAME, &quot;test-name-12345&quot;...) = 0</code>. You also see the system calls, when other threads are named, such as <code>948730 14:22:19.440447 (+     0.000084) prctl(PR_SET_NAME, &quot;GC Thread#0&quot; &lt;unfinished ...&gt;</code>. I assume you did not find the call in the sources, because it is invoked through a c stdlib."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"edited":false,"creation_date":1675984424,"comment_id":133051112,"body":"@Joe23 - Really?  Evidence?  According to (<code>grep</code> search of) the OpenJDK 8u &amp; 17u source code there are no calls to <code>prctl(PR_SET_NAME, ...)</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1675963126,"comment_id":133045477,"body":"It leads to a system call though: <code>prctl(PR_SET_NAME, &quot;new-name&quot;)</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/SEQOn.jpg?s=256&g=1","account_id":10611364,"user_type":"registered","user_id":7815223,"link":"https://stackoverflow.com/users/7815223/shagun-verma","reputation":163,"display_name":"Shagun Verma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"reply_to_user":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"edited":false,"creation_date":1675946402,"comment_id":133039335,"body":"To know the difference, you can see <a href=\"https://javarevisited.blogspot.com/2016/12/difference-between-thread-and-executor.html?m=1\" rel=\"nofollow noreferrer\">javarevisited.blogspot.com/2016/12/&hellip;</a>"},{"owner":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"edited":false,"creation_date":1675921816,"comment_id":133032776,"body":"Thanks a lot Shagun Verma,  I&#39;d like to make a question: &#191;What would be the difference between this executor and a thread?  I appreciate a lot your answer, it is helping me to move foward. My code is partially working at this moment, I still need to make additional modifications... I&#39;m gonna continue tomorrow and update this post with additional feedback/comments.  Thanks again!!!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"edited":false,"creation_date":1665070421,"comment_id":130618251,"body":"Without SupervisorJob, if any of the jobs launched with the scope fail, the rest of them are canceled and it can never launch another job again. There are potentially cases where that would be the behavior you might want though. I haven&#39;t personally ever had any though."},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"edited":false,"creation_date":1665068670,"comment_id":130617492,"body":"Please note: this community wants quality answers. Telling people &quot;go read some documentation about X&quot; isn&#39;t that. Seriously: if you dont want to spend the time to write a proper answer, then write a comment. Otherwise, invest a few minutes and write an answer that deserves to be called &quot;answer&quot;."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"edited":false,"creation_date":1665067927,"comment_id":130617196,"body":"Thanks ! Could you explain how SupervisorJob is useful and what happens when it is not used, please ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e34d0dd755c1ca59cd89d4a4e566439a?s=256&d=identicon&r=PG","account_id":2226374,"user_type":"registered","user_id":1965042,"link":"https://stackoverflow.com/users/1965042/vcg","reputation":106,"display_name":"vcg"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"edited":false,"creation_date":1665065857,"comment_id":130616325,"body":"Sorry misunderstood the question, I guess you are using <code>lastEdit</code> as static var, you may want to add <code>volatile</code> keyword to the var, so that the threads will access to the real value of your var.. take a look at <a href=\"https://www.baeldung.com/java-volatile\" rel=\"nofollow noreferrer\">volatile keyword</a>"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73968534,"edited":false,"creation_date":1665029066,"comment_id":130604574,"body":"I have searched about scheduleAtFixedRate. But what I want to do is initially delay execution for 10 seconds. And if I do something else in another program, it will restart the timer and execute the code after 10s."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664731012,"comment_id":130534053,"body":"@john16384, <code>InterruptedException</code> is not intended to stop a thread. It is intended to get a thread&#39;s attention. If <i>you</i> want it to stop <i>your</i> thread, then it&#39;s up to you to write a handler so that the thread can catch the exception and then <i>cleanly</i> stop itself."},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664718111,"comment_id":130531264,"body":"certainly not, I&#39;m highly in favor of checked exceptions, just missing why an exception intended to interrupt / stop a thread isn&#39;t part of the declaration of the <code>run</code> method which serves as the entry points for many threads; been looking through the JBS is something was proposed like this, and this is the most similar ticket I could find: <a href=\"https://bugs.openjdk.org/browse/JDK-8150342\" rel=\"nofollow noreferrer\">bugs.openjdk.org/browse/JDK-8150342</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664717869,"comment_id":130531209,"body":"@john16384: i think this is just another argument against checked exceptions, let the exception be thrown and kill the thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664717553,"comment_id":130531125,"body":"Thanks, but I&#39;m not trying to catch an exception from a thread in another thread. The uncaught handler will log it, I know, I&#39;m just asking why would <code>run</code> not have been declared to throw <code>InterruptedException</code> to make it easier to terminate threads with out having to go through the <code>try...catch</code> boilerplate.  Any runtime exception terminates the thread, but an <code>InterruptedException</code> should for some reason be disallowed?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3383e4fd807a451772e79e0f5ccca51c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7413926,"user_type":"registered","user_id":11374957,"link":"https://stackoverflow.com/users/11374957/kaan","reputation":5474,"display_name":"Kaan"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73220736,"edited":false,"creation_date":1659917762,"comment_id":129402173,"body":"<i>&quot;the Callable/Future is much better to catch and log errors&quot;</i> – this doesn&#39;t make sense.. any thread or runnable can catch exceptions and log errors."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2dbd48d7460f4e598ad5142d154055e9?s=256&d=identicon&r=PG","account_id":2898508,"user_type":"registered","user_id":2485774,"link":"https://stackoverflow.com/users/2485774/chazz1","reputation":133,"display_name":"Chazz1","accept_rate":87},"content_license":"CC BY-SA 4.0","score":0,"post_id":73220736,"edited":false,"creation_date":1659525531,"comment_id":129314469,"body":"I had something like that. But something went wrong on the production site, and the runnable stopped and nobody noticed it until some days later. For what I&#39;ve read, the Callable/Future is much better to catch and log errors. I was trying to implement a callable so I could relaunch it when something like this happens."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"edited":false,"creation_date":1658862721,"comment_id":129156352,"body":"Hi @Dinesh... I had used Inmemory map to store authorization related data. Can you please help me explain your issue more."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1658234434,"comment_id":128996582,"body":"@DeepikaSwarup - I am also having a similar approach of calling a Remote Service using Spring HTTPInvoker from Kafka Consumer and getting the same above error. i am stuck with no ways to get further, can you explain a bit more on how and what you did with inmemory map ? Related question here:  <a href=\"https://stackoverflow.com/q/72999102/1764587\">stackoverflow.com/q/72999102/1764587</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654936471,"comment_id":128214757,"body":"Sure Stanislav, I will try."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654933365,"comment_id":128214350,"body":"@ShubhamChaurasia, that&#39;s interesting.. Maybe it&#39;s the ThreadPoolExecutor which has issues with threads constantly fighting for tasks. Could you increase the number of operations? If the trend improves, that again would point to the fact that the culprit is somewhere in the thread pool. If that&#39;s the case, try ForkJoinPool. It&#39;s supposed to be more performant in such scenarios."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654932827,"comment_id":128214278,"body":"No worries and thanks for updating again. Actually I did that earlier and I understand what you are measuring is the total time to complete the program with overlapping threads being run concurrently. For the same purpose I was calculating the average time.  Anyways, I ran it with your implementation of runBenchmark() and I am seeing similar results -  1. On 8 cores - =====runBenchmark() FINISHED in 171217 2. On 16 cores - =====runBenchmark() FINISHED in 186911 3. On 32 cores - =====runBenchmark() FINISHED in 267623   As we can see, the time is increasing with number of cores."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654931031,"comment_id":128214042,"body":"@ShubhamChaurasia, take a look now. Hopefully it answers the question now :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930625,"comment_id":128213978,"body":"@ShubhamChaurasia, I think now I see the problem and my answer is not far off. Let me update it :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930204,"comment_id":128213938,"body":"@ShubhamChaurasia, ah, so you&#39;re not increasing the number of threads - it&#39;s always 100 regardless of whether you&#39;re running on the machine with 8 or 32 cores? If that&#39;s the case, then sorry for the confusion."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929824,"comment_id":128213893,"body":"I clarified it a bit more in the question - &quot;1000000 is number of floating point divisions that each thread does, 100 is number of threads.&quot;"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929495,"comment_id":128213849,"body":"The amount of work is constant in all the setups. All 8, 16, and 32 cores systems are getting to process 100 threads and 1M operations in each thread. Then we can expect a perf gain, is that right ?"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654929307,"comment_id":128213823,"body":"@ShubhamChaurasia, in your question you stated that you expect the time to decrease. Which doesn&#39;t make sense. If you&#39;re adding x2 cores but also add x2 work, then why would that finish faster?"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929067,"comment_id":128213792,"body":"I get your point about dividing total number of operations among threads. But here I think we are more concerned about the number of these threads that cores can service and there we are seeing lesser number of cores winning due to some reason."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654928808,"comment_id":128213769,"body":"Updated in &quot;EDIT 1:&quot; with ThreadLocalRandom observations."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654927880,"comment_id":128213654,"body":"Thanks for pointing out, sure will try."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72570061,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"edited":false,"creation_date":1654883240,"comment_id":128206982,"body":"Both implementing <code>Step</code> or extending <code>AbstractStep</code> should work. It is up to you. In regards to how to set the commit-interval dynamically with a job parameter, you can take a look at this: <a href=\"https://stackoverflow.com/questions/26041550/spring-batch-dynamic-commit-interval-or-a-custom-completion-policy\" title=\"spring batch dynamic commit interval or a custom completion policy\">stackoverflow.com/questions/26041550/&hellip;</a>."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570061,"edited":false,"creation_date":1654873120,"comment_id":128203604,"body":"Awesome thank you for this answer. So for dynamic steps I would implement the Step Interface or should I use the AbstractStep class? What classes should I extend for the dynamic commit interval?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849677,"comment_id":128194958,"body":"Yeah I will take a look and see if I can find something I can use"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654849625,"comment_id":128194933,"body":"There are lots of simple socket server examples out there on the interwebz for java, C#, C++, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849288,"comment_id":128194819,"body":"I did extend the class and implemented the accept in the new class though am afraid it will not create sessions as per your advice, an answer in android java is welcome as I can convert it to C#, updating my code"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654848834,"comment_id":128194682,"body":"As step 1 above says, this blocking call needs to be on a separate thread (the &quot;Accept&quot; thread) which does nothing but this blocking call and spawns other threads for clients."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654848710,"comment_id":128194655,"body":"Hello sir from your reputation I can see you are advanced, I needed help with this, since the blocking call will not execute code below it as  it listens on connections forever, how to avoid that but still get the message from the source device?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"edited":false,"creation_date":1654790801,"comment_id":128181712,"body":"@BlueRyse: If you can provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> you may get better answers. I understand you want to make the post short but that discourages people from helping when they don&#39;t have something they can run. And even if the suggested code doesn&#39;t work make sure you understand the point of avoiding races and not waiting if a notification isn&#39;t coming."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"edited":false,"creation_date":1654786982,"comment_id":128180183,"body":"Unfortunately, this solution doesn&#39;t work. At this point, I guess there&#39;s something wrong with my OS, Eclipse, or the JVM."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551685,"edited":false,"creation_date":1654719975,"comment_id":128161955,"body":"This answer worked perfectly, thank you so so so much! I can&#39;t believe I didn&#39;t catch this one myself."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71327704,"edited":false,"creation_date":1649934361,"comment_id":127002672,"body":"Thanks Gray for the pointers... It helped me in getting more insight and fixing it. Since there was no controller involved and Kafka was calling PUT method directly, I was unable to get HTTP context... In order to resolve my issue, I created an inmemory map..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1646333964,"comment_id":126103570,"body":"Sorry @DeepikaSwarup.  I don&#39;t know enough about your application to answer appropriately."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"edited":false,"creation_date":1646331272,"comment_id":126102702,"body":"Thanks Gray for the pointers. Yes putData() is directly being called by my consumer and not through controller. Will it be correct if I call my controller API through consumer in the same project? And then through controller I will call putData()."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1646248410,"comment_id":126078767,"body":"@pveentjer right, but isn&#39;t a data race a result of a missing happens before chain? I mean the phrase: &quot;... are not ordered by a happens-before relationship, it is said to contain a data race&quot; from chapter 17 of JLS. My point being that, unless there is HB for all actions, yes, a data race can happen. Was that your point? thank you."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"edited":false,"creation_date":1646241445,"comment_id":126076367,"body":"Small correction: Happens-before consistent is a relaxation of happens-before. Happens-before consistent also deals when a read and write are concurrent (so not ordered by happens-before; so in data race)."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646233765,"comment_id":126073067,"body":"@Holger you&#39;re right, I&#39;ve edited."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645697231,"comment_id":125942829,"body":"In other words, the fact that the volatile write and read (to the same variable) have a “synchronizes-with” relation is the <i>prerequisite</i> to have a <i>happens-before</i> relationship. As &#167;17.4.5. says at the beginning “<i>If an action x synchronizes-with a following action y, then we also have hb(x, y).</i>” It than proceeds to say “<b>It follows from the above definitions that:</b> <i>A write to a volatile field (&#167;8.3.1.4) happens-before every subsequent read of that field.</i>” This conclusion is what we want; since it has been spelled out explicitly, there is no need to discuss “synchronizes-with” at all."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645680815,"comment_id":125938156,"body":"The happens-before order is the transitive closure of the union of the synchronizes-with order and the program order. So if you have established that 2 actions are ordered by the synchronizes-with order, it is automatically implied that they are ordered by the happens-before order."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71212240,"edited":false,"creation_date":1645611395,"comment_id":125915941,"body":"good answer, simple, yet very good."},{"owner":{"profile_image":"https://i.stack.imgur.com/Poqe8.png?s=256&g=1","account_id":10898797,"user_type":"registered","user_id":8011734,"link":"https://stackoverflow.com/users/8011734/marwa-eltayeb","reputation":1961,"display_name":"Marwa Eltayeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1637332712,"comment_id":123805434,"body":"You are very welcome. I am so glad that my answer is helpful for you."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"edited":false,"creation_date":1637222866,"comment_id":123769689,"body":"Thank you very much for your detailed and involved answer."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJzLkOQelMMXYxAJxRKLvxqRtrmM6VXMlnw9PvD0=k-s256","account_id":23184907,"user_type":"registered","user_id":17282180,"link":"https://stackoverflow.com/users/17282180/iosiv","reputation":25,"display_name":"Iosiv"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967575,"edited":false,"creation_date":1637095160,"comment_id":123733467,"body":"Thanks! Great explanation. I understand your point. Actually, I suspected that was the issue from the very beginning, but unfortunately I&#39;m not allowed to modify the Player classes (for learning/suffering purposes), so I&#39;m actually looking for a solution that involves only the Ball class. I tried, for instance, to  get the name of the current thread and use this to lock the methods for each of them every time. Or to use two booleans instead of one. No success so far, but I&#39;ll keep trying."},{"owner":{"profile_image":"https://i.stack.imgur.com/5ovO7.png?s=256&g=1","account_id":9713597,"user_type":"registered","user_id":7204683,"link":"https://stackoverflow.com/users/7204683/umair","reputation":615,"display_name":"Umair","accept_rate":38},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"edited":false,"creation_date":1636997613,"comment_id":123701661,"body":"you are welcome @TanmayMandaogane"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636975020,"comment_id":123692464,"body":"It is possible, but at that point there are no other threads. If there were any, they&#39;d run. Every thread has its own code. This is not magic, code cannot jump between threads. Code still must be executed sequentially by a single thread. Therefore, you need to wait for client connections in one thread, and start clients in another thread. The server needs to have its own thread which will handle the connections. The infinite loop will hog the thread forever and the code after Server.start() never runs."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636974720,"comment_id":123692369,"body":"It can. This is not about other threads. Other threads will run the <code>GameClientHandler.run()</code> code, but not anything else. What&#39;s happening, is this: Thread1: &quot;I&#39;ll wait for a client to connect. When it connects, I&#39;ll start a thread to handle it, then wait for another connection, and another, and another, and another. When infinite connections are done (never), only then will I move on and actually start two clients.&quot; This thread gets stuck at step 1, waiting for a client to connect. There are no clients. There are no other (handler) threads because you only start them after a client connects."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"edited":false,"creation_date":1636974674,"comment_id":123692353,"body":"@PetrJaneček Regarding the latter part of your comment, If a thread is looping forever, it is impossible to switch to another thread?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973382,"edited":false,"creation_date":1636974467,"comment_id":123692266,"body":"Exactly. Just to make it a little more clear, the code will wait forever at the <code>serverSocket.accept()</code> call (which is called before the <code>new Thread(...)</code> part) and will never move on from there."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636974240,"comment_id":123692177,"body":"You never get to <code>client1.startConnection()</code>. Your code is stuck forever at <code>serverSocket.accept()</code> which waits forever. It will not move from that point. Even if that was not the case, the then there&#39;s the infinite loop. Again, the code would loop forever, never actually getting to <code>client1.startConnection()</code>."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636973999,"comment_id":123692082,"body":"But I also have client1.startConnection()?"},{"owner":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"edited":false,"creation_date":1636926068,"comment_id":123682000,"body":"thank you so much brother I got It  everything."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636896634,"comment_id":123674561,"body":"If you are trying to demonstrate that the code is not thread-safe, be aware that the <code>println</code> <i>could</i> be altering the way that things are working.  Also, be aware that thread non-safe behavior may actually occur on particular platforms under particular circumstances that are hard to reproduce.  They may depend on hardware behavior, numbers of cores, specific code sequences generated by specific JIT compilers, etc.   (The fact that you are not able to show thread non-safety does NOT mean that code is thread-safe.  You have to carefully analyze the code against what the JLS says.)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895965,"comment_id":123674410,"body":"I modifed code a bit <code>new _Thread(new Dummy()).start()</code>, but didn&#39;t achieved expected result. Every time it prints that list has all 10_000 elements. Does it happens because <code>start()</code> methods triggers <code>happens-before</code> and all values from constructor in main thread will be visible in <code>_Thread</code> or it is just hard to reproduce?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":1,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636895558,"comment_id":123674310,"body":"1) Yes.  If you satisfy <b>all</b> of the prerequisites. 2) Yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895045,"comment_id":123674169,"body":"Does it mean that if I will used <code>final</code> on unsynchronized collection, values put in during construction won&#39;t be cached inside of thread but will be commited in main memory despite there is no synchronization and collection isn&#39;t thread-safe, and if there will be no <code>final</code> modifier there is possibility that values put in will be visible only to thread which executed code in constructor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894805,"comment_id":123674109,"body":"<code>final fields also allow programmers to implement thread-safe immutable objects without synchronization</code> why do I even have to use synchronization inside of constructor if only single thread can execute code in it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894676,"comment_id":123674091,"body":"As for example int this question - <a href=\"https://stackoverflow.com/questions/6457109/java-concurrency-is-final-field-initialized-in-constructor-thread-safe\" title=\"java concurrency is final field initialized in constructor thread safe\">stackoverflow.com/questions/6457109/&hellip;</a> was used <code>final</code> <code>HashMap</code>, and all values were put in constructor. I wonder what will be the difference if there was no <code>final</code> modifier. As for me, I see no difference bcs anyway thread won&#39;t return object until constructor finishes his work, he didn&#39;t pass out <code>this</code> out of constructor. Or bcs it is not synchronized <code>Map</code> thread can cache values which he put into <code>Map</code> and other threads won&#39;t see fully populated map but only part of it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa0490fa29da8a5d40dd219d9f13dccb?s=256&d=identicon&r=PG","account_id":49729,"user_type":"registered","user_id":148208,"link":"https://stackoverflow.com/users/148208/justin-kredible","reputation":8364,"display_name":"Justin Kredible","accept_rate":74},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955150,"edited":false,"creation_date":1636815008,"comment_id":123660346,"body":"This approach requires the thread to poll the queue with a timeout. For this application, how often the producer places a new object in the queue is indeterminate. It could be as little as a few milliseconds to as much as a few minutes. This means choosing a suitable timeout for the consumers is almost impossible. The goal is to prevent the consumer threads from needlessly consuming CPU time as well as needlessly blocking. The consumer threads should only block while the producer is active. If the producer has exited, the consumers should exit once the queue is empty."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":68788509,"edited":false,"creation_date":1631416285,"comment_id":122214241,"body":"a &quot;fairy tale&quot; answer got accepted agains this. of course."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629711786,"comment_id":121749897,"body":"It did not help"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629222254,"comment_id":121628473,"body":"If they are not static, then each thread has their own separate copy of those variables..  Each thread will wait for the other thread to change their copy of turn and notify their copy of monitor, but that will never happen, because the other thread is doing that to the other copy."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"edited":false,"creation_date":1629209876,"comment_id":121623256,"body":"Hey, I&#39;m pretty sure it&#39;s a dumb question but why does the program not work if monitor and turn are not static?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629175752,"comment_id":121610331,"body":"Glad it helped. Just remember that <code>synchronized</code> always works upon any object. Means threads will compete to access the <code>synchronized</code> object. You cannot sync the threads, but need to make them access common <code>synchronized</code> object, to make them run in sync."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1629128619,"comment_id":121599510,"body":"I expressed myself pretty badly, I was talking about the first Output but because the run method is synchronized at the time when t1 creates t2, t2 can&#39;t use the run Method yet because it&#39;s already in use, correct?. I think I understood the concept itself now and just have to code it a couple times to get it into my brain. I can&#39;t express how much I appreciate the time you put into your answer, it really helped a lot! (and sorry for the late answer)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124cda7f0e8d259e69d49ed43868639e?s=256&d=identicon&r=PG","account_id":99786,"user_type":"registered","user_id":269361,"link":"https://stackoverflow.com/users/269361/fool4jesus","reputation":2155,"display_name":"fool4jesus","accept_rate":79},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"edited":false,"creation_date":1629126606,"comment_id":121598571,"body":"@TomDibble Yeah, that&#39;s true; of course, depending on how often this happens, we might not want to pay the stack trace overhead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629122491,"comment_id":121596460,"body":"What you could try is to use saveAndFlush() instead of save() on the repository. It instantly brings the changes to the database."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629122329,"comment_id":121596389,"body":"In the subclass-Thread approach, can&#39;t we just override <code>interrupt()</code> itself, and capture thread state of the interrupter from <code>Thread.currentThread()</code>, at least thread id and name, likely also the current stack trace?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629114483,"comment_id":121593048,"body":"I am using the DB interface to validate the logic, i see that using transaction, money don’t edit"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68793486,"edited":false,"creation_date":1629110199,"comment_id":121591447,"body":"It’s not really encapsulation when you’re still dealing with threads directly. Nothing prevents other threads from calling the original <code>interrupt()</code> method without a name here. Generally, code should not depend on names in that form anyway. See for example, <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html\" rel=\"nofollow noreferrer\"><code>FutureTask</code></a> and how it nowhere deals with threads in the API. You may <code>cancel</code> it with interruption and it will interrupt the processing thread if there is one and it is still processing this very task."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629109610,"comment_id":121591219,"body":"@Saintka I saw in your edited question that for a withdrawal you are doing money += value. Is this right? Usually on withdrawal you remove money from your account.  Further question, what is your test assertion? From your code I currently can&#39;t see what you are validating to see if your logic worked or not. Something like account.getMoney().equals(1000); or so."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629102820,"comment_id":121588455,"body":"The cost of a context switch is not only the context switch itself, but also running into cold caches. And depending on the microarchitecture and the OS, a context switch can also lead to TLB evictions to prevent security problem as those caused by meltdown and others."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629102621,"comment_id":121588383,"body":"How can a method return a different object one by one id? Yes, sthat synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629093754,"comment_id":121585425,"body":"@Saintka I&#39;m not sure which part you don&#39;t understand: that <code>findById</code> may return a different object for the same id, or that synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a97334841a1e42ce096e1e220116af2?s=256&d=identicon&r=PG","account_id":931371,"user_type":"registered","user_id":961204,"link":"https://stackoverflow.com/users/961204/jobless91","reputation":33,"display_name":"jobless91"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629087452,"comment_id":121584297,"body":"@fool4jesus yes, that&#39;s a mistake in question. I forgot to add an <code>if(Thread.interrupted())</code> condition. I will update the question but I got your point. Key motivation for this question is, I have a blocking queue which is getting interrupted while waiting for memory(it is reaching it&#39;s size limit we have defined). I wanted to look for that interrupting thread. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629086477,"comment_id":121584175,"body":"Interesting reasoning, but i don&#39;t understand, how is this related in this situation, please give an example"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081187,"comment_id":121583556,"body":"Thanks, I will avoid the CompletableFuture for now, I never a fan of callback anyway. I am not a CS grad, so I tried my best to understand the server-client. Thanks for the clarification."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081037,"comment_id":121583538,"body":"That makes so much sense! I only use that <code>CompletableFuture</code> there, assuming there are only 4 threads from the ForkJoinPool.commonPool, I can imagine the Opening Handshake will do Redis select to determine if it&#39;s a valid request and it will block the async code."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080594,"comment_id":121583489,"body":"Also, I think you&#39;re lacking a sense of perspective. Your CPU can run literally billions of ops a second. That 500 feels expensive, but in context, we&#39;re talking about a nanosecond. Just write the simplest code you can, make lots of threads, call blocking code, don&#39;t worry about accidentally blocking, and worry about inefficient algorithms instead. You can handle hundreds of simultaneous connections on the cheapest AWS virtual server that way, no problem."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080418,"comment_id":121583465,"body":"The reason async makes it easier: If you block <i>anywhere</i> in an async block, that means the thread is twiddling its thumbs. If I figure out you forgot (e.g. you do a sync DB call somewhere), I just need to get into the &#39;block&#39; mode on 10 simultaneous connections and your server&#39;s CPU is 100% frozen out, not responding to anything else. It is much, MUCH harder to loop a thread using a malicious request, and it&#39;s much easier to realize that&#39;s happening (as CPU load would jump to 100%)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080336,"comment_id":121583454,"body":"500+ cycles, as in: The CPU could be doing 500 simple calculations. <b>But it is what it is</b>, you cannot avoid this cost no matter how hard you try. runAsync won&#39;t do it either. The point is: If you read a blogpost that says async avoids it, they are misunderstanding how CPUs work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080291,"comment_id":121583450,"body":"async makes it much <i>easier</i> to DDOS a server, not harder. That runAsync trick does mostly nothing. It certainly doesn&#39;t prevent DDoS attacks. You can&#39;t avoid the context switching. Period. Nothing can."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629079915,"comment_id":121583411,"body":"Does this mean <code>CompletableFuture.runAsync( () - &gt; { WebSocket websocket = new WebSocket(socket, listener); es.execute(websocket); });</code>, I use this after <code>final Socket socket = serverSocket.accept();</code> in case the server is under DDoS with very long http message body during the handshake, so other client trying to connect will not be affectted. Does using CompletableFuture will make the Java application suffers from context switching cost? And, could you please explain about the magnitude of the <code>500+ cycles worth</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/65d747d7ca1ea7c6fae309cce663236c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14357,"user_type":"registered","user_id":29470,"link":"https://stackoverflow.com/users/29470/tim-moore","reputation":9128,"display_name":"Tim Moore"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629077466,"comment_id":121583076,"body":"Nice answer. I wondered whether <code>interrupter</code> would need to be <code>volatile</code> or otherwise synchronized in order to be reliably visible to the interrupted thread. After some quick research, it looks to me like that is not required, and this code is reliable as is. This is discussed at <a href=\"https://stackoverflow.com/q/45269123/29470\">stackoverflow.com/q/45269123/29470</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628948146,"comment_id":121559775,"body":"The code which you have written in question contains 2 mistakes: 1) You have assumed that <code>t1</code> will always run before <code>t2</code>, but this is wrong assumption. 2) You have entered delay of <code>500ms</code> via <code>Thread.sleep</code>, but you never know how much exact delay is needed to make both the treads sync. It totally depends on the processor. It may work on some processor, but not on other. In my code, I haven&#39;t entered any delay. But using <code>wait</code> and <code>notify</code> to run threads in sync. In this case I am not worried about how much delay is needed. They will work in sync by waiting and notifying the other."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628947550,"comment_id":121559647,"body":"No your imagination is not correct. When you start 2 threads one after the other, they will be submitted to the tread scheduler. Now its up to the thread scheduler to run whichever thread first. In most of the cases, thread scheduler will run first submitted thread first, but not in every case. In my updated version, I have created and ran 2nd thread from 1st thread itself, thus I am assured that 1st thread is running and then only 2nd thread will come into existence. It will just delay the 2nd thread a bit, but once both are in execution, they will run in sync (with <code>wait</code> and <code>notify</code>)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628941390,"comment_id":121558331,"body":"Can I imagine it like this: If you just start 2 Threads one after another the thread you started first is starting a bit earlier than the 2nd one but the &#39;time difference&#39; is smaller than the potential inconsistency (and that&#39;s what happenes in my code on the top). But your programs, especially the updated version, give some buffer between the 2 Threads and that buffer is bigger than the potential inconsistency which makes it consistent. Thread 2 is always gonna be slower because Thread 1 creates and starts it (With slower I mean that Thread 1 is further advanced in the run function than T1 is"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628930979,"comment_id":121556085,"body":"I am impressed with how you are debugging this concept. You are somewhat correct that it may lead to inconsistencies (not always, it depends on the thread schedular) in the above two approaches. Check my updated answer, it will guarantee that <code>t1</code> is executed before <code>t2</code> in every case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761559,"edited":false,"creation_date":1628896464,"comment_id":121551703,"body":"I see, I understand it now. Thank you so much!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893069,"comment_id":121551138,"body":"Can&#39;t this lead to mistakes because Threads are inconsistent? Or did I get something wrong? Sorry if it&#39;s a dumb question and thank you so much for the time you put into your answer!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893000,"comment_id":121551129,"body":"First of All thank you so much for this answer, I really appreciate it a lot. I hope I got how it works: The synchronized oponent variable lets a Thread wait if another Thread is already using it (just like join does). So the Thread t1 goes into the first if statement and prints out c and then goes into wait state while the Thread t2 goes into the else statement, also prints c and then notifys t1 and goes into wait state and then both go into the next for loop? So basicly t1 is always a bit faster than t2 because they execute at the same time but t2 has the longer path?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b46fd0a429838cd67ea0650e953899be?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22447688,"user_type":"registered","user_id":16651360,"link":"https://stackoverflow.com/users/16651360/marco","reputation":54,"display_name":"Marco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"edited":false,"creation_date":1628833721,"comment_id":121531019,"body":"That is why the synchronizer is static."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"edited":false,"creation_date":1628787809,"comment_id":121521292,"body":"In order to protect access to the shared variable, both threads need to synchronize on the  <i>same</i> object."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785660,"comment_id":121520574,"body":"similar <a href=\"https://stackoverflow.com/questions/52949210/printing-alphabets-and-numbers-using-multi-threading\" title=\"printing alphabets and numbers using multi threading\">stackoverflow.com/questions/52949210/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785475,"comment_id":121520494,"body":"maybe they want you to know about atomic variables"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"edited":false,"creation_date":1628785271,"comment_id":121520408,"body":"Well it&#39;s an uni exercise and I don&#39;t think it&#39;s supposed to be that hard because we just started with Threads. It wants us to solve it with a global boolean variable so maybe that makes it easier?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760859,"edited":false,"creation_date":1628784688,"comment_id":121520186,"body":"What I meant is that I want the first Thread to print out the first char and the right after the second Thread his first char. What happens right now is that sometimes the first Thread starts first and sometimes the second One so the Output can be something like : aABb but I always want it to be aAbB"},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67831727,"edited":false,"creation_date":1623175910,"comment_id":120002308,"body":"I don&#39;t know where you decided in the first paragraph that it is going to <i>replace</i> the value and that no mutations are allowed, which is still replace, if you ask me. Then simply highlighting the words <i>happens-before</i> is not what I was after, by far. I don&#39;t think this answers my question. I will may be revise my opinion after some time when I re-read it, but currently I can&#39;t accept this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1621500701,"comment_id":119516539,"body":"@pveentjer right, this is a good illustration of how risky is to don&#39;t follow JMM literally) I&#39;d say, we just get &quot;undefined behaviour&quot; without appropriate HB edges"},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621492098,"comment_id":119512957,"body":"If you don&#39;t have a synchronized getter, the JIT can also cause problems. E.g. if the value is used in a loop, it could hoist the read out of the loop. So this will fail on CPUs with strong memory models as well."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621348442,"comment_id":119465495,"body":"@kidfrom then you may be interested in an example of using jcstress lib, which is an official tool for testing Java standard library, like <a href=\"https://vimeo.com/131395566\" rel=\"nofollow noreferrer\">vimeo.com/131395566</a> This is a good example why we need volatile"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621347500,"comment_id":119464960,"body":"@AnatolG if I use <code>thread.join</code>, the count value will be 20k because it will wait until all threads have been terminated before invoking <code>Counter.getCount()</code>. I am writing a study material for bootcamp to show that &quot;even thread safe code can fail because it takes time to get the most updated value although it is a volatile attribute, just make sure you understand the volatile and the synchronized keyword&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346909,"comment_id":119464633,"body":"@kidfrom BTW, why do you need 20k threads and each one increments the counter only once? I&#39;d say that it isn&#39;t a good idea to have so many threads in your application (you need much memory for stacks, a lot of CPU spent on context switching etc) In the real life you have 10x active threads, if most of them are parked/waiting for IO-1000x threads are OK.If you test multithreaded code,it&#39;s enough to use up to...10 threads, but each of them should live long enough to make 100K-100M operations to produce highly concurrent scenarious with higher calls/per sec ratio than in case of 100K-100M threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346214,"comment_id":119464248,"body":"@kidfrom I hope you do something like  for (Thread t : threads) { t.join(); }  to make sure all incrementers have their work finished completely and only then you call getCount() ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621345772,"comment_id":119463997,"body":"@Anatolgy I will mark this as answer. However, when I test the increment() method <code>without the Object.wait();</code> with 20k of threads, the count value always between 19990 - 19999, i double check with <code>while (counter.getCount() != 20000) {}</code> to wait until the count value 20k before testing, resulting in failed test. In short, I should learn more about the JMM requirements you mention."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621345326,"comment_id":119463757,"body":"@kidfrom right. JLS has specific part to describe how to write/save and read/load values/references in multithreaded environment to have updates visible to readers. To have the value written and read under the same lock (in our case - in a block synchronized on the same monitor) OR to do both write and read to/from a volatile field are 2 simplest ways to satisfy JMM requirements (there are some other ways to get Happens-before edge, but these 2 are the most simple/obvious/pragmatic ones)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621344294,"comment_id":119463207,"body":"For problem 2. (after removing the <code>Object.wait()</code>) Do you mean that both the setter and getter needs to have <code>synchronized</code> in order to prevent data race because the setter method is accessed by multiple thread?, currently if I only use <code>synchronized</code> in the setter method, the test never fails, but I do use Intel chips, so I am not sure whether the code is thread safe even if the <code>Object.wait()</code> is removed."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621343778,"comment_id":119462897,"body":"@kidfrom again :) in this particular code we have 2 different problems: 1 - a race condition - broken (by .wait()) atomicity. To fix it, you have to get rid of the wait(), which releases the monitor. If we need to simulate some workload, use, for example, Thread.sleep() instead. 2 - a data race. The updated counter may not be visible outside by a reader via getCount(). To fix this problem, declare the counter as a volatile field or add synchronized on the getter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621341708,"comment_id":119461847,"body":"I tested it, it seems concurrent logic can&#39;t work with <code>Object.wait()</code> which causes the lock to be released."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621340416,"comment_id":119461241,"body":"So if I have a <code>synchronized</code> setter, but the <code>count</code> attribute does not have <code>volatile</code>, it will cause problem in ARM, are the solutions 1: to use <code>synchronized</code> getter e.g. <code>synchronized void increment() {int temp = getCount(); wait(100); count = temp + 1; }</code> 2. to use <code>volatile</code> keyword to the <code>count</code> attribute?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621333614,"comment_id":119458251,"body":"@Argun cannot reproduce the problem, add a complete <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mimimal reproducible example</a> demonstrating the problem if you want some hint about a possible solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621328813,"comment_id":119456005,"body":"Added Client Class"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621285252,"comment_id":119445065,"body":"@Argun the added part does not tell from where these message are coming from, bottlenecks are possible on the client itself, on the connection, on the datagram processor, please clarify"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621271693,"comment_id":119440006,"body":"Added this part to the question"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621265049,"comment_id":119437061,"body":"@Argun sorry, I cannot understand what you mean, is the server too slow?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621263243,"comment_id":119436204,"body":"I have a simple client that sends messages once per millisecond, but I receive messages about once every 15 milliseconds"},{"owner":{"profile_image":"https://lh4.googleusercontent.com/-qppNtT-hLks/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pK5M5owjrXVau33ScI3xdldvJyNw/mo/photo.jpg?sz=256","account_id":13982631,"user_type":"registered","user_id":10098446,"link":"https://stackoverflow.com/users/10098446/mohendra-amatya","reputation":381,"display_name":"Mohendra Amatya"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67556264,"edited":false,"creation_date":1621169911,"comment_id":119408724,"body":"So, is there a way to test whether the variable f is 0 (i.e partially initialized), I removed the final from the class A. I only get 42."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dec37b21723a50cb3d4d415149d22fe8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5240687,"user_type":"registered","user_id":4187837,"link":"https://stackoverflow.com/users/4187837/gavin","reputation":1727,"display_name":"Gavin","accept_rate":86},"content_license":"CC BY-SA 4.0","score":1,"post_id":66471075,"edited":false,"creation_date":1614848320,"comment_id":117511806,"body":"I think in this instance it would be great if you could provide a link to the issue in the appropriate bug tracker"},{"owner":{"profile_image":"https://i.stack.imgur.com/xfXW3.png?s=256&g=1","account_id":8824128,"user_type":"registered","user_id":6592881,"link":"https://stackoverflow.com/users/6592881/sfili-81","reputation":2378,"display_name":"Sfili_81"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66468855,"edited":false,"creation_date":1614845105,"comment_id":117510321,"body":"Add some explanation to your answer"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":66458166,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"edited":false,"creation_date":1614784040,"comment_id":117491240,"body":"You are setting a value on a <i>thread local</i> variable. The value will be associated with the thread executing the <code>tl.set(bar);</code> statement. When the main thread executes the statement, the value is associated with the main thread which is still alive afterwards (as it is the thread calling <code>System.gc()</code> in a loop). When a different thread executes the statement, the value will be associated with that particular thread and can be removed when that thread terminates."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"content_license":"CC BY-SA 4.0","score":0,"post_id":66458166,"edited":false,"creation_date":1614783119,"comment_id":117490713,"body":"Thanks for the details, could you please explain &quot;to stop the value from being associated with the main thread&quot;, is this because New Thread does not have a reference on Main thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/OWvGv.jpg?s=256&g=1","account_id":14035474,"user_type":"registered","user_id":10138295,"link":"https://stackoverflow.com/users/10138295/thenameisviru","reputation":13,"display_name":"TheNameIsViRu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65396071,"edited":false,"creation_date":1609153489,"comment_id":115759699,"body":"Thank you @emandt for your reply. I used recursion concept for API request call."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"edited":false,"creation_date":1608579497,"comment_id":115622058,"body":"No problem, always glad to help!"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65395539,"edited":false,"creation_date":1608575148,"comment_id":115620417,"body":"Thanks for your time, I&#39;ll definitely try it out tomorrow"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"edited":false,"creation_date":1608557328,"comment_id":115612203,"body":"Omg, I&#39;ve been busy solving this problem for so long. Your help me with &#39;Platform.runLater (new Runnable ()&#39; a lot and it works now. I have added this to my run() in the MyTask Class <code>Platform.runLater (new Runnable () { @Override public void run () { text.set (Integer.toString (counter)); }});</code>                                          Thank you very much"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711094,"comment_id":84626646,"body":"@JeffG actually answered this in the answer below!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711049,"comment_id":84626612,"body":"I actually liked this last example quite well. Reminds me of using a closure in JS to reference variables in the outer scope. But is the <code>this.myParam</code> then really necessary? Couldn&#39;t you just drop the private variables and refer to the variable from the outer scope? I understand (of course) that this has some implications, such as the variable being open to change after starting the thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465383993,"comment_id":62875576,"body":"That&#39;s how I&#39;ve always developed my apps, however if you don&#39;t wish to make all those changes, other answers might help you get around your issue using the application class. For your future reference, I recommend using the one activity class immediately, and then many fragments. Hope this helps :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465383688,"comment_id":62875407,"body":"Okay, so you mean I should abandon the <code>Application</code> object altogether and move all the initialization code to the first <code>Activity</code> ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465382792,"comment_id":62874882,"body":"Why are you extending the application class and not the activity one?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465277621,"comment_id":62820071,"body":"Thank you for your answer, it was very interesting. However, I believe you misunderstood my question. The problem is not caused by the initializations in the first <code>Activity</code>, but those in the global <code>Application</code> object. And I don&#39;t believe I can apply such a separation of concerns there, because unlike an <code>Activity</code> it only has an <code>onCreate()</code> method."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364292853,"comment_id":22180658,"body":"@Ovidiu Latcu agreed. what if the user wants to interact button on the screen, other than publishing update say to the progress bar.This method publishProgress is used to display any form of progress in the user interface while the background computation is still executing. For instance, it can be used to animate a progress bar or show logs in a text field."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364292322,"comment_id":22180396,"body":"you can use <code>publishProgress</code> to update the <code>UI</code> when using an <code>AsyncTask</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364290742,"comment_id":22179483,"body":"you will be running long operations in doInBackground() andu cannot update ui untill doInBackground finishes, keep the user waiting to interact with ui. Only in onPostExecute() ui is updated and user can interact with ui."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364285020,"comment_id":22177118,"body":"IDK why you say that AsyncTask should be used for &quot;a few seconds at most&quot;... nevertheless for very long operations it is recommended to use <code>Services</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/add6146aeae299f7241d7733b850e717?s=256&d=identicon&r=PG","account_id":347517,"user_type":"registered","user_id":681671,"link":"https://stackoverflow.com/users/681671/dojo","reputation":5454,"display_name":"Dojo","accept_rate":59},"content_license":"CC BY-SA 2.5","score":0,"post_id":5533219,"edited":false,"creation_date":1301924639,"comment_id":6295543,"body":"Yeah, i did not notice any significant overhead while testing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53f721a451a1c68caf8316cefcde3083?s=256&d=identicon&r=PG","account_id":2017134,"user_type":"registered","user_id":1804173,"link":"https://stackoverflow.com/users/1804173/bluenote10","reputation":24247,"display_name":"bluenote10","accept_rate":77},"content_license":"CC BY-SA 4.0","score":0,"post_id":817926,"edited":false,"creation_date":1691781839,"comment_id":135543258,"body":"I don&#39;t really understand this example: My understanding is that access to an instance only has to be synchronized if mutability is involved. As long as things are immutable, everything is thread safe. Giving each thread its own instance &quot;solves&quot; the problem in the sense that each thread can happily mutate their own instance. But what&#39;s the use case for that? I mainly see use cases for <b>pure immutability</b> or <b>synchronized mutability</b>, and would be curious to understand under which circumstances &quot;diverging mutability&quot; is helpful."},{"owner":{"profile_image":"https://i.stack.imgur.com/DzDIR.jpg?s=256&g=1","account_id":140189,"user_type":"registered","user_id":346309,"link":"https://stackoverflow.com/users/346309/jpm","reputation":9145,"display_name":"JPM","accept_rate":92},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1685024577,"comment_id":134606015,"body":"White window still shows even with this."},{"owner":{"profile_image":"https://i.stack.imgur.com/riCsa.jpg?s=256&g=1","account_id":4675848,"user_type":"registered","user_id":3786226,"link":"https://stackoverflow.com/users/3786226/mc-topaz","reputation":607,"display_name":"Mc_Topaz","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1675268093,"comment_id":132892992,"body":"This worked for me. I created a drawable with a blue background. In my theme in the /res/valyes/themes.xml i added the <code>&lt;item name=&quot;android:windowBackground&quot;&gt;@drawable&#47;my_drawable&lt;&#47;item&gt; line.</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53e2e1f2b1c0d69f29505aeb9dfe1832?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15744638,"user_type":"registered","user_id":11360924,"link":"https://stackoverflow.com/users/11360924/landnbloc","reputation":1028,"display_name":"landnbloc"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1649960919,"comment_id":127012263,"body":"This delayed any screen from opening for the app for around 4 seconds for me. Felt like the app icon was never touched. Run on cheap Samsung Galaxy A02s"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJz0y1sMaJYi2GG8YJ1jEkEE1KHBRcruM2LGurMB=k-s256","account_id":24305399,"user_type":"registered","user_id":18248235,"link":"https://stackoverflow.com/users/18248235/cflowe-visit","reputation":341,"display_name":"Cflowe Visit"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877113,"edited":false,"creation_date":1649098333,"comment_id":126785570,"body":"so it means java didn&#39;t support it normally?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-TmRHUaNDjGI/AAAAAAAAAAI/AAAAAAAABpg/WUC4cyxANRI/photo.jpg?sz=256","account_id":8987793,"user_type":"registered","user_id":6700830,"link":"https://stackoverflow.com/users/6700830/codesinthedark","reputation":151,"display_name":"CodesInTheDark"},"content_license":"CC BY-SA 4.0","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"edited":false,"creation_date":1630084728,"comment_id":121868293,"body":"@KonstantinMilyutin The problem is that Thread does not use WeakReference for values, only for the keys. If a value uses a custom class it will prevent its ClassLoader to be gc-ed and in turn, it will prevent the whole application and its ThreadLocals to be gc-ed because you get a circular reference."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-_DP3LTfLMXw/AAAAAAAAAAI/AAAAAAAAAHk/dzYHVVdXUnE/photo.jpg?sz=256","account_id":5826102,"user_type":"registered","user_id":4592448,"link":"https://stackoverflow.com/users/4592448/fortran","reputation":2248,"display_name":"Fortran","accept_rate":100},"content_license":"CC BY-SA 4.0","score":2,"post_id":37681189,"edited":false,"creation_date":1624386021,"comment_id":120343518,"body":"best answer, dont foget add to black theme, not only white)"},{"owner":{"profile_image":"https://i.stack.imgur.com/SsTc7.jpg?s=256&g=1","account_id":2305297,"user_type":"registered","user_id":2024692,"link":"https://stackoverflow.com/users/2024692/cromax","reputation":1882,"display_name":"Cromax","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":54241038,"edited":false,"creation_date":1615620045,"comment_id":117752140,"body":"But you actually made a new class — it&#39;s just anonymous class. :-) On the other hand it&#39;s exactly the same approach as in solution no.1 in <a href=\"https://stackoverflow.com/a/39214833/2024692\">stackoverflow.com/a/39214833/2024692</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/LXMHI.png?s=256&g=1","account_id":15515017,"user_type":"registered","user_id":11192811,"link":"https://stackoverflow.com/users/11192811/rajnish-sharma","reputation":390,"display_name":"Rajnish Sharma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1611765220,"comment_id":116557330,"body":"Just remove the bitmap and use this instead : <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layer-list xmlns:android=&quot;http:&#47;&#47;schemas.android.com&#47;apk&#47;res&#47;android&quot;&gt;     &lt;item         android:drawable=&quot;@color&#47;black&quot;&#47;&gt;     &lt;item         android:drawable=&quot;@mipmap&#47;ic_launcher_round&quot;         android:gravity=&quot;center&quot;&#47;&gt; &lt;&#47;layer-list&gt;</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44288d0ab21eb3318b526a6c50028685?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7900776,"user_type":"registered","user_id":5967872,"link":"https://stackoverflow.com/users/5967872/kyl3r","reputation":3946,"display_name":"KYL3R"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"reply_to_user":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"edited":false,"creation_date":1609595487,"comment_id":115873214,"body":"Hey @JeremLachkar - I got the same error, but solved it. &lt;bitmap&gt; cannot load xml icons / vectors (at that time?) but using PNGs worked for me!"},{"owner":{"profile_image":"https://i.stack.imgur.com/QIkTb.png?s=256&g=1","account_id":4366153,"user_type":"registered","user_id":3561889,"link":"https://stackoverflow.com/users/3561889/ucdemir","reputation":2931,"display_name":"Ucdemir","accept_rate":59},"content_license":"CC BY-SA 4.0","score":3,"post_id":57090517,"edited":false,"creation_date":1609260073,"comment_id":115793457,"body":"I test and still white screen there"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bffea7de598020c514bdca3b0239d865?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8509289,"user_type":"registered","user_id":6379785,"link":"https://stackoverflow.com/users/6379785/gmetal","reputation":2918,"display_name":"gmetal"},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1608648341,"comment_id":115643334,"body":"Setting <code>android:windowDisablePreview</code> will remove the white screen on startup by not showing anything. Therefore, if during your app initialisation you are doing a lot of things (e.g. initialising external services) then your app will appear to hang (which it does not). The most appropriate solution is setting a custom <code>android:windowBackground</code>. In reality, the white screen at startup is just the default windowBackground that you are seeing."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"edited":false,"creation_date":1608349885,"comment_id":115563769,"body":"@Rafay You accepted an answer, which is the Stack Overflow version of marking it resolved. You don&#39;t need to do anything more."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333585,"comment_id":115561235,"body":"Can I close the question if i don&#39;t need the answer anymore? Or mark it resolved/answered?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333542,"comment_id":115561217,"body":"I read more about happens-before and find out I don&#39;t need AtomicReference in my code. Also in my real code, i am using ExecutorService to assign tasks. I reorg&#39;d my code and gotten rid of AtomicReference all-together. Thanks for explanation."},{"owner":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"content_license":"CC BY-SA 4.0","score":1,"post_id":49254344,"edited":false,"creation_date":1604422253,"comment_id":114340412,"body":"looks promising, but Android says at runtime &quot;Binary XML file line #7: &lt;bitmap&gt; requires a valid &#39;src&#39; attribute&quot;. Maybe the drawables are not loaded so early in the app launch process ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b3c046745a2523e02497f69fae887460?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10453530,"user_type":"registered","user_id":7706354,"link":"https://stackoverflow.com/users/7706354/lava","reputation":6345,"display_name":"lava"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1603808538,"comment_id":114150018,"body":"nice solution .I saw a app .but it was a loading screen . i thought .how they achieve it .i look it into youtube .they also white screen with youtube icon.now i found it this it"},{"owner":{"profile_image":"https://i.stack.imgur.com/eMjQ1.jpg?s=256&g=1","account_id":1482742,"user_type":"registered","user_id":6680585,"link":"https://stackoverflow.com/users/6680585/tom-taylor","reputation":3434,"display_name":"Tom Taylor","accept_rate":84},"content_license":"CC BY-SA 4.0","score":0,"post_id":64406380,"edited":false,"creation_date":1603002786,"comment_id":113894433,"body":"If possible attach the geeksforgeeks link too."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4287ab180a9b6483865a60e4b68ca9d8?s=256&d=identicon&r=PG","account_id":143382,"user_type":"registered","user_id":351688,"link":"https://stackoverflow.com/users/351688/a-w","reputation":2912,"display_name":"A.W.","accept_rate":91},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1602913733,"comment_id":113875884,"body":"This works for me in Android Studio 4.1, tested on a real device"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8bea1f01a8f41b0714de4eddc3c93ce8?s=256&d=identicon&r=PG","account_id":11180480,"user_type":"registered","user_id":8207228,"link":"https://stackoverflow.com/users/8207228/ralf-kleberhoff","reputation":7021,"display_name":"Ralf Kleberhoff"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601534733,"comment_id":113439134,"body":"At Stackoverflow we can&#39;t replace a good tutorial. Threads are covered e.g. in <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/procthread.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/essential/concurrency/&hellip;</a>. Work through that tutorial, and if things are still unclear after that, you&#39;re welcome to come back to us."},{"owner":{"user_type":"does_not_exist","display_name":"user11473537"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601487800,"comment_id":113426579,"body":"How should I go about creating a thread? And when I do this, do I just plug it in to the parenthesis of ColumnCalculator()?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f914cd02166793195d9d950503f8f739?s=256&d=identicon&r=PG","account_id":1352170,"user_type":"registered","user_id":1291492,"link":"https://stackoverflow.com/users/1291492/controlaltdel","reputation":34246,"display_name":"ControlAltDel","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141533,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1601486881,"comment_id":113426160,"body":"@SolomonSlow Good point."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"edited":false,"creation_date":1601466476,"comment_id":113415837,"body":"That is not possible as it will only print from 0 to 2. My output was: 0,2,1,1,0,2. And the second time: 0,2,1,0,1,2"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"edited":false,"creation_date":1601463501,"comment_id":113414430,"body":"This program also printing the same <code>01230123</code> is the output, means it is not executing simultaneously"},{"owner":{"profile_image":"https://i.stack.imgur.com/av9Qt.jpg?s=256&g=1","account_id":13442905,"user_type":"registered","user_id":9699634,"link":"https://stackoverflow.com/users/9699634/vikas-gutte","reputation":1666,"display_name":"VikaS GuttE"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1600614412,"comment_id":113136923,"body":"Prefect solution working for me (<code>compileSdkVersion 30</code>). Thank you!"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-Toy7JJFRdP8/AAAAAAAAAAI/AAAAAAAAAro/14UEMAKHESo/photo.jpg?sz=256","account_id":13406308,"user_type":"registered","user_id":9674249,"link":"https://stackoverflow.com/users/9674249/i30mb1","reputation":4142,"display_name":"i30mb1"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1600254943,"comment_id":113028146,"body":"nice value <code>animationStarted</code> that you never change"},{"owner":{"profile_image":"https://i.stack.imgur.com/QEyD7.jpg?s=256&g=1","account_id":3806533,"user_type":"registered","user_id":3158802,"link":"https://stackoverflow.com/users/3158802/rupam-das","reputation":403,"display_name":"Rupam Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"edited":false,"creation_date":1597069443,"comment_id":112005701,"body":"@Faakhir So did you find any solution? I am still looking a solution, which remove this white screen and also there&#39;s no delay at launching time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/de979476f21ed488c4be02f10dd8e2cc?s=256&d=identicon&r=PG","account_id":134590,"user_type":"registered","user_id":336827,"link":"https://stackoverflow.com/users/336827/freedev","reputation":26825,"display_name":"freedev","accept_rate":61},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1593511507,"comment_id":110800726,"body":"the parameter -Djdk.tls.disabledAlgorithms=TLSv1.3 does not work"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e21783a690b300752aceb0db57946012?s=256&d=identicon&r=PG","account_id":493787,"user_type":"registered","user_id":905640,"link":"https://stackoverflow.com/users/905640/markus","reputation":6348,"display_name":"markus","accept_rate":78},"content_license":"CC BY-SA 4.0","score":3,"post_id":54655885,"edited":false,"creation_date":1591261970,"comment_id":109990571,"body":"I see the same problem also with OpenJDK 11.0.6"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197569,"edited":false,"creation_date":1588241389,"comment_id":108825786,"body":"This code will spin mindlessly if the condition is false At least add a sleep into it. The point of having two tests escapes me."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61520614,"edited":false,"creation_date":1588241320,"comment_id":108825750,"body":"Doesn&#39;t answer the question that was asked in any way. Do read the question before answering."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/99266f63196c82aaeb18e36727424c07?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3869264,"user_type":"registered","user_id":3204950,"link":"https://stackoverflow.com/users/3204950/rameshvanka","reputation":51,"display_name":"rameshvanka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":36420786,"edited":false,"creation_date":1583690106,"comment_id":107193590,"body":"please refer my blog: <a href=\"https://rameshvanka.blogspot.com/2020/03/excel-with-multi-threaded-way.html\" rel=\"nofollow noreferrer\">rameshvanka.blogspot.com/2020/03/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=256&d=identicon&r=PG","account_id":18868,"user_type":"registered","user_id":43681,"link":"https://stackoverflow.com/users/43681/sleske","reputation":82004,"display_name":"sleske","accept_rate":70},"content_license":"CC BY-SA 4.0","score":3,"post_id":33116773,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"edited":false,"creation_date":1579880483,"comment_id":105926418,"body":"@SaptarshiBasu: As discussed in the linked question <a href=\"http://stackoverflow.com/questions/24700798/is-jax-rs-client-thread-safe\">Is JAX-RS Client Thread Safe</a>, unfortunately the spec does not require <code>Client</code> to be thread safe. In some implementations it is (e.g. in Jersey, I believe), in others it is not (e.g. Apache CXF)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/83b2bbbdc0f34ed6148dab188c6bb987?s=256&d=identicon&r=PG","account_id":367746,"user_type":"registered","user_id":714112,"link":"https://stackoverflow.com/users/714112/sridhar-sarnobat","reputation":24129,"display_name":"Sridhar Sarnobat","accept_rate":80},"content_license":"CC BY-SA 4.0","score":1,"post_id":48020642,"edited":false,"creation_date":1568405101,"comment_id":102276985,"body":"Finally a way to do it without those annoying fields. Now I just need to wait for my product to upgrade to Java 8."},{"owner":{"profile_image":"https://i.stack.imgur.com/ncQ0v.jpg?s=256&g=1","account_id":3023551,"user_type":"registered","user_id":2564032,"link":"https://stackoverflow.com/users/2564032/vasif","reputation":688,"display_name":"Vasif"},"content_license":"CC BY-SA 4.0","score":1,"post_id":817926,"edited":false,"creation_date":1565716109,"comment_id":101436153,"body":"but this solution has own problem like your objects are still exist on ThreadPool and it can cause OOM issue if you are going to store different objects in ThreadLocal and your application get a lot of requests.  I saw it as a solution for passing object to other methods without passing it as a parameter. So u can pu object in ThreadLocal and then remove it in finally to clear it up."},{"owner":{"profile_image":"https://i.stack.imgur.com/XpMUU.jpg?s=256&g=1","account_id":1431364,"user_type":"registered","user_id":1353722,"link":"https://stackoverflow.com/users/1353722/lefloh","reputation":10713,"display_name":"lefloh","accept_rate":81},"content_license":"CC BY-SA 4.0","score":0,"post_id":33116773,"edited":false,"creation_date":1563874533,"comment_id":100836191,"body":"Could you please prove this with e.g. a link to the documentation?"},{"owner":{"profile_image":"https://i.stack.imgur.com/kKvXH.gif?s=256&g=1","account_id":31180,"user_type":"registered","user_id":85421,"link":"https://stackoverflow.com/users/85421/user85421","reputation":29173,"display_name":"user85421"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877115,"edited":false,"creation_date":1560196246,"comment_id":99648680,"body":"<code>final</code> is not that important any more; it&#39;s enough if the variable is <i>effectively final</i> (despite it does no harm having it)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7654f9d9e0ffaa1d4972cccb20861377?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5847132,"user_type":"registered","user_id":4606939,"link":"https://stackoverflow.com/users/4606939/prnjn","reputation":386,"display_name":"prnjn","accept_rate":92},"content_license":"CC BY-SA 4.0","score":3,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1559122084,"comment_id":99318469,"body":"@Robin answer doesn&#39;t have to be exactly what the other person said, if something is already said then additional information is more valuable than writing the same thing over again. And here the answer holds quality and important information."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9da43a7cb4f685c3db616ad144f5de69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5428620,"user_type":"registered","user_id":4320184,"link":"https://stackoverflow.com/users/4320184/dashenswen","reputation":560,"display_name":"dashenswen","accept_rate":12},"content_license":"CC BY-SA 4.0","score":0,"post_id":32122972,"edited":false,"creation_date":1556167088,"comment_id":98346639,"body":"I still didn&#39;t see the benefit of using ThreadLocal to generate the unique id in example one if all your purpose is to return an incremental unique integer value.   ```  public class ThreadId {      // Atomic integer containing the next thread ID to be assigned      private static final AtomicInteger nextId = new AtomicInteger(0);       // Returns the current thread&#39;s unique ID, assigning it if necessary      public static int get() {          return nextId..getAndIncrement();      }  } ```"},{"owner":{"profile_image":"https://i.stack.imgur.com/FbWEX.png?s=256&g=1","account_id":2616549,"user_type":"registered","user_id":2265497,"link":"https://stackoverflow.com/users/2265497/slesh","reputation":1922,"display_name":"slesh","accept_rate":41},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1553257457,"comment_id":97327392,"body":"Disabling TLS 1.3 doesn&#39;t work - <a href=\"https://stackoverflow.com/questions/55298459/java-11-httpclient-leads-to-endless-ssl-loop-even-with-disabled-tlsv-1-3\" title=\"java 11 httpclient leads to endless ssl loop even with disabled tlsv 1 3\">stackoverflow.com/questions/55298459/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/RDWxl.png?s=256&g=1","account_id":4342327,"user_type":"registered","user_id":3545273,"link":"https://stackoverflow.com/users/3545273/serge-ballesta","reputation":145474,"display_name":"Serge Ballesta","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":24721873,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1551106477,"comment_id":96508170,"body":"It is a rather old question, but I could remember what it was about. I said it should never be done again, because it is a recipe for building deadlocks..."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":2,"post_id":54485918,"edited":false,"creation_date":1549987007,"comment_id":96099623,"body":"Just found out that even with <code>-Djdk.tls.disabledAlgorithms=TLSv1.3</code> the client still uses TLS v1.3"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549676532,"comment_id":96000901,"body":"Oh interesting Zarathustra."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":1,"post_id":54485918,"edited":false,"creation_date":1549620385,"comment_id":95976355,"body":"Disabling TLS 1.3 did not help :/"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549051688,"comment_id":95779683,"body":"Interesting link. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1549051585,"comment_id":95779623,"body":"Thought about TLS 1.3 issues too ... maybe its this bug here <a href=\"https://bugs.openjdk.java.net/browse/JDK-8207009\" rel=\"nofollow noreferrer\">bugs.openjdk.java.net/browse/JDK-8207009</a> - not sure if it is fixed in my version"},{"owner":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"content_license":"CC BY-SA 4.0","score":7,"post_id":33116773,"edited":false,"creation_date":1547577262,"comment_id":95236529,"body":"This is incorrect. <code>Client</code> is meant to be shared. That&#39;s why the client implementation class have volatile variables. <code>WebTarget</code> is not thread safe."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":26803040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/KcrPN.jpg?s=256&g=1","account_id":1146772,"user_type":"registered","user_id":1129332,"link":"https://stackoverflow.com/users/1129332/ilya-gazman","reputation":31458,"display_name":"Ilya Gazman","accept_rate":61},"edited":false,"creation_date":1538172480,"comment_id":92064842,"body":"@IlyaGazman, The javadoc for <code>Thread.yield()</code> makes it quite clear that it is not required to do anything at all. You can&#39;t rely on it for any purpose whatsoever because it might literally do <i>nothing</i> when you call it."},{"owner":{"profile_image":"https://i.stack.imgur.com/KcrPN.jpg?s=256&g=1","account_id":1146772,"user_type":"registered","user_id":1129332,"link":"https://stackoverflow.com/users/1129332/ilya-gazman","reputation":31458,"display_name":"Ilya Gazman","accept_rate":61},"content_license":"CC BY-SA 4.0","score":0,"post_id":26803040,"edited":false,"creation_date":1538146077,"comment_id":92054153,"body":"100 times a second might seem like a lot, but if you have two threads that are highly depended on each other, yielding can potentially save you the 1/100 of a second over each cycle.  For example, let&#39;s say that you are trying to mark all the even numbers in an array while the other threads do the same for the odd numbers, and you can&#39;t allow them to have a gap bigger than a 100. With such extreme dependency, wait() may cause a significant performance decrease, while yielding not so much."},{"owner":{"profile_image":"https://i.stack.imgur.com/cE9IP.png?s=256&g=1","account_id":4928931,"user_type":"registered","user_id":3969362,"link":"https://stackoverflow.com/users/3969362/slion","reputation":2728,"display_name":"Slion"},"content_license":"CC BY-SA 4.0","score":2,"post_id":44430166,"edited":false,"creation_date":1533239999,"comment_id":90285977,"body":"That works great for me on a NativeActivity OpenGL application. I&#39;m not sure why this is not higher up in the answers as it is the most complete and expedient answer. No Java involved just a couple of XML file changes."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/--S24vwJjcPU/AAAAAAAAAAI/AAAAAAAAAdA/ZMh1tx27y1A/photo.jpg?sz=256","account_id":5910560,"user_type":"registered","user_id":4650969,"link":"https://stackoverflow.com/users/4650969/midhilaj","reputation":4935,"display_name":"Midhilaj","accept_rate":0},"content_license":"CC BY-SA 4.0","score":4,"post_id":37718830,"edited":false,"creation_date":1531757857,"comment_id":89704563,"body":"grate now it is not showing #ffffff color but it is now showing #000000"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51310395,"edited":false,"creation_date":1531458661,"comment_id":89611864,"body":"Exactly the same issue: jstack without the mixed mode flag is running fine. But i&#39;m using Oracle jdk 1.8.0_172."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51305417,"edited":false,"creation_date":1531399936,"comment_id":89588974,"body":"Thank you for the hint. I&#39;m using the jstack of the jvm which runs the process."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530084564,"comment_id":89104213,"body":"@DavidStuder Hmmm. I would say that in your example both threads are properly terminated. In that case the application (the Java VM) should also terminate."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083998,"comment_id":89103907,"body":"@daniu Well did not understand it that way. But I am sure that the <code>OwnThread#run</code> is terminated properly and that the <code>main</code> thread causes the issue."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530083680,"comment_id":89103744,"body":"@DavidStuder He&#39;s saying your <code>OwnThread#run</code> method doesn&#39;t finish IIUC."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083527,"comment_id":89103659,"body":"@Seelenvirtuose I think you are right, the <b>main thread</b> is still running and doing something, but I don&#39;t know what or why. There is simply no other code than calling the self-made thread and as already mentioned, debugging the <code>main</code> method leads to this <code>exit()</code>-method, which really should <b>terminate</b> the main thread as I see it."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083365,"comment_id":89103583,"body":"@Seelenvirtuose Thank you very much for your explanation. It really helps to understand it a little bit better, but still I do not understand my case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":2,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083123,"comment_id":89103454,"body":"@daniu Well ... This is because one thread is terminated: the main thread! I still speak about my example. I think, OPs problem is vice versa. The main thread is still running but the other thread terminated. That means that the main thread is still doing something."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082995,"comment_id":89103380,"body":"OP does state he found out that &quot;the last called method is the exit()-method of the Thread-class&quot; when debugging though."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530082688,"comment_id":89103245,"body":"@daniu It is running because it is <i>not</i> terminated (or exited as you say)."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082601,"comment_id":89103190,"body":"But why is the other thread still running if it has been <code>exit</code>ed?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ce01465deb2032903f0c1b86bc3f431e?s=256&d=identicon&r=PG","account_id":1085180,"user_type":"registered","user_id":1081043,"link":"https://stackoverflow.com/users/1081043/wisbucky","reputation":34239,"display_name":"wisbucky","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":877115,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f1b044b33c5d5ee61e223aac39761f43?s=256&d=identicon&r=PG","account_id":947019,"user_type":"registered","user_id":974063,"link":"https://stackoverflow.com/users/974063/randall-cook","reputation":6758,"display_name":"Randall Cook","accept_rate":100},"edited":false,"creation_date":1526608818,"comment_id":87821232,"body":"I had the same experience as @RandallCook for Anonymous class. As long as I had the <code>final X parameter</code> before the <code>new Runnable()</code> line, then I could access <code>parameter</code> inside <code>run()</code>. I didn&#39;t need to need to do the extra <code>p = parameter</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/GAem5.jpg?s=256&g=1","account_id":6960621,"user_type":"registered","user_id":5340181,"link":"https://stackoverflow.com/users/5340181/jmess","reputation":623,"display_name":"JMess"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817864,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"edited":false,"creation_date":1524610168,"comment_id":87039878,"body":"@sudeepdino008 you don&#39;t always have control of the creation of those threads (webapp frameworks, threadpool libraries)"},{"owner":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"content_license":"CC BY-SA 3.0","score":43,"post_id":37718830,"edited":false,"creation_date":1521288616,"comment_id":85673078,"body":"It hang application for 2 sec and then application launch, not useful for me!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2e814c6b5e0dd56c34931b48c5621269?s=256&d=identicon&r=PG","account_id":2080635,"user_type":"registered","user_id":1852693,"link":"https://stackoverflow.com/users/1852693/dexter","reputation":4105,"display_name":"Dexter","accept_rate":71},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1521135579,"comment_id":85614052,"body":"This is the best explanation of the use of TL."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40e56e654d3ff1a9a228a00d4f5b1d05?s=256&d=identicon&r=PG","account_id":344283,"user_type":"registered","user_id":676506,"link":"https://stackoverflow.com/users/676506/rick-rainer-ludwig","reputation":2371,"display_name":"Rick-Rainer Ludwig","accept_rate":74},"content_license":"CC BY-SA 3.0","score":2,"post_id":47562423,"edited":false,"creation_date":1517999648,"comment_id":84320427,"body":"In this example is a major issue: Who is responsible for the closing the connection? Instead of creating this connection as initiali value, let the consumer of the connection create the connection explicitly and bind it to the thread via ThreadLocal. The creator of the connection is then also responsbible for closing. This is not clear in this example. Creating and binding the connection can also be hidden in a simple framework by something like Transaction.begin() and Transaction.end()."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505906040,"comment_id":79601684,"body":"You&#39;re right. I&#39;ve probably stumbled upon several misuses of <code>ThreadLocal</code>, where it was accessible globally. As you said, it can still be used as a class field limiting the visibility."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505904944,"comment_id":79601012,"body":"It can simply be a part of object state, doesn&#39;t have to be used globally. Sure, you get little bit overhead, but if multiple objects have to have different state per thread, you can use <code>ThreadLocal</code> as object field..."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505897515,"comment_id":79596152,"body":"It is a form of global state, in the sense that it&#39;s accessible from anywhere in the code (in the same thread&#39;s context). This comes with all the repercussions, such as not being able to reason about who reads and writes this value. Using a function parameter is not a retarded thing, it&#39;s a good practice promoting clean interfaces. However, I agree with you that passing a parameter across the whole depth of your codebase is a code smell. But, I also believe that in many occasions the use of ThreadLocal is a code smell in the first place which led you here, so this what one should reconsider."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505893607,"comment_id":79593705,"body":"ThreadLocals are NOT global state unless you make it global state. They are practically always accessible stack resource. You can simulate thread local with simply passing that variable in all your methods (which is retarded); that doesn&#39;t make it global state..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893375,"comment_id":79593571,"body":"@Pacerier why would you need any synchronization with <code>ThreadLocal</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":2,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893190,"comment_id":79593462,"body":"@Pacerier how is member variable related? He was talking about local variable, which means every method call, new <code>SimpleDateFormat</code> would be created, which is a waste. Thread local is much better because it is flexible and memory &quot;leak&quot; is hardly noticeable and can be managed when thread is destroyed anyways. Member variable <code>SimpleDateFormat</code> is bad because it is not thread safe!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":13037170,"edited":false,"creation_date":1505849224,"comment_id":79578629,"body":"@Jeff, Dude, that&#39;s true of every code you write, not just <code>ThreadLocal</code> pattern. If you do <code>F(){    member=random(); F2(); write(member);     }</code> and F2 overrides member with a new value, then obviously <code>write(member)</code> will no longer write the number you have <code>random()</code>ed. This is literally just common sense. Similarly, if you do <code>F(){   F();   }</code>, then gd luck with your infinite loop! This is true everywhere and is not specific to <code>ThreadLocal</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":2,"post_id":820131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"edited":false,"creation_date":1505847274,"comment_id":79577539,"body":"@JeremyStein, The better answers are at <a href=\"https://stackoverflow.com/a/817911/632951\">stackoverflow.com/a/817911/632951</a> and <a href=\"https://stackoverflow.com/a/17398338/632951\">stackoverflow.com/a/17398338/632951</a> and <a href=\"https://stackoverflow.com/a/818364/632951\">stackoverflow.com/a/818364/632951</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1505845648,"comment_id":79576630,"body":"@Esko, In your project, your use of ThreadLocal in hashcode and equals is unneeded. A better approach is to create or pass a reference to a hashcode/equals function whenever it is needed. This way, you can completely avoid the need for ThreadLocal hack."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505839955,"comment_id":79573846,"body":"@Enerccio, Dude, a member variable in the context of each object instance. It can be accessible from all method calls."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"edited":false,"creation_date":1505839879,"comment_id":79573796,"body":"@AlexanderRyzhov, A thread-safe alternative is an even higher price to pay since you need to pay synchronization overhead on every method call. Use a local variable instead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":1,"post_id":37679026,"edited":false,"creation_date":1494668971,"comment_id":74934880,"body":"I solved this issue by animating between themes and changing the theme with no drawable but just the back color same and then on onWindowFocusChanged() mad the content visible and the animated it other wise my whited down between the transition as well. animation of themes helped alot"},{"owner":{"profile_image":"https://i.stack.imgur.com/GGyFL.jpg?s=256&g=1","account_id":7201903,"user_type":"registered","user_id":5498855,"link":"https://stackoverflow.com/users/5498855/ivan-milisavljevic","reputation":2058,"display_name":"Ivan Milisavljevic"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37679026,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"edited":false,"creation_date":1494533092,"comment_id":74882435,"body":"This is straight forward implementation. There could be some other parts of your code that  causing the issue. Please open another question and il be there to help you:)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":5,"post_id":37679026,"edited":false,"creation_date":1494501426,"comment_id":74860894,"body":"it didnt help still white screen and animation at end"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-zysTsphgh80/AAAAAAAAAAI/AAAAAAAAACM/Q2h-OaaX0mA/photo.jpg?sz=256","account_id":8179843,"user_type":"registered","user_id":6157415,"link":"https://stackoverflow.com/users/6157415/mike-d3vid-tyson","reputation":1731,"display_name":"Mike D3ViD Tyson"},"content_license":"CC BY-SA 3.0","score":0,"post_id":43630459,"edited":false,"creation_date":1493203026,"comment_id":74311442,"body":"probably the error is here :  \t\t[...]<code>List&lt;?&gt; results = List.class.cast(payload.get(&quot;result&quot;)); \t\t \t\tresults.remove(0); \t\tresults.remove(0); \t\tresults.remove(results.size()-1); \t\tresults.remove(results.size()-1); </code>[...]"},{"owner":{"profile_image":"https://i.stack.imgur.com/n93hU.png?s=256&g=1","account_id":281630,"user_type":"registered","user_id":578046,"link":"https://stackoverflow.com/users/578046/saurabh-patil","reputation":4230,"display_name":"Saurabh Patil","accept_rate":45},"content_license":"CC BY-SA 3.0","score":20,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1485415179,"comment_id":70919029,"body":"@Robin: I disagree. The question is about how to use ThreadLocal correctly, to get a complete understanding of any concept (ThreadLocal here) it&#39;s also important to understand how not to use it and the risks of using it carelessly, and that is what Phil&#39;s answer is about. I&#39;m glad he covered that point which isn&#39;t covered in any other answers. All those votes are well deserved. I believe SO should build understanding of concepts rather than just being a QA site."},{"owner":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"content_license":"CC BY-SA 3.0","score":4,"post_id":818120,"edited":false,"creation_date":1477492859,"comment_id":67790858,"body":"I believe the answer is not relevant anymore, because <code>Thread</code> uses <code>WeakReference&lt;ThreadLocal&gt;</code>. So when the associated <code>ThreadLocal</code> is <code>gc</code>&#39;ed, the Map will also remove stale values during next rehashing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477175443,"comment_id":67661162,"body":"Solution provided by me also stops the ServerSocket from .accept()ing incoming connections. <b>The point is that the socket on the <i>client side</i> is still created without any exception. Why does it happen, when the ServerSocket didn&#39;t accept the connection?</b>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4301e2847b861058706df775f913e02d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8829249,"user_type":"registered","user_id":6596346,"link":"https://stackoverflow.com/users/6596346/paul","reputation":96,"display_name":"paul","accept_rate":40},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"edited":false,"creation_date":1477174745,"comment_id":67661022,"body":"If you read the loop condition after the maximum number of clients is reached the server will simply stop listening for further connections and ultimately clients will not be able to connect"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477174528,"comment_id":67660965,"body":"Okay, but the problem still remains the same. The socket on the client side is still created without any problems, even despite the fact that the connection was not accepted by the server. I&#39;m looking for a method to check if the server commited server.accept() action."},{"owner":{"profile_image":"https://i.stack.imgur.com/U7HAo.png?s=256&g=1","account_id":4426354,"user_type":"registered","user_id":3604745,"link":"https://stackoverflow.com/users/3604745/hack-r","reputation":22622,"display_name":"Hack-R","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":877115,"edited":false,"creation_date":1473173400,"comment_id":66033727,"body":"I think you&#39;re missing a <code>)</code> in the first example"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/26fcfa6386864df2897f9bcb8b47f190?s=256&d=identicon&r=PG","account_id":2199682,"user_type":"registered","user_id":1944408,"link":"https://stackoverflow.com/users/1944408/user1944408","reputation":569,"display_name":"user1944408","accept_rate":67},"content_license":"CC BY-SA 3.0","score":4,"post_id":817926,"edited":false,"creation_date":1469632844,"comment_id":64620156,"body":"Just be careful not to use double brace initialization for your SimpleDateFormat because that would create an anonymous class so your class loader could not be garbage collected. memory leak: return new SimpleDateFormat(){{applyPattern(&quot;yyyyMMdd HHmm&quot;)}};"},{"owner":{"profile_image":"https://i.stack.imgur.com/XiFZh.jpg?s=256&g=1","account_id":1542133,"user_type":"registered","user_id":1955871,"link":"https://stackoverflow.com/users/1955871/rob","reputation":6317,"display_name":"Rob","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"edited":false,"creation_date":1469544726,"comment_id":64574551,"body":"@YordanBoev As I mentioned in the answer, you should figure out what the Finalizer thread is doing. Taking a series of thread dumps (or pausing that thread in the debugger) and seeing what that particular thread is doing, whether it is making progress, usually observed running a particular class&#39; finalize method, waiting for a lock, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"edited":false,"creation_date":1469527755,"comment_id":64562168,"body":"Hey Rob, I am thankful for your interest in my problem. I am familiar how Finalizer and GC work in a JVM. The problem is that the Objects that reside in the Finalizer queue are not mine and not directly created from me, but though Jersey. I am simply following Jersey&#39;s examples and best practices in a multi-threaded environment and it is not working. The starvation of the Finalizer thread is very unlikely to be the problem, because CPU usage stays under 100% for a good amount of time and even the lowest priority threads should get execution time. Nevertheless, I will look more into it. Thanks!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"edited":false,"creation_date":1467365186,"comment_id":63713362,"body":"@sudeepdino008 no because new SimpleDateFormat would have to be created each call to the method, which is silly"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"content_license":"CC BY-SA 3.0","score":8,"post_id":817926,"edited":false,"creation_date":1466758440,"comment_id":63461690,"body":"The ThreadLocal.get() method will call ThreadLocal.initialValue() (once) for each thread, which means that a SimpleDateFormat object is created for each thread. Isn&#39;t it better then just to have SimpleDateFormat as local variables(since we don&#39;t have to deal with garbage collection issues) ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"content_license":"CC BY-SA 3.0","score":4,"post_id":817864,"edited":false,"creation_date":1466757574,"comment_id":63461215,"body":"If each thread wants to have its own copy of something, why can&#39;t it simply be declared local( which is always thread safe)?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1YZhh.png?s=256&g=1","account_id":996598,"user_type":"registered","user_id":1012372,"link":"https://stackoverflow.com/users/1012372/jayesh","reputation":6067,"display_name":"Jayesh","accept_rate":49},"content_license":"CC BY-SA 3.0","score":0,"post_id":817864,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f671bc1d0b48c1b03402cd6fe2c369c6?s=256&d=identicon&r=PG","account_id":16974,"user_type":"registered","user_id":37539,"link":"https://stackoverflow.com/users/37539/ian-varley","reputation":9287,"display_name":"Ian Varley","accept_rate":75},"edited":false,"creation_date":1465875462,"comment_id":63070300,"body":"@IanVarley: Thanks for pointing that. So if we have variable that is declared and used in MyThread class, then do we need ThreadLocal in that case? Example: class MyThread extends Thread{ String var1;, int var2; } in this case var1 and var2 will be part of Thread own stack and is not shared, so do we require ThreadLocal in this case? I might be totally wrong in my understanding, please guide."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fb0bdbf18101aa257fb3613b07058d7b?s=256&d=identicon&r=PG","account_id":57501,"user_type":"registered","user_id":172272,"link":"https://stackoverflow.com/users/172272/didier-a","reputation":4679,"display_name":"Didier A.","accept_rate":83},"content_license":"CC BY-SA 3.0","score":3,"post_id":818120,"edited":false,"creation_date":1465597151,"comment_id":62985101,"body":"If the ThreadPool keeps the Threads alive, then their ThreadLocals will too, but they will be overwritten by the new values when the thread in the pool is allocated again no? Why would it leak? It just seems to me that you&#39;d have a fix increase of memory maybe, equal to num thread * size of threadlocal value, but your ThreadPool should manage itself to a reasonable size, so this isn&#39;t really a memory leak, increasing MaxPermSize should in fact be a good solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"edited":false,"creation_date":1456391754,"comment_id":58927903,"body":"@NullPointerException if you want to wait until the process has finished, yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"edited":false,"creation_date":1456391048,"comment_id":58927457,"body":"so it is enought to add p.waitFor(); after Helpers.asynchOutputWrite ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 3.0","score":5,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446036704,"comment_id":54574459,"body":"@jayendrabhatt, Read locks and write locks come in pairs:  If thread R holds a read lock, it blocks thread W from obtaining the corresponding write lock, but it does <i>not</i> block thread S from getting the same read lock.  A reader/writer lock pair allows any number of readers to &quot;own&quot; the read lock at the same time, <i>OR</i> it allows <i>one</i> writer to own the write lock, but it never allows a reader and a writer at the same time, and it never allows more than one writer at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=256&d=identicon&r=PG","account_id":372293,"user_type":"registered","user_id":721269,"link":"https://stackoverflow.com/users/721269/david-schwartz","reputation":180467,"display_name":"David Schwartz","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446017305,"comment_id":54563020,"body":"@jayendrabhatt It&#39;s very hard to understand your questions. What do you think it means for a lock to be atomic?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"content_license":"CC BY-SA 3.0","score":0,"post_id":33384952,"edited":false,"creation_date":1446017055,"comment_id":54562912,"body":"That implies the read lock is atomic . And you mean there is  no obstruction for the read lock acquired thread to do a write operation  ? correct me if am wrong"},{"owner":{"profile_image":"https://i.stack.imgur.com/6Pkuc.jpg?s=256&g=1","account_id":1420137,"user_type":"registered","user_id":1344935,"link":"https://stackoverflow.com/users/1344935/evil-washing-machine","reputation":1323,"display_name":"Evil Washing Machine","accept_rate":69},"content_license":"CC BY-SA 3.0","score":8,"post_id":818120,"edited":false,"creation_date":1442266494,"comment_id":53003727,"body":"Now that PermGen is killed by Java 8, does this change this answer in any way?"},{"owner":{"profile_image":"https://i.stack.imgur.com/wGrow.png?s=256&g=1","account_id":1806558,"user_type":"registered","user_id":1643558,"link":"https://stackoverflow.com/users/1643558/tgkprog","reputation":4512,"display_name":"tgkprog","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":818120,"edited":false,"creation_date":1439412174,"comment_id":51856671,"body":"Or just restart your node instead of a hot deploy. (for most cases, I&#39;m sure there are others where you just need to wrap around a soft reference). But you see a big drop in objects used and time if you use thread locals or spring thread scope (reused across users as the thread pool for web requests is long living) instead of stuffing every service in a session scope."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"edited":false,"creation_date":1439315757,"comment_id":51806957,"body":"Singletons doesn&#39;t are &quot;good&quot; or &quot;bad&quot; on all situations. On a nutshell:  The main objective of a Singleton is keep the creation of expensible objects at minimum, preferably only one.  On multiple classloading environments (like web application containers) they are almost useless.  They are hard to unit test or use on testing. Do you need a strategy to deal with."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"edited":false,"creation_date":1439315069,"comment_id":51806609,"body":"@SachinGorade is just to enforce just one formatter instance for each classloader.  On environment that have just one main classloader, that works like a Singleton."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"content_license":"CC BY-SA 3.0","score":5,"post_id":817926,"edited":false,"creation_date":1438670329,"comment_id":51531090,"body":"@overthink Is there any reason to declare ThreadLocal static and final, I mean performance or something?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=256&d=identicon&r=PG","account_id":37136,"user_type":"registered","user_id":106104,"link":"https://stackoverflow.com/users/106104/user253751","reputation":57822,"display_name":"user253751","accept_rate":62},"content_license":"CC BY-SA 3.0","score":2,"post_id":877113,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"edited":false,"creation_date":1431138587,"comment_id":48380540,"body":"@IsaacKleinman well, you have to do that anyway, unless you extend Thread. And this solution still works in that case - just change &quot;implements Runnable&quot; to &quot;extends Thread&quot;, &quot;Runnable&quot; to &quot;Thread&quot;, and &quot;new Thread(r)&quot; to &quot;r&quot;."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27739235,"edited":false,"creation_date":1420329606,"comment_id":43932892,"body":"I think this would work. However, it doesn&#39;t address priorities."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420327815,"comment_id":43932436,"body":"Also, your solution has a separate priority queue for each producer, when I need a higher priorities to apply across messages of different producers. You have LinkedHashMap&lt;Producer,PriorityQueue&gt;; I ended up doing essentially Map&lt;Priority,LinkedHashMap&lt;Producer,PriorityQueue&gt;&gt;. I&#39;m accepting your answer since it got me thinking on the right track and is the closest to what I ended up actually doing."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":1,"post_id":27738182,"edited":false,"creation_date":1420327792,"comment_id":43932435,"body":"Since you&#39;ve got a ReentrantLock on the outside, you don&#39;t need a PriorityBlockingQueue on the inside, a PriorityQueue will be fine - double locking would give worse performance and greater risk of deadlocks (not with your current code, but possible with future changes)."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420287732,"comment_id":43920240,"body":"I like this idea (in particular use of ReenterantLock and Condition). I&#39;m going to try something similar."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420264486,"comment_id":43915347,"body":"Suppose producer #1 submits 100 messages. So far 50 of them have been processed. Now producer #2 submits 100 messages. Due to incrementing the underlying ID, won&#39;t all of producer #2&#39;s messages have higher ID numbers than producer #1&#39;s, so none of them will be processed until producer #1&#39;s are done? That isn&#39;t round-robin."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184978,"comment_id":43888897,"body":"I haven&#39;t thought out the details of the bookkeeping, and that&#39;s not necessarily the only way to do it, but the sequence I gave is the one you wanted, yes?"},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420184902,"comment_id":43888883,"body":"So you would have a counter, which increments by N (where N is current producer count), and an array sized N of boolean flags, initially all false. When producer x requests an ID, if flags[x] is false, set flags[x]=true; if flags[x] is true, increment counter by N, set all flags to false, set flags[x]=true; then, in either case, return counter+x? I assume also a synchronised block to protect the counter and the array. Also, to change producer count dynamically, would need to resize array, setting all its values to false, incrementing counter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184125,"comment_id":43888686,"body":"No. You would have incremented the underlying ID as per my last sentence, so in your example the IDs would run 0,2,4,6,8,10,12,14,16,18,19, ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420183492,"comment_id":43888525,"body":"With two producers, are you saying to allocate even IDs to the first producer, odd IDs to the second? Suppose producer #1 submits 10 messages, which are fully processed - it consumes the first ten odd IDs. Some time later, producer #1 submits 10 messages, which get the next ten odd IDs. Simultaneously, producer #2 submits 10 messages, which consume the first ten even IDs. Won&#39;t this result in producer #2&#39;s first batch being processed before producer #1&#39;s second batch? That&#39;s not round robin of outstanding messages."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416481671,"comment_id":42595773,"body":"There is last option, with combined CountDownLatches. Using while countdown loop costs nothing, so it&#39;s not a problem doing while release."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416481064,"comment_id":42595419,"body":"If you look at the question, I wanted to avoid countDown in loop."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":2,"post_id":27035047,"edited":false,"creation_date":1416477391,"comment_id":42593392,"body":"I dont need timeout, I need to explicitly release()"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416477256,"comment_id":42593307,"body":"You specify max timeout for operations, and go from there. You&#39;ll need to have some kind of completion timeout anyway, regardless of desired implementation."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416477238,"comment_id":42593296,"body":"I am pointing to that release() method would be very useful, like in Semaphore"},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416477055,"comment_id":42593178,"body":"but in case I dont the time know what all operations consume, its useless."},{"owner":{"profile_image":"https://i.stack.imgur.com/LdDoZ.png?s=256&g=1","account_id":957028,"user_type":"registered","user_id":982149,"link":"https://stackoverflow.com/users/982149/fildor","reputation":15143,"display_name":"Fildor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416472826,"comment_id":42590762,"body":"&quot;but if something fails&quot; - wouldn&#39;t interrupting be more appropriate here?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7df9b99b5d8ac9eda9330768ca1acf09?s=256&d=identicon&r=PG","account_id":266709,"user_type":"registered","user_id":554431,"link":"https://stackoverflow.com/users/554431/bestsss","reputation":11856,"display_name":"bestsss"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415382041,"comment_id":42186813,"body":"@VictorSorokin, while <code>notifyAll</code> seems the go-to solution it has a pretty terribly performance impact when more than a single thread is involved. All threads have to acquire the monitor effectively causing a lot of coherency traffic and CPU wastage. That being said if there are different conditions for the same lock, you probably want to refactor the code and use more locks."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415356943,"comment_id":42172481,"body":"@Victor Sorokin: in that case you <i>have</i> different conditions, as you are not waiting for “nonempty condition” but “Foo available” and “Bar available” then. In that case you need either the consumer doing a re-<code>notify</code> if it didn’t consume or the producer using <code>notifyAll</code> whereas the former may soon become even more inefficient as the latter. So right, if in doubt, just use <code>notifyAll</code>…"},{"owner":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"edited":false,"creation_date":1415356575,"comment_id":42172261,"body":"Well, you right there&#39;s explicit <code>Condition</code> for this, but one can&#39;t say it&#39;s safe to use <code>notify</code> in case of multiple consumers, <i>in a general case</i> (e.g., what if different consumers consume differnt type of items?)."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415356378,"comment_id":42172135,"body":"@Victor Sorokin: it obviously depends on the condition. E.g. if you put exactly one item into an empty queue there is no reason to wake up more than one consumer. If you have multiple different conditions you may consider using a <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html\" rel=\"nofollow noreferrer\"><code>Lock</code></a> as that API supports defining distinct <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html\" rel=\"nofollow noreferrer\">conditions</a> you may <code>await</code> and <code>signal</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"edited":false,"creation_date":1415356023,"comment_id":42171936,"body":"More often than not, it&#39;s better to use <code>notifyAll()</code> instead of <code>notify</code>, since different threads can wait for different conditions to occur, and if you use <code>notify</code> it may go to wrong thread, and this notification is lost for thread it really belongs to. If you know that there&#39;s no more than one waiting thread, using <code>notify</code> is fine."},{"owner":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"content_license":"CC BY-SA 3.0","score":39,"post_id":820131,"edited":false,"creation_date":1415140486,"comment_id":42077909,"body":"Why did I have to scroll down so far to find this essential answer!?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f1b044b33c5d5ee61e223aac39761f43?s=256&d=identicon&r=PG","account_id":947019,"user_type":"registered","user_id":974063,"link":"https://stackoverflow.com/users/974063/randall-cook","reputation":6758,"display_name":"Randall Cook","accept_rate":100},"content_license":"CC BY-SA 3.0","score":2,"post_id":877115,"edited":false,"creation_date":1402094056,"comment_id":37157734,"body":"I have code similar to your anonymous class example, except I access <code>parameter</code> directly from the <code>run()</code> method without using a field like <code>p</code> at all. It seems to work. Is there some subtle multithreading thing I am missing by not copying <code>parameter</code> to <code>p</code> beforehand?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":32,"post_id":818120,"edited":false,"creation_date":1397668086,"comment_id":35337070,"body":"This is an awful lot of upvotes for an answer that, while informative, does not in any way actually answer the question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=256&d=identicon&r=PG","account_id":150501,"user_type":"registered","user_id":363751,"link":"https://stackoverflow.com/users/363751/supercat","reputation":78480,"display_name":"supercat","accept_rate":35},"content_license":"CC BY-SA 3.0","score":2,"post_id":13037170,"edited":false,"creation_date":1395096280,"comment_id":34174699,"body":"Re-entrancy isn&#39;t a problem if code is prepared to deal with it.  On entry, make note of whether the variable is already set, and on exit, restore its previous value (if there was any), or remove it (if not)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":877113,"edited":false,"creation_date":1381871974,"comment_id":28740620,"body":"This means that each Thread constructed using <code>r</code> will have the same argument, so if we want to pass different arguments to multiple Threads running <code>MyThread</code> we&#39;d need to create a new <code>MyThread</code> instance using the desired argument for each Thread. In other words, to get a thread up and running we need to create two objects: Thread and MyThread. Is this considered bad, performance-wise?"},{"owner":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"content_license":"CC BY-SA 3.0","score":22,"post_id":817926,"edited":false,"creation_date":1372354343,"comment_id":25173897,"body":"This is high price to pay for hacking <code>SimpleDateFormat</code>. Perhaps it&#39;s better to use <a href=\"http://stackoverflow.com/questions/10411944/java-text-simpledateformat-not-thread-safe\">a thread-safe alternative</a>. If you agree that <a href=\"http://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons\">singletons are bad</a> then <code>ThreadLocal</code> is even worse."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=256&d=identicon&r=PG","account_id":114848,"user_type":"registered","user_id":301832,"link":"https://stackoverflow.com/users/301832/donal-fellows","reputation":134189,"display_name":"Donal Fellows","accept_rate":60},"content_license":"CC BY-SA 3.0","score":12,"post_id":818120,"edited":false,"creation_date":1370953796,"comment_id":24640175,"body":"The thread that Julien links to has moved to <a href=\"http://jsr166-concurrency.10961.n7.nabble.com/Threadlocals-and-memory-leaks-in-J2EE-td3960.html\" rel=\"nofollow noreferrer\">here</a> it seems, and is <i>well worth reading…</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd01dd06eefc977f4746b1ff55799c2b?s=256&d=identicon&r=PG","account_id":94225,"user_type":"registered","user_id":257364,"link":"https://stackoverflow.com/users/257364/volksman","reputation":2029,"display_name":"Volksman","accept_rate":0},"content_license":"CC BY-SA 3.0","score":4,"post_id":820131,"edited":false,"creation_date":1367029500,"comment_id":23246108,"body":"That&#39;s exactly how the exPOJO framework (www.expojo.com) allows access to ORM Session/PersistenceManager without needing the overhead of annotations and injection. It is kind of like &#39;thread injection&#39; instead of &#39;object injection&#39;. It provides access to dependencies without the requirement (and overhead) of having them embedded in every object that might need those dependencies. It&#39;s amazing how &#39;light weight&#39; you can make a DI framework when you use thread injection instead of classic DI (eg., Spring etc.,)"},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282504,"comment_id":22176134,"body":"No tens seconds is not too long."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e7f50c8aa281d791b4d5be24d2c2961?s=256&d=identicon&r=PG","account_id":1778663,"user_type":"registered","user_id":1621913,"link":"https://stackoverflow.com/users/1621913/joeyl","reputation":1295,"display_name":"JoeyL","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"edited":false,"creation_date":1364282415,"comment_id":22176102,"body":"@Raghunandan I would say the task could last ~10 seconds.  Would that be too long for asynctask?"},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282217,"comment_id":22176010,"body":"it also depends how long will it take to get data from database. don&#39;t want the user to keep waiting to interact with the ui. For long Running operations asynctask is not good."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e7f50c8aa281d791b4d5be24d2c2961?s=256&d=identicon&r=PG","account_id":1778663,"user_type":"registered","user_id":1621913,"link":"https://stackoverflow.com/users/1621913/joeyl","reputation":1295,"display_name":"JoeyL","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282115,"comment_id":22175970,"body":"Thank you Nirali for the response &lt;3 :)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1c9d8c24df8646c416ef0fbf2177c848?s=256&d=identicon&r=PG","account_id":416223,"user_type":"registered","user_id":791486,"link":"https://stackoverflow.com/users/791486/friedryk","reputation":376,"display_name":"Friedryk"},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1357923042,"comment_id":19832107,"body":"I&#39;ve just being hit the face with date/calendar/format concurrency problems. Though I understood quickly what was going on, your post made it plain and simple to solve my problems without major overhaul of my code. Thanks!  Personnally I made a point in calling ThreadLocal remove after each get(), idealy in a finally clause. Any thoughts if it is overkill ? I wanted to make sure memory could be reclaimed after execution of enclosing Thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/cIuFJ.jpg?s=256&g=1","account_id":887421,"user_type":"registered","user_id":926520,"link":"https://stackoverflow.com/users/926520/pankaj","reputation":5160,"display_name":"Pankaj","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1356923862,"comment_id":19500485,"body":"Here is a complete example showing different threads have their own copy. <a href=\"http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables\" rel=\"nofollow noreferrer\">journaldev.com/1076/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/hlWHy.jpg?s=256&g=1","account_id":1151383,"user_type":"registered","user_id":1133011,"link":"https://stackoverflow.com/users/1133011/david-kroukamp","reputation":36217,"display_name":"David Kroukamp","accept_rate":96},"content_license":"CC BY-SA 3.0","score":0,"post_id":14072987,"edited":false,"creation_date":1356716429,"comment_id":19456095,"body":"@NickHaughton Also see this similar answer which uses a single Swing Timer, to move a ball and repaint its container afterwards to refelect changes: <a href=\"http://stackoverflow.com/questions/14068472/java-mouselistener-action-event-in-paintcomponent/14070147#14070147\" title=\"java mouselistener action event in paintcomponent\">stackoverflow.com/questions/14068472/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=256&d=identicon&r=PG","account_id":4495,"user_type":"registered","user_id":6782,"link":"https://stackoverflow.com/users/6782/alnitak","reputation":335863,"display_name":"Alnitak","accept_rate":78},"content_license":"CC BY-SA 3.0","score":7,"post_id":877113,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/7CZNr.png?s=256&g=1","account_id":148793,"user_type":"registered","user_id":360826,"link":"https://stackoverflow.com/users/360826/jason-m","reputation":6615,"display_name":"jason m","accept_rate":73},"edited":false,"creation_date":1353601838,"comment_id":18503246,"body":"@jasonm no, it&#39;s a constructor - constructors don&#39;t have a return type."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=256&d=identicon&r=PG","account_id":7639,"user_type":"registered","user_id":13317,"link":"https://stackoverflow.com/users/13317/kenster","reputation":23810,"display_name":"Kenster","accept_rate":85},"content_license":"CC BY-SA 3.0","score":11,"post_id":818120,"edited":false,"creation_date":1335905541,"comment_id":13420747,"body":"Alex Vasseur moved his blog. <a href=\"http://avasseur.blogspot.com/2003/11/threadlocal-and-memory-leaks.html\" rel=\"nofollow noreferrer\">Here</a> is a current link to the memory leak article."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/63f1d837b7123c72135da37e2f0042de?s=256&d=identicon&r=PG","account_id":283806,"user_type":"registered","user_id":581528,"link":"https://stackoverflow.com/users/581528/ray","reputation":4839,"display_name":"Ray","accept_rate":84},"content_license":"CC BY-SA 2.5","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7ccd45f17734f7d050a186468bdc38eb?s=256&d=identicon&r=PG","account_id":25274,"user_type":"registered","user_id":64881,"link":"https://stackoverflow.com/users/64881/phil-m","reputation":6653,"display_name":"Phil M"},"edited":false,"creation_date":1297682605,"comment_id":5577062,"body":"do you think this could be avoided by using a SoftReference?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f671bc1d0b48c1b03402cd6fe2c369c6?s=256&d=identicon&r=PG","account_id":16974,"user_type":"registered","user_id":37539,"link":"https://stackoverflow.com/users/37539/ian-varley","reputation":9287,"display_name":"Ian Varley","accept_rate":75},"content_license":"CC BY-SA 2.5","score":21,"post_id":817864,"edited":false,"creation_date":1274889994,"comment_id":2966244,"body":"By default, static objects, or objects explicitly passed between threads where both threads posses a reference to the same object, are shared. Objects declared locally in a thread are not shared (they&#39;re local to the thread&#39;s stack). Just wanted to clarify that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ec3b4d2db3e6e33b498deb38592e862d?s=256&d=identicon&r=PG","account_id":15307,"user_type":"registered","user_id":32174,"link":"https://stackoverflow.com/users/32174/julien-chastang","reputation":17620,"display_name":"Julien Chastang","accept_rate":71},"content_license":"CC BY-SA 2.5","score":173,"post_id":817926,"edited":false,"creation_date":1241408353,"comment_id":627914,"body":"Another alternative to synchronization or threadlocal is to make the variable a local variable. Local vars are always thread safe. I assume that it is bad practice to make DateFormats local because they are expensive to create, but I have never seen solid metrics on this topic."},{"owner":{"profile_image":"https://i.stack.imgur.com/Gr7qI.jpg?s=256&g=1","account_id":416701,"user_type":"registered","user_id":792238,"link":"https://stackoverflow.com/users/792238/siddhartha","reputation":4306,"display_name":"Siddhartha","accept_rate":87},"content_license":"CC BY-SA 4.0","score":1,"post_id":817911,"edited":false,"creation_date":1591165314,"comment_id":109947697,"body":"This made me curious. <code>&#39;datum&#39; is the singular form and &#39;data&#39; is the plural form. </code>"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-MZrFtPI_zTY/AAAAAAAAAAI/AAAAAAAABq4/bnw-OB7pSQc/photo.jpg?sz=256","account_id":9963171,"user_type":"registered","user_id":8503883,"link":"https://stackoverflow.com/users/8503883/wyskoj","reputation":378,"display_name":"wyskoj"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877104,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/M2hPC.gif?s=256&g=1","account_id":7030407,"user_type":"registered","user_id":6032016,"link":"https://stackoverflow.com/users/6032016/snow","reputation":1058,"display_name":"Snow","accept_rate":69},"edited":false,"creation_date":1552610241,"comment_id":97086864,"body":"@Snow the <code>@Override</code> explicitly states that it is overriding the abstract method in the Thread class."},{"owner":{"profile_image":"https://i.stack.imgur.com/M2hPC.gif?s=256&g=1","account_id":7030407,"user_type":"registered","user_id":6032016,"link":"https://stackoverflow.com/users/6032016/snow","reputation":1058,"display_name":"Snow","accept_rate":69},"content_license":"CC BY-SA 4.0","score":1,"post_id":877104,"edited":false,"creation_date":1525382471,"comment_id":87346018,"body":"why do we need the <code>@Override</code> for?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/48c0da7b99e8558e7180f5621573eac2?s=256&d=identicon&r=PG","account_id":37202,"user_type":"registered","user_id":106315,"link":"https://stackoverflow.com/users/106315/jwoolard","reputation":6114,"display_name":"jwoolard","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":877118,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0dd38a06cfe5d6c484b1170461b560e6?s=256&d=identicon&r=PG","account_id":285969,"user_type":"registered","user_id":584947,"link":"https://stackoverflow.com/users/584947/fiwjlxszaphezil","reputation":12256,"display_name":"fIwJlxSzApHEZIl","accept_rate":92},"edited":false,"creation_date":1513705261,"comment_id":82751370,"body":"True, the setter and all access to the parameter should be synchronised."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0dd38a06cfe5d6c484b1170461b560e6?s=256&d=identicon&r=PG","account_id":285969,"user_type":"registered","user_id":584947,"link":"https://stackoverflow.com/users/584947/fiwjlxszaphezil","reputation":12256,"display_name":"fIwJlxSzApHEZIl","accept_rate":92},"content_license":"CC BY-SA 3.0","score":1,"post_id":877118,"edited":false,"creation_date":1507848475,"comment_id":80386674,"body":"Doesn&#39;t adding a setter create potential race conditions? If the thread starts with the variable as one value but the setter changes it mid-execution wouldn&#39;t that be problematic?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6aa466372eb9032019cc31650bf43b44?s=256&d=identicon&r=PG","account_id":1733652,"user_type":"registered","user_id":1586687,"link":"https://stackoverflow.com/users/1586687/deep","reputation":1606,"display_name":"deep","accept_rate":50},"content_license":"CC BY-SA 3.0","score":7,"post_id":817911,"edited":false,"creation_date":1466527059,"comment_id":63348733,"body":"Kudos for using datum instead of data."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/422a99817d5df8fce3ed70457ffbe79d?s=256&d=identicon&r=PG","account_id":2409048,"user_type":"registered","user_id":2104648,"link":"https://stackoverflow.com/users/2104648/caelum","reputation":811,"display_name":"Caelum","accept_rate":86},"content_license":"CC BY-SA 3.0","score":11,"post_id":877104,"edited":false,"creation_date":1415297483,"comment_id":42149467,"body":"+1 for showing how to do it extending Thread instead of implementing Runnable."},{"owner":{"profile_image":"https://i.stack.imgur.com/3kCnW.jpg?s=256&g=1","account_id":83658,"user_type":"registered","user_id":234391,"link":"https://stackoverflow.com/users/234391/cornel-masson","reputation":1362,"display_name":"Cornel Masson","accept_rate":57},"content_license":"CC BY-SA 3.0","score":11,"post_id":817911,"edited":false,"creation_date":1406108801,"comment_id":38695149,"body":"Perhaps... It can be useful, though, if you have a huge, existing codebase to which you have to add a new datum that has to be passed around <i>everywhere</i>, e.g. a session context, db transaction, logged-in user, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6483c2f0fcf64b578c55ca0df7e01096?s=256&d=identicon&r=PG","account_id":80364,"user_type":"registered","user_id":227299,"link":"https://stackoverflow.com/users/227299/ruan-mendes","reputation":90939,"display_name":"Ruan Mendes","accept_rate":72},"content_license":"CC BY-SA 3.0","score":13,"post_id":817911,"edited":false,"creation_date":1373580275,"comment_id":25622695,"body":"So you should avoid thread locals the same way you avoid globals. I cannot possibly accept that it&#39;s OK to create globals (thread locals) instead of passing values around, people don&#39;t like because it often reveals architecture problems that they don&#39;t want to fix."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-bSeb0Nt8ym4/AAAAAAAAAAI/AAAAAAAAvhY/Q919jXhqOac/photo.jpg?sz=256","account_id":13179806,"user_type":"registered","user_id":21197077,"link":"https://stackoverflow.com/users/21197077/gneginskiy","reputation":91,"display_name":"gneginskiy"},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676277435,"comment_id":133097633,"body":"in &quot;implementing Runnable&quot;, &#39;classroom&#39; is a shared resource with syncrhonized non-static method run(). Which means that only one thread can access the method at a time for a given Runnable object.   On the contrary, In case of &quot;extending Thread&quot; you have 3 objects, and no concurrent access to this code happens. When annotating non-static method as &quot;syncrhonized&quot;, mutual exclusion happens per object. For static methods synchronized methods are locked per class."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676277148,"comment_id":133097549,"body":"&quot;<code>ie.getMessage();</code>&quot; does nothing. You should read up about how to handle exceptions, and specifically how to handle an <code>InterruptedException</code> (because it typically requires something different to other exception types)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":5,"post_id":75433400,"edited":false,"creation_date":1676276851,"comment_id":133097464,"body":"But the answer is that in your first example you have three instances of ClassRoom and in the second you only have one, so <code>synchronized</code> does nothing in the first case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":1,"post_id":75433400,"edited":false,"creation_date":1676276712,"comment_id":133097425,"body":"Please explain what your code is meant to do -- what do you expect to happen? What is happening that you don&#39;t expect? That is, what is &quot;proper output&quot;? Perhaps leaving the newlines in your output examples would make your question easier to understand."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/97cbc5a26a5cfcdbb3fb718c3e066d87?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21083132,"user_type":"registered","user_id":15496965,"link":"https://stackoverflow.com/users/15496965/henning","reputation":3240,"display_name":"Henning"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1676136795,"comment_id":133078828,"body":"I don&#39;t think the issue is related to multi-threading. I think the problem is that <code>maxItemCount</code> should be set to a different value. See my answer below for details."},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":1,"post_id":73977101,"edited":false,"creation_date":1665074259,"comment_id":130619763,"body":"If you were testing this on x86 hardware, <a href=\"https://stackoverflow.com/q/63912669\">What does it mean that &quot;two store are seen in a consistent order by other processors&quot;?</a> is a duplicate that explains why you can&#39;t observe IRIW reordering on that system."},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":73977101,"edited":false,"creation_date":1665074073,"comment_id":130619698,"body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/27807118/will-two-atomic-writes-to-different-locations-in-different-threads-always-be-see\">Will two atomic writes to different locations in different threads always be seen in the same order by other threads?</a>  Also <a href=\"https://stackoverflow.com/q/48383867\">Acquire/release semantics with 4 threads</a>  And comments on <a href=\"https://stackoverflow.com/q/69003544\">Still can&#39;t get a true root cause explanation on IRIW scenario</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/N4ivW.png?s=256&g=1","account_id":78868,"user_type":"registered","user_id":224132,"link":"https://stackoverflow.com/users/224132/peter-cordes","reputation":337070,"display_name":"Peter Cordes","accept_rate":83},"content_license":"CC BY-SA 4.0","score":1,"post_id":73977101,"edited":false,"creation_date":1665074040,"comment_id":130619689,"body":"This is the IRIW litmus test.  Unless you tested on a recent PowerPC server, all threads will agree on the order of stores, even if the stores are <code>relaxed</code> and the loads are just <code>acquire</code>.  ISO C++ doesn&#39;t guarantee it without <code>seq_cst</code>, but it also doesn&#39;t guarantee that every allowed ordering actually will be observed in practice.  Especially ones the hardware you choose doesn&#39;t do naturally.  (The loads do need to be <code>acquire</code> so it doesn&#39;t fail because of local load-load reordering on the readers, actually observing the global order of store visibility)"},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":73968499,"edited":false,"creation_date":1665068577,"comment_id":130617460,"body":"Yeah, &quot;hot&quot; waiting ... isn&#39;t a good idea."},{"owner":{"profile_image":"https://i.stack.imgur.com/Fp4Pm.jpg?s=256&g=1","account_id":1085259,"user_type":"registered","user_id":1081110,"link":"https://stackoverflow.com/users/1081110/dawood-ibn-kareem","reputation":78314,"display_name":"Dawood ibn Kareem"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968499,"edited":false,"creation_date":1665029459,"comment_id":130604631,"body":"I suspect what&#39;s happening is that your program is spending all its resources comparing <code>Ssytem.currentTimeMillis()</code> to <code>lastEdit</code>, and nothing else gets a chance to run.  You might need a <code>Thread.sleep</code> somewhere in there.  Also, make sure that <code>lastEdit</code> is declared <code>volatile</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":3,"post_id":73944324,"edited":false,"creation_date":1664889314,"comment_id":130569451,"body":"Recommended read <a href=\"https://stackoverflow.com/q/504103/2711488\">How do I write a correct micro-benchmark in Java?</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":4,"post_id":73944324,"edited":false,"creation_date":1664889198,"comment_id":130569393,"body":"You are not waiting for the completion of the threads, hence you’re only measuring how long it takes <i>to start the threads</i>, which boils down to how long it takes to convert a lambda expression into a <code>Runnable</code>. Which can be longer for the first lambda expression as explained in <a href=\"https://stackoverflow.com/a/34642063/2711488\">this answer</a>. However, if you fix the code to wait for the completion of the actual operation, you’re still not comparing similar operations. After the first replacement operation, there are no <code>E</code>s in the string."},{"owner":{"profile_image":"https://i.stack.imgur.com/Pzwgx.jpg?s=256&g=1","account_id":10777133,"user_type":"registered","user_id":7928721,"link":"https://stackoverflow.com/users/7928721/samabcde","reputation":7282,"display_name":"samabcde"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73944324,"edited":false,"creation_date":1664871514,"comment_id":130563723,"body":"Don&#39;t see much different in my machine, e.g. I see  <code>2 in t1</code>.  <code>1 in t2</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926124,"edited":false,"creation_date":1664717260,"comment_id":130531056,"body":"So, it&#39;s not about <code>Runnable</code> but it&#39;s about <i><code>run</code></i> method.. it&#39;s now clearer."},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926124,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"edited":false,"creation_date":1664716832,"comment_id":130530968,"body":"@GiorgiTsiklauri The standard <code>Runnable</code> that you can pass to <code>Thread</code>s constructor does not allow you to throw an <code>InterruptedException</code> from its <code>run</code> method because <code>InterruptedException</code> is a checked exception."},{"owner":{"profile_image":"https://i.stack.imgur.com/5Xcxt.png?s=256&g=1","account_id":1674243,"user_type":"registered","user_id":1553537,"link":"https://stackoverflow.com/users/1553537/giorgi-tsiklauri","reputation":10078,"display_name":"Giorgi Tsiklauri","accept_rate":29},"content_license":"CC BY-SA 4.0","score":1,"post_id":73926124,"edited":false,"creation_date":1664716758,"comment_id":130530954,"body":"I really struggle to understand &quot;<i>Java Thread&#39;s doesn&#39;t accept a Runnable that allows throwing of InterruptedException</i>&quot;..."},{"owner":{"profile_image":"https://graph.facebook.com/1080827148618335/picture?type=large","account_id":7278875,"user_type":"registered","user_id":5549301,"link":"https://stackoverflow.com/users/5549301/udara-seneviratne","reputation":2373,"display_name":"Udara Seneviratne","accept_rate":38},"content_license":"CC BY-SA 4.0","score":0,"post_id":73920478,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Ln6Kz.png?s=256&g=1","account_id":12305345,"user_type":"registered","user_id":8978587,"link":"https://stackoverflow.com/users/8978587/shahart","reputation":450,"display_name":"ShaharT"},"edited":false,"creation_date":1664682081,"comment_id":130526204,"body":"@ShaharT When we have the issue, it&#39;s observable only the &quot;** SMS received from SMSC [{}]&quot;, &quot;Point 1: Active thread count : [{}]&quot; and &quot;Point 2: Active thread count : [{}]&quot;. If the problem is on the other end we could see at least &quot;Thread start &quot; which is inside the thread before the resttemplate call. Isn&#39;t it?"},{"owner":{"profile_image":"https://i.stack.imgur.com/Ln6Kz.png?s=256&g=1","account_id":12305345,"user_type":"registered","user_id":8978587,"link":"https://stackoverflow.com/users/8978587/shahart","reputation":450,"display_name":"ShaharT"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73920478,"edited":false,"creation_date":1664651302,"comment_id":130522424,"body":"well, if nothing was changed at your side, probably something got changed on the other end: the <code>smppMoSMS.getApplicationUrl()</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1654928765,"comment_id":128213757,"body":"@ThomasKl&#228;ger Updated in &quot;EDIT 1:&quot; with ThreadLocalRandom observations."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1654927939,"comment_id":128213662,"body":"Thanks @ThomasKl&#228;ger, will run with per thread random generator."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72582076,"edited":false,"creation_date":1654927764,"comment_id":128213640,"body":"<code>Random.nextDouble()</code> calls <code>Random.next()</code> twice. <code>Random.next()</code> uses an internal field <code>AtomicLong seed</code> with <code>seed.compareAndSet()</code> which is synchronization point between the threads (i.e. it is required that all threads see the same seed value). Replace the global <code>RANDOM</code> instance with a per-thread <code>Random</code> generator."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"edited":false,"creation_date":1654927762,"comment_id":128213638,"body":"Thanks for checking @StanislavBashkyrtsev  I invoked the same number of operations (numOperationsPerThread) in each thread.  I have updated the full code in the question under &quot;Complete runnable example&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582076,"edited":false,"creation_date":1654927501,"comment_id":128213599,"body":"Please show a complete, runnable example."},{"owner":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"content_license":"CC BY-SA 4.0","score":2,"post_id":72580556,"edited":false,"creation_date":1654918017,"comment_id":128212684,"body":"What do you mean by &quot;performance sticks into a network&quot;?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 4.0","score":1,"post_id":72580556,"edited":false,"creation_date":1654905217,"comment_id":128211552,"body":"Have you read the documentation on <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadPoolExecutor.html\" rel=\"nofollow noreferrer\">ThreadPoolExecutor</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=256&d=identicon&r=PG","account_id":16878,"user_type":"registered","user_id":37213,"link":"https://stackoverflow.com/users/37213/duffymo","reputation":306143,"display_name":"duffymo","accept_rate":81},"content_license":"CC BY-SA 4.0","score":1,"post_id":72580556,"edited":false,"creation_date":1654902993,"comment_id":128211277,"body":"Not sure I&#39;m following your logic about changing the pool size.  The ones I&#39;m familiar with are fixed by configuration at runtime and don&#39;t change.  It&#39;s up to you to tune and monitor your app and determine thread size.  Something like Netty and its ring buffer can be a good way to manage high throughput.  It uses a single thread and non-blocking I/O.  Scales like mad.  Maybe you should look at it."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72567117,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1654873045,"comment_id":128203575,"body":"So what I did is created a bean ThreadManager class that creates, destroys, and changes the pool sizes. The specific class I use for the pools is ThreadPoolTaskExecutor which allows me to control everything regarding the pools it has created."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72567117,"edited":false,"creation_date":1654842588,"comment_id":128192881,"body":"I will add an answer to your questions, but just curious, how are you changing the thread pool size at runtime? Is it via JMX?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72557561,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=256&d=identicon&r=PG","account_id":111736,"user_type":"registered","user_id":295004,"link":"https://stackoverflow.com/users/295004/morrison-chang","reputation":11811,"display_name":"Morrison Chang"},"edited":false,"creation_date":1654766380,"comment_id":128172067,"body":"@MorrisonChang, its android java interop on C#"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a29d6038e4dcb7fac98ef41c002975e1?s=256&d=identicon&r=PG","account_id":111736,"user_type":"registered","user_id":295004,"link":"https://stackoverflow.com/users/295004/morrison-chang","reputation":11811,"display_name":"Morrison Chang"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72557561,"edited":false,"creation_date":1654766215,"comment_id":128172004,"body":"You added <code>java</code> as a tag but the code looks like C#. If you are using Xamarin please add/correct your question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72556212,"edited":false,"creation_date":1654765691,"comment_id":128171815,"body":"I have rolled back your last edit. If you want to ask a new question, then post a new question, do not change the scope of an existing question by changing or adding a question, especially if your original question has been answered already."},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72556212,"edited":false,"creation_date":1654759794,"comment_id":128169638,"body":"The <code>.get</code> call makes it blocking and not run in parallel. So while you run on a different thread it doesn&#39;t make any difference. Use a <code>CompletableFuture</code> instead then wrap all of them in another <code>CompleteableFuture.allOf</code> and get the results."},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72556212,"edited":false,"creation_date":1654759658,"comment_id":128169582,"body":"Calling <code>get()</code> on a <code>Future</code> will block, so your code has a parallelism of 1."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":0,"post_id":72556212,"edited":false,"creation_date":1654759478,"comment_id":128169528,"body":"Please don&#39;t use bold and italic in such a universal way - it makes it <i>harder</i> to read instead of easier."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1654713856,"comment_id":128160060,"body":"@SolomonSlow Well it might be the case. I just thought that the main thread gets stuck and unable to call <code>notifyAll()</code> hence a deadlock. I might be wrong."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"edited":false,"creation_date":1654711844,"comment_id":128159317,"body":"@Darkman, &quot;Deadlock&quot; means that two or more threads are all unable to make progress because each one of them is waiting for one of the others to do something. But, no thread will ever wait in a<code>notifyAll()</code> call. It always returns immediately. It wakes whatever threads are waiting at that moment, or it does absolutely nothing if no thread is waiting. When a thread gets stuck waiting for a notification that happened <i>before</i> the thread started to wait, that usually is called, &quot;lost notification.&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"edited":false,"creation_date":1654704426,"comment_id":128156671,"body":"It seems like a deadlock to me. One in <code>wait()</code> and another one <code>notifyAll()</code>. Move <code>notifyAll()</code> above the line <code>b.mb2();</code> should fix the problem."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/IIQJV.jpg?s=256&g=1","account_id":318670,"user_type":"registered","user_id":636009,"link":"https://stackoverflow.com/users/636009/david-conrad","reputation":15681,"display_name":"David Conrad"},"edited":false,"creation_date":1654703247,"comment_id":128156174,"body":"@DavidConrad Oh, right. Very rusty."},{"owner":{"profile_image":"https://i.stack.imgur.com/IIQJV.jpg?s=256&g=1","account_id":318670,"user_type":"registered","user_id":636009,"link":"https://stackoverflow.com/users/636009/david-conrad","reputation":15681,"display_name":"David Conrad"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654702019,"comment_id":128155631,"body":"@Tenfour04 The lock is not held by the the thread while it&#39;s waiting. <a href=\"https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait()\" rel=\"nofollow noreferrer\">&quot;The current thread must own this object&#39;s monitor. The thread releases ownership of this monitor and waits...&quot;</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654699961,"comment_id":128154552,"body":"I tried to do it as asked by the assignment (calling thread waiting for both threads to terminate <code>mb1()</code>), but if I do that the threads calls <code>notifyAll()</code> before the calling threads gets to call the <code>wait()</code>. This results again in a deadlock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"edited":false,"creation_date":1654699621,"comment_id":128154398,"body":"Based on the comment you just deleted, I could see that <code>join</code> would not be able to accomplish it. What you should describe in your question is that the calling thread should be waiting for <code>mb1()</code> to complete in both of the other threads before it continues. By the way, you&#39;re using wait backwards. You want the calling thread to wait on the other threads, not the other way around. The reason I&#39;m not writing a full answer is that I think I would get it wrong. Working with Java threads directly is very complicated, and there are libraries for simplifying it, so I&#39;m super rusty on it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72547510,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86162,"display_name":"Tenfour04","accept_rate":83},"edited":false,"creation_date":1654699441,"comment_id":128154309,"body":"After investigating more, yes, using <code>synchronization</code> and its <code>methods</code> is the way my teacher wants the assignment to be done."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654681397,"comment_id":128146887,"body":"From a cursory glance, I think I see the problem (improper synchronization). But I don&#39;t have time to properly look at it, or write a good answer, just yet. I&#39;ll try to get to give an answer tomorrow."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654675348,"comment_id":128144585,"body":"@Slaw Here&#39;s Spider.java, which extends RecursiveTask: pastebin.com/8eDsVNDg and here&#39;s SpiderUtils.java: pastebin.com/5NpjY79T"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654639491,"comment_id":128137868,"body":"Can you show your <code>ForkJoinTask</code> implementation?"},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654629613,"comment_id":128135050,"body":"@Slaw I&#39;m not quite sure what you mean by sharing the source of the stream between multiple instances, I just pass the urls to the new instances and that&#39;s it for the results of that method. The code I provided is the only place where the stream is used."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654582686,"comment_id":128118263,"body":"Hmm. The stack trace indicates the exception is being thrown from a stream pipeline. The only stream I see in your code is <code>crawForURLs(&quot;a&quot;, &quot;href&quot;).stream()</code>. Make sure that you are not sharing the <i>source</i> of the stream between multiple <code>ForkJoinTask</code> instances, at least not when that source can have read+write operations by multiple threads at the &quot;same time&quot; (without the proper synchronization)."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"edited":false,"creation_date":1654572063,"comment_id":128116484,"body":"@Slaw I wish I could provide that example but I honestly don&#39;t know how to reproduce the error, it only happens sometimes and I haven&#39;t found a pattern yet. I will update the original question with the full stack trace."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72525288,"edited":false,"creation_date":1654569877,"comment_id":128116154,"body":"Can you try to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating the problem, and the full stack trace of the error?"},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72429901,"edited":false,"creation_date":1653917585,"comment_id":127961830,"body":"That is why Spring has the <code>TaskExecutor</code> which you can give a task which will execute in the background (or just call a method annotated with <code>@Async</code>). Don&#39;t roll your own... In this case you even might want an <code>ASyncTaskScheduler</code> and schedule a task to do something each x seconds (3 seconds in this case)."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJxX9Iix5-V4Afy0vaosyCz1npCO7X3fhNOxSnIe=k-s256","account_id":25423725,"user_type":"registered","user_id":19229200,"link":"https://stackoverflow.com/users/19229200/scizora","reputation":21,"display_name":"Scizora"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72429901,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"edited":false,"creation_date":1653917216,"comment_id":127961703,"body":"@BasilBourque thanks for the recommendation! i will have a look at it!"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJxX9Iix5-V4Afy0vaosyCz1npCO7X3fhNOxSnIe=k-s256","account_id":25423725,"user_type":"registered","user_id":19229200,"link":"https://stackoverflow.com/users/19229200/scizora","reputation":21,"display_name":"Scizora"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72429901,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"edited":false,"creation_date":1653917163,"comment_id":127961683,"body":"@M.Deinum hello, i just edited in the related codes to the original question. and yes i understand that java threads can be a little finicky and i shouldnt create threads myself, however other then creating threads to execute this particular concurrent operation i am unsure of the other possible approaches."},{"owner":{"profile_image":"https://i.stack.imgur.com/ZWEI3.jpg?s=256&g=1","account_id":322981,"user_type":"registered","user_id":642706,"link":"https://stackoverflow.com/users/642706/basil-bourque","reputation":310755,"display_name":"Basil Bourque","accept_rate":58},"content_license":"CC BY-SA 4.0","score":1,"post_id":72429901,"edited":false,"creation_date":1653894963,"comment_id":127953849,"body":"The Executors framework is your friend here. Search to learn about <code>ExecutorService</code>. In modern Java, we rarely deal with <code>Thread</code> class directly."},{"owner":{"profile_image":"https://i.stack.imgur.com/qHEzx.png?s=256&g=1","account_id":3192259,"user_type":"registered","user_id":2696260,"link":"https://stackoverflow.com/users/2696260/m-deinum","reputation":117619,"display_name":"M. Deinum"},"content_license":"CC BY-SA 4.0","score":2,"post_id":72429901,"edited":false,"creation_date":1653891734,"comment_id":127952961,"body":"Please add code, and you shouldn&#39;t be creating threads yourself."},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71817703,"edited":false,"creation_date":1649605273,"comment_id":126912708,"body":"Two semaphores and one unit?  When input, signal a semaphore and wait on the other."},{"owner":{"profile_image":"https://i.stack.imgur.com/g89TG.jpg?s=256&g=1","account_id":3428879,"user_type":"registered","user_id":2873896,"link":"https://stackoverflow.com/users/2873896/luke-briggs","reputation":3755,"display_name":"Luke Briggs"},"content_license":"CC BY-SA 4.0","score":2,"post_id":71817703,"edited":false,"creation_date":1649603509,"comment_id":126912314,"body":"Maybe approach it more like this: <a href=\"https://stackoverflow.com/questions/4044726/how-to-set-a-timer-in-java\">A timer</a> which ticks once a second. When it ticks, depending on if it is currently black or white&#39;s turn, you update their time counts accordingly. While/sleep loops have a tendancy to &#39;drift&#39; from true time, given it doesn&#39;t take exactly 1 second per iteration."},{"owner":{"profile_image":"https://i.stack.imgur.com/nc9J4.jpg?s=256&g=1","account_id":5055881,"user_type":"registered","user_id":15055605,"link":"https://stackoverflow.com/users/15055605/yamin","reputation":3266,"display_name":"YaMiN"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71817703,"edited":false,"creation_date":1649602883,"comment_id":126912176,"body":"You can use threads or <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html\" rel=\"nofollow noreferrer\">ExecutorService</a>."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1646308885,"comment_id":126093738,"body":"@NathanHughes I had intended to use this as a demonstration of wait() and notifyAll() methods in a scenario involving three threads. I do understand threads can have unexpected behavior and this is probably not very useful. Just meant it as a proof of concept."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":2,"post_id":71325131,"edited":false,"creation_date":1646292800,"comment_id":126088296,"body":"Depends on <code>getQueryExecutor()</code>. Normally, you would have a limit in executors. In fact, you could have a single threaded executor with a queue capacity of one, naturally preventing submitting a new job when there is a pending one. Besides that, I can’t tell for sure whether the first variant permits overlapping or not. That’s why I would use a single atomic integer for the state, to have far fewer state transitions and easy to understand code. That’s also the advantage of your variant, I can see immediately that concurrent calls of <code>computeFunction.call()</code> are possible."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646258109,"comment_id":126081745,"body":"This doesn&#39;t seem like a great way of demonstrating inter-thread communication. Maybe try using Actors?"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1646252056,"comment_id":126079968,"body":"@NathanHughes I wanted to use this as a demonstration of inter-thread communication between three threads for the learners. But the unexpected output is baffling me."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646251848,"comment_id":126079904,"body":"This seems very painful, and doesn&#39;t seem likely to teach you anything."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-qCwENZDh52k/AAAAAAAAAAI/AAAAAAAADjY/4vqCcXX96N4/photo.jpg?sz=256","account_id":12929247,"user_type":"registered","user_id":9348806,"link":"https://stackoverflow.com/users/9348806/akash-das","reputation":163,"display_name":"Akash Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b31ee54d9d3789bf16fe971dbb4a2ef8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9760,"user_type":"registered","user_id":18157,"link":"https://stackoverflow.com/users/18157/jim-garrison","reputation":85860,"display_name":"Jim Garrison","accept_rate":100},"edited":false,"creation_date":1646251617,"comment_id":126079832,"body":"@JimGarrison I have edited the outputs to include the names of the threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b31ee54d9d3789bf16fe971dbb4a2ef8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9760,"user_type":"registered","user_id":18157,"link":"https://stackoverflow.com/users/18157/jim-garrison","reputation":85860,"display_name":"Jim Garrison","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71328425,"edited":false,"creation_date":1646251093,"comment_id":126079657,"body":"You omitted the crucial bit... the actual output showing which thread printed which number."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246373,"comment_id":126078077,"body":"if it will spawn thousands of calls then I believe the first one may be preferred, but if the memory is enough to handle multiple threads or if the calls would not be that much, then I believe my option is a valid one, maybe I am looking for too much excuses to use my code lol."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246362,"comment_id":126078071,"body":"There is a definite advantage on the first code, and it is that it prevents the unnecessary creation of threads, which means the semaphore begins to work EVEN BEFORE the execution begins, that is what makes the task so complex, the problem is that it makes the task a lot more slow, so I believe we should also take into account what is the context of the code being used on, ..."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-RP1GwpkAYX4/AAAAAAAAAAI/AAAAAAAAAEc/fknm-MHAJYU/photo.jpg?sz=256","account_id":15545149,"user_type":"registered","user_id":11214643,"link":"https://stackoverflow.com/users/11214643/delark","reputation":1170,"display_name":"Delark"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71325131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646246007,"comment_id":126077952,"body":"Thanks for your response @Holger, I&#39;ve made a list of all the possible scenarios of the first code, if by &quot;overlapping&quot; you mean 2 consecutive calls with the different result, that also happens in the first one (under a special case). If you mean the same result computed twice, that happens also, it is just that the first computation is not dispatched the same computation is performed again and this time dispatched. If you mean asynchronously, then the first code is still in the need to perform the second call AFTER the first dispatch was cancelled (the computation was still performed)."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71325131,"edited":false,"creation_date":1646242210,"comment_id":126076652,"body":"What happens when the new action is scheduled right between <code>if (invalidationVersion != invalidationCount.get()) return;</code> and <code>T value = computeFunction.call();</code>? Then, you have overlapping computations. The logic of the first code snippet can be simplified though. Just by replacing the three <code>AtomicBoolean</code>s by a single <code>AtomicInteger</code> using three bits. Since there are several adjacent uses of the <code>AtomicBoolean</code>s (i.e. there’s no action with inter-thread semantics in-between), the single <code>AtomicInteger</code> allows to reduce the number of accesses."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fa54191534d8fd4ef49d9776f0749acb?s=256&d=identicon&r=PG","account_id":24290154,"user_type":"registered","user_id":18235332,"link":"https://stackoverflow.com/users/18235332/eric","reputation":41,"display_name":"eric"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71317154,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"edited":false,"creation_date":1646220964,"comment_id":126068032,"body":"Yes your are right, my mistake."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218967,"comment_id":126067379,"body":"i tried adding a sleep or wait after an objects was attempted to be read, but it doesn&#39;t unlock the inputstream. synchronized (ois) {                     System.out.println(&quot;t1: locked ois&quot;);                     o = ois.readObject();                     while(o == null){                         ois.wait(500);                         Thread.sleep(500);                     }                 }"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218416,"comment_id":126067213,"body":"how do I make t1 unlock ois if no objects come along, but only for a second to allow t2 to take lock (if t2 activated); otherwise, it just repeats the process (if t2 inactive -  waiting)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646218254,"comment_id":126067161,"body":"I want t1 to run continuously, listening for objects from a server on another computer. I don&#39;t know if there is a more effective way to notify it only when the server wants to send data, because the server is not on the same computer so its only input is through this stream."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"edited":false,"creation_date":1646217236,"comment_id":126066809,"body":"But while t1 is waiting for objects to come along it holds on to the lock, so t2 can&#39;t do its work in that case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd320b2ee6e007375c49892457ea7842?s=256&d=identicon&r=PG","account_id":24314867,"user_type":"registered","user_id":18256231,"link":"https://stackoverflow.com/users/18256231/hadsag","reputation":11,"display_name":"hadsag"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71320990,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d799a3f9fa2cfe1bcebe2c73cd5aa77d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7226774,"user_type":"registered","user_id":5515060,"link":"https://stackoverflow.com/users/5515060/lino","reputation":19717,"display_name":"Lino","accept_rate":100},"edited":false,"creation_date":1646216945,"comment_id":126066707,"body":"I added the buffer class. The print &quot;t2: waiting to lock ois&quot;  wouldn&#39;t run if it didn&#39;t receive any object. But i guess you&#39;re talking about t1 and in that case, yeah that is true that it doesn&#39;t receive any objects. I want t1 to run continuously despite not receiving anything, but when t2 is activated, I want them to synchronize on the usage of ObjectInputStream."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d799a3f9fa2cfe1bcebe2c73cd5aa77d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7226774,"user_type":"registered","user_id":5515060,"link":"https://stackoverflow.com/users/5515060/lino","reputation":19717,"display_name":"Lino","accept_rate":100},"content_license":"CC BY-SA 4.0","score":2,"post_id":71320990,"edited":false,"creation_date":1646216520,"comment_id":126066573,"body":"Because you never receive an object?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71311675,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"edited":false,"creation_date":1646201081,"comment_id":126061907,"body":"Hi Gray... I have updated above problem with code snippet."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 4.0","score":2,"post_id":71317154,"edited":false,"creation_date":1646192545,"comment_id":126060506,"body":"The constructor doesn&#39;t get called because you&#39;re not calling it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71311675,"edited":false,"creation_date":1646165231,"comment_id":126054861,"body":"Can you provide a small code snippet?"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71212008,"edited":false,"creation_date":1645532858,"comment_id":125891312,"body":"Your understanding was true before Java 5. And it still would be true when the field is modified after publication."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GiAodSydlQ6OSWarwkzr-_d2qQsh_c6dIkeK2PS=k-s256","account_id":23525175,"user_type":"registered","user_id":17571825,"link":"https://stackoverflow.com/users/17571825/nickthefreak97","reputation":33,"display_name":"NickTheFreak97"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71096361,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"edited":false,"creation_date":1644828672,"comment_id":125700092,"body":"@Darkman: The point would be that students can join mid class at any time. For a student joining when the class already started, the class ending time would be different than the others in the same classroom. Also it shouldn&#39;t be a student&#39;s responsibility to manage the beginning and end of classes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53aa3f0985b383044bf3f33643ffde76?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14584795,"user_type":"registered","user_id":10534012,"link":"https://stackoverflow.com/users/10534012/darkman","reputation":2961,"display_name":"Darkman"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71096361,"edited":false,"creation_date":1644771041,"comment_id":125688926,"body":"It seems that you don&#39;t need to <code>synchronized</code> or <code>wait()</code> at all. Why not just using <code>Thread.sleep()</code>? Let the students <code>joinClass()</code> any time they want to, put them to <code>sleep(3000L)</code>, and voila <code>remove(0)</code> them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ebe86c740cbc6df07e23cf0109fae16?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9966483,"user_type":"registered","user_id":7374044,"link":"https://stackoverflow.com/users/7374044/user7374044","reputation":157,"display_name":"user7374044"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"edited":false,"creation_date":1637000807,"comment_id":123702891,"body":"@BrennenSprimont I&#39;m asking for now theoretically cause they biggest concern I have is that should it look like when developing microservices. I don&#39;t know if I should split microservice between readers-microservice and writers-microservice to be able to scale them independently. Also I don&#39;t know how I should do with the MySQL db. I will be using 2 tables not more. From time to time updates and inserts, mostry reads (simple selects with primary key)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973901,"comment_id":123692046,"body":"The other threads are NOT started. Before starting a new thread, you get stuck on the <code>serverSocket.accept()</code> call which is blocking forever, waiting for some client to connect on the socket. Move that call into the handlers, perhaps, or into a separate thread. Only then will the handler thread start. Still, you&#39;d never exit the loop and therefore never start any clients, so you still need to fix that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973551,"comment_id":123691920,"body":"To not to block the main thread which executes the infinite loop"},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"edited":false,"creation_date":1636973477,"comment_id":123691891,"body":"@kiner_shah I don&#39;t think it&#39;s relevant to the question.."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"edited":false,"creation_date":1636973442,"comment_id":123691876,"body":"@Antoniossss But why? That is my question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973366,"comment_id":123691851,"body":"@GoldCredential, where is <code>GameClient</code> defined?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6665878d41d42307eb53e9fae311a471?s=256&d=identicon&r=PG","account_id":1658807,"user_type":"registered","user_id":1527544,"link":"https://stackoverflow.com/users/1527544/antoniossss","reputation":31819,"display_name":"Antoniossss","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973365,"comment_id":123691849,"body":"Start your server in a separate thread."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EOq0k.jpg?s=256&g=1","account_id":5989971,"user_type":"registered","user_id":6168139,"link":"https://stackoverflow.com/users/6168139/rushi","reputation":142,"display_name":"rushi"},"edited":false,"creation_date":1636973260,"comment_id":123691811,"body":"@rushi I meant the main thread could be paused and the program could go to one of the newly created threads."},{"owner":{"profile_image":"https://i.stack.imgur.com/EOq0k.jpg?s=256&g=1","account_id":5989971,"user_type":"registered","user_id":6168139,"link":"https://stackoverflow.com/users/6168139/rushi","reputation":142,"display_name":"rushi"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973217,"comment_id":123691792,"body":"Why would context switching cause the the while loop to break?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa3c9a8b29d3a64f5841a6d511777979?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5964120,"user_type":"registered","user_id":4688321,"link":"https://stackoverflow.com/users/4688321/kiner-shah","reputation":4275,"display_name":"kiner_shah"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973062,"edited":false,"creation_date":1636973072,"comment_id":123691724,"body":"Your question is unclear and is missing information. <code>GameClientHandler</code> where is this defined and what does it contain? What are you expecting to happen with your code?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJzLkOQelMMXYxAJxRKLvxqRtrmM6VXMlnw9PvD0=k-s256","account_id":23184907,"user_type":"registered","user_id":17282180,"link":"https://stackoverflow.com/users/17282180/iosiv","reputation":25,"display_name":"Iosiv"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967482,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"edited":false,"creation_date":1636927509,"comment_id":123682296,"body":"@BurakSerdar you are right. I was just experimenting and forgot to move it back to where it was originally (after the while loop). And yes, I&#39;m sure it is full of problems, like the fact that InterruptedExceptions are not being catched anywhere..."},{"owner":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"content_license":"CC BY-SA 4.0","score":1,"post_id":69967482,"edited":false,"creation_date":1636927312,"comment_id":123682245,"body":"You are printing &quot;Ball taken..&quot; before the ball is actually taken. That is only one of the problems though."},{"owner":{"profile_image":"https://i.stack.imgur.com/dVLIh.jpg?s=256&g=1","account_id":5281408,"user_type":"registered","user_id":4216641,"link":"https://stackoverflow.com/users/4216641/turing85","reputation":18797,"display_name":"Turing85"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967482,"edited":false,"creation_date":1636927240,"comment_id":123682225,"body":"Please <a href=\"https://stackoverflow.com/posts/69967482/edit\">edit</a> the post and show the class creating the <code>Payer</code>-instances, as well as the <code>Ball</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"edited":false,"creation_date":1636924724,"comment_id":123681722,"body":"These days, MySQL and just about every sql engine should be able to handle 3+ writer threads/processes without any problems. What do your insert statements look like? Are there any triggers? Are you manually locking in your insert statements or in a trigger? Have you made any major configuration changes from what came out of the box?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ebe86c740cbc6df07e23cf0109fae16?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9966483,"user_type":"registered","user_id":7374044,"link":"https://stackoverflow.com/users/7374044/user7374044","reputation":157,"display_name":"user7374044"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"edited":false,"creation_date":1636924289,"comment_id":123681617,"body":"@BrennenSprimont I know it&#39;s a wide topic but in your example: if I use the e.g. 3 writers threads how I will sync them to do not make a lock / deadlock on a mysql table? How should I syncronize them?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124841c72fb0abe3b8865f7dd92b53c5?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5861089,"user_type":"registered","user_id":4616759,"link":"https://stackoverflow.com/users/4616759/brennen-sprimont","reputation":1644,"display_name":"Brennen Sprimont"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967003,"edited":false,"creation_date":1636923276,"comment_id":123681364,"body":"I don&#39;t think there is a &quot;1 size fits all&quot; solution for these kind of systems. You&#39;ll need to describe the system more. As for your questions, you can have several threads or processes reading/writing to a database. Just make more database connections (a lot of this handled through connection pools in libraries these days). Queue&#39;s are really common for these kinds of systems, Kafka is a popular one, but again, it&#39;s hard to tell if queues/kafka is the right tool without knowing more. As for books, look for stuff on &quot;horizontal scaling&quot;, I think this is the term you are looking for."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":1,"post_id":69960082,"edited":false,"creation_date":1636898510,"comment_id":123675090,"body":"IMO, you are mixing up what &quot;fully constructed&quot; means. The <code>ArrayList</code> instance is <i>empty</i> when it is &quot;fully constructed.&quot; Then, the <code>Dummy</code> constructor <i>mutates</i> the list, <i>after</i> the list has been &quot;constructed.&quot; Your use of <code>final</code> prevents the other thread from seeing the <i>list</i> in an un-constructed state, but you allow the other thread to see the <code>Dummy</code> instance before the <code>Dummy</code> is fully constructed. You allow it to see the <code>Dummy</code> while its constructor still is mutating the list."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":2,"post_id":69960082,"edited":false,"creation_date":1636863083,"comment_id":123668830,"body":"What are you actually asking?  As far as I can see, this &quot;question&quot; doesn&#39;t actually contain any questions.  Just a statement of intent, and some assertions about how you believe this code should behave.  What do you actually want us to answer here?"},{"owner":{"profile_image":"https://i.stack.imgur.com/bCY3c.png?s=256&g=1","account_id":12206189,"user_type":"registered","user_id":8909235,"link":"https://stackoverflow.com/users/8909235/lkatiforis","reputation":5872,"display_name":"lkatiforis"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957844,"edited":false,"creation_date":1636834429,"comment_id":123664799,"body":"You forgot to add the code snippet."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636816390,"comment_id":123660674,"body":"...In Java, those special measures are called &quot;synchronization,&quot; and the literature talks about the &quot;happens before relationships&quot; that synchronization establishes. &quot;Java synchronization&quot; and &quot;Java happens before&quot; are good terms to search for in Google."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636816294,"comment_id":123660652,"body":"The compiler, the JRE, and even the hardware operate under the assumption that most code will not interact with other threads. That&#39;s the best strategy because allowing for interactions between threads slows things down, and in fact, <i>most</i> of our code does <i>not</i> depend on other threads. So, if some other thread happens to change the value of <code>server.lock</code>, there&#39;s no guarantee about when (or even, if <i>ever</i>) that the thread executing the loop in your example will &quot;see&quot; the change. If you want to ensure that the loop promptly sees it, then you&#39;ll have to take special measures..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955201,"edited":false,"creation_date":1636814473,"comment_id":123660252,"body":"This seems to be the same as <a href=\"https://stackoverflow.com/q/25425130/217324\">stackoverflow.com/q/25425130/217324</a>,  it means you have a memory visibility issue. Also using busy waiting is a really inefficient way to solve this."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJynPZiDBDs71AjXvsPBCToWWKmYqFbwB2ssAvX0=k-s256","account_id":23182000,"user_type":"registered","user_id":17279700,"link":"https://stackoverflow.com/users/17279700/darius-boengiu","reputation":21,"display_name":"Darius Boengiu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69954623,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0b74304b7f2b17bae10c78728f8b874b?s=256&d=identicon&r=PG","account_id":3042393,"user_type":"registered","user_id":2579066,"link":"https://stackoverflow.com/users/2579066/marvin","reputation":643,"display_name":"Marvin","accept_rate":50},"edited":false,"creation_date":1636810323,"comment_id":123659325,"body":"@Marvin if I don&#39;t use join not all types of tickets will be stored in the array"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0b74304b7f2b17bae10c78728f8b874b?s=256&d=identicon&r=PG","account_id":3042393,"user_type":"registered","user_id":2579066,"link":"https://stackoverflow.com/users/2579066/marvin","reputation":643,"display_name":"Marvin","accept_rate":50},"content_license":"CC BY-SA 4.0","score":1,"post_id":69954623,"edited":false,"creation_date":1636810242,"comment_id":123659312,"body":"Joining the Thread after start will stop executing for-loop until that thread is finished."},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636808651,"comment_id":123658938,"body":"Thinking more about it, it seems to me that, if you don&#39;t need notification of the completion of all downloads, all that would be needed is for the work threads to keep a private flag that indicates if it just queued up a retry request.  If it gets a null, (or other termination request), it requeues the termination request but only terminates itself if it has not just requeued a retry.  That ensures that there will alwsys be a thread to handle any last retries:)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/526bc371b11b45dc3a16ba95bc31b278?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7405785,"user_type":"registered","user_id":5634769,"link":"https://stackoverflow.com/users/5634769/gpasch","reputation":2672,"display_name":"gpasch"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636804937,"comment_id":123658113,"body":"My solution would be to use as much flags and things as possible. Right now you dont have a solution that works. As for calling for an &quot;elegant&quot; solution that is a qualitative statement so that leads me NOWHERE!!"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636796011,"comment_id":123656326,"body":"Maybe a priority queue with the killer-null as lowest priority?  That would seem to work?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636795635,"comment_id":123656232,"body":"Yes, there is still the issue of how the producer could determine when the last download has been successfully downloaded, ie. there can be no more download attempts to retry:("},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636794317,"comment_id":123655980,"body":"&#39;blocking queue has no mechanism for the producer to signal that it won&#39;t be putting more data to the queue&#39;.  That&#39;s easy, if you really need to do it - queue up a null reference instead of a valid URL object and have the work threads check the dequeued reference for null and, if it is, requeue the null and terminate.  Pretty soon after posting the null, all your work threads will have got the null and be gone:)"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636794052,"comment_id":123655933,"body":"&#39;The problem of notifying the worker threads that they could exit once the queue was empty&#39;..is that necessary?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69950945,"edited":false,"creation_date":1636793995,"comment_id":123655920,"body":"&#39;once the producer was finished, it couldn&#39;t just complete its execution because it needed to hang around to put failed URLs back into the queue&#39;....why is that a problem?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/df5e4bae59e1c0f2e390095d2142fe1a?s=256&d=identicon&r=PG","account_id":22856176,"user_type":"registered","user_id":17001012,"link":"https://stackoverflow.com/users/17001012/riggel","reputation":11,"display_name":"Riggel"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69946372,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/31b41159edcc827d59913465cf571717?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13113788,"user_type":"registered","user_id":9473786,"link":"https://stackoverflow.com/users/9473786/tyler-v","reputation":10080,"display_name":"Tyler V"},"edited":false,"creation_date":1636790546,"comment_id":123655314,"body":"I added my Fragment."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31b41159edcc827d59913465cf571717?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13113788,"user_type":"registered","user_id":9473786,"link":"https://stackoverflow.com/users/9473786/tyler-v","reputation":10080,"display_name":"Tyler V"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69946372,"edited":false,"creation_date":1636766847,"comment_id":123652427,"body":"If your fragments are slow to create it likely means you are doing too much work in the Fragment itself. The solution is to fix the Fragment so it can load and display its own data asynchronously, not to create it like this in a handler (which is not implemented correctly anyway). You would have to post an actual Fragment that shows this issue if you wanted more specific answers..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629189117,"comment_id":121614344,"body":"@SolomonSlow I need to <code>CompleteableFuture</code> because I want to process in parallel everything, like read from DB in main thread, then process in the thread pools.  Actually You are right I didn&#39;t need to store the results, After removing <code>futures.add</code> and then just finally calling the <code>shutdown</code> method resolved the memory issue and it didnt even skipped the tasks pending in the thread pools, as I was thinking. <code>ExecutorService</code> FixedThreadPool create live thread and not daemon threads, so the program does not exits untill all tasks are finished. Thanks for the help."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68802148,"edited":false,"creation_date":1629129712,"comment_id":121599926,"body":"Actually, Why are you using <code>CompletableFuture</code> at all? You&#39;re building a list of 1,000,000 results, and then you want to create an array of those results, but where do you actually ever <i>use</i> the results? If I were trying to solve your problem, I would use a <code>ThreadPoolExecutor</code> that was constructed with a fixed-size <code>ArrayBlockingQueue</code> for its task queue, and I would submit plain <code>Runnable</code> tasks to it. Because the queue is bounded, that would prevent the database reader thread from out-pacing the worker threads, and it would limit your heap usage."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629127599,"comment_id":121599048,"body":"@SolomonSlow TotalData is 1Million whereas workerCount starts from 0 and then after each iteration 5k is added to it and it stops when it reaches to 1Million by that time alot of data is already processed by threads but I get heap memory error as I save results in a list. I do that to call the Completeable future join method to process any remaining tasks"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629126755,"comment_id":121598655,"body":"So, are you  saying that <code>totalData</code> is 5K, and not one million? <code>totalData</code> is how many results will be in memory at the same time, and it&#39;s the upper bound on how many records might be in memory at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629125047,"comment_id":121597710,"body":"@SolomonSlow No, I read data in batches lets say I read 5k records each time and then that array is  supplied to the &#39;supplyAsync&#39; method which will be processed in a thread pool.  The loop is working on the main thread as soon as the count reaches to totalData it exists goes to next code snippet where i call the shutDown methods of the executor services"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0105d720803ed2616466c6d825ec2ae9?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4475927,"user_type":"registered","user_id":3641058,"link":"https://stackoverflow.com/users/3641058/learning-developer","reputation":52,"display_name":"Learning Developer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1629124789,"comment_id":121597570,"body":"@SolomonSlow workerCount var is used as on offset for picking data from DB, I agree its poorly named.  The number of threads are set to 15 when the initial task is being sent, its result is processed in another thread pool  whose thread count is 10"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629124630,"comment_id":121597482,"body":"What is the point of &quot;reading data...in batches?&quot; Your loop doesn&#39;t appear to do the actual work in batches. It looks like you first submit the entire one million tasks to the pool, and then you wait for all of them to be completed. Depending on the relative speed of processing the records vs. retrieving the records, and depending on the structure of code you haven&#39;t shown to us, you may have up to the whole one million records in memory at the same time, and you certainly will have the whole one million results in memory at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68802148,"edited":false,"creation_date":1629124400,"comment_id":121597360,"body":"Your <code>Worker</code> class looks like a <i>task</i>, and your <code>workerCount</code> looks like the number of tasks that have been submitted to the thread pool. A task is not the same thing as a worker. We usually say &quot;worker&quot; when we are talking about the threads that belong to the pool. Each worker performs many tasks in a typical thread pool use-case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a97334841a1e42ce096e1e220116af2?s=256&d=identicon&r=PG","account_id":931371,"user_type":"registered","user_id":961204,"link":"https://stackoverflow.com/users/961204/jobless91","reputation":33,"display_name":"jobless91"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68784557,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"edited":false,"creation_date":1629087870,"comment_id":121584354,"body":"Thanks @TomDibble, I had forgot to add sleep() or if (Thread.interrupted()) condition in my code sample."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"edited":false,"creation_date":1629076890,"comment_id":121583006,"body":"@BeUndead thanks, i will look up to the thread pool design, i think implementing your idea is a more viable task todo since resedesign the rfc6455 does take a week or so. Regarding the Spring Framework, do you have good tutorial on how to see Spring annotation works e.g. <code>@EnableWebSocketMessageBroker</code> which class the annotation create, so I can be better on how the server works step by step."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629076439,"comment_id":121582941,"body":"@chrylis-cautiouslyoptimistic- For the specific reason, I dont know how Spring dependency injection works, it&#39;s like a Black Box, use &#39;@SpringApplication` and couple of this that, suddenly you have websocket endpoint. But when I found a bug, reading the document is a hell to went through and when you want a specific feature, I am not sure how to implement it because Spring Framework actually dont tell you which class does that specific annotation use e.g. <code>@EnableWebSocketMessageBroker</code>. I spent weeks to debug and read the Spring Framework without progress."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629076424,"comment_id":121582940,"body":"@chrylis-cautiouslyoptimistic- &quot;handle&quot; in this case, how do the server receive incoming packet data and sending packet data, currently I put each WebSocket connection in 1 unique thread, but this mean I have to create thread pool of 100 threads to handle 100 alive connection unlike HTTP request/response. Environment? I still use it locally on my laptop, I have not push it, probably using graalvm. I have not finished with thr SSL context yet."},{"owner":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"edited":false,"creation_date":1629075890,"comment_id":121582859,"body":"Ideally, make a threadpool (of whatever size your regular traffic is) and allow it to grow (and preferably shrink) to handle spikes, and let java+OS worry about the rest... But even more ideally, don’t do this yourself, use a library like @chrylis recommended above. These are ludicrously complicated topics, which take people years to figure out (I certainly haven’t) and even more years to implement well."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"edited":false,"creation_date":1629075664,"comment_id":121582833,"body":"@BeUndead assuming the concurrency concept and clever hardware design, <code>Executors.newFixedThreadPool(2000);</code> will not cause problem because 1. The OS will delegate each thread at a time <code>Thread A - &gt; Thread B - &gt; Thread A</code> and 2. CPU nowadays capable to execute 2 threads at the same time, assuming I have a 4 cores, the best thread pool size is 8 threads, I just have to redesign how to handle the WebSocket connections <code>e.g. 2000 keep alive connections</code> in 8 threads. Am I right?"},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796254,"edited":false,"creation_date":1629074967,"comment_id":121582756,"body":"What exactly do you mean by &quot;handle&quot;, and what environment are you running your sockets in? Is there a specific reason you&#39;re not using an existing platform (such as Spring) to handle these matters for you automatically?"},{"owner":{"profile_image":"https://i.stack.imgur.com/gKLfe.png?s=256&g=1","account_id":2889245,"user_type":"registered","user_id":2478398,"link":"https://stackoverflow.com/users/2478398/beundead","reputation":3533,"display_name":"BeUndead"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68796254,"edited":false,"creation_date":1629074957,"comment_id":121582753,"body":"<a href=\"https://stackoverflow.com/a/34689857/2478398\">stackoverflow.com/a/34689857/2478398</a> Give this answer and the one below it a read. But in effect ‘it depends’, and on a lot of things such as how CPU intensive the tasks you’re giving each thread are."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68784557,"edited":false,"creation_date":1629059463,"comment_id":121580564,"body":"Added a Thread.sleep(5000); in Thread B so it compiles and sits there until threadA interrupts it. I think that was what was intended originally."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629031004,"comment_id":121573920,"body":"@tgdavies my code only works correctly in one thread"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629030933,"comment_id":121573900,"body":"@tgdavies synchronised my two account. Why not? i get a full fledged object from my database"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"edited":false,"creation_date":1629030445,"comment_id":121573804,"body":"(and for bonus points: if your code worked correctly, can you see how it can deadlock?)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":1,"post_id":68791080,"edited":false,"creation_date":1629030361,"comment_id":121573788,"body":"What does synchronised do exactly? What does that mean <code>findById</code> must guarantee for your code to work?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"edited":false,"creation_date":1629030209,"comment_id":121573759,"body":"@tgdavies what&#39;s wrong with taking data from the database?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"edited":false,"creation_date":1629030115,"comment_id":121573737,"body":"@BoristheSpider I take these values ​​from the database and i lock monitor"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68791080,"edited":false,"creation_date":1629028202,"comment_id":121573279,"body":"What requirement does your synchronisation scheme place on <code>accountRepository.findById</code>?"},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":1,"post_id":68791080,"edited":false,"creation_date":1629026940,"comment_id":121573015,"body":"I also see <code>Account.numberTransaction++</code> which is not a thread safe call."},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":2,"post_id":68791080,"edited":false,"creation_date":1629026854,"comment_id":121572998,"body":"What do you think your synchronised blocks are doing here? Put another way, where does the instance of <code>Account</code> come from?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1628969048,"comment_id":121564662,"body":"@ThomasKl&#228;ger there is no synchronization point required for a sleep. <a href=\"https://docs.oracle.com/javase/specs/jls/se16/html/jls-17.html#jls-17.3\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/specs/jls/se16/html/jls-17.html#jls-1&zwnj;&#8203;7.3</a> &quot;It is important to note that neither Thread.sleep nor Thread.yield have any synchronization semantics.&quot;"},{"owner":{"profile_image":"https://i.stack.imgur.com/uAEcW.jpg?s=256&g=1","account_id":1689973,"user_type":"registered","user_id":1552534,"link":"https://stackoverflow.com/users/1552534/wjs","reputation":37330,"display_name":"WJS"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68786081,"edited":false,"creation_date":1628968522,"comment_id":121564550,"body":"I wonder if using a <code>record</code> type would help since records are inherently immutable?"},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":2,"post_id":68786081,"edited":false,"creation_date":1628968246,"comment_id":121564489,"body":"Note that if you are wanting the fields not to be modifiable, make them <code>final</code>. Also, the JVM is tuned to make creating lots of small objects <i>extremely</i> cheap; in a multithreaded scenario, your overhead is going to be collecting them all in one place."},{"owner":{"profile_image":"https://i.stack.imgur.com/uAEcW.jpg?s=256&g=1","account_id":1689973,"user_type":"registered","user_id":1552534,"link":"https://stackoverflow.com/users/1552534/wjs","reputation":37330,"display_name":"WJS"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628967573,"comment_id":121564347,"body":"Before considering significant performance improvements in threading, you may want to consider how many cores you have.  Unless you have multiple cores and lots of processing to do using multiple threads won&#39;t benefit you."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628966607,"comment_id":121564133,"body":"tl;dr; Add your code, and give us the bench mark times."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":3,"post_id":68786081,"edited":false,"creation_date":1628966579,"comment_id":121564132,"body":"Possibly because you&#39;re not cpu bound. Possibly because you&#39;re doing the multi-threading wrong.  I would go with the first assumption since 1 million objects isn&#39;t that many, and to create 1 million objects with two fields, it would be pretty hard to improve with threads."},{"owner":{"profile_image":"https://i.stack.imgur.com/fL1rH.png?s=256&g=1","account_id":935202,"user_type":"registered","user_id":964243,"link":"https://stackoverflow.com/users/964243/boann","reputation":49046,"display_name":"Boann","accept_rate":66},"content_license":"CC BY-SA 4.0","score":1,"post_id":68785125,"edited":false,"creation_date":1628966203,"comment_id":121564039,"body":"<a href=\"https://stackoverflow.com/questions/25425130/loop-doesnt-see-value-changed-by-other-thread-without-a-print-statement\" title=\"loop doesnt see value changed by other thread without a print statement\">stackoverflow.com/questions/25425130/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 4.0","score":2,"post_id":68785125,"edited":false,"creation_date":1628959340,"comment_id":121562432,"body":"Without declaring the <code>flag</code> as <code>volatile</code> and without other statements that require synchronization points (<code>Thread.sleep()</code> and <code>System.out.println()</code> both require these) the JVM may assume that the main thread is the only thread accessing (reading and/or writing) the <code>flag</code> variable, i.e. it may move the read of the <code>flag</code> variable <b>before</b> the <code>while (true) {}</code> statement."},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":2,"post_id":68785125,"edited":false,"creation_date":1628959221,"comment_id":121562409,"body":"Yup, <code>PrintWriter</code> is <code>sychronized</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c4269e3a7210fb1a98b7de6f4ecd5336?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8446407,"user_type":"registered","user_id":6336910,"link":"https://stackoverflow.com/users/6336910/tom-chen","reputation":43,"display_name":"Tom Chen"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"edited":false,"creation_date":1628959107,"comment_id":121562380,"body":"But, when i replace the &quot;Thread.sleep(1);&quot;  to &quot;System.out.println(&quot;balabala&quot;);&quot; ,  it also fix the problem"},{"owner":{"profile_image":"https://i.stack.imgur.com/R8AYO.jpg?s=256&g=1","account_id":2366187,"user_type":"registered","user_id":2071828,"link":"https://stackoverflow.com/users/2071828/boris-the-spider","reputation":60162,"display_name":"Boris the Spider","accept_rate":88},"content_license":"CC BY-SA 4.0","score":0,"post_id":68785125,"edited":false,"creation_date":1628958620,"comment_id":121562260,"body":"<code>sleep</code> (may) cause your thread to be descheduled so it’s caches would be flushed. To point 2; no. If it’s not written back to main memory then it’s moot in any case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ffbf4e85b8ffbae4e9039b9c0cf07bc8?s=256&d=identicon&r=PG","account_id":2496,"user_type":"registered","user_id":3474,"link":"https://stackoverflow.com/users/3474/erickson","reputation":266244,"display_name":"erickson","accept_rate":83},"content_license":"CC BY-SA 4.0","score":2,"post_id":68760729,"edited":false,"creation_date":1628785951,"comment_id":121520687,"body":"I understand this is an assignment, but it&#39;s a stupid one. The best tool for this job (or anything that requires alternation of tasks in perfect lockstep) is a single thread. Also global variables are terrible too."},{"owner":{"profile_image":"https://i.stack.imgur.com/zflGZ.png?s=256&g=1","account_id":440158,"user_type":"registered","user_id":829571,"link":"https://stackoverflow.com/users/829571/assylias","reputation":323231,"display_name":"assylias","accept_rate":94},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760729,"edited":false,"creation_date":1628784998,"comment_id":121520310,"body":"You need some form of synchronization between the two threads, otherwise how would they know when to run and when to wait? Using a boolean is one option."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68746177,"edited":false,"creation_date":1628712818,"comment_id":121498029,"body":"The best way is to use direct access to off-heap memory (see, for example, <a href=\"https://github.com/anatolygudkov/workshops/tree/master/offheap-memory\" rel=\"nofollow noreferrer\">github.com/anatolygudkov/workshops/tree/master/offheap-memor&zwnj;&#8203;y</a>) and make sure you address the memory in sequential manner (cache-friendly) if possible. Also, make sure you share between threads as less memory as possible and the sharing is correct in terms of JMM."},{"owner":{"profile_image":"https://i.stack.imgur.com/DaSIO.jpg?s=256&g=1","account_id":12191330,"user_type":"registered","user_id":8898704,"link":"https://stackoverflow.com/users/8898704/asad-ganiev","reputation":459,"display_name":"Asad Ganiev"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68746177,"edited":false,"creation_date":1628707067,"comment_id":121496058,"body":"How about allocating data to off-heap?"},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1623203402,"comment_id":120009585,"body":"@Holger do you mind posting an answer? I understood your point finally."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/113b0b46b3de42ce4dee28c6006a85c5?s=256&d=identicon&r=PG","account_id":63444,"user_type":"registered","user_id":187808,"link":"https://stackoverflow.com/users/187808/tamas-rev","reputation":7018,"display_name":"Tamas Rev","accept_rate":100},"edited":false,"creation_date":1622833684,"comment_id":119914556,"body":"@TamasRev no you can&#39;t use <code>get</code>. The comments and the initial questions I linked discuss that much broader."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/113b0b46b3de42ce4dee28c6006a85c5?s=256&d=identicon&r=PG","account_id":63444,"user_type":"registered","user_id":187808,"link":"https://stackoverflow.com/users/187808/tamas-rev","reputation":7018,"display_name":"Tamas Rev","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":67825678,"edited":false,"creation_date":1622816357,"comment_id":119907973,"body":"Yes, it is good enough for visibility. I think it&#39;s a bit too much for visibility. For the <code>read()</code> method you can use <code>CHM.get()</code> and live happily ever after."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67825678,"edited":false,"creation_date":1622797003,"comment_id":119899831,"body":"You’re going back to the issue already <a href=\"https://stackoverflow.com/a/67822241/2711488\">explained here</a>. The problem is, what does the caller of <code>read</code> do? It will see “the result of the latest <code>write</code>”, but which write was the latest write? Without any defined order, none may have happen yet and all of them may be running just now, concurrently to the caller of the <code>read</code> method."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 4.0","score":1,"post_id":67825678,"edited":false,"creation_date":1622739725,"comment_id":119884905,"body":"I would consider this to be implied by the thread-safety guarantee."},{"owner":{"profile_image":"https://i.stack.imgur.com/zflGZ.png?s=256&g=1","account_id":440158,"user_type":"registered","user_id":829571,"link":"https://stackoverflow.com/users/829571/assylias","reputation":323231,"display_name":"assylias","accept_rate":94},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621335709,"comment_id":119459227,"body":"@Polcio The problem comes from parts of your code that you have not shown here, so it&#39;s a bit hard to guess what the cause could be. Can you try to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621334753,"comment_id":119458795,"body":"There&#39;s <i>probably</i> a race condition there (it should be an <code>AtomicInteger</code>), but I think it&#39;s unlikely that that causes the problem you describe."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-GLkF4bZir6M/AAAAAAAAAAI/AAAAAAAAAMQ/F902rk_Qd38/photo.jpg?sz=256","account_id":10496819,"user_type":"registered","user_id":7736755,"link":"https://stackoverflow.com/users/7736755/polcio","reputation":3,"display_name":"Polcio"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67584453,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"edited":false,"creation_date":1621334338,"comment_id":119458610,"body":"@JoachimSauer I do have a <code>static</code> field, but it&#39;s only an integer that keeps track of the number of people that have been updated. Every call to scrape() adds 1 to that static integer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a648ccb47bbbe9497c073315aac4d33e?s=256&d=identicon&r=PG","account_id":17835,"user_type":"registered","user_id":40342,"link":"https://stackoverflow.com/users/40342/joachim-sauer","reputation":303905,"display_name":"Joachim Sauer","accept_rate":62},"content_license":"CC BY-SA 4.0","score":1,"post_id":67584453,"edited":false,"creation_date":1621334045,"comment_id":119458456,"body":"Sounds like you have some <code>static</code> fields or maybe <code>ThreadLocal</code> values that get mixed up. Maybe a shared HTTP connection  object? Anything like that. But your question doesn&#39;t contain enough details to know for sure."},{"owner":{"profile_image":"https://i.stack.imgur.com/Losy8.jpg?s=256&g=1","account_id":17020749,"user_type":"registered","user_id":12313402,"link":"https://stackoverflow.com/users/12313402/vijay","reputation":1278,"display_name":"Vijay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64346783,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cH194.png?s=256&g=1","account_id":13960481,"user_type":"registered","user_id":10081874,"link":"https://stackoverflow.com/users/10081874/rishabh-ritweek","reputation":600,"display_name":"Rishabh Ritweek"},"edited":false,"creation_date":1621320757,"comment_id":119452527,"body":"Update from me (@Vijay), we should stop all threads in the onStop() override method. There is no need to run the process if the activity is closed because they are not going to make any changes now."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621285053,"comment_id":119444999,"body":"From the same site: <a href=\"https://www.baeldung.com/java-wait-and-sleep\" rel=\"nofollow noreferrer\">Wait and sleep</a> and <a href=\"https://www.baeldung.com/java-thread-safety\" rel=\"nofollow noreferrer\">Thread safety</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284956,"comment_id":119444961,"body":"@kidfrom read my comment above, wait() releases the lock, so it actually breaks the synchronized method in two parts, ergo it&#39;s no longer atomic and no longer thread safe. That&#39;s it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":3,"post_id":67576652,"edited":false,"creation_date":1621284827,"comment_id":119444915,"body":"I would say it&#39;s just a really bad example - or at least, a very poorly explained one. If they&#39;d used <code>Thread.sleep</code>, it would still be safe. To use <code>Object.wait</code> <i>without explaining that that effectively splits the synchronized method into two synchronized blocks</i> is really poor IMO :("},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"edited":false,"creation_date":1621284670,"comment_id":119444864,"body":"@Rocco I am refering to Baeldung.com, please kindly check the article I have attached above, it has a chance of thread interleaving, it demonstrate it by using <code>Object.wait(100)</code> without actually explaining further."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284525,"comment_id":119444831,"body":"@kidfrom the synchronized code without the wait <b>is</b> thread-safe, why do you say it&#39;s not?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"edited":false,"creation_date":1621284275,"comment_id":119444727,"body":"@akuzminykh My bad, I have updated the post. The expected result is 10 because the unit test execute the <code>Counter.increment()</code> 10 times."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"edited":false,"creation_date":1621284190,"comment_id":119444690,"body":"@JonSkeet I think Baeldung.com is trying to explain about synchronized keyword does not always mean thread safe method. Do you happen know how to explain why this code is not thread safe, without the <code>Object.wait()</code>?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621284154,"comment_id":119444678,"body":"Why should the result be 2? What does &quot;fail&quot; mean to you?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"edited":false,"creation_date":1621284023,"comment_id":119444631,"body":"@JonSkeet from my understanding, updating the count value require 3 operations. <code>read</code>, <code>increment</code>, <code>write</code>. The <code>Object.wait()</code> and <code>Thread.sleep()</code> is to force the <code>increment</code> and <code>write</code> operations to be executed at a later time. Upon closer inspection, <code>Thread.sleep()</code> does not release the lock while <code>Object.wait()</code> does release the lock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67576652,"edited":false,"creation_date":1621283673,"comment_id":119444537,"body":"Wait releases the monitor, so you read count first, then release the monitor, in the 100ms some other thread can enter the synchronized code and read count. Just to clarify, wait is not a pausing method."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=256&d=identicon&r=PG","account_id":11683,"user_type":"registered","user_id":22656,"link":"https://stackoverflow.com/users/22656/jon-skeet","reputation":1438219,"display_name":"Jon Skeet","accept_rate":86},"content_license":"CC BY-SA 4.0","score":1,"post_id":67576652,"edited":false,"creation_date":1621283579,"comment_id":119444504,"body":"Can you describe what you understand <code>wait()</code> to do, exactly? In particular, have you thought about the difference between <code>Object.wait()</code> and <code>Thread.sleep</code>?"},{"owner":{"profile_image":"https://graph.facebook.com/1156441754401375/picture?type=large","account_id":9122040,"user_type":"registered","user_id":6787187,"link":"https://stackoverflow.com/users/6787187/alpit-anand","reputation":1213,"display_name":"Alpit Anand","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":67572673,"edited":false,"creation_date":1621265588,"comment_id":119437337,"body":"Got it. :-D, please do write in answer section."},{"owner":{"profile_image":"https://graph.facebook.com/1156441754401375/picture?type=large","account_id":9122040,"user_type":"registered","user_id":6787187,"link":"https://stackoverflow.com/users/6787187/alpit-anand","reputation":1213,"display_name":"Alpit Anand","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":67572673,"edited":false,"creation_date":1621265502,"comment_id":119437296,"body":"Ok, so you are suggesting, just a single object of arc would do the trick ?"},{"owner":{"profile_image":"https://i.stack.imgur.com/QT3fG.png?s=256&g=1","account_id":2709823,"user_type":"registered","user_id":2338547,"link":"https://stackoverflow.com/users/2338547/markspace","reputation":10716,"display_name":"markspace"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67572673,"edited":false,"creation_date":1621265496,"comment_id":119437292,"body":"These are different objects, so the lock is different and each thread acquires its own (different) lock.  You&#39;ll need to lock something in common if you want them to work sequentially."},{"owner":{"profile_image":"https://i.stack.imgur.com/M84sB.png?s=256&g=1","account_id":16503230,"user_type":"registered","user_id":11923999,"link":"https://stackoverflow.com/users/11923999/burak-serdar","reputation":48083,"display_name":"Burak Serdar"},"content_license":"CC BY-SA 4.0","score":4,"post_id":67572673,"edited":false,"creation_date":1621265465,"comment_id":119437281,"body":"A <code>synchronized</code> method will acquire the lock on the instance. You have two separate instances of <code>Arc</code>, so the two threads acquire locks on two separate objects."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"edited":false,"creation_date":1621254544,"comment_id":119431760,"body":"@MarkRotteveel Even if I don&#39;t run listenerThreadUDP and put it in the queue, the timing is wrong."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 4.0","score":1,"post_id":67566923,"edited":false,"creation_date":1621247849,"comment_id":119429003,"body":"Consider using a <code>LinkedBlockingQueue</code> or <code>ArrayBlockingQueue</code> instead, those allow you to block waiting for an element."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621247209,"comment_id":119428741,"body":"Processing objects in listeners takes quite a long time, and I need a very accurate arrival time of the object"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621246382,"comment_id":119428343,"body":"Why? Why not do it all in one thread? What benefit are you deriving from the second thread and the queue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ac0a06c961f3af17dca9b69fce42201?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8517137,"user_type":"registered","user_id":6385232,"link":"https://stackoverflow.com/users/6385232/geanakuch","reputation":835,"display_name":"geanakuch"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67566923,"edited":false,"creation_date":1621244229,"comment_id":119427431,"body":"You probably shouldn&#39;t be using <code>Thread::sleep</code> at all. Try and use <code>wait</code> and <code>notify</code> instead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197514,"edited":false,"creation_date":1621226979,"comment_id":119421761,"body":"Your title doesn&#39;t agree with your question. Please clarify."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=256","account_id":15064163,"user_type":"registered","user_id":10871900,"link":"https://stackoverflow.com/users/10871900/dan1st-is-crying","reputation":13516,"display_name":"dan1st is crying"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67477822,"edited":false,"creation_date":1620731151,"comment_id":119281458,"body":"Also note that the <code>toString()</code> method might create a new String each time so using this for synchronisation is not safe."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2a352f3db748629d8bd227d825f89240?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11953108,"user_type":"registered","user_id":8746228,"link":"https://stackoverflow.com/users/8746228/adarsh","reputation":1423,"display_name":"adarsh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67477822,"edited":false,"creation_date":1620728492,"comment_id":119280272,"body":"<a href=\"https://dzone.com/articles/synchronized-by-the-value-of-the-object-in-java\" rel=\"nofollow noreferrer\">This</a> may help."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":2,"post_id":67477822,"edited":false,"creation_date":1620720297,"comment_id":119276845,"body":"If you have multiple machines accessing the same account id, you can&#39;t use synchronized because you can only synchronized within a single JVM. So it will not prevent different JVM&#39;s from accessing the same account."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":5,"post_id":67477822,"edited":false,"creation_date":1620684043,"comment_id":119268820,"body":"<code>synchronized</code> is useless in a server environment, because it only constrains a single copy of your application. Transactions are how you ensure consistency with multiple instances."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":2,"post_id":67477822,"edited":false,"creation_date":1620683274,"comment_id":119268590,"body":"What you <i>usually</i> need is <code>@Transactional</code>."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-hqwHmWigIJo/AAAAAAAAAAI/AAAAAAAAANk/Nt-fGNNCYUs/photo.jpg?sz=256","account_id":7326250,"user_type":"registered","user_id":5580567,"link":"https://stackoverflow.com/users/5580567/stanislav-orlov","reputation":234,"display_name":"Stanislav Orlov"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485755,"edited":false,"creation_date":1618169734,"comment_id":118515113,"body":"In JDK 11.0.10 this bug is now in httpserver, fix with jdk.tls.disabledAlgorithms=TLSv1.3 helps when server thread is stucked at doClosure() after each new client&#39;s request before previous request was finished"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a1012f8368ea61afa24e1f90ca65363c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20444761,"user_type":"registered","user_id":15000817,"link":"https://stackoverflow.com/users/15000817/george","reputation":116,"display_name":"George"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66472876,"edited":false,"creation_date":1614853940,"comment_id":117514469,"body":"This is a complex topic and it&#39;s easy to get lost. Here&#39;s how I would approach it: - read and understand the basic idea (your favorite documentation/example site) - write some code, play with something in a multi threaded way (here you&#39;ll most likely hit issues and that is  a good spot to start searching for answers and learning more) - once you have something running, read more about threads, issues with them and pitfalls By the time you get here you should have answered your question already.  Check out: <a href=\"https://docs.oracle.com/javase/specs/jls/se15/html/jls-17.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/specs/jls/se15/html/jls-17.html</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dd071a6a7c97ba637c558c5e71137c7b?s=256&d=identicon&r=PG","account_id":332245,"user_type":"registered","user_id":657427,"link":"https://stackoverflow.com/users/657427/christophe-roussy","reputation":16487,"display_name":"Christophe Roussy","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":66472876,"edited":false,"creation_date":1614852925,"comment_id":117513977,"body":"You mean how the JVM does it ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":1,"post_id":66472876,"edited":false,"creation_date":1614852781,"comment_id":117513918,"body":"I can&#39;t help but feel like you&#39;re worrying about the wood and not seeing the trees. Have you tried using them? What were the practical problems you encountered?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8887b6449cf1ee169bfafa91d8348110?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14554565,"user_type":"registered","user_id":12682179,"link":"https://stackoverflow.com/users/12682179/jon-b","reputation":61,"display_name":"Jon B"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614787300,"comment_id":117492851,"body":"Studying for an exam, so clearing the theoretical concepts"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=256&d=identicon&r=PG","account_id":1111280,"user_type":"registered","user_id":1101692,"link":"https://stackoverflow.com/users/1101692/shark","reputation":6531,"display_name":"Shark","accept_rate":89},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614787139,"comment_id":117492767,"body":"... what are you trying to achieve?"},{"owner":{"profile_image":"https://i.stack.imgur.com/oyNTO.jpg?s=256&g=1","account_id":5940172,"user_type":"registered","user_id":4671717,"link":"https://stackoverflow.com/users/4671717/chris-maggiulli","reputation":3457,"display_name":"Chris Maggiulli","accept_rate":25},"content_license":"CC BY-SA 4.0","score":0,"post_id":66460441,"edited":false,"creation_date":1614786862,"comment_id":117492638,"body":"This question is better suited for software engineering stack exchange"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":66452567,"edited":false,"creation_date":1614778512,"comment_id":117488306,"body":"It’s not as simple as it looks on the first glance."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":0,"post_id":66452567,"edited":false,"creation_date":1614759400,"comment_id":117479793,"body":"Why would it be finalized if you store it in the ThreadLocal? You&#39;ve stored it somewhere that is still reachable (because <code>Foo</code> is still loaded). If you store a string in the ThreadLocal, you&#39;re not storing the Bar, so it is unreachable and can be gc&#39;d."},{"owner":{"profile_image":"https://i.stack.imgur.com/49VtI.jpg?s=256&g=1","account_id":7926575,"user_type":"registered","user_id":5985853,"link":"https://stackoverflow.com/users/5985853/alexey-soshin","reputation":16936,"display_name":"Alexey Soshin"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65411185,"edited":false,"creation_date":1608824786,"comment_id":115695735,"body":"This is, in fact, a difficult problem to solve, since threads in JVM in general are cooperative."},{"owner":{"profile_image":"https://i.stack.imgur.com/RKSgV.png?s=256&g=1","account_id":2485939,"user_type":"registered","user_id":2164365,"link":"https://stackoverflow.com/users/2164365/abra","reputation":19426,"display_name":"Abra","accept_rate":40},"content_license":"CC BY-SA 4.0","score":1,"post_id":65407356,"edited":false,"creation_date":1608636528,"comment_id":115638234,"body":"Have you read <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html\" rel=\"nofollow noreferrer\">Concurrency in Swing</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/af0f9bfe593f36642a032cd7ea611e7d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8532578,"user_type":"registered","user_id":6395627,"link":"https://stackoverflow.com/users/6395627/slaw","reputation":39918,"display_name":"Slaw"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608598197,"comment_id":115627784,"body":"Not necessarily related to your problem, but note the thread which actually performs the I/O is never stopped even when a timeout occurs."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/958fe700d57780eb1cc28b93796bbf69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13521732,"user_type":"registered","user_id":9754736,"link":"https://stackoverflow.com/users/9754736/scroll","reputation":158,"display_name":"Scroll"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608575807,"comment_id":115620674,"body":"After restarting the task I get new data in file that getting though the circuit board connected by usb. And sometimes circuit board does not fulfill the file with new bytes and file is empty that’s why I want to wait for 5 seconds."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=256&d=identicon&r=PG","account_id":36137,"user_type":"registered","user_id":102937,"link":"https://stackoverflow.com/users/102937/robert-harvey","reputation":178799,"display_name":"Robert Harvey","accept_rate":90},"content_license":"CC BY-SA 4.0","score":1,"post_id":65396228,"edited":false,"creation_date":1608573660,"comment_id":115619829,"body":"If you&#39;re just running threads in series, you don&#39;t need threads; you can just call each method and let them block."},{"owner":{"profile_image":"https://i.stack.imgur.com/QT3fG.png?s=256&g=1","account_id":2709823,"user_type":"registered","user_id":2338547,"link":"https://stackoverflow.com/users/2338547/markspace","reputation":10716,"display_name":"markspace"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65396228,"edited":false,"creation_date":1608568122,"comment_id":115617251,"body":"Yes, multiple cores help, but not if the entire process blocks and only one thread can execute at a time.  That obviously does nothing to complete faster.  What you are after is parallelism, and it&#39;s not automatic when using multiple threads.  Look up <a href=\"https://en.wikipedia.org/wiki/Amdahl%27s_law\" rel=\"nofollow noreferrer\">Amdahl&#39;s Law.</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65396228,"edited":false,"creation_date":1608567552,"comment_id":115616989,"body":"It helps in situations where several tasks can work independently without synchronization."},{"owner":{"profile_image":"https://i.stack.imgur.com/rkpYv.jpg?s=256&g=1","account_id":2819940,"user_type":"registered","user_id":2423906,"link":"https://stackoverflow.com/users/2423906/sedj601","reputation":12538,"display_name":"SedJ601","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608566854,"comment_id":115616649,"body":"Why would you want to restart reading a file if the complete file has not been read within five seconds? If the file read did not complete within five seconds of the first attempt, what are the chances of it completed in five seconds any attempt after that?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/958fe700d57780eb1cc28b93796bbf69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13521732,"user_type":"registered","user_id":9754736,"link":"https://stackoverflow.com/users/9754736/scroll","reputation":158,"display_name":"Scroll"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393125,"edited":false,"creation_date":1608564422,"comment_id":115615487,"body":"@Joe Thanks for your answer. May JavaFx has a better way to realize timeout for task without CompletableFuture?"},{"owner":{"profile_image":"https://i.stack.imgur.com/2VjzX.jpg?s=256&g=1","account_id":6696437,"user_type":"registered","user_id":5164318,"link":"https://stackoverflow.com/users/5164318/emandt","reputation":2557,"display_name":"emandt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65393915,"edited":false,"creation_date":1608563271,"comment_id":115614952,"body":"You didn&#39;t post &quot;postRequest()&quot; code, so it&#39;s not easy to understand when you run &quot;notify()&quot;. Also there isn&#39;t any &quot;WHILE&quot; so where do you do the iteration? However your solution seems wrong because &quot;dialog&quot; seems an UI element and MUST BE NOT accessed from the &quot;doInBackground()&quot; directly. Please add &quot;postRequest()&quot; code"},{"owner":{"user_type":"does_not_exist","display_name":"user2670200"},"content_license":"CC BY-SA 4.0","score":1,"post_id":65393125,"edited":false,"creation_date":1608561706,"comment_id":115614208,"body":"the word &quot;Future&quot; says literally IN THE FUTURE and NOT JET and that is the reason why &quot;it skips read data code and falls to try block right away&quot;. Maybe this thread here can help you out of the maze <a href=\"https://stackoverflow.com/questions/34233375/return-completablefuturevoid-or-completablefuture\" title=\"return completablefuturevoid or completablefuture\">stackoverflow.com/questions/34233375/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/ayujB.jpg?s=256&g=1","account_id":70123,"user_type":"registered","user_id":203657,"link":"https://stackoverflow.com/users/203657/kleopatra","reputation":51175,"display_name":"kleopatra","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608550508,"comment_id":115609370,"body":"a) use fx concurrency/animation support b) whatever you use, you <b>must not</b> update nodes (nor any of their properties) off the fx application thread c) when asking for debugging help, please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> demonstrating what&#39;s not working as expected"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608548743,"comment_id":115608543,"body":"Also to avoid the exception when doing something from a different thread might be avoided if you put the changing code inside <code>Platform.runLater(new Runnable(){ &#47;* ... *&#47; });</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391501,"edited":false,"creation_date":1608548650,"comment_id":115608506,"body":"Welcome to SO. You might be able to use a stopwatch like <code>org.apache.commons.lang.time.StopWatch</code> (documentation: <a href=\"https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/StopWatch.html\" rel=\"nofollow noreferrer\">commons.apache.org/proper/commons-lang/apidocs/org/apache/&hellip;</a>)&zwnj;&#8203;. Start it when your application starts, and use getTime to get the time. I am not sure if there is a porperty to bind to or not."},{"owner":{"profile_image":"https://i.stack.imgur.com/ayujB.jpg?s=256&g=1","account_id":70123,"user_type":"registered","user_id":203657,"link":"https://stackoverflow.com/users/203657/kleopatra","reputation":51175,"display_name":"kleopatra","accept_rate":53},"content_license":"CC BY-SA 4.0","score":1,"post_id":65344341,"edited":false,"creation_date":1608247748,"comment_id":115532926,"body":"java naming conventions please"},{"owner":{"profile_image":"https://i.stack.imgur.com/cH194.png?s=256&g=1","account_id":13960481,"user_type":"registered","user_id":10081874,"link":"https://stackoverflow.com/users/10081874/rishabh-ritweek","reputation":600,"display_name":"Rishabh Ritweek"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64346783,"edited":false,"creation_date":1602652831,"comment_id":113784855,"body":"post the error stack trace"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601640199,"comment_id":113475855,"body":"Yes, just spinning off threads is bad. You would use an executor service of some sort and submit tasks. The problem with locks, is they don&#39;t offer any order. All of the threads get to the lock and wait. When it is free, any one of the threads grab it. The way I have set it up, it says, task A is ready, then it says taskB is ready. I don&#39;t using a queue changes your code that much. I rewrote it because it was easier for me, but you just need to apply the concept."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1601635627,"comment_id":113474126,"body":"@matt 1 code with tryLock is bad, I saw a lock there. I was told that it is better not to rewrite the code too much. There should be 2 streams to output AAGGGA. The option with a queue is interesting, but you have to rewrite everything, does not quite meet the requirements of the task. Or I misunderstood you?"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1601635611,"comment_id":113474120,"body":"@matt 10 threads I was trying to create a situation of increasing load to see if threads are blocked or not. I&#39;ve tried 10 to 10,000 to make sure threads are blocking correctly, but might this be a bad way?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601628642,"comment_id":113471481,"body":"Why are you starting 10 threads? You don&#39;t really have any flow control regarding who grabs the lock again when their free. Also note that your two lock loop, it is very likely that one thread will grab a lock, and then another thread will grab the other lock then they&#39;ll never break out of that loop. This has to do with the locking order."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-9Oq4xYfjb_s/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckBcBhc1Nx8LCzDot0Uj7PK1q4Dcg/photo.jpg?sz=256","account_id":19640045,"user_type":"registered","user_id":14376373,"link":"https://stackoverflow.com/users/14376373/%d0%94%d0%b0%d1%80%d1%8c%d1%8f-%d0%9a%d0%be%d1%81%d1%82%d1%8f%d0%ba%d0%be%d0%b2%d0%b0","reputation":1,"display_name":"Дарья Костякова"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ffbf4ec8b9cd473633dcd91ae792647?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12223265,"user_type":"registered","user_id":8921755,"link":"https://stackoverflow.com/users/8921755/ivan","reputation":8608,"display_name":"Ivan"},"edited":false,"creation_date":1601620924,"comment_id":113468651,"body":"@Ivan i tried tryLock with timeout but the problem remains in the loop. If I run it, everything will go to sleep. Apparently I do not quite understand how to implement this correctly"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d408dc90321b7207a17d46e0832b43df?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12458416,"user_type":"registered","user_id":9070798,"link":"https://stackoverflow.com/users/9070798/patrick","reputation":1488,"display_name":"Patrick"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601609432,"comment_id":113466324,"body":"Welcome to StackOverflow! &quot;if you call the threads, it will work, but if you call the threads into a loop, everything collapses&quot;.  Could you edit your question to include the code where you call threads into a loop? This would help us distinguish the situations that work/don&#39;t work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ffbf4ec8b9cd473633dcd91ae792647?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12223265,"user_type":"registered","user_id":8921755,"link":"https://stackoverflow.com/users/8921755/ivan","reputation":8608,"display_name":"Ivan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601607348,"comment_id":113466007,"body":"To avoid deadlocks you need to take locks on objects in the same order in all threads like first take lock on an object with smaller hashcode. Or you can use implementation of <code>Lock</code> interface and method <code>tryLock</code> with timeout"},{"owner":{"profile_image":"https://i.stack.imgur.com/vJbKg.jpg?s=256&g=1","account_id":288696,"user_type":"registered","user_id":589259,"link":"https://stackoverflow.com/users/589259/maarten-bodewes","reputation":91230,"display_name":"Maarten Bodewes","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":64163535,"edited":false,"creation_date":1601589889,"comment_id":113462751,"body":"The language barrier is one thing, but it would be nice if you could post a MCVE and indicate the exact errors / situations that you are encountering. &quot;everything collapses&quot; and &quot;we don&#39;t have what we need&quot; are not all that helpful."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-ASSuy8DNx_M/AAAAAAAAAAI/AAAAAAAAAFY/as99ZogPzR8/photo.jpg?sz=256","account_id":14766420,"user_type":"registered","user_id":10664313,"link":"https://stackoverflow.com/users/10664313/pourya-pourbagheri","reputation":11,"display_name":"Pourya Pourbagheri"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64147000,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/46c472a2ce6b7b2b680057df5143a62e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19382678,"user_type":"registered","user_id":14173556,"link":"https://stackoverflow.com/users/14173556/paladin","reputation":774,"display_name":"paladin"},"edited":false,"creation_date":1601551094,"comment_id":113445999,"body":"@paladin thanks, this made it a lot easier."},{"owner":{"profile_image":"https://i.stack.imgur.com/72UnO.png?s=256&g=1","account_id":5553464,"user_type":"registered","user_id":4405757,"link":"https://stackoverflow.com/users/4405757/thiyagu","reputation":17547,"display_name":"Thiyagu","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":64150330,"edited":false,"creation_date":1601536823,"comment_id":113439939,"body":"Why do you need both a semaphore and a fixed thread pool? Wouldn&#39;t having a thread pool of size <code>C</code> and submitting all tasks (<code>Q*N</code> tasks) be sufficient?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/46c472a2ce6b7b2b680057df5143a62e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19382678,"user_type":"registered","user_id":14173556,"link":"https://stackoverflow.com/users/14173556/paladin","reputation":774,"display_name":"paladin"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64147000,"edited":false,"creation_date":1601512417,"comment_id":113434533,"body":"Using &quot;sub images&quot; is indeed most times the best way to handle this. But instead of some real sub images, like 4 quarter images, you better use a &quot;scan-line interleave&quot; method, meaning each thread calculates another line of the image. For example, you have 4 threads, so thread 1 calculates line (1 + 4*n), thread 2 calculates line (2 + 4*n), thread 3 calculates line (3 + 4*n), thread 4 calculates line (4 + 4*n), where n is a natural number (inclusive zero). Java has a large number of image manipulating methods aiding in your task."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/16b7172bb346958c1b69e0229ba1ac4f?s=256&d=identicon&r=PG","account_id":1723085,"user_type":"registered","user_id":1578356,"link":"https://stackoverflow.com/users/1578356/newday","reputation":3842,"display_name":"newday","accept_rate":63},"content_license":"CC BY-SA 4.0","score":0,"post_id":64112611,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/GzStD.jpg?s=256&g=1","account_id":3666831,"user_type":"registered","user_id":3055036,"link":"https://stackoverflow.com/users/3055036/dukekosy","reputation":61,"display_name":"dukekosy"},"edited":false,"creation_date":1601501903,"comment_id":113432046,"body":"The test was done without the collector that uses the response."},{"owner":{"profile_image":"https://i.stack.imgur.com/GzStD.jpg?s=256&g=1","account_id":3666831,"user_type":"registered","user_id":3055036,"link":"https://stackoverflow.com/users/3055036/dukekosy","reputation":61,"display_name":"dukekosy"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64112611,"edited":false,"creation_date":1601498298,"comment_id":113430763,"body":"you&#39;re iterating the list twice. try removing the collector and streaming once."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bdfb4dab635798f20b7ab172df2b3f4e?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":12583055,"user_type":"registered","user_id":9732672,"link":"https://stackoverflow.com/users/9732672/nomadmaker","reputation":447,"display_name":"NomadMaker"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64141492,"edited":false,"creation_date":1601482607,"comment_id":113424256,"body":"The parent class or parent thread? These are different."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"edited":false,"creation_date":1601461073,"comment_id":113413364,"body":"@Conffusion I have updated the example in my question. Please look into that that is executing one by one not simultaneously"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601460784,"comment_id":113413229,"body":"yes, and the success of it will depend also on how thread safe <code>bulkMailSender</code> is because it is instantiated outside your method so can potentially be shared by .multiple threads."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"edited":false,"creation_date":1601460660,"comment_id":113413162,"body":"@Conffusion you mean if two requests comes to my method then it will execute both simultaneously?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64134839,"edited":false,"creation_date":1601460389,"comment_id":113413042,"body":"every application that wants to access this method will create a new thread. So you don&#39;t have to instantiate threads upfront. If you want to limit the number of parallel threads you need to setup a queue and a threadpool."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"edited":false,"creation_date":1601459686,"comment_id":113412709,"body":"@Henry Ok my issue is if we know how many threads are going to access my application then I can call directly with <code>Thread t1 = new Thread(new MagicTask());</code> t1.start();. If we dont know how to call that method with different threads?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601459547,"comment_id":113412636,"body":"I don&#39;t understand your problem. Just call <code>sendMail</code> from different threads and it will be executed in parallel."},{"owner":{"profile_image":"https://i.stack.imgur.com/7ghSp.jpg?s=256&g=1","account_id":238684,"user_type":"registered","user_id":507738,"link":"https://stackoverflow.com/users/507738/mc-emperor","reputation":22543,"display_name":"MC Emperor","accept_rate":71},"content_license":"CC BY-SA 4.0","score":0,"post_id":64134839,"edited":false,"creation_date":1601459535,"comment_id":113412632,"body":"Regarding your question – what exactly is the issue you are facing? Is there something not working? Do you encounter exceptions thrown?"},{"owner":{"profile_image":"https://i.stack.imgur.com/7ghSp.jpg?s=256&g=1","account_id":238684,"user_type":"registered","user_id":507738,"link":"https://stackoverflow.com/users/507738/mc-emperor","reputation":22543,"display_name":"MC Emperor","accept_rate":71},"content_license":"CC BY-SA 4.0","score":1,"post_id":64134839,"edited":false,"creation_date":1601459351,"comment_id":113412523,"body":"Note that <code>if(!dto.isEmpty())</code> is unnecessary, because the enhanced <code>for</code> loop here already implies that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2024ec11c96392f88d503af55dcf6914?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19130937,"user_type":"registered","user_id":13972844,"link":"https://stackoverflow.com/users/13972844/hung-vu","reputation":483,"display_name":"Hung Vu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64001620,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"edited":false,"creation_date":1600794945,"comment_id":113198495,"body":"@Henry As you said, the standard seems to be 60 fps as in <a href=\"https://developer.android.com/topic/performance/vitals/render\" rel=\"nofollow noreferrer\">Android documentation</a>. However, the main point of my question is about determining the workload and threshold of main thread.   As my example shown, only the inclusion of two lines in <code>onBtnClick</code> is enough to make a change in rendering performance, even nothing is calling them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=256&d=identicon&r=PG","account_id":2006972,"user_type":"registered","user_id":1796579,"link":"https://stackoverflow.com/users/1796579/henry","reputation":43182,"display_name":"Henry"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64001620,"edited":false,"creation_date":1600745802,"comment_id":113176801,"body":"Basically, everything that takes longer than 16ms (one frame) is too much."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597166396,"comment_id":112043282,"body":"use CompletableFuture.allOf(dependedentTasks).thenRunAsync()."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597150326,"comment_id":112034838,"body":"&quot;only after the dependent Task are executed&quot; - are you sure? Usually dependent Tasks are executed after independed."},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597150077,"comment_id":112034706,"body":"if  Task-C dependends on task Task-B, then it probably wants to use some value computed by Task-B, right? Why don&#39;t you ask how to pass that value?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ampOo.jpg?s=256&g=1","account_id":17033694,"user_type":"registered","user_id":12323248,"link":"https://stackoverflow.com/users/12323248/akuzminykh","reputation":4572,"display_name":"akuzminykh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597138775,"comment_id":112029361,"body":"So before the root of the tree can be executed, its children have to be executed first? Or is it the other way around?"},{"owner":{"profile_image":"https://i.stack.imgur.com/qDozH.jpg?s=256&g=1","account_id":5126886,"user_type":"registered","user_id":4108590,"link":"https://stackoverflow.com/users/4108590/ravindra-ranwala","reputation":20904,"display_name":"Ravindra Ranwala","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":63354899,"edited":false,"creation_date":1597137411,"comment_id":112028771,"body":"Well, what is the question?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"edited":false,"creation_date":1589171547,"comment_id":109176709,"body":"As it is a <code>BufferedWriter</code> you also need to call <code>flush()</code> after the newline."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-kZ6I3Z1pZR4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb_NhR3Q7JgAnrbJvIajAMxUXMGTg/mo/photo.jpg?sz=256","account_id":15183229,"user_type":"registered","user_id":10955997,"link":"https://stackoverflow.com/users/10955997/siddharth-teli","reputation":107,"display_name":"Siddharth Teli"},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"edited":false,"creation_date":1589115672,"comment_id":109158946,"body":"@user207421 I have added write.newLine() but it still doesn&#39;t work ."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61711333,"edited":false,"creation_date":1589112411,"comment_id":109157693,"body":"As usual. You are reading lines but you aren&#39;t writing lines. Add a line terminator when sending the message."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197514,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VgOZI.png?s=256&g=1","account_id":85671,"user_type":"registered","user_id":238704,"link":"https://stackoverflow.com/users/238704/president-james-k-polk","reputation":40858,"display_name":"President James K. Polk"},"edited":false,"creation_date":1588322592,"comment_id":108857329,"body":"@PresidentJamesMoveonPolk Clearly not. You don&#39;t need anything more than a connecting client here. It doesn&#39;t have to do anything else. Telnet would do."},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553510233,"comment_id":97396818,"body":"@MahmoudBenHassine I&#180;ve opened the next ticket: <a href=\"https://jira.spring.io/browse/BATCH-2801\" rel=\"nofollow noreferrer\">jira.spring.io/browse/BATCH-2801</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1553005917,"comment_id":97219862,"body":"As mentioned, I&#39;m not sure neither. I tried to reproduce the case before answering but I don&#39;t know yet if this is s bug in spring batch or an issue with your configuration. I will try my best to dig deeper asap. In all cases, you can open an issue in JIRA so that we don&#39;t forget to tackle it :-)"},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553004976,"comment_id":97219205,"body":"@MahmoudBenHassine  It is very difficult to me to know if the problem is a Spring Batch bug or a problem that is causing the concurrency of threads. I dont have much experience debugging multi-thread. I think the multi-thread is well designed but I&#39;m not 100% sure. Could you give me your personal opinion about it?My apologies, but I need much more practice to be able to assess whether it is a Spring Batch bug or not. Thanks."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1553004274,"comment_id":97218718,"body":"Here is the JIRA instance for the project: <a href=\"https://jira.spring.io/projects/BATCH\" rel=\"nofollow noreferrer\">jira.spring.io/projects/BATCH</a>. You need to create an account then open a new issue. Please do open an issue only if you are sure it is actually a bug, in which case please provide a failing test. FYI, we are planning to migrate issues from JIRA to github later this year (but that&#39;s a plan, not a commitment), so you will be able at some point to open issues directly on github."},{"owner":{"profile_image":"https://i.stack.imgur.com/z7Bck.jpg?s=256&g=1","account_id":13566844,"user_type":"registered","user_id":9786749,"link":"https://stackoverflow.com/users/9786749/un0tec","reputation":180,"display_name":"un0tec"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"edited":false,"creation_date":1553002918,"comment_id":97217839,"body":"@MahmoudBenHassine Thanks for answering. I have tried to find the reason why isnt respecting the maxitemcounter, but I cannot find it. In the meanwhile, I will try to use other ways to get partitioned, for example, sharing the large file into smaller ones and using multiresource. Could you tell me how I can open a Jira ticket to expose the problem? Thanks in advance."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":0,"post_id":55227133,"edited":false,"creation_date":1552987572,"comment_id":97208015,"body":"I was able to reproduce the case (see <a href=\"https://github.com/benas/sandbox/blob/master/so55227133/output.txt\" rel=\"nofollow noreferrer\">this repo</a>). However, I can&#39;t see why the second thread is not respecting the <code>maxItemCount</code>. I need to dig deeper to investigate what&#39;s happening behind the scene. In the meantime, if you didn&#39;t find an answer and believe it is a bug, please open a ticket in JIRA and we will plan if for a future release."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8554ce4e2c007be9ccebcc8389704470?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6241436,"user_type":"registered","user_id":4854931,"link":"https://stackoverflow.com/users/4854931/alex78191","reputation":2512,"display_name":"Alex78191","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":877096,"edited":false,"creation_date":1551120567,"comment_id":96515768,"body":"Now you can use <code>Consumer&lt;T&gt;</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7873b837674aa1eff075f26872c0eacd?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5762640,"user_type":"registered","user_id":4548520,"link":"https://stackoverflow.com/users/4548520/user25","reputation":2957,"display_name":"user25","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":37437037,"edited":false,"creation_date":1551043353,"comment_id":96484870,"body":"What is the point of using thread, service to load something later? You don&#39;t need all that stuff when user opens your app? This doesn&#39;t make sense. Just you splash screen and that&#39;s all. Even official Google apps do it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":2,"post_id":54485755,"edited":false,"creation_date":1550003912,"comment_id":96108063,"body":"see <a href=\"https://bugs.openjdk.java.net/browse/JDK-8217094\" rel=\"nofollow noreferrer\">bugs.openjdk.java.net/browse/JDK-8217094</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485755,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"edited":false,"creation_date":1549621520,"comment_id":95976971,"body":"@kantianethics any clue what exactly causes this issue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":5,"post_id":54485755,"edited":false,"creation_date":1549217280,"comment_id":95815494,"body":"This issue is fixed in JDK 13 b04; I was using an earlier build."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/533c7b2a9a184acbd7b86b44d042d555?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":9193952,"user_type":"registered","user_id":6833372,"link":"https://stackoverflow.com/users/6833372/kantianethics","reputation":671,"display_name":"kantianethics","accept_rate":57},"content_license":"CC BY-SA 4.0","score":1,"post_id":54485755,"edited":false,"creation_date":1549182587,"comment_id":95806630,"body":"I can reproduce this on Mac on JDK 13 with just a blocking HttpClient::send followed by a Thread.sleep(Long.MAX_VALUE). Changing TLS did nothing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"edited":false,"creation_date":1531715302,"comment_id":89681579,"body":"I&#39;m observing long running requests in a web application. Threaddumps point at native classloading methods.  My question in <a href=\"https://stackoverflow.com/questions/49507981/unsafe-defineclass-hangs-slow-reflection-calls\" title=\"unsafe defineclass hangs slow reflection calls\">stackoverflow.com/questions/49507981/&hellip;</a> lead to this tooling issue."},{"owner":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"edited":false,"creation_date":1531609619,"comment_id":89661366,"body":"Why do you want <code>-m</code> mode? If you are interested in non-Java stack, then <code>gdb</code> should be a better tool for this."},{"owner":{"profile_image":"https://i.stack.imgur.com/54njx.png?s=256&g=1","account_id":4210603,"user_type":"registered","user_id":3448419,"link":"https://stackoverflow.com/users/3448419/apangin","reputation":94386,"display_name":"apangin"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49516601,"edited":false,"creation_date":1531609518,"comment_id":89661351,"body":"This can be either a bug in HotSpot Serviceability Agent or an attempt to get a stacktrace while JVM is in inconsistent state. In both cases you can hardly do anything about it."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"edited":false,"creation_date":1530083786,"comment_id":89103809,"body":"@Seelenvirtuose Thank you, I&#39;ve already feared that it&#39;s not normal behaviour. I will <b>reinstall eclipse</b> and see what it brings."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51055780,"edited":false,"creation_date":1530083587,"comment_id":89103682,"body":"Ok. This is weird. Obviously both threads are terminated, but the application is still running. That might be an issue of Eclipse but it might also be an issue of the Java VM. Maybe a reinstall will help here. <i>This is not normal behavior and has nothing to do with your Java code.</i>"},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"edited":false,"creation_date":1530083051,"comment_id":89103410,"body":"@Seelenvirtuose The thing is, I ran it exactly like described with nothing going on in the <code>run()</code>-method and nothing else in the <code>main</code>-method and the issue still exists. I will edit my post and add a screenshot of the running thread, maybe it&#39;s better understandable afterwards."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51055780,"edited":false,"creation_date":1530082859,"comment_id":89103322,"body":"@DavidStuder In your example, no thread (neither the main thread nor the other started thread) is running. This program directly terminates. Maybe you simplfied your code too much. Look at my examples to get an idea. Otherwise please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5359684119625d3f23eca684d7f83f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11147483,"user_type":"registered","user_id":8181750,"link":"https://stackoverflow.com/users/8181750/l-spillner","reputation":1772,"display_name":"L.Spillner"},"edited":false,"creation_date":1530082508,"comment_id":89103146,"body":"@L.Spillner the state of the started thread is <b>terminated</b>, but the main thread (where the mentioned <code>exit()</code>-method is called on) is still <b>running</b>."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530082424,"comment_id":89103102,"body":"@daniu I tried it with <code>join()</code> as well as with <code>yield()</code>, did not change anything. But what would be the proper way to do it then?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5359684119625d3f23eca684d7f83f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11147483,"user_type":"registered","user_id":8181750,"link":"https://stackoverflow.com/users/8181750/l-spillner","reputation":1772,"display_name":"L.Spillner"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"edited":false,"creation_date":1530080815,"comment_id":89102325,"body":"Usually a thread is considered &#39;terminated&#39; when the <code>exit()</code>  method is run. Have you debugged the state of the thread after that point?"},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51055780,"edited":false,"creation_date":1530080544,"comment_id":89102206,"body":"Apart from &quot;this is not the proper way to do it&quot;: Did you try adding a <code>thread.join()</code> at the end of <code>main</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fb9385b7f1a792d5159eca8bbb2c34f8?s=256&d=identicon&r=PG","account_id":151394,"user_type":"registered","user_id":365237,"link":"https://stackoverflow.com/users/365237/eis","reputation":52351,"display_name":"eis","accept_rate":96},"content_license":"CC BY-SA 3.0","score":0,"post_id":45265777,"edited":false,"creation_date":1501103301,"comment_id":77636919,"body":"@AnsarSamad add it as an answer then"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/49c522ddb886ec08a37597bd38ef941d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11238865,"user_type":"registered","user_id":8243973,"link":"https://stackoverflow.com/users/8243973/ansar-samad","reputation":759,"display_name":"Ansar Samad","accept_rate":38},"content_license":"CC BY-SA 3.0","score":0,"post_id":45265777,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"edited":false,"creation_date":1500828586,"comment_id":77497900,"body":"Thank you Mark , it worked by associated the  map with session"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG","account_id":213468,"user_type":"registered","user_id":466862,"link":"https://stackoverflow.com/users/466862/mark-rotteveel","reputation":103500,"display_name":"Mark Rotteveel"},"content_license":"CC BY-SA 3.0","score":2,"post_id":45265777,"edited":false,"creation_date":1500817764,"comment_id":77494476,"body":"You do realise that a servlet and its fields are shared by all requests, right? You need to associate the map with the request or user session."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b4128da626e5b0049cd4fb88033e3b3?s=256&d=identicon&r=PG","account_id":8546,"user_type":"registered","user_id":15472,"link":"https://stackoverflow.com/users/15472/tucuxi","reputation":17688,"display_name":"tucuxi","accept_rate":87},"content_license":"CC BY-SA 3.0","score":0,"post_id":43630406,"edited":false,"creation_date":1493222948,"comment_id":74327096,"body":"Use e.printStackTrace() (or better yet, logging) to know the cause of the error, in the probable case of a cascading exception."},{"owner":{"profile_image":"https://i.stack.imgur.com/LJRFQ.jpg?s=256&g=1","account_id":228170,"user_type":"registered","user_id":490315,"link":"https://stackoverflow.com/users/490315/whirlwin","reputation":16153,"display_name":"whirlwin","accept_rate":94},"content_license":"CC BY-SA 3.0","score":2,"post_id":817856,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/55f6773c05e270af85af74cd5faac83a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1861835,"user_type":"registered","user_id":1686291,"link":"https://stackoverflow.com/users/1686291/not-a-bug","reputation":4286,"display_name":"Not a bug","accept_rate":73},"edited":false,"creation_date":1490879935,"comment_id":73317327,"body":"@Notabug If you are explicit, you can name your variable so that it&#39;s it that you&#39;re dealing with a ThreadLocal value, e.g. <code>RequestUtils.getCurrentRequestThreadLocal()</code>. Not saying this is very elegant though, but this stems from the fact that ThreadLocal itself is not very elegant in most cases."},{"owner":{"profile_image":"https://i.stack.imgur.com/VgOZI.png?s=256&g=1","account_id":85671,"user_type":"registered","user_id":238704,"link":"https://stackoverflow.com/users/238704/president-james-k-polk","reputation":40858,"display_name":"President James K. Polk"},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197514,"edited":false,"creation_date":1477177546,"comment_id":67661564,"body":"Unless you show your client code your question will be difficult or impossible to answer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8f914b710648b6f4ec8c71f1ed25925b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5887937,"user_type":"registered","user_id":4635346,"link":"https://stackoverflow.com/users/4635346/vivek-pratap-singh","reputation":1604,"display_name":"Vivek Pratap Singh","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1472801177,"comment_id":65907218,"body":"i have not extended Application class but i am still getting the white screen"},{"owner":{"profile_image":"https://i.stack.imgur.com/w9jTN.jpg?s=256&g=1","account_id":3013228,"user_type":"registered","user_id":2587435,"link":"https://stackoverflow.com/users/2587435/paul-samsotha","reputation":205797,"display_name":"Paul Samsotha","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":38570732,"edited":false,"creation_date":1469667627,"comment_id":64636178,"body":"Looks like something that you may want to file as an issue with jersey. As an aside its recommended to reuse <code>Client</code> instances in an application as they are expensive to create"},{"owner":{"profile_image":"https://i.stack.imgur.com/PVlNj.jpg?s=256&g=1","account_id":3730535,"user_type":"registered","user_id":3103093,"link":"https://stackoverflow.com/users/3103093/tin-tran","reputation":2265,"display_name":"Tin Tran"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1465403038,"comment_id":62889861,"body":"What are the operations in Application#onCreate(). Is it IO?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ff48e8eb52418d733229f3dadee07967?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1576496,"user_type":"registered","user_id":1462770,"link":"https://stackoverflow.com/users/1462770/amir","reputation":16227,"display_name":"Amir","accept_rate":67},"edited":false,"creation_date":1464862645,"comment_id":62663091,"body":"@Amir: I think you may be mistaken about what I am asking. This has nothing to do with Instant Run. It is a long-running problem with Android applications. It happens irrespective of OS version and even with projects that are built with Eclipse."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/8muVa.png?s=256&g=1","account_id":2211999,"user_type":"registered","user_id":1953590,"link":"https://stackoverflow.com/users/1953590/kevin-krumwiede","reputation":9954,"display_name":"Kevin Krumwiede","accept_rate":74},"edited":false,"creation_date":1464862481,"comment_id":62662982,"body":"@KevinKrumwiede: yes, that is the case when the app is still in the background, and the app process is alive and well. If you dismiss the app, the process is killed, the <code>Application</code> instance is gone, and the white screen is back with a vengeance ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/8muVa.png?s=256&g=1","account_id":2211999,"user_type":"registered","user_id":1953590,"link":"https://stackoverflow.com/users/1953590/kevin-krumwiede","reputation":9954,"display_name":"Kevin Krumwiede","accept_rate":74},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464861493,"comment_id":62662268,"body":"Incidentally, are you aware that the <code>Application</code> instance may be retained even when all your activities have finished?  When that happens, <code>Application#onCreate()</code> will <i>not</i> be called again the next time your app is launched."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ff48e8eb52418d733229f3dadee07967?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1576496,"user_type":"registered","user_id":1462770,"link":"https://stackoverflow.com/users/1462770/amir","reputation":16227,"display_name":"Amir","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464861380,"comment_id":62662175,"body":"If you use android studio 2.0 disable instant run and this issue will fixed."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cbcf412e8fc60799c981f62a7c30e907?s=256&d=identicon&r=PG","account_id":974021,"user_type":"registered","user_id":995891,"link":"https://stackoverflow.com/users/995891/zapl","reputation":63348,"display_name":"zapl","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464180862,"comment_id":62378183,"body":"Wrt theme, the trick is not to set a NoActionBar theme, it&#39;s to adjust the initial activity&#39;s theme so that an empty themed screen looks like the fully initialized one."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e70b29205599416fa49cf0d2e41e8b97?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":473257,"user_type":"registered","user_id":882251,"link":"https://stackoverflow.com/users/882251/darwind","reputation":7312,"display_name":"Darwind","accept_rate":100},"edited":false,"creation_date":1464180569,"comment_id":62377950,"body":"@Darwind: wow ... cool idea! Looks neat. You should post this as an answer ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c94c6ea772afeeb297ec29eaa2cd00c6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5531638,"user_type":"registered","user_id":4391450,"link":"https://stackoverflow.com/users/4391450/axelh","reputation":14395,"display_name":"AxelH"},"edited":false,"creation_date":1464180526,"comment_id":62377911,"body":"@AxelH: please be more specific ... what should I use exactly? A Service? A Thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/sM42n.jpg?s=256&g=1","account_id":4061727,"user_type":"registered","user_id":5699956,"link":"https://stackoverflow.com/users/5699956/atiq","reputation":14535,"display_name":"Atiq","accept_rate":70},"edited":false,"creation_date":1464180487,"comment_id":62377871,"body":"@Anders: interesting idea ... :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"edited":false,"creation_date":1464180468,"comment_id":62377858,"body":"@BeshoyHanna: So I should use an <code>IntentService</code> then?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e70b29205599416fa49cf0d2e41e8b97?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":473257,"user_type":"registered","user_id":882251,"link":"https://stackoverflow.com/users/882251/darwind","reputation":7312,"display_name":"Darwind","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464180015,"comment_id":62377486,"body":"You might find that this is still an issue after you&#39;ve moved all initialisationcode out of the <code>Application</code> class. This is due to newer versions of Android&#39;s way of &quot;cold-starting&quot; the apps. Google actually addressed the launchtimes at Google I/O this year and it will be fixed in N from what I remember. In the meantime, you should look at what Google calls a &quot;branded launchscreen&quot;. Here&#39;s an example on how to create it: <a href=\"http://antonioleiva.com/branded-launch-screen/\" rel=\"nofollow noreferrer\">antonioleiva.com/branded-launch-screen</a> - no more white screen in the beginning ;-) And please don&#39;t use splashscreens - it&#39;s annoying to the user."},{"owner":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464179968,"comment_id":62377452,"body":"Ideally, an application would offload processing and not use the main thread for long operations. This is a well accepted practice. If the operations need to happen before the app loads, then it should an least not share a thread with the UI."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"edited":false,"creation_date":1464179736,"comment_id":62377235,"body":"@BeshoyHanna: please explain how we would use that here ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/SIZQF.jpg?s=256&g=1","account_id":2158717,"user_type":"registered","user_id":1913371,"link":"https://stackoverflow.com/users/1913371/beshoy-hanna","reputation":611,"display_name":"Beshoy Hanna","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464179666,"comment_id":62377185,"body":"Have you looked into lazy loading? I believe you are on the right track with services not on the main thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/sM42n.jpg?s=256&g=1","account_id":4061727,"user_type":"registered","user_id":5699956,"link":"https://stackoverflow.com/users/5699956/atiq","reputation":14535,"display_name":"Atiq","accept_rate":70},"content_license":"CC BY-SA 3.0","score":0,"post_id":37437037,"edited":false,"creation_date":1464179305,"comment_id":62376889,"body":"<a href=\"http://stackoverflow.com/questions/35054872/how-to-pre-load-mainactivity-in-splashactivity-so-there-would-be-no-delay-when-l\">This</a> might help"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c94c6ea772afeeb297ec29eaa2cd00c6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5531638,"user_type":"registered","user_id":4391450,"link":"https://stackoverflow.com/users/4391450/axelh","reputation":14395,"display_name":"AxelH"},"content_license":"CC BY-SA 3.0","score":1,"post_id":37437037,"edited":false,"creation_date":1464179169,"comment_id":62376789,"body":"You found the problem yourself, you are doing to many init in in the application context, blocking the loading of the activity, try to asynchronized this, letting a loading activity to show up until some thread ends."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cbfaeb8d0e2ee5da976331d2cb13d0ec?s=256&d=identicon&r=PG","account_id":21279,"user_type":"registered","user_id":51577,"link":"https://stackoverflow.com/users/51577/tddmonkey","reputation":20918,"display_name":"tddmonkey","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":33097230,"edited":false,"creation_date":1458491935,"comment_id":59873372,"body":"Possible duplicate of <a href=\"http://stackoverflow.com/questions/24700798/is-jax-rs-client-thread-safe\">Is JAX-RS Client Thread Safe</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b0def851c1fc8d0b28aa35e7cc8c3fa?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7927394,"user_type":"registered","user_id":5986438,"link":"https://stackoverflow.com/users/5986438/yanozai","reputation":143,"display_name":"yanozai","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"edited":false,"creation_date":1457491052,"comment_id":59426713,"body":"Also how can I identify the runnables?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9b0def851c1fc8d0b28aa35e7cc8c3fa?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7927394,"user_type":"registered","user_id":5986438,"link":"https://stackoverflow.com/users/5986438/yanozai","reputation":143,"display_name":"yanozai","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"edited":false,"creation_date":1457490857,"comment_id":59426661,"body":"on the same handler object?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1bd5ceef90b9ae51814c10e2147f98da?s=256&d=identicon&r=PG","account_id":1596878,"user_type":"registered","user_id":1478764,"link":"https://stackoverflow.com/users/1478764/chrynan","reputation":3602,"display_name":"chRyNaN","accept_rate":72},"content_license":"CC BY-SA 3.0","score":0,"post_id":35881814,"edited":false,"creation_date":1457490656,"comment_id":59426602,"body":"You could use the removeCallback methods."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/55f6773c05e270af85af74cd5faac83a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1861835,"user_type":"registered","user_id":1686291,"link":"https://stackoverflow.com/users/1686291/not-a-bug","reputation":4286,"display_name":"Not a bug","accept_rate":73},"content_license":"CC BY-SA 3.0","score":13,"post_id":817856,"edited":false,"creation_date":1455192376,"comment_id":58384994,"body":"If you are using ThreadLocal, never write a wrapper over it !!! Each and every developer who wants to use the variable must know it is &#39;ThreadLocal&#39;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bb5a57aef64da898ac42004c1b4054a5?s=256&d=identicon&r=PG","account_id":430718,"user_type":"registered","user_id":814304,"link":"https://stackoverflow.com/users/814304/imysak","reputation":2188,"display_name":"iMysak","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":28626848,"edited":false,"creation_date":1424429351,"comment_id":45554819,"body":"just to remind: You should be very accurate when you open same file simultaniously! Extremelly whith modify operation!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4b61245891a940650109f1b308ccf54d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5503425,"user_type":"registered","user_id":4372063,"link":"https://stackoverflow.com/users/4372063/astra-bear","reputation":2646,"display_name":"Astra Bear","accept_rate":38},"content_license":"CC BY-SA 3.0","score":0,"post_id":28626848,"edited":false,"creation_date":1424428676,"comment_id":45554457,"body":"It looks like a file format problem. I would test it with a single thread first."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a8397ff2192e8da580a986bc316794da?s=256&d=identicon&r=PG","account_id":2526737,"user_type":"registered","user_id":2195963,"link":"https://stackoverflow.com/users/2195963/awani","reputation":394,"display_name":"Awani","accept_rate":67},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798073,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VjxwC.jpg?s=256&g=1","account_id":1101161,"user_type":"registered","user_id":1093528,"link":"https://stackoverflow.com/users/1093528/fge","reputation":119804,"display_name":"fge","accept_rate":65},"edited":false,"creation_date":1415353288,"comment_id":42170428,"body":"So aren&#39;t they both doing the same task - waiting so that other threads can execute? Also, when using yield(), how will the thread come back to runnable state?"},{"owner":{"profile_image":"https://i.stack.imgur.com/VjxwC.jpg?s=256&g=1","account_id":1101161,"user_type":"registered","user_id":1093528,"link":"https://stackoverflow.com/users/1093528/fge","reputation":119804,"display_name":"fge","accept_rate":65},"content_license":"CC BY-SA 3.0","score":2,"post_id":26798073,"edited":false,"creation_date":1415352843,"comment_id":42170191,"body":"Well, if you <code>.wait()</code>, another thread has to <code>.notify()</code> you -- on the exact same object reference. <code>.yield()</code> is simply a hint to the JVM that &quot;if you ant to schedule me out, you can for the moment&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"edited":false,"creation_date":1405272793,"comment_id":38352117,"body":"@WarrenDew said, &quot;there are a few other issues...&quot;  Here&#39;s one:  You wrote <code>new Thread(this)</code> in your constructors.  That may not be causing any problem for you in this code, but google for &quot;leaking this in constructor&quot; if you want to know why it&#39;s generally a Bad Idea."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"edited":false,"creation_date":1405243207,"comment_id":38344236,"body":"Your immediate issue is that both threads go into a wait on the lock, and then they never get notified.  There are a few other issues with this code as well, though."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=256&d=identicon&r=PG","account_id":48693,"user_type":"registered","user_id":144746,"link":"https://stackoverflow.com/users/144746/voo","reputation":29189,"display_name":"Voo","accept_rate":93},"content_license":"CC BY-SA 3.0","score":10,"post_id":24720849,"edited":false,"creation_date":1405242134,"comment_id":38343992,"body":"So I guess this means somewhere a new semester just started? <i>sigh</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/42011fbeea421853b43ae8679f065267?s=256&d=identicon&r=PG","account_id":2655538,"user_type":"registered","user_id":2296325,"link":"https://stackoverflow.com/users/2296325/adrian-olar","reputation":2893,"display_name":"Adrian Olar","accept_rate":87},"content_license":"CC BY-SA 3.0","score":0,"post_id":24720849,"edited":false,"creation_date":1405240326,"comment_id":38343600,"body":"Take a look here: <a href=\"http://stackoverflow.com/questions/6017281/odd-even-number-printing-using-thread\" title=\"odd even number printing using thread\">stackoverflow.com/questions/6017281/&hellip;</a>    It seems to be exactly what you need."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2374e43485f6caeb3302e66c327608e2?s=256&d=identicon&r=PG","account_id":200481,"user_type":"registered","user_id":446357,"link":"https://stackoverflow.com/users/446357/mtilsted","reputation":5196,"display_name":"MTilsted","accept_rate":64},"content_license":"CC BY-SA 3.0","score":0,"post_id":14072940,"edited":false,"creation_date":1356715437,"comment_id":19455785,"body":"You are not allowed to do painting outside of the Gui thread. You can&#39;t redirect drawing to a secondary thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/KiIon.png?s=256&g=1","account_id":36493,"user_type":"registered","user_id":104117,"link":"https://stackoverflow.com/users/104117/valentin-rocher","reputation":11667,"display_name":"Valentin Rocher","accept_rate":89},"content_license":"CC BY-SA 2.5","score":4,"post_id":877096,"edited":false,"creation_date":1242643405,"comment_id":684341,"body":"Do you mean passing a parameter to an already running thread ? Because all the current answers are about passing parameters to new threads..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3d186f3c6ad2de59b356c1cfad9af404?s=256&d=identicon&r=PG","account_id":36459,"user_type":"registered","user_id":104014,"link":"https://stackoverflow.com/users/104014/artem-barger","reputation":40877,"display_name":"Artem Barger","accept_rate":89},"content_license":"CC BY-SA 2.5","score":6,"post_id":877096,"edited":false,"creation_date":1242643218,"comment_id":684332,"body":"Would you mind to add some extra explanation of that exactly you trying to do? There are a lot of several techniques to it, but all of them depend on the final goal."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7253953e22cc6dbf31aef624f03e5cc3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":543631,"user_type":"registered","user_id":912829,"link":"https://stackoverflow.com/users/912829/acv","reputation":10094,"display_name":"ACV","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":17656373,"edited":false,"creation_date":1666378538,"comment_id":130931328,"body":"BTW, here&#39;s how to synchronize one (excerpt from javadoc): Note that this implementation is not synchronized. If multiple threads access a map concurrently, and at least one of the threads modifies the map structurally, it must be synchronized externally.  [...] the map should be &quot;wrapped&quot; using the Collections.synchronizedSortedMap method. This is best done at creation time, to prevent accidental unsynchronized access to the map:     <code>SortedMap m = Collections.synchronizedSortedMap(new TreeMap(...));</code>"},{"owner":{"profile_image":"https://graph.facebook.com/4179024102157380/picture?type=large","account_id":21573087,"user_type":"registered","user_id":15905693,"link":"https://stackoverflow.com/users/15905693/akash-beura","reputation":29,"display_name":"Akash Beura"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"reply_to_user":{"profile_image":"https://lh5.googleusercontent.com/-IXG79Rfpowg/AAAAAAAAAAI/AAAAAAAAA4M/BJyTiPZfySw/photo.jpg?sz=256","account_id":6291221,"user_type":"registered","user_id":4888849,"link":"https://stackoverflow.com/users/4888849/oleksandr-bushkovskyi","reputation":775,"display_name":"Oleksandr Bushkovskyi"},"edited":false,"creation_date":1633437572,"comment_id":122754895,"body":"@OleksandrBushkovskyi it is doing :(, the the reply in the answer posted below. explained the scenario there."},{"owner":{"profile_image":"https://graph.facebook.com/4179024102157380/picture?type=large","account_id":21573087,"user_type":"registered","user_id":15905693,"link":"https://stackoverflow.com/users/15905693/akash-beura","reputation":29,"display_name":"Akash Beura"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"reply_to_user":{"profile_image":"https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=256","account_id":15760814,"user_type":"registered","user_id":11372593,"link":"https://stackoverflow.com/users/11372593/guillaume-blaquiere","reputation":68973,"display_name":"guillaume blaquiere"},"edited":false,"creation_date":1633436334,"comment_id":122754404,"body":"@guillaumeblaquiere sorry for late reply, but we&#39;ve configured only 1 subscriber on that topic, and thing is multiple pods are attempting to process it even before the first delivery attempt has returned an Ack or Nack.. I also see the delivery attempt count is also increasing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8ef6a31909e8b4f2ef36c880b06fc398?s=256&d=identicon&r=PG","account_id":1677260,"user_type":"registered","user_id":2159502,"link":"https://stackoverflow.com/users/2159502/chaplean","reputation":197,"display_name":"chaplean","accept_rate":25},"content_license":"CC BY-SA 4.0","score":0,"post_id":69333175,"edited":false,"creation_date":1632739794,"comment_id":122566015,"body":"Thanks for the comment, good point! Optimizing the code above :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":2,"post_id":69333175,"edited":false,"creation_date":1632738570,"comment_id":122565509,"body":"There is no point in wrapping a <code>while(condition) …</code> loop in a <code>if(condition) …</code>, the loop does already have a pre-test. You’re just performing the same test twice when <code>true</code>. Besides that, now that you changed the <code>list</code> to a <code>Set</code>, you shouldn’t name the variable <code>list</code> either, further, the <code>add</code> contract is already sufficient for testing the presence. In other words, you can simply do <code>while(!set.add(value)) { this.wait(); } return new Lock(value);</code> and that’s it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8ef6a31909e8b4f2ef36c880b06fc398?s=256&d=identicon&r=PG","account_id":1677260,"user_type":"registered","user_id":2159502,"link":"https://stackoverflow.com/users/2159502/chaplean","reputation":197,"display_name":"chaplean","accept_rate":25},"content_license":"CC BY-SA 4.0","score":0,"post_id":69333175,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1e68f9207d9bb5d4b3660f1dbef19605?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18688943,"user_type":"registered","user_id":13623742,"link":"https://stackoverflow.com/users/13623742/charlie-armstrong","reputation":2332,"display_name":"Charlie Armstrong"},"edited":false,"creation_date":1632650611,"comment_id":122545738,"body":"@CharlieArmstrong agree, same with me, that is why my question is here :) Let&#39;s see"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1e68f9207d9bb5d4b3660f1dbef19605?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18688943,"user_type":"registered","user_id":13623742,"link":"https://stackoverflow.com/users/13623742/charlie-armstrong","reputation":2332,"display_name":"Charlie Armstrong"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69333175,"edited":false,"creation_date":1632647784,"comment_id":122545112,"body":"Hmm ok I get what you&#39;re saying now.  I don&#39;t know of a great solution off the top of my head.  It&#39;s possible your solution is the simplest way to do it, just to me this feels like a situation where there&#39;s got to be a more built-in way to do this.  I&#39;d be surprised if none of the Java libraries had something for this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8ef6a31909e8b4f2ef36c880b06fc398?s=256&d=identicon&r=PG","account_id":1677260,"user_type":"registered","user_id":2159502,"link":"https://stackoverflow.com/users/2159502/chaplean","reputation":197,"display_name":"chaplean","accept_rate":25},"content_license":"CC BY-SA 4.0","score":0,"post_id":69333175,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1e68f9207d9bb5d4b3660f1dbef19605?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18688943,"user_type":"registered","user_id":13623742,"link":"https://stackoverflow.com/users/13623742/charlie-armstrong","reputation":2332,"display_name":"Charlie Armstrong"},"edited":false,"creation_date":1632647192,"comment_id":122544979,"body":"@CharlieArmstrong synchronized block uses object, and I have only Account IBAN value (String). I know about String.intern() method but it has problems with GC. Regarding &quot;all equivalent strings refer to the same lock object&quot; - we have millions of account records, so it will not be a good solution to store their IBANs in a HashMap"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1e68f9207d9bb5d4b3660f1dbef19605?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18688943,"user_type":"registered","user_id":13623742,"link":"https://stackoverflow.com/users/13623742/charlie-armstrong","reputation":2332,"display_name":"Charlie Armstrong"},"content_license":"CC BY-SA 4.0","score":1,"post_id":69333175,"edited":false,"creation_date":1632646222,"comment_id":122544785,"body":"Maybe I&#39;m missing something, but I honestly don&#39;t see why this code is necessary.  Wouldn&#39;t a simple <code>synchronized (value) { ... }</code> serve the exact same purpose, eliminating the need for your entire Mutex class?  Sure, you could beef it up a little bit so that all equivalent strings refer to the same lock object, but I think you&#39;re reinventing the wheel with your Mutex class."},{"owner":{"profile_image":"https://graph.facebook.com/1022932294519907/picture?type=large","account_id":9664741,"user_type":"registered","user_id":7171559,"link":"https://stackoverflow.com/users/7171559/tr%e1%ba%a7n-v%c4%83n-dem","reputation":13,"display_name":"Trần Văn Dem"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69323845,"edited":false,"creation_date":1632555802,"comment_id":122528939,"body":"are you understand my question? I want the &quot;check&quot; in test1() is false because a race condition in my buffer is occured but the check is alway true. so I think my buffer don&#39;t have race condition but I can&#39;t explain why? if i use &quot;blockingqueue&quot; alternative the &quot;check&quot; is true."},{"owner":{"profile_image":"https://graph.facebook.com/1022932294519907/picture?type=large","account_id":9664741,"user_type":"registered","user_id":7171559,"link":"https://stackoverflow.com/users/7171559/tr%e1%ba%a7n-v%c4%83n-dem","reputation":13,"display_name":"Trần Văn Dem"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69323845,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/RKSgV.png?s=256&g=1","account_id":2485939,"user_type":"registered","user_id":2164365,"link":"https://stackoverflow.com/users/2164365/abra","reputation":19426,"display_name":"Abra","accept_rate":40},"edited":false,"creation_date":1632554959,"comment_id":122528794,"body":"yes I sure that the for loop is entered"},{"owner":{"profile_image":"https://graph.facebook.com/1022932294519907/picture?type=large","account_id":9664741,"user_type":"registered","user_id":7171559,"link":"https://stackoverflow.com/users/7171559/tr%e1%ba%a7n-v%c4%83n-dem","reputation":13,"display_name":"Trần Văn Dem"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69323845,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/RKSgV.png?s=256&g=1","account_id":2485939,"user_type":"registered","user_id":2164365,"link":"https://stackoverflow.com/users/2164365/abra","reputation":19426,"display_name":"Abra","accept_rate":40},"edited":false,"creation_date":1632554442,"comment_id":122528722,"body":"I will check size of sw, sr by &quot;System.out.println(sw.size())&quot;. Do you see it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f7dc7a5a289fbe1afd4d5d3a8f92054a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3194540,"user_type":"registered","user_id":2698033,"link":"https://stackoverflow.com/users/2698033/user2698033","reputation":23,"display_name":"user2698033"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69321964,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=256&d=identicon&r=PG","account_id":220160,"user_type":"registered","user_id":477420,"link":"https://stackoverflow.com/users/477420/alexei-levenkov","reputation":99410,"display_name":"Alexei Levenkov"},"edited":false,"creation_date":1632527186,"comment_id":122525389,"body":"Hi Alexei! I didn&#39;t code it yet, just seeing what would be the best (or at least good) approach. Im sorry but i don&#39;t need to start 31 threads, i just need to start a thread for each combination of true bits. The thing is that i have to test all 31 combinations that have a true bit, and thats for 5 bits. Maybe if then there are more bits the thing starts to get bigger. My question was if this was the only approach."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=256&d=identicon&r=PG","account_id":220160,"user_type":"registered","user_id":477420,"link":"https://stackoverflow.com/users/477420/alexei-levenkov","reputation":99410,"display_name":"Alexei Levenkov"},"content_license":"CC BY-SA 4.0","score":2,"post_id":69321964,"edited":false,"creation_date":1632526753,"comment_id":122525338,"body":"Since starting thread is quite an expensive operation it somewhat does not matter how complex code is to decide when to start new thread... But at this point it is quite unclear what exactly you have problem with - it seem you just need to start 31 thread corresponding to values 1-31 (skipping 00000)... Maybe <a href=\"https://stackoverflow.com/posts/69321964/edit\">edit</a> the question to show code you have and brief explanation what part you measured already and found that it needs optimization."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=256","account_id":15760814,"user_type":"registered","user_id":11372593,"link":"https://stackoverflow.com/users/11372593/guillaume-blaquiere","reputation":68973,"display_name":"guillaume blaquiere"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"edited":false,"creation_date":1632208344,"comment_id":122423747,"body":"The only reason to consume the same message, in the same time is to have several subscription. If you have only one subscription, the message is delivered to one and only one subscriber at a time. However, if the message is nack (timeout or explicit nack) it returns to the message pool and can be delivered to another subscriber. but it&#39;s not concurrent it&#39;s subsequent."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-IXG79Rfpowg/AAAAAAAAAAI/AAAAAAAAA4M/BJyTiPZfySw/photo.jpg?sz=256","account_id":6291221,"user_type":"registered","user_id":4888849,"link":"https://stackoverflow.com/users/4888849/oleksandr-bushkovskyi","reputation":775,"display_name":"Oleksandr Bushkovskyi"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"edited":false,"creation_date":1632206489,"comment_id":122423174,"body":"Yes, once subscriber receives the message, other subscribers to the same subscription won&#39;t receive it during the ackDeadline span."},{"owner":{"profile_image":"https://graph.facebook.com/4179024102157380/picture?type=large","account_id":21573087,"user_type":"registered","user_id":15905693,"link":"https://stackoverflow.com/users/15905693/akash-beura","reputation":29,"display_name":"Akash Beura"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"reply_to_user":{"profile_image":"https://lh5.googleusercontent.com/-IXG79Rfpowg/AAAAAAAAAAI/AAAAAAAAA4M/BJyTiPZfySw/photo.jpg?sz=256","account_id":6291221,"user_type":"registered","user_id":4888849,"link":"https://stackoverflow.com/users/4888849/oleksandr-bushkovskyi","reputation":775,"display_name":"Oleksandr Bushkovskyi"},"edited":false,"creation_date":1632204646,"comment_id":122422667,"body":"@OleksandrBushkovskyi let&#39;s say I will have 5 minuted ackDeadline, but isn&#39;t it possible for other pods to subscribe to that message again in parallel within that 5 minutes time span? Or once a subscriber processes the message, others can&#39;t?"},{"owner":{"profile_image":"https://graph.facebook.com/4179024102157380/picture?type=large","account_id":21573087,"user_type":"registered","user_id":15905693,"link":"https://stackoverflow.com/users/15905693/akash-beura","reputation":29,"display_name":"Akash Beura"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"reply_to_user":{"profile_image":"https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=256","account_id":15760814,"user_type":"registered","user_id":11372593,"link":"https://stackoverflow.com/users/11372593/guillaume-blaquiere","reputation":68973,"display_name":"guillaume blaquiere"},"edited":false,"creation_date":1632204642,"comment_id":122422665,"body":"@guillaumeblaquiere I have one subscription, i believe multiple pods act like subscribers to the same subscription at same time."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-IXG79Rfpowg/AAAAAAAAAAI/AAAAAAAAA4M/BJyTiPZfySw/photo.jpg?sz=256","account_id":6291221,"user_type":"registered","user_id":4888849,"link":"https://stackoverflow.com/users/4888849/oleksandr-bushkovskyi","reputation":775,"display_name":"Oleksandr Bushkovskyi"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"edited":false,"creation_date":1632169998,"comment_id":122416466,"body":"I can think of couple possible reasons:  - message is not acknowledged at the end of processing;  - message is acknowledged after the ackDeadline. In both cases message will become available in the subscription for duplicated processing after the ackDeadline."},{"owner":{"profile_image":"https://lh5.googleusercontent.com/-FQBr5NRaPHA/AAAAAAAAAAI/AAAAAAAABb0/XuGqOq18jyg/photo.jpg?sz=256","account_id":15760814,"user_type":"registered","user_id":11372593,"link":"https://stackoverflow.com/users/11372593/guillaume-blaquiere","reputation":68973,"display_name":"guillaume blaquiere"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69257436,"edited":false,"creation_date":1632166908,"comment_id":122415515,"body":"Have you only one subscription or your pod also create a subscription to the topic?"},{"owner":{"profile_image":"https://i.stack.imgur.com/Cf2VX.jpg?s=256&g=1","account_id":10716734,"user_type":"registered","user_id":7887075,"link":"https://stackoverflow.com/users/7887075/amol-kshirsagar","reputation":243,"display_name":"Amol Kshirsagar"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69202716,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VQuo9.jpg?s=256&g=1","account_id":202356,"user_type":"registered","user_id":449378,"link":"https://stackoverflow.com/users/449378/navaneeth-sen","reputation":6380,"display_name":"Navaneeth Sen","accept_rate":62},"edited":false,"creation_date":1631791657,"comment_id":122320802,"body":"thanks @NavaneethSen and user207421 Now I have aggregated above   fileUploadLodgeReturnDetailsDTO objects into lists such that even if multiple threads try to PUT into the HashMap, they will always do the PUT at different KEYS. So, even if 4 threads are modifying the HashMap with PUT they will do so at 4 diff Keys at any given time. I am not doing a GET at all now since there will be no value corresponding to the key present in the HashMap when I do a PUT.  Would it still cause ConcurrentModificationException? From what read it occurs when you are iterating and updating via multiple threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":1,"post_id":69202716,"edited":false,"creation_date":1631772195,"comment_id":122312821,"body":"Why not just use synchronization? In the context of uploading files any attempt to improve on it is futile."},{"owner":{"profile_image":"https://i.stack.imgur.com/VQuo9.jpg?s=256&g=1","account_id":202356,"user_type":"registered","user_id":449378,"link":"https://stackoverflow.com/users/449378/navaneeth-sen","reputation":6380,"display_name":"Navaneeth Sen","accept_rate":62},"content_license":"CC BY-SA 4.0","score":1,"post_id":69202716,"edited":false,"creation_date":1631771409,"comment_id":122312646,"body":"Why do you want to write to the hashmap concurrently? Cant you use a Queue to write values to the hashmap for simplicity? Which means push the messages into the queue first and write to the Hashmap by popping from the queue"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a0ced8e21d2a761db718acb6362b9225?s=256&d=identicon&r=PG","account_id":44852,"user_type":"registered","user_id":131872,"link":"https://stackoverflow.com/users/131872/camickr","reputation":322224,"display_name":"camickr","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":64697896,"edited":false,"creation_date":1604588878,"comment_id":114397602,"body":"However, your Thread.sleep() is now preventing the GUI from repainting itself until the looping code is finished executing. The solution is to NOT use Thread.sleep() and looping code. See: <a href=\"https://stackoverflow.com/questions/64196198/bubble-sort-animation\" title=\"bubble sort animation\">stackoverflow.com/questions/64196198/bubble-sort-animation</a> for two approaches to restructure looping code."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a0ced8e21d2a761db718acb6362b9225?s=256&d=identicon&r=PG","account_id":44852,"user_type":"registered","user_id":131872,"link":"https://stackoverflow.com/users/131872/camickr","reputation":322224,"display_name":"camickr","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":64697896,"edited":false,"creation_date":1604588862,"comment_id":114397594,"body":"<i>My guess is that I create an instance of the game in the main method and terefore the first game runs in the main thread. The new game doesn&#39;t run in the main thread and therefore the GUI is somehow blocked.</i> - GUI code should run on the <code>Event Dispatch Thread (EDT)</code>. This is the Thread that responds to events and repaints the GUI. All Swing components should be updated on the EDT. When you start the game your code runs on the AWT Thread, which is not correct. When you click a button the code in the ActionListener does execute on the EDT, which is good."},{"owner":{"profile_image":"https://i.stack.imgur.com/gWeJr.jpg?s=256&g=1","account_id":114128,"user_type":"registered","user_id":300257,"link":"https://stackoverflow.com/users/300257/gilbert-le-blanc","reputation":50467,"display_name":"Gilbert Le Blanc","accept_rate":89},"content_license":"CC BY-SA 4.0","score":0,"post_id":64697896,"edited":false,"creation_date":1604588777,"comment_id":114397550,"body":"Generally, when you create a Swing GUI, you create the GUI components one time.  If you want to reuse the GUI, you update the text or images in the GUI components.  Also, it&#39;s a really good idea to create separate application model, view3, and controller classes.  That way, you can focus on one part of the application at a time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b8cfca4f9fe4cdc7a0914f595a79f14?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15856821,"user_type":"registered","user_id":11441011,"link":"https://stackoverflow.com/users/11441011/maloomeister","reputation":2451,"display_name":"maloomeister"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64697896,"edited":false,"creation_date":1604583533,"comment_id":114394660,"body":"This is quite the wall of code. At first glance, I see that your GUI is not running in the Event Dispatch Thread (EDT). Did you check out the <a href=\"https://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html\" rel=\"nofollow noreferrer\">Concurrency in Swing</a> tutorial?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bbd074543b27f42277dc23ef40b1195b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6379952,"user_type":"registered","user_id":4949750,"link":"https://stackoverflow.com/users/4949750/amongalen","reputation":3111,"display_name":"Amongalen"},"content_license":"CC BY-SA 4.0","score":1,"post_id":64676963,"edited":false,"creation_date":1604481212,"comment_id":114357660,"body":"&quot;Not allow the boolean value to be changed till it runs to completion&quot; - is your current implementation supposed to achieve this? From what I can tell nothing stops other threads from changing <code>immortal</code> during execution of the synchronized block."},{"owner":{"profile_image":"https://i.stack.imgur.com/K1mTV.jpg?s=256&g=1","account_id":969721,"user_type":"registered","user_id":992484,"link":"https://stackoverflow.com/users/992484/madprogrammer","reputation":344527,"display_name":"MadProgrammer","accept_rate":60},"content_license":"CC BY-SA 4.0","score":0,"post_id":64654918,"edited":false,"creation_date":1604361550,"comment_id":114319527,"body":"Will it work yes, will there be unexpected results, most probably.  You need to look at concurrency theory and understand things like race conditions. You can&#39;t guarantee the order in which the two threads will execute and you will need consider what that means if the order changes.  You also need to consider how the memory model of the JVM works, as modifying the state of the object might not be &quot;updated&quot; to other threads until some point in the future (that&#39;s quite vague and some one can descibe it better, but you&#39;d want to investigate things like <code>volatile</code>)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d99204bcce923f40f5c72b7f80121644?s=256&d=identicon&r=PG","account_id":2139538,"user_type":"registered","user_id":1898563,"link":"https://stackoverflow.com/users/1898563/michael","reputation":42521,"display_name":"Michael","accept_rate":78},"content_license":"CC BY-SA 4.0","score":3,"post_id":64654918,"edited":false,"creation_date":1604361422,"comment_id":114319489,"body":"&quot;<i>will there be unexpected results</i>&quot; Whether it&#39;s unexpected or not depends on what you expect."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=256","account_id":13308494,"user_type":"registered","user_id":9607556,"link":"https://stackoverflow.com/users/9607556/%d0%93%d0%b5%d0%bd%d0%bd%d0%b0%d0%b4%d0%b8%d0%b9-%d0%9e%d1%81%d0%b5%d1%82%d1%80%d0%be%d0%b2","reputation":13,"display_name":"Геннадий Осетров"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60914276,"edited":false,"creation_date":1585556714,"comment_id":107791037,"body":"The same way it can happen during the object construction without proper synchronization."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":60914276,"edited":false,"creation_date":1585552252,"comment_id":107789195,"body":"How do you imagine it &quot;escapes the method&quot;? It is created there and then returned; how will another piece of code get access to it other than as a result of <code>createValue</code>, ie after it was already put in the map?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/28674d9366e96aaf1030dc2112efd3c8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15452950,"user_type":"registered","user_id":11147851,"link":"https://stackoverflow.com/users/11147851/pavel-smirnov","reputation":4661,"display_name":"Pavel Smirnov"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60914276,"edited":false,"creation_date":1585485430,"comment_id":107769710,"body":"No, it&#39;s not possible. <code>ConcurrentHashMap</code> guarantees the <a href=\"https://www.logicbig.com/tutorials/core-java-tutorial/java-multi-threading/happens-before.html\" rel=\"nofollow noreferrer\">Happens-before relationship</a>. So, as long as <code>put</code> happens before <code>get</code>, you will get consistent results."},{"owner":{"profile_image":"https://i.stack.imgur.com/ljO2n.jpg?s=256&g=1","account_id":7571081,"user_type":"registered","user_id":6767102,"link":"https://stackoverflow.com/users/6767102/slandshow","reputation":473,"display_name":"SlandShow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585477846,"comment_id":107767296,"body":"Let us <a href=\"https://chat.stackoverflow.com/rooms/210522/discussion-between-slandshow-and-andreas\">continue this discussion in chat</a>."},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"edited":false,"creation_date":1585477732,"comment_id":107767260,"body":"I&#39;m sorry, but <i>where</i> can we see that? Your question doesn&#39;t show any <i>bytecode</i>, and it doesn&#39;t show any <i>deoptimization</i>. What we do see is that JIT <i>compiles</i> the code (presumably optimizing it too but we don&#39;t see that since we don&#39;t see the code it compiled into), the exact opposite of what you just said."},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":1,"post_id":60912357,"edited":false,"creation_date":1585477129,"comment_id":107767076,"body":"Changed the enhanced print to store <code>x</code> and <code>y</code> in local variables, so the printed values are what is actually compared by the <code>if</code> statement. I get e.g. <code>2623 &gt; 2622, 19040 &gt; 19035, 22985 &gt; 22984, 31192 &gt; 29296, ...</code> is a single run. Those are differences of 1, 5, 1, and 1896, and that is a symptom of <b>data races, not code reordering</b>. You&#39;re right, it&#39;s a data race, not a race condition, I misspoke on that, but it sure isn&#39;t code reordering either. --- My point: Your claim <i>&quot;You can notice instructions reordering&quot;</i> is unproven, and unlikely, and is based on a false assumption."},{"owner":{"profile_image":"https://i.stack.imgur.com/ljO2n.jpg?s=256&g=1","account_id":7571081,"user_type":"registered","user_id":6767102,"link":"https://stackoverflow.com/users/6767102/slandshow","reputation":473,"display_name":"SlandShow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585476825,"comment_id":107766999,"body":"I know how to fix such incident. But still, what u want now? Are you trying to prove your case? I still think that it&#39;s because of data race. And yes, what about bytecode compilation log?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ljO2n.jpg?s=256&g=1","account_id":7571081,"user_type":"registered","user_id":6767102,"link":"https://stackoverflow.com/users/6767102/slandshow","reputation":473,"display_name":"SlandShow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585476278,"comment_id":107766851,"body":"@Andreas  And? What u want to say?"},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"edited":false,"creation_date":1585476214,"comment_id":107766836,"body":"I enhanced your <code>Ooops!</code> print statement to show the values. On first run I got <code>Ooops! y &gt; x (59759 &gt; 60415)</code>. On another run I got <code>Ooops! y &gt; x (47619 &gt; 48071) Ooops! y &gt; x (479509 &gt; 479506) ...</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/ljO2n.jpg?s=256&g=1","account_id":7571081,"user_type":"registered","user_id":6767102,"link":"https://stackoverflow.com/users/6767102/slandshow","reputation":473,"display_name":"SlandShow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585476213,"comment_id":107766835,"body":"@Andreas my question - is not a statement. I&#39;am just researching. But from my point of you, here is not race condition, it&#39;s data race. And difference is big, because if we are talking about data race - it&#39;s looks like that CPU reorder some instructions."},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"edited":false,"creation_date":1585476036,"comment_id":107766789,"body":"It&#39;s a lot more likely that you&#39;re seeing race conditions between the two threads. But, only one way to be sure. Do your <b>research</b> instead of guessing, i.e. look at the JIT-compiled code."},{"owner":{"profile_image":"https://i.stack.imgur.com/ljO2n.jpg?s=256&g=1","account_id":7571081,"user_type":"registered","user_id":6767102,"link":"https://stackoverflow.com/users/6767102/slandshow","reputation":473,"display_name":"SlandShow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585475932,"comment_id":107766763,"body":"@Andreas &gt;f so, why do you believe that is an effect of code reordering, and not memory cache refreshing between the two threads?   Because it&#39;s looks like instructions reordering."},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"edited":false,"creation_date":1585475844,"comment_id":107766739,"body":"If you want to <i>see</i> if there is code reordering, you need to look at the code JIT generates, so read this: <a href=\"https://stackoverflow.com/q/1503479/5221149\">How to see JIT-compiled code in JVM?</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60912357,"edited":false,"creation_date":1585475595,"comment_id":107766689,"body":"<i>&quot;You can notice instructions reordering&quot;</i> I can see no indication of reordering in that question. Did you perhaps mean to say that your program prints <code>Ooops! y &gt; x</code>? If so, why do you believe that is an effect of code reordering, and not memory cache refreshing between the two threads?"},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 4.0","score":1,"post_id":60912120,"edited":false,"creation_date":1585475457,"comment_id":107766663,"body":"You&#39;ve mixed up the &quot;old&quot; low level <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html\" rel=\"nofollow noreferrer\">wait/notify</a> with the high level <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/newlocks.html\" rel=\"nofollow noreferrer\">Lock</a> mechanism."},{"owner":{"profile_image":"https://i.stack.imgur.com/1ypfs.jpg?s=256&g=1","account_id":6390592,"user_type":"registered","user_id":4956907,"link":"https://stackoverflow.com/users/4956907/micha%c5%82-krzywa%c5%84ski","reputation":16008,"display_name":"Michał Krzywański"},"content_license":"CC BY-SA 4.0","score":1,"post_id":60912120,"edited":false,"creation_date":1585475081,"comment_id":107766565,"body":"All java objects can be used as locks. Right now you are calling <code>wait</code> and <code>notify</code> on <code>lock</code> object without synchronziing on it - that is why you get an exception. Typically you either use <code>notify</code> and <code>wait</code> methods on some shared lock object OR <code>Lock</code> instances with it&#39;s <code>lock</code> and <code>unlock</code> methods AND <code>Condition</code> instances which are created from your <code>Lock</code> instances."},{"owner":{"profile_image":"https://i.stack.imgur.com/QT3fG.png?s=256&g=1","account_id":2709823,"user_type":"registered","user_id":2338547,"link":"https://stackoverflow.com/users/2338547/markspace","reputation":10716,"display_name":"markspace"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60895586,"edited":false,"creation_date":1585359202,"comment_id":107739722,"body":"You seem to be asking if Java requires <code>sychronized</code> on both reads and writes, or if it&#39;s only required on the write.  That question has already been answered: <a href=\"https://stackoverflow.com/questions/27120914/do-i-need-to-add-some-locks-or-synchronization-if-there-is-only-one-thread-writi\" title=\"do i need to add some locks or synchronization if there is only one thread writi\">stackoverflow.com/questions/27120914/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=256&d=identicon&r=PG","account_id":2053598,"user_type":"registered","user_id":1831987,"link":"https://stackoverflow.com/users/1831987/vgr","reputation":41316,"display_name":"VGR"},"content_license":"CC BY-SA 4.0","score":3,"post_id":60895586,"edited":false,"creation_date":1585355337,"comment_id":107739093,"body":"It definitely is not guaranteed. See the Java Language Specification, <a href=\"https://docs.oracle.com/javase/specs/jls/se11/html/jls-17.html#jls-17.3\" rel=\"nofollow noreferrer\">section 17.3</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8fbe63f77ce3f9656c62b27db4d8583b?s=256&d=identicon&r=PG","account_id":785560,"user_type":"registered","user_id":845414,"link":"https://stackoverflow.com/users/845414/johannes-kuhn","reputation":14879,"display_name":"Johannes Kuhn"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60895586,"edited":false,"creation_date":1585353765,"comment_id":107738820,"body":"How do you even ensure that &quot;the second threads executes slightly later&quot;?"},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60880702,"edited":false,"creation_date":1585290671,"comment_id":107712752,"body":"The <code>checkNullObjectsConsumer</code> field is no more stateful than the <code>validationDefinitionService</code> field. It is assigned on instance creation and never changes after that. &quot;State&quot; refers to classes where calling a method with the same arguments repeatedly might produce different results because the &quot;state&quot; of the class has been changed. That requires some kind of mutator method, e.g. a method like <code>set</code>, <code>add</code>, <code>remove</code>, etc. There are no such methods here."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-QxawwUszUkQ/AAAAAAAAAAI/AAAAAAAAAIM/GVbDBib3VQQ/photo.jpg?sz=256","account_id":9428143,"user_type":"registered","user_id":7012488,"link":"https://stackoverflow.com/users/7012488/erkan-erki%c5%9fi","reputation":159,"display_name":"Erkan Erkişi","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":60880702,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585290568,"comment_id":107712720,"body":"then these biconsumers not indicating any state. I was confused. thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60880702,"edited":false,"creation_date":1585290405,"comment_id":107712670,"body":"So? That variable (field) refers to a method, to code, not to any state value fields. There is no state there. And those variables (fields) are all final, so they can never change once the class instance has been created. I don&#39;t understand what &quot;state&quot; you believe they have."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-QxawwUszUkQ/AAAAAAAAAAI/AAAAAAAAAIM/GVbDBib3VQQ/photo.jpg?sz=256","account_id":9428143,"user_type":"registered","user_id":7012488,"link":"https://stackoverflow.com/users/7012488/erkan-erki%c5%9fi","reputation":159,"display_name":"Erkan Erkişi","accept_rate":57},"content_license":"CC BY-SA 4.0","score":0,"post_id":60880702,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"edited":false,"creation_date":1585289933,"comment_id":107712574,"body":"@Andreas thanks for comment. there are consumer variables (biconsumers) in class scope?"},{"owner":{"profile_image":"https://i.stack.imgur.com/s4qlq.png?s=256&g=1","account_id":6780825,"user_type":"registered","user_id":5221149,"link":"https://stackoverflow.com/users/5221149/andreas","reputation":155680,"display_name":"Andreas"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60880702,"edited":false,"creation_date":1585289526,"comment_id":107712479,"body":"<i>&quot;Because this is stateful class right now&quot;</i> In what way is that class stateful? As far as I can see, there is no fields maintaining state, and there is no actions that would change any kind of state. As such, without state, that class should be fully thread-safe. Well, unless <code>ValidationDefinitionService</code> has state (but you already said it doesn&#39;t) or isn&#39;t otherwise thread-safe."},{"owner":{"profile_image":"https://i.stack.imgur.com/2Vx3A.jpg?s=256&g=1","account_id":2345668,"user_type":"registered","user_id":2055998,"link":"https://stackoverflow.com/users/2055998/pm-77-1","reputation":13002,"display_name":"PM 77-1","accept_rate":68},"content_license":"CC BY-SA 4.0","score":0,"post_id":60871531,"edited":false,"creation_date":1585240234,"comment_id":107697872,"body":"So it&#39;s one-way communication? Then it sounds like a Producer-Consumer problem that is normally solved with queues of some sort."},{"owner":{"profile_image":"https://graph.facebook.com/622975221173646/picture?type=large","account_id":7090325,"user_type":"registered","user_id":5425719,"link":"https://stackoverflow.com/users/5425719/nak-leng","reputation":15,"display_name":"Nak Leng"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60871531,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/2Vx3A.jpg?s=256&g=1","account_id":2345668,"user_type":"registered","user_id":2055998,"link":"https://stackoverflow.com/users/2055998/pm-77-1","reputation":13002,"display_name":"PM 77-1","accept_rate":68},"edited":false,"creation_date":1585239986,"comment_id":107697753,"body":"@PM77-1 thread Two has data that it was initialized with, that it needs to transfer over to thread One. I&#39;m not sure if I can use queue classes, but I believe I can."},{"owner":{"profile_image":"https://i.stack.imgur.com/2Vx3A.jpg?s=256&g=1","account_id":2345668,"user_type":"registered","user_id":2055998,"link":"https://stackoverflow.com/users/2055998/pm-77-1","reputation":13002,"display_name":"PM 77-1","accept_rate":68},"content_license":"CC BY-SA 4.0","score":1,"post_id":60871531,"edited":false,"creation_date":1585239738,"comment_id":107697619,"body":"What does &quot;<i>interact</i>&quot; entail? Can you use <code>queue</code> classes?"},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 4.0","score":1,"post_id":60871531,"edited":false,"creation_date":1585239720,"comment_id":107697606,"body":"You could share the <code>Semaphore</code> between them."},{"owner":{"profile_image":"https://i.stack.imgur.com/JjtR4.jpg?s=256&g=1","account_id":10591420,"user_type":"registered","user_id":7801853,"link":"https://stackoverflow.com/users/7801853/shelly","reputation":183,"display_name":"Shelly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60850133,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ada69b2a87f0732a5b051e769d07b13d?s=256&d=identicon&r=PG","account_id":1628551,"user_type":"registered","user_id":1503554,"link":"https://stackoverflow.com/users/1503554/thisisnozaku","reputation":2314,"display_name":"ThisIsNoZaku","accept_rate":43},"edited":false,"creation_date":1585145487,"comment_id":107660180,"body":"@ThisIsNoZaku .. Yes get the returned value"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ada69b2a87f0732a5b051e769d07b13d?s=256&d=identicon&r=PG","account_id":1628551,"user_type":"registered","user_id":1503554,"link":"https://stackoverflow.com/users/1503554/thisisnozaku","reputation":2314,"display_name":"ThisIsNoZaku","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":60850133,"edited":false,"creation_date":1585145315,"comment_id":107660081,"body":"What do you mean by &quot;retrieve callable returned value&quot;? Do you mean get the value?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7b4a3c036be422fb5dbef76614019c42?s=256&d=identicon&r=PG","account_id":2015855,"user_type":"registered","user_id":1803183,"link":"https://stackoverflow.com/users/1803183/rafa%c5%82ek","reputation":121,"display_name":"Rafałek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":60838503,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5e9b86bbe0805dfaf5d07146d2a69956?s=256&d=identicon&r=PG","account_id":2242,"user_type":"registered","user_id":3095,"link":"https://stackoverflow.com/users/3095/dave","reputation":13698,"display_name":"Dave","accept_rate":89},"edited":false,"creation_date":1585082681,"comment_id":107639996,"body":"Yes. Does it matter what it does ? It does some work needed to stop which takes some time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5e9b86bbe0805dfaf5d07146d2a69956?s=256&d=identicon&r=PG","account_id":2242,"user_type":"registered","user_id":3095,"link":"https://stackoverflow.com/users/3095/dave","reputation":13698,"display_name":"Dave","accept_rate":89},"content_license":"CC BY-SA 4.0","score":0,"post_id":60838503,"edited":false,"creation_date":1585081524,"comment_id":107639569,"body":"So your &quot;stop&quot; method starts up a CompletableFuture?  I&#39;m confused as to what it actually does."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4d7b9067a778f9419ee2901effa056ac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6797655,"user_type":"registered","user_id":5232255,"link":"https://stackoverflow.com/users/5232255/jason-law","reputation":975,"display_name":"Jason Law"},"content_license":"CC BY-SA 4.0","score":0,"post_id":10528572,"edited":false,"creation_date":1579514270,"comment_id":105778703,"body":"A related question: <a href=\"https://stackoverflow.com/questions/23960055/differences-in-safe-publishing-between-volatile-final-and-synchronized\">java - Differences in safe publishing between volatile,final and synchronized - Stack Overflow</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f5390b6c93de246b5b872f84d62a1875?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4322748,"user_type":"registered","user_id":3530379,"link":"https://stackoverflow.com/users/3530379/liubenxi","reputation":91,"display_name":"liubenxi"},"content_license":"CC BY-SA 4.0","score":2,"post_id":56913443,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0d2bf7cf3c762b08b632c0bdc60a0712?s=256&d=identicon&r=PG","account_id":406824,"user_type":"registered","user_id":776548,"link":"https://stackoverflow.com/users/776548/archit","reputation":933,"display_name":"Archit","accept_rate":22},"edited":false,"creation_date":1562554229,"comment_id":100396921,"body":"@Archit I find out the reason. Before the transaction finish, the provider already put the element into the queue. At this moment, the database has not been changed yet. However the consumer already access the database, which leads to the error."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f7f3d090c173df712ee5e0b14e955823?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8998625,"user_type":"registered","user_id":6707992,"link":"https://stackoverflow.com/users/6707992/yfl","reputation":357,"display_name":"yfl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/RJgJM.png?s=256&g=1","account_id":261142,"user_type":"registered","user_id":545127,"link":"https://stackoverflow.com/users/545127/raedwald","reputation":47118,"display_name":"Raedwald","accept_rate":69},"edited":false,"creation_date":1562547317,"comment_id":100395876,"body":"@Raedwald, anything set up in PostConstruct depends no resources that are not available at object construction."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0d2bf7cf3c762b08b632c0bdc60a0712?s=256&d=identicon&r=PG","account_id":406824,"user_type":"registered","user_id":776548,"link":"https://stackoverflow.com/users/776548/archit","reputation":933,"display_name":"Archit","accept_rate":22},"content_license":"CC BY-SA 4.0","score":0,"post_id":56913443,"edited":false,"creation_date":1562481107,"comment_id":100382272,"body":"ok understood. Though what you are saying should not happen ideally. Can you share a working snippet of your code in a pastebin or similar, so that I can also try"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f5390b6c93de246b5b872f84d62a1875?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4322748,"user_type":"registered","user_id":3530379,"link":"https://stackoverflow.com/users/3530379/liubenxi","reputation":91,"display_name":"liubenxi"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56913443,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0d2bf7cf3c762b08b632c0bdc60a0712?s=256&d=identicon&r=PG","account_id":406824,"user_type":"registered","user_id":776548,"link":"https://stackoverflow.com/users/776548/archit","reputation":933,"display_name":"Archit","accept_rate":22},"edited":false,"creation_date":1562418070,"comment_id":100371520,"body":"@Archit I&#39;m using a blocking queue with not limit, so the put will not waits. In fact, both reading and writing are needed in the code snippet. I think the best way is to move blockingQueue.put()outside <code>@Transactional</code>, the blockingQueue.put() will proceed if the <code>@Transactional</code> success."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0d2bf7cf3c762b08b632c0bdc60a0712?s=256&d=identicon&r=PG","account_id":406824,"user_type":"registered","user_id":776548,"link":"https://stackoverflow.com/users/776548/archit","reputation":933,"display_name":"Archit","accept_rate":22},"content_license":"CC BY-SA 4.0","score":0,"post_id":56913443,"edited":false,"creation_date":1562415859,"comment_id":100371057,"body":"Also what would happen if producer cannot write to BlockingQueue (as it is full) and waits. You will have very long running transactions then. Maybe you would want to re-consider why you want database transaction here"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0d2bf7cf3c762b08b632c0bdc60a0712?s=256&d=identicon&r=PG","account_id":406824,"user_type":"registered","user_id":776548,"link":"https://stackoverflow.com/users/776548/archit","reputation":933,"display_name":"Archit","accept_rate":22},"content_license":"CC BY-SA 4.0","score":0,"post_id":56913443,"edited":false,"creation_date":1562415770,"comment_id":100371043,"body":"The purpose of transactional will be defeated if you put blockingQueue.put() outside @Transactional i guess. Why do u want to transaction and rollback here anyways. Transactional is required when writing to DB. While reading its not required (which is what i guess you are doing)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/89f6272aa65ac53175d7c214d57ad1be?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3175948,"user_type":"registered","user_id":2683814,"link":"https://stackoverflow.com/users/2683814/s7vr","reputation":74316,"display_name":"s7vr","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":56904832,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b4c3acc21c6d768e3875ebac67b53bdf?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8086222,"user_type":"registered","user_id":6093696,"link":"https://stackoverflow.com/users/6093696/eric","reputation":906,"display_name":"Eric"},"edited":false,"creation_date":1562361737,"comment_id":100363135,"body":"Thanks Eric. Are you saying I don&#39;t need synchronization at all for both read and write when the variable is marked as volatile ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4c3acc21c6d768e3875ebac67b53bdf?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8086222,"user_type":"registered","user_id":6093696,"link":"https://stackoverflow.com/users/6093696/eric","reputation":906,"display_name":"Eric"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56904832,"edited":false,"creation_date":1562340317,"comment_id":100356190,"body":"Yes, if it’s a single variable, then the <code>synchronized</code> block is unnecessary and a volatile write is sufficient."},{"owner":{"profile_image":"https://i.stack.imgur.com/RJgJM.png?s=256&g=1","account_id":261142,"user_type":"registered","user_id":545127,"link":"https://stackoverflow.com/users/545127/raedwald","reputation":47118,"display_name":"Raedwald","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"edited":false,"creation_date":1562331843,"comment_id":100351966,"body":"&quot;For e.g. any variable that is set in a method with the @PostConstruct annotation cannot be final&quot;: so, don&#39;t set it in the @PostConstruct method, set it in the constructor, so you <i>can</i> make it <code>final</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=256&d=identicon&r=PG","account_id":86477,"user_type":"registered","user_id":240443,"link":"https://stackoverflow.com/users/240443/amadan","reputation":192896,"display_name":"Amadan","accept_rate":79},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"edited":false,"creation_date":1562309215,"comment_id":100341283,"body":"I don&#39;t think a compile-time check that something will happen only once is possible."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f7f3d090c173df712ee5e0b14e955823?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8998625,"user_type":"registered","user_id":6707992,"link":"https://stackoverflow.com/users/6707992/yfl","reputation":357,"display_name":"yfl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=256&d=identicon&r=PG","account_id":86477,"user_type":"registered","user_id":240443,"link":"https://stackoverflow.com/users/240443/amadan","reputation":192896,"display_name":"Amadan","accept_rate":79},"edited":false,"creation_date":1562309142,"comment_id":100341255,"body":"@Amadan, I wouldn&#39;t say it is a duplicate as I am asking for something that will check compile time. Also, since the problem lies with a DI framework, suggested solutions such as the Builder pattern wouldn&#39;t really work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=256&d=identicon&r=PG","account_id":86477,"user_type":"registered","user_id":240443,"link":"https://stackoverflow.com/users/240443/amadan","reputation":192896,"display_name":"Amadan","accept_rate":79},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"edited":false,"creation_date":1562307567,"comment_id":100340619,"body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/33772376/how-to-allow-variables-being-set-only-once-in-java\">How to allow variables being set only once in java</a>, <a href=\"https://stackoverflow.com/questions/14146182/how-to-create-a-variable-that-can-be-set-only-once-but-isnt-final-in-java\">How to create a variable that can be set only once but isn&#39;t final in Java</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 4.0","score":1,"post_id":56897420,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=256&d=identicon&r=PG","account_id":86477,"user_type":"registered","user_id":240443,"link":"https://stackoverflow.com/users/240443/amadan","reputation":192896,"display_name":"Amadan","accept_rate":79},"edited":false,"creation_date":1562307563,"comment_id":100340615,"body":"@Amadan What???"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 4.0","score":0,"post_id":56897420,"edited":false,"creation_date":1562307536,"comment_id":100340601,"body":"Note that &quot;effectively final&quot; fields don&#39;t have the same thread-safety guarantees as the actual <code>final</code> keyword."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=256&d=identicon&r=PG","account_id":86477,"user_type":"registered","user_id":240443,"link":"https://stackoverflow.com/users/240443/amadan","reputation":192896,"display_name":"Amadan","accept_rate":79},"content_license":"CC BY-SA 4.0","score":1,"post_id":56897420,"edited":false,"creation_date":1562307394,"comment_id":100340547,"body":"<a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html\" rel=\"nofollow noreferrer\"><code>CompletableFuture</code></a>? &quot;When two or more threads attempt to complete, completeExceptionally, or cancel a CompletableFuture, only one of them succeeds.&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4c3acc21c6d768e3875ebac67b53bdf?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8086222,"user_type":"registered","user_id":6093696,"link":"https://stackoverflow.com/users/6093696/eric","reputation":906,"display_name":"Eric"},"content_license":"CC BY-SA 4.0","score":1,"post_id":56893624,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=256&d=identicon&r=PG","account_id":536567,"user_type":"registered","user_id":905488,"link":"https://stackoverflow.com/users/905488/mick-mnemonic","reputation":7838,"display_name":"Mick Mnemonic"},"edited":false,"creation_date":1562273085,"comment_id":100334350,"body":"@MickMnemonic, I wouldn&#39;t recommend plain old Akka actors since there is no back-pressure and at-most delivery is the default guarantee. Akka Streams on the other hand are reactive but the learning curve is steep!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b5772cd098fe7c457af4c4269d3a884e?s=256&d=identicon&r=PG","account_id":2705724,"user_type":"registered","user_id":5264558,"link":"https://stackoverflow.com/users/5264558/daniele","reputation":2702,"display_name":"Daniele"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56893624,"edited":false,"creation_date":1562272445,"comment_id":100334201,"body":"Anyway, you can use executors only; the concurrent processing is done with an executor with N threads, and the sequential part can be done with a single-threaded executor. (no need to use blocking queue directly). Maybe have a look at guava&#39;s listenable futures?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b5772cd098fe7c457af4c4269d3a884e?s=256&d=identicon&r=PG","account_id":2705724,"user_type":"registered","user_id":5264558,"link":"https://stackoverflow.com/users/5264558/daniele","reputation":2702,"display_name":"Daniele"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56893624,"edited":false,"creation_date":1562272098,"comment_id":100334116,"body":"&quot;without infinite memory&quot;- are they consumed faster than they are produced? (otherwise obv. your queues can grow indefinitely.)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/efb324daddc3ad22736171ba863234d8?s=256&d=identicon&r=PG","account_id":536567,"user_type":"registered","user_id":905488,"link":"https://stackoverflow.com/users/905488/mick-mnemonic","reputation":7838,"display_name":"Mick Mnemonic"},"content_license":"CC BY-SA 4.0","score":1,"post_id":56893624,"edited":false,"creation_date":1562270363,"comment_id":100333683,"body":"If you&#39;re looking for a framework, maybe <a href=\"https://akka.io/\" rel=\"nofollow noreferrer\">akka.io</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4c3acc21c6d768e3875ebac67b53bdf?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8086222,"user_type":"registered","user_id":6093696,"link":"https://stackoverflow.com/users/6093696/eric","reputation":906,"display_name":"Eric"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56880178,"edited":false,"creation_date":1562230437,"comment_id":100315691,"body":"I think it depends entirely upon what your supplier and predicate looks like. In your example, it doesn&#39;t seem like there is any happens-before relation between the reads and writes to <code>instance</code> that would prevent a data race. Although, I wonder if you change your code such that your predicate checks <code>instanceCount</code> and if you make sure to initialize all your fields in the singleton before calling <code>instanceCount.incrementAndGet()</code> if that would be enough."},{"owner":{"profile_image":"https://i.stack.imgur.com/pYuGC.jpg?s=256&g=1","account_id":3977767,"user_type":"registered","user_id":3280538,"link":"https://stackoverflow.com/users/3280538/flakes","reputation":22190,"display_name":"flakes","accept_rate":74},"content_license":"CC BY-SA 4.0","score":0,"post_id":56880178,"edited":false,"creation_date":1562214405,"comment_id":100309346,"body":"I want to say no. I believe this falls prey to the same issues as the normal DCL solutions where the static field <code>instance</code> should be volatile to alleviate data-race issues. See <a href=\"https://stackoverflow.com/questions/49840773/need-of-volatile-keyword-in-case-of-dcl\">this answer</a> for the standard <code>volatile</code> approach. What I&#39;m unsure of is if the use of the supplier would return a fully initialized object, or fall prey to the same issues as the non-wrapped constructor call (i.e because of use of method-reference)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f9702bb76cf5f671cf6aa94a18df6259?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6302434,"user_type":"registered","user_id":4896651,"link":"https://stackoverflow.com/users/4896651/shadov","reputation":5409,"display_name":"Shadov","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":56880178,"edited":false,"creation_date":1562211282,"comment_id":100308831,"body":"Ran some jcstress tests on it, seems like it works."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1562073245,"comment_id":100256648,"body":"Hint: If a reader or writer thread cannot proceed due to being excluded by the lock, it has to <code>wait</code> until the lock is released. Each time a thread releases a lock, it <i>notifies</i> any/all <i>wait</i>ing threads that the lock&#39;s state has changed and those threads then re-check if they can proceed and either go <code>wait</code>ing again or acquire the lock and continue."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31758f7b69fb8af29b79575853c19ae4?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15128202,"user_type":"registered","user_id":10916892,"link":"https://stackoverflow.com/users/10916892/user10916892","reputation":847,"display_name":"user10916892"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1562072548,"comment_id":100256239,"body":"Can anyone please share some code ? I am not able to get it correct yet."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31758f7b69fb8af29b79575853c19ae4?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15128202,"user_type":"registered","user_id":10916892,"link":"https://stackoverflow.com/users/10916892/user10916892","reputation":847,"display_name":"user10916892"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"edited":false,"creation_date":1562072505,"comment_id":100256212,"body":"@JimmyB thanks but still i need to have a way to release the lock at my will, not sure how to do that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1562066521,"comment_id":100252730,"body":"I suggest not calling the synchronization object <code>writeLock</code>. Rather think about it this way: The <code>SharedResource</code> (as a synchronization tool) has some internal state composed of one or more data fields, and accesses to those data fields, both by &#39;readers&#39; and &#39;writers&#39;, need to be protected against illegal concurrent accesses via a single synchronization object."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1562065488,"comment_id":100252225,"body":"You also cannot call <code>obj.wait()</code> or <code>obj.notify()</code> if you don&#39;t hold the monitor on <code>obj</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1562065308,"comment_id":100252122,"body":"Your updated code is half-way there now. You must however make sure that checks of conditions, e.g. <code>if (canReadContinue)</code>, happen inside the same critical section as the action taken based on the condition. - Where is <code>canReadContinue</code> ever set to false? Also, <code>synchronized</code> implies a &quot;memory barrier&quot;, so variables to which <i>all</i> accesses are protected via <code>synchronized</code> need not be <code>volatile</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/DOSFM.jpg?s=256&g=1","account_id":3076714,"user_type":"registered","user_id":2605850,"link":"https://stackoverflow.com/users/2605850/vinay-sharma","reputation":1193,"display_name":"Vinay Sharma","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":56847027,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/68339d6cdb18de89897c8b8bd5b6e44a?s=256&d=identicon&r=PG","account_id":2844499,"user_type":"registered","user_id":2443288,"link":"https://stackoverflow.com/users/2443288/david","reputation":599,"display_name":"David","accept_rate":100},"edited":false,"creation_date":1562063132,"comment_id":100250958,"body":"@David would you like to share little more details."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/68339d6cdb18de89897c8b8bd5b6e44a?s=256&d=identicon&r=PG","account_id":2844499,"user_type":"registered","user_id":2443288,"link":"https://stackoverflow.com/users/2443288/david","reputation":599,"display_name":"David","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":56847027,"edited":false,"creation_date":1562057090,"comment_id":100247746,"body":"ConcurrentHashMap  would definitely work but you could implement your resource in a way where the caller doesn&#39;t have to hold the readlock (you could grab the readlock internally when the read is called) and similarly with the writelock"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":56836221,"edited":false,"creation_date":1561998474,"comment_id":100230738,"body":"<a href=\"https://stackoverflow.com/a/24022445/2711488\">This answer</a> contains a JDK 1.4 compatible reentrant lock implementation. Take it as an exercise, to extend it to a read-write lock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/JNHZt.jpg?s=256&g=1","account_id":4962253,"user_type":"registered","user_id":3992939,"link":"https://stackoverflow.com/users/3992939/c0der","reputation":18492,"display_name":"c0der","accept_rate":73},"edited":false,"creation_date":1561989757,"comment_id":100226593,"body":"@c0der You&#39;d still need some shared (&quot;read&quot;) lock for the multiple readers."},{"owner":{"profile_image":"https://i.stack.imgur.com/JNHZt.jpg?s=256&g=1","account_id":4962253,"user_type":"registered","user_id":3992939,"link":"https://stackoverflow.com/users/3992939/c0der","reputation":18492,"display_name":"c0der","accept_rate":73},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"edited":false,"creation_date":1561989120,"comment_id":100226284,"body":"@JimmyB I mean have a mechanism where read locks only write. Write locks both."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1561989026,"comment_id":100226228,"body":"Without 1.5, you have to use <code>Object.wait</code> and <code>Object.notify</code>.  I don&#39;t want to write it out in an answer, because it&#39;s annoying :)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6fe43a9d31f2308c4e64a62cf0c310d1?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6095312,"user_type":"registered","user_id":4756299,"link":"https://stackoverflow.com/users/4756299/andrew-henle","reputation":33135,"display_name":"Andrew Henle"},"content_license":"CC BY-SA 4.0","score":1,"post_id":56836221,"edited":false,"creation_date":1561988728,"comment_id":100226081,"body":"<i>lets say JDK 1.4</i> Why?!?! That was last updated in <a href=\"https://en.wikipedia.org/wiki/Java_version_history\" rel=\"nofollow noreferrer\">2008</a>.  Java 8 is already five years old."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":1,"post_id":56836221,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/JNHZt.jpg?s=256&g=1","account_id":4962253,"user_type":"registered","user_id":3992939,"link":"https://stackoverflow.com/users/3992939/c0der","reputation":18492,"display_name":"c0der","accept_rate":73},"edited":false,"creation_date":1561988185,"comment_id":100225783,"body":"@c0der As long as both locks are <i>exclusive</i> locks, there&#39;s no benefit because readers would block other readers, which is not requested."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=256&d=identicon&r=PG","account_id":1000314,"user_type":"registered","user_id":1015327,"link":"https://stackoverflow.com/users/1015327/jimmyb","reputation":12261,"display_name":"JimmyB"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/5DblQ.png?s=256&g=1","account_id":8326,"user_type":"registered","user_id":14955,"link":"https://stackoverflow.com/users/14955/thilo","reputation":258555,"display_name":"Thilo","accept_rate":55},"edited":false,"creation_date":1561988067,"comment_id":100225721,"body":"@Thilo It&#39;s probably homework..."},{"owner":{"profile_image":"https://i.stack.imgur.com/JNHZt.jpg?s=256&g=1","account_id":4962253,"user_type":"registered","user_id":3992939,"link":"https://stackoverflow.com/users/3992939/c0der","reputation":18492,"display_name":"c0der","accept_rate":73},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1561987617,"comment_id":100225487,"body":"Have two locks. Read lock and write lock."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31758f7b69fb8af29b79575853c19ae4?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15128202,"user_type":"registered","user_id":10916892,"link":"https://stackoverflow.com/users/10916892/user10916892","reputation":847,"display_name":"user10916892"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/5DblQ.png?s=256&g=1","account_id":8326,"user_type":"registered","user_id":14955,"link":"https://stackoverflow.com/users/14955/thilo","reputation":258555,"display_name":"Thilo","accept_rate":55},"edited":false,"creation_date":1561987284,"comment_id":100225341,"body":"@Thilo lets say JDK 1.4"},{"owner":{"profile_image":"https://i.stack.imgur.com/5DblQ.png?s=256&g=1","account_id":8326,"user_type":"registered","user_id":14955,"link":"https://stackoverflow.com/users/14955/thilo","reputation":258555,"display_name":"Thilo","accept_rate":55},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1561987234,"comment_id":100225313,"body":"If it helps, there is a backport of java.util.concurrent for Java 1.3: <a href=\"http://backport-jsr166.sourceforge.net/\" rel=\"nofollow noreferrer\">backport-jsr166.sourceforge.net</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/5DblQ.png?s=256&g=1","account_id":8326,"user_type":"registered","user_id":14955,"link":"https://stackoverflow.com/users/14955/thilo","reputation":258555,"display_name":"Thilo","accept_rate":55},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"edited":false,"creation_date":1561987064,"comment_id":100225209,"body":"@user10916892 why is that? What is your target JDK version?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/31758f7b69fb8af29b79575853c19ae4?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15128202,"user_type":"registered","user_id":10916892,"link":"https://stackoverflow.com/users/10916892/user10916892","reputation":847,"display_name":"user10916892"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56836221,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"edited":false,"creation_date":1561986910,"comment_id":100225129,"body":"Thanks for the comment Andy but idea is not to use or have minimal use of Java 5 and above concurrency api classes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 4.0","score":7,"post_id":56836221,"edited":false,"creation_date":1561986223,"comment_id":100224757,"body":"Why not just use a <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReadWriteLock.html\" rel=\"nofollow noreferrer\"><code>ReadWriteLock</code></a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9a03c98f2758dd9307a5b114a5494604?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3990188,"user_type":"registered","user_id":3289405,"link":"https://stackoverflow.com/users/3289405/user3289405","reputation":137,"display_name":"user3289405"},"content_license":"CC BY-SA 4.0","score":0,"post_id":56706833,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/40d9bb2e8df635f2f598b7577c5b3eb9?s=256&d=identicon&r=PG","account_id":10326,"user_type":"registered","user_id":19450,"link":"https://stackoverflow.com/users/19450/ben-manes","reputation":9293,"display_name":"Ben Manes"},"edited":false,"creation_date":1561145168,"comment_id":99982062,"body":"The tutorial link did help. thank you!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40d9bb2e8df635f2f598b7577c5b3eb9?s=256&d=identicon&r=PG","account_id":10326,"user_type":"registered","user_id":19450,"link":"https://stackoverflow.com/users/19450/ben-manes","reputation":9293,"display_name":"Ben Manes"},"content_license":"CC BY-SA 4.0","score":2,"post_id":56706833,"edited":false,"creation_date":1561134095,"comment_id":99977656,"body":"This <a href=\"https://www.baeldung.com/java-caching-caffeine\" rel=\"nofollow noreferrer\">tutorial</a> might help. It could simply be <code>return 42;</code>. The cache will invoke it atomically per-key, but it may be called concurrently across different keys. So any shared state (like an http client) has to be used in a threadsafe manner."},{"owner":{"profile_image":"https://i.stack.imgur.com/LEgo9.jpg?s=256&g=1","account_id":11415719,"user_type":"registered","user_id":10584605,"link":"https://stackoverflow.com/users/10584605/eto","reputation":7030,"display_name":"ETO"},"content_license":"CC BY-SA 4.0","score":0,"post_id":53332447,"edited":false,"creation_date":1542351326,"comment_id":93545222,"body":"Possible duplicate of <a href=\"https://stackoverflow.com/questions/826319/classcastexception-when-casting-to-the-same-class\">ClassCastException when casting to the same class</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d09ac82ef9d3d8ca179c95e9aaddd89c?s=256&d=identicon&r=PG","account_id":1677215,"user_type":"registered","user_id":1542453,"link":"https://stackoverflow.com/users/1542453/ylg","reputation":855,"display_name":"YLG","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":53319482,"edited":false,"creation_date":1542285031,"comment_id":93519033,"body":"<a href=\"https://docs.oracle.com/cd/B19306_01/server.102/b14220/transact.htm\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/B19306_01/server.102/b14220/transact.htm</a> Refer this."},{"owner":{"profile_image":"https://i.stack.imgur.com/98geJ.png?s=256&g=1","account_id":21819,"user_type":"registered","user_id":53341,"link":"https://stackoverflow.com/users/53341/matbailie","reputation":84238,"display_name":"MatBailie","accept_rate":93},"content_license":"CC BY-SA 4.0","score":0,"post_id":53319482,"edited":false,"creation_date":1542284983,"comment_id":93519004,"body":"Look in to Oracle&#39;s support for SAVEPOINTs.  You can then open a transaction, do some stuff, mark a save point, do more stuff, and on an error decide which save point to roll back to."},{"owner":{"profile_image":"https://i.stack.imgur.com/BBFAi.png?s=256&g=1","account_id":12937317,"user_type":"registered","user_id":9354242,"link":"https://stackoverflow.com/users/9354242/meini","reputation":77,"display_name":"Meini"},"content_license":"CC BY-SA 4.0","score":2,"post_id":53316923,"edited":false,"creation_date":1542277017,"comment_id":93514311,"body":"AFAIK the <code>@Lock</code> on <code>stopWaiting</code> is not recognized since you have to invoke it on the business object and not on <code>this</code>."},{"owner":{"profile_image":"https://graph.facebook.com/10212007640618238/picture?type=large","account_id":14745498,"user_type":"registered","user_id":10648986,"link":"https://stackoverflow.com/users/10648986/glexnor","reputation":21,"display_name":"Glexnor"},"content_license":"CC BY-SA 4.0","score":0,"post_id":53290957,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca03242df77ec2d8f70f2cea0d6209be?s=256&d=identicon&r=PG","account_id":61566,"user_type":"registered","user_id":183406,"link":"https://stackoverflow.com/users/183406/meriton","reputation":68934,"display_name":"meriton","accept_rate":74},"edited":false,"creation_date":1542152463,"comment_id":93463822,"body":"I been reading a lot about it but I am a bit lost. Theacher gave us this project last fryday and must be delivered on fryday 23th. And they gave us almost no information about this classes... I know I must keep reading, but anything could be very handy at this ponit hehe"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca03242df77ec2d8f70f2cea0d6209be?s=256&d=identicon&r=PG","account_id":61566,"user_type":"registered","user_id":183406,"link":"https://stackoverflow.com/users/183406/meriton","reputation":68934,"display_name":"meriton","accept_rate":74},"content_license":"CC BY-SA 4.0","score":1,"post_id":53290957,"edited":false,"creation_date":1542151671,"comment_id":93463630,"body":"A better way to approach this would be to identify what each of these concurrency primitives is intended for, for instance by reading their Javadoc. Then, you could answer not only this question, but pick the right tool for every concurrency problem you&#39;ll encounter in your career."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40d9bb2e8df635f2f598b7577c5b3eb9?s=256&d=identicon&r=PG","account_id":10326,"user_type":"registered","user_id":19450,"link":"https://stackoverflow.com/users/19450/ben-manes","reputation":9293,"display_name":"Ben Manes"},"content_license":"CC BY-SA 3.0","score":1,"post_id":49794862,"edited":false,"creation_date":1523547774,"comment_id":86616200,"body":"<code>CompletableFuture.orTimeout​(duration)</code> would be a good fit. You could combine that with <a href=\"https://github.com/ben-manes/caffeine\" rel=\"nofollow noreferrer\">Caffeine&#39;s</a> <code>AsyncLoadingCache</code> to compute and cache the work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a37ffb1ba4d217afeb48d58eea5ed23c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":232720,"user_type":"registered","user_id":497753,"link":"https://stackoverflow.com/users/497753/mannie","reputation":1625,"display_name":"Mannie","accept_rate":70},"content_license":"CC BY-SA 3.0","score":0,"post_id":49794862,"edited":false,"creation_date":1523540114,"comment_id":86610538,"body":"Thanks for your comment - The question has been greatly simplified to describe the problem; real world its not waiting 10seconds &amp; take it that the delay to respond is much less expensive than the time on connection establishment process - in this scenario &#39;best practice&#39; is to wait for a short period before giving up as 95-99% of the calls will complete in this timeframe eliminating the second call."},{"owner":{"profile_image":"https://i.stack.imgur.com/SD6L1.jpg?s=256&g=1","account_id":381513,"user_type":"registered","user_id":978567,"link":"https://stackoverflow.com/users/978567/edharned","reputation":1884,"display_name":"edharned"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49794862,"edited":false,"creation_date":1523539443,"comment_id":86610004,"body":"When a connection thread waits it ties up the network. This is not a good practice. I don&#39;t see your problem. If the result is not there, return &quot;not complete&quot; immediately. On the other hand your computation threads can publish a &quot;work in progress Object&quot; and update it periodically (if possible.) When the Object says, &quot;almost done&quot;, then maybe the connection thread may wait a second or two."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523538114,"comment_id":86608945,"body":"I was thinking about solving this with Spring Cache, but now it seems to be that it won&#39;t be suitable. I understand now what you want but I don&#39;t think it&#39;s actually cache. Looks more like some pub-sub."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8e90c639304d60bdbf04e5df714c1221?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8622016,"user_type":"registered","user_id":6456586,"link":"https://stackoverflow.com/users/6456586/denis-stephanov","reputation":4801,"display_name":"Denis Stephanov","accept_rate":63},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"edited":false,"creation_date":1523537877,"comment_id":86608773,"body":"save to database and also to cache. because when another user call load method from controller, this method will be async, and will periodically checked if there is some new data. I don&#39;t want to kill database with too much requests, so because I want it check in loop just cache in database"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523537657,"comment_id":86608602,"body":"So you basically want to save a database call or what?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8e90c639304d60bdbf04e5df714c1221?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8622016,"user_type":"registered","user_id":6456586,"link":"https://stackoverflow.com/users/6456586/denis-stephanov","reputation":4801,"display_name":"Denis Stephanov","accept_rate":63},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"edited":false,"creation_date":1523536884,"comment_id":86607976,"body":"@lexicore I want cache data manually, when in controller is called save method. This data are saved into database and also into cache where it will be waiting until another user call load method by controller, and this data read and delete from cache."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523536639,"comment_id":86607777,"body":"First question is which call do you actually want to cache."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523536535,"comment_id":86607708,"body":"This is my point - it is hard to understand how you actually want to use a cache."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8e90c639304d60bdbf04e5df714c1221?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8622016,"user_type":"registered","user_id":6456586,"link":"https://stackoverflow.com/users/6456586/denis-stephanov","reputation":4801,"display_name":"Denis Stephanov","accept_rate":63},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"edited":false,"creation_date":1523536452,"comment_id":86607642,"body":"@lexicore In code I don&#39;t use real cache, I only show example how I want to use cache if it possible."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523535333,"comment_id":86606801,"body":"And why do you remove <code>recepient</code> from the cache if <code>cache</code> did not contain the recepient anyway?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a42f8ff287eb5abf432ce696bf7c653b?s=256&d=identicon&r=PG","account_id":115767,"user_type":"registered","user_id":303810,"link":"https://stackoverflow.com/users/303810/lexicore","reputation":42976,"display_name":"lexicore","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":49796004,"edited":false,"creation_date":1523535251,"comment_id":86606740,"body":"I don&#39;t see in your code where you actually put data into your cache."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f3ebc16d77ca1a98356d5a4d115dc4e4?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6429356,"user_type":"registered","user_id":4983196,"link":"https://stackoverflow.com/users/4983196/gippy-aulakh","reputation":104,"display_name":"Gippy Aulakh"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49794862,"edited":false,"creation_date":1523532206,"comment_id":86604717,"body":"have you tried Thread.sleep(1000); Just put these before the statement where you want to take pause"},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49791645,"edited":false,"creation_date":1523523317,"comment_id":86598798,"body":"This is a really bad question (the mock question I mean)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3fb5cc3bf8c821ed846880c22c154743?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10279879,"user_type":"registered","user_id":7585450,"link":"https://stackoverflow.com/users/7585450/codeninja","reputation":55,"display_name":"Codeninja"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49791645,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ac3d067c37ac7b414d7a4fdffa646594?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6094808,"user_type":"registered","user_id":4755974,"link":"https://stackoverflow.com/users/4755974/veselin-davidov","reputation":7041,"display_name":"Veselin Davidov"},"edited":false,"creation_date":1523522740,"comment_id":86598385,"body":"@Veselin Davidov , can you please explain the reason for this output?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ac3d067c37ac7b414d7a4fdffa646594?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6094808,"user_type":"registered","user_id":4755974,"link":"https://stackoverflow.com/users/4755974/veselin-davidov","reputation":7041,"display_name":"Veselin Davidov"},"content_license":"CC BY-SA 3.0","score":1,"post_id":49791645,"edited":false,"creation_date":1523522546,"comment_id":86598222,"body":"I just got 0, 2, 4, 6, 0, 2, 4, 6,  which is different than A and B :)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3fb5cc3bf8c821ed846880c22c154743?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10279879,"user_type":"registered","user_id":7585450,"link":"https://stackoverflow.com/users/7585450/codeninja","reputation":55,"display_name":"Codeninja"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49791645,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2317715305ab2adcf04c0d6888c0446c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3939498,"user_type":"registered","user_id":3254536,"link":"https://stackoverflow.com/users/3254536/neijwiert","reputation":995,"display_name":"Neijwiert","accept_rate":89},"edited":false,"creation_date":1523522327,"comment_id":86598087,"body":"Thanks for the reply @Neijwiert , can you please elaborate"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2317715305ab2adcf04c0d6888c0446c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3939498,"user_type":"registered","user_id":3254536,"link":"https://stackoverflow.com/users/3254536/neijwiert","reputation":995,"display_name":"Neijwiert","accept_rate":89},"content_license":"CC BY-SA 3.0","score":0,"post_id":49791645,"edited":false,"creation_date":1523521998,"comment_id":86597907,"body":"If a statement is on a single line it doesn&#39;t mean it gets executed in a single cpu cycle."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=256&d=identicon&r=PG","account_id":44195,"user_type":"registered","user_id":129570,"link":"https://stackoverflow.com/users/129570/oliver-charlesworth","reputation":269053,"display_name":"Oliver Charlesworth","accept_rate":79},"content_license":"CC BY-SA 3.0","score":0,"post_id":49782916,"edited":false,"creation_date":1523474560,"comment_id":86581177,"body":"It&#39;s also worth noting that the heap and the cache are not distinct things.  The heap is an abstraction, built inside virtual memory.  That itself is an abstraction on top of physical memory, parts of which are duplicated into various caches at various times."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e6e618a83a21b4d17d1af0310d706b13?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10886234,"user_type":"registered","user_id":8003647,"link":"https://stackoverflow.com/users/8003647/miao","reputation":85,"display_name":"Miao"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49782916,"edited":false,"creation_date":1523474508,"comment_id":86581149,"body":"Yes, I think they are the only cache there are if I&#39;m right"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=256&d=identicon&r=PG","account_id":44195,"user_type":"registered","user_id":129570,"link":"https://stackoverflow.com/users/129570/oliver-charlesworth","reputation":269053,"display_name":"Oliver Charlesworth","accept_rate":79},"content_license":"CC BY-SA 3.0","score":0,"post_id":49782916,"edited":false,"creation_date":1523474492,"comment_id":86581146,"body":"The Java Memory Model defines what guarantees exist around accessing data from multiple threads.  If you use suitable locking constructs (etc.), then these questions are moot."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 3.0","score":0,"post_id":49782916,"edited":false,"creation_date":1523474487,"comment_id":86581142,"body":"&quot;Does a multi-thread suffer of visibility problem?&quot; Yes."},{"owner":{"profile_image":"https://i.stack.imgur.com/oIJia.png?s=256&g=1","account_id":318397,"user_type":"registered","user_id":635608,"link":"https://stackoverflow.com/users/635608/mat","reputation":203598,"display_name":"Mat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49782916,"edited":false,"creation_date":1523474408,"comment_id":86581087,"body":"Are you talking about the CPU cache (L1, L2 etc)?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1988d60d9df1a4aaecc77ffc49532a5a?s=256&d=identicon&r=PG","account_id":1310600,"user_type":"registered","user_id":1258669,"link":"https://stackoverflow.com/users/1258669/otuser","reputation":3828,"display_name":"OTUser","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":49780277,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"edited":false,"creation_date":1523464584,"comment_id":86576077,"body":"@Kayaman thanks for the suggestion, I&#39;ll get rid of <code>LOGGER.isErrorEnabled()</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":1,"post_id":49780277,"edited":false,"creation_date":1523464391,"comment_id":86575966,"body":"You know you don&#39;t need to call <code>LOGGER.isErrorEnabled()</code> everytime before you log? It&#39;s a useless micro-optimization from the olden days. It may be useful in the <b>rare</b> case where constructing the log message itself can be expensive."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/88f3b89cfc3c38ea4f65acaa989929bb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10593585,"user_type":"registered","user_id":7803223,"link":"https://stackoverflow.com/users/7803223/uhel","reputation":3,"display_name":"Uhel"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49764014,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/35fe6d7d24896378ec1c5ea80423a9d6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3480698,"user_type":"registered","user_id":2912841,"link":"https://stackoverflow.com/users/2912841/nitnamby","reputation":404,"display_name":"nitnamby"},"edited":false,"creation_date":1523460920,"comment_id":86573672,"body":"I see now, I  will try to implement this version as well just for my reference however the exam question was requesting conditions written in an answer given by @Guts  Thanks"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/35fe6d7d24896378ec1c5ea80423a9d6?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3480698,"user_type":"registered","user_id":2912841,"link":"https://stackoverflow.com/users/2912841/nitnamby","reputation":404,"display_name":"nitnamby"},"content_license":"CC BY-SA 3.0","score":1,"post_id":49764014,"edited":false,"creation_date":1523446922,"comment_id":86563131,"body":"You could use a <code>ReadWriteLock</code> to control access between Admin and Non admin users instead of a making the whole method Synchronized .  The code could look lot simpler.  Admin users could acquire a WriteLock while other users can use a ReadLock for concurrent access."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/db0a0198951e15aadcb42b40452c29f7?s=256&d=identicon&r=PG","account_id":24127,"user_type":"registered","user_id":61158,"link":"https://stackoverflow.com/users/61158/akarnokd","reputation":69392,"display_name":"akarnokd","accept_rate":98},"content_license":"CC BY-SA 3.0","score":1,"post_id":49765151,"edited":false,"creation_date":1523432859,"comment_id":86553723,"body":"See the relevant section in the <a href=\"https://github.com/ReactiveX/RxJava#continuations\" rel=\"nofollow noreferrer\">Getting Started</a>."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 3.0","score":1,"post_id":49763724,"edited":false,"creation_date":1523429393,"comment_id":86551746,"body":"Are you sure that <code>x</code> has the type <code>Map&lt;String, String&gt;</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"edited":false,"creation_date":1523400775,"comment_id":86543510,"body":"Build a new class that holds the two maps, and give it two methods: one  that takes in <code>req</code> and updates the maps accordingly, and one that combines two instance of this class."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1d368ad2d022237279a697202cca3510?s=256&d=identicon&r=PG","account_id":1869832,"user_type":"registered","user_id":1692342,"link":"https://stackoverflow.com/users/1692342/user1692342","reputation":5089,"display_name":"user1692342","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"edited":false,"creation_date":1523400719,"comment_id":86543499,"body":"@LouisWasserman Yes thats what I want to move towards. Using a Collector. If it was a single map I was writing to, I could have just return a K,V pair with SingleEntry, but I need to collect 2 maps. That&#39;s were I&#39;m unable to go ahead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ae7bb06b9a23a4dd7eea69e853d47d12?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":465573,"user_type":"registered","user_id":869736,"link":"https://stackoverflow.com/users/869736/louis-wasserman","reputation":192703,"display_name":"Louis Wasserman","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"edited":false,"creation_date":1523400624,"comment_id":86543473,"body":"You would have to use a <code>Collector</code>.  Do not use <code>put</code> or any other operation that modifies state in a parallel stream (or, ideally, any other stream).  You will probably have to build a heavily customized collector for this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1d368ad2d022237279a697202cca3510?s=256&d=identicon&r=PG","account_id":1869832,"user_type":"registered","user_id":1692342,"link":"https://stackoverflow.com/users/1692342/user1692342","reputation":5089,"display_name":"user1692342","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"edited":false,"creation_date":1523399958,"comment_id":86543289,"body":"@shmosel Sorry. Forgot to update code. Updated now"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"edited":false,"creation_date":1523399679,"comment_id":86543215,"body":"<code>response.getTitle()</code> returns a boolean??"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1d368ad2d022237279a697202cca3510?s=256&d=identicon&r=PG","account_id":1869832,"user_type":"registered","user_id":1692342,"link":"https://stackoverflow.com/users/1692342/user1692342","reputation":5089,"display_name":"user1692342","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":49763724,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"edited":false,"creation_date":1523399621,"comment_id":86543202,"body":"@shmosel Updated the question (at the end)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 3.0","score":2,"post_id":49763724,"edited":false,"creation_date":1523399361,"comment_id":86543137,"body":"You haven&#39;t really explained what you&#39;re trying to do. Also, your code is full of compile errors."},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":0,"post_id":49747795,"edited":false,"creation_date":1523345497,"comment_id":86510063,"body":"It&#39;s like the capacity/fillfactor trade-off with a regular <code>HashMap</code>. Depends on what you need. That&#39;s why they&#39;re configurable."},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":3,"post_id":49747070,"edited":false,"creation_date":1523342933,"comment_id":86508479,"body":"So you&#39;re using a <b>non-threadsafe</b> map. What do you think?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1d368ad2d022237279a697202cca3510?s=256&d=identicon&r=PG","account_id":1869832,"user_type":"registered","user_id":1692342,"link":"https://stackoverflow.com/users/1692342/user1692342","reputation":5089,"display_name":"user1692342","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":49747070,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/11bd6a01c0f2042a2aa1b5133ffaa9bd?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5122294,"user_type":"registered","user_id":4105457,"link":"https://stackoverflow.com/users/4105457/flown","reputation":11550,"display_name":"Flown"},"edited":false,"creation_date":1523342846,"comment_id":86508436,"body":"@Flown Updated question. Added my map implementation type"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/11bd6a01c0f2042a2aa1b5133ffaa9bd?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5122294,"user_type":"registered","user_id":4105457,"link":"https://stackoverflow.com/users/4105457/flown","reputation":11550,"display_name":"Flown"},"content_license":"CC BY-SA 3.0","score":4,"post_id":49747070,"edited":false,"creation_date":1523342769,"comment_id":86508385,"body":"Is your <code>Map</code> implementation thread safe?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/08a2c6f16c0d4dad20d169d9d76848ac?s=256&d=identicon&r=PG","account_id":208953,"user_type":"registered","user_id":459745,"link":"https://stackoverflow.com/users/459745/hai-vu","reputation":38291,"display_name":"Hai Vu","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":48124257,"edited":false,"creation_date":1515213166,"comment_id":83225474,"body":"You might want to look into the <code>Manager</code> object in the <a href=\"https://docs.python.org/2/library/multiprocessing.html#managers\" rel=\"nofollow noreferrer\">multiprocessing</a> module"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/604c028c06a1de9248ea22d9d4b64caa?s=256&d=identicon&r=PG","account_id":1925486,"user_type":"registered","user_id":1736049,"link":"https://stackoverflow.com/users/1736049/user1736049","reputation":366,"display_name":"user1736049","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":46484053,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ygjaF.png?s=256&g=1","account_id":559545,"user_type":"registered","user_id":921834,"link":"https://stackoverflow.com/users/921834/andrei-zaitcev","reputation":1388,"display_name":"andrei_zaitcev"},"edited":false,"creation_date":1506672808,"comment_id":79923475,"body":"@andrei_zaitcev it is to gather the data that is given within the same timestamp (second) in one object. I am very open to other approaches of doing this. These callback methods are called at different times, but can have data at the same timestamp."},{"owner":{"profile_image":"https://i.stack.imgur.com/ygjaF.png?s=256&g=1","account_id":559545,"user_type":"registered","user_id":921834,"link":"https://stackoverflow.com/users/921834/andrei-zaitcev","reputation":1388,"display_name":"andrei_zaitcev"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46484053,"edited":false,"creation_date":1506672579,"comment_id":79923330,"body":"Why do you need a <code>while</code> loop? Doesn&#39;t the SDK&#39;s api provide a descent method with callbacks to get a data from sensors?"},{"owner":{"profile_image":"https://i.stack.imgur.com/Rjx6y.png?s=256&g=1","account_id":204659,"user_type":"registered","user_id":453005,"link":"https://stackoverflow.com/users/453005/dwb","reputation":37559,"display_name":"DwB","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":46436946,"edited":false,"creation_date":1506522803,"comment_id":79856836,"body":"That is in no way reasonable.  You can not, reasonably, limit the scale of synchronization on the list because there are multiple way to access a given element in the list (iterator, enumerator, access-by-index) and growing the list by one element can cause a complete rebuild of the array (i.e. allocate new array, copy old elements, dump old array)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c4692a85d90bd5ba033227f7ff61eeea?s=256&d=identicon&r=PG","account_id":2134700,"user_type":"registered","user_id":1894777,"link":"https://stackoverflow.com/users/1894777/tonywen","reputation":71,"display_name":"TonyWen","accept_rate":50},"content_license":"CC BY-SA 3.0","score":0,"post_id":46436946,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Rjx6y.png?s=256&g=1","account_id":204659,"user_type":"registered","user_id":453005,"link":"https://stackoverflow.com/users/453005/dwb","reputation":37559,"display_name":"DwB","accept_rate":100},"edited":false,"creation_date":1506486290,"comment_id":79835242,"body":"@DwB thanks for the info. Actually, I found that, from source code of Vector or synchronizedList, synchronized keyword is used to ensure thread safety. Take get() for example, thread A wants to call get(0), while thread B wants to call get(1), using synchronized will only allow one thread call get() function even though two threads are trying to read data from different location. What I am trying to do is to do this simultaneously if threads are accessing different slots."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=256&d=identicon&r=PG","account_id":2734060,"user_type":"registered","user_id":2357112,"link":"https://stackoverflow.com/users/2357112/user2357112","reputation":263892,"display_name":"user2357112","accept_rate":26},"content_license":"CC BY-SA 3.0","score":5,"post_id":46438859,"edited":false,"creation_date":1506482362,"comment_id":79834349,"body":"If you&#39;re trying to reason about multithreaded program semantics, cache and RAM are not what you should be thinking about. Learn the Java memory model. Think in terms of the Java memory model, not cache and RAM."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=256&d=identicon&r=PG","account_id":2734060,"user_type":"registered","user_id":2357112,"link":"https://stackoverflow.com/users/2357112/user2357112","reputation":263892,"display_name":"user2357112","accept_rate":26},"content_license":"CC BY-SA 3.0","score":1,"post_id":46438859,"edited":false,"creation_date":1506482247,"comment_id":79834320,"body":"Cache use happens automatically. It&#39;s handled by the processor."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=256&d=identicon&r=PG","account_id":279365,"user_type":"registered","user_id":574479,"link":"https://stackoverflow.com/users/574479/biziclop","reputation":49126,"display_name":"biziclop","accept_rate":87},"content_license":"CC BY-SA 3.0","score":1,"post_id":46436946,"edited":false,"creation_date":1506467038,"comment_id":79830987,"body":"I assume this is an exercise and not an easy one as there are built-in concurrent collections in the JDK."},{"owner":{"profile_image":"https://i.stack.imgur.com/Rjx6y.png?s=256&g=1","account_id":204659,"user_type":"registered","user_id":453005,"link":"https://stackoverflow.com/users/453005/dwb","reputation":37559,"display_name":"DwB","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":46436946,"edited":false,"creation_date":1506466429,"comment_id":79830846,"body":"That exists, it is called Vector."},{"owner":{"profile_image":"https://graph.facebook.com/888524107876859/picture?type=large","account_id":5961968,"user_type":"registered","user_id":4686871,"link":"https://stackoverflow.com/users/4686871/sergei-sirik","reputation":1269,"display_name":"Sergei Sirik","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":46436946,"edited":false,"creation_date":1506466388,"comment_id":79830835,"body":"What about <code>List list = Collections.synchronizedList(new ArrayList());</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dea2252138dd9905af87cd6803fb5665?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1939636,"user_type":"registered","user_id":1746118,"link":"https://stackoverflow.com/users/1746118/naman","reputation":28467,"display_name":"Naman","accept_rate":95},"content_license":"CC BY-SA 3.0","score":0,"post_id":46377086,"edited":false,"creation_date":1506151882,"comment_id":79713029,"body":"Please also refer to <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/java/util/concurrent/&hellip;</a> and verify LinkedBlockingQueue is not used in the class."},{"owner":{"profile_image":"https://i.stack.imgur.com/Ru56X.jpg?s=256&g=1","account_id":8418204,"user_type":"registered","user_id":6317835,"link":"https://stackoverflow.com/users/6317835/feidd","reputation":33,"display_name":"FeidD"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46377086,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dea2252138dd9905af87cd6803fb5665?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1939636,"user_type":"registered","user_id":1746118,"link":"https://stackoverflow.com/users/1746118/naman","reputation":28467,"display_name":"Naman","accept_rate":95},"edited":false,"creation_date":1506151512,"comment_id":79712949,"body":"you can search about method iterator;there <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/LinkedBlockingQueue.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/java/util/concurrent/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/Ru56X.jpg?s=256&g=1","account_id":8418204,"user_type":"registered","user_id":6317835,"link":"https://stackoverflow.com/users/6317835/feidd","reputation":33,"display_name":"FeidD"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46377086,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dea2252138dd9905af87cd6803fb5665?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1939636,"user_type":"registered","user_id":1746118,"link":"https://stackoverflow.com/users/1746118/naman","reputation":28467,"display_name":"Naman","accept_rate":95},"edited":false,"creation_date":1506151450,"comment_id":79712936,"body":"ref LinkedBlockingQueue"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dea2252138dd9905af87cd6803fb5665?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":1939636,"user_type":"registered","user_id":1746118,"link":"https://stackoverflow.com/users/1746118/naman","reputation":28467,"display_name":"Naman","accept_rate":95},"content_license":"CC BY-SA 3.0","score":0,"post_id":46377086,"edited":false,"creation_date":1506151248,"comment_id":79712895,"body":"the java doc you quoted is from which class or method?"},{"owner":{"profile_image":"https://i.stack.imgur.com/7ghSp.jpg?s=256&g=1","account_id":238684,"user_type":"registered","user_id":507738,"link":"https://stackoverflow.com/users/507738/mc-emperor","reputation":22543,"display_name":"MC Emperor","accept_rate":71},"content_license":"CC BY-SA 3.0","score":0,"post_id":45857765,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1503566750,"comment_id":78673399,"body":"@daniu That&#39;s the thing I was wondering as well, hence my confusion."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":45857765,"edited":false,"creation_date":1503566724,"comment_id":78673370,"body":"How would another thread have a reference to an object the constructor of which has not finished executing yet?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1084b173b00aaa4d371f441fa8a2cc07?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10554252,"user_type":"registered","user_id":7775986,"link":"https://stackoverflow.com/users/7775986/lealo","reputation":331,"display_name":"Lealo"},"content_license":"CC BY-SA 3.0","score":0,"post_id":3367192,"edited":false,"creation_date":1502469728,"comment_id":78239526,"body":"if you use a while instead of an if statement inside your thread - does that mean that you create a new loop everytime your thread runs?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42722195,"edited":false,"creation_date":1489415791,"comment_id":72647721,"body":"<i>might be</i> means <i>might be</i>."},{"owner":{"profile_image":"https://graph.facebook.com/1280649655351226/picture?type=large","account_id":10448311,"user_type":"registered","user_id":7702742,"link":"https://stackoverflow.com/users/7702742/kaidong-wu","reputation":3,"display_name":"Kaidong Wu"},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5ab2cb96e5967ee0f535b09c2aa8ba6f?s=256&d=identicon&r=PG","account_id":3506889,"user_type":"registered","user_id":2932228,"link":"https://stackoverflow.com/users/2932228/alon-segal","reputation":828,"display_name":"Alon Segal","accept_rate":75},"edited":false,"creation_date":1489407518,"comment_id":72641982,"body":"@AlonSegal  is just some question in the lesson, now i know what the problem is ."},{"owner":{"profile_image":"https://graph.facebook.com/1280649655351226/picture?type=large","account_id":10448311,"user_type":"registered","user_id":7702742,"link":"https://stackoverflow.com/users/7702742/kaidong-wu","reputation":3,"display_name":"Kaidong Wu"},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b8838b740a8c26535020a06d2a6d4735?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10108456,"user_type":"registered","user_id":7470253,"link":"https://stackoverflow.com/users/7470253/m-prokhorov","reputation":3914,"display_name":"M. Prokhorov"},"edited":false,"creation_date":1489407473,"comment_id":72641957,"body":"@M.Prokhorov yeah, maybe is the synchronized problem"},{"owner":{"profile_image":"https://graph.facebook.com/1280649655351226/picture?type=large","account_id":10448311,"user_type":"registered","user_id":7702742,"link":"https://stackoverflow.com/users/7702742/kaidong-wu","reputation":3,"display_name":"Kaidong Wu"},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"edited":false,"creation_date":1489407436,"comment_id":72641928,"body":"@HedraWD  I didn&#39;t have it"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5ab2cb96e5967ee0f535b09c2aa8ba6f?s=256&d=identicon&r=PG","account_id":3506889,"user_type":"registered","user_id":2932228,"link":"https://stackoverflow.com/users/2932228/alon-segal","reputation":828,"display_name":"Alon Segal","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"edited":false,"creation_date":1489406266,"comment_id":72641197,"body":"Why are you using both semaphores and monitor (synchronized)?"},{"owner":{"profile_image":"https://i.stack.imgur.com/LdDoZ.png?s=256&g=1","account_id":957028,"user_type":"registered","user_id":982149,"link":"https://stackoverflow.com/users/982149/fildor","reputation":15143,"display_name":"Fildor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"edited":false,"creation_date":1489406252,"comment_id":72641183,"body":"tl;dr Why use Semaphores for this when java has <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Condition.html\" rel=\"nofollow noreferrer\">Conditions</a>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b8838b740a8c26535020a06d2a6d4735?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10108456,"user_type":"registered","user_id":7470253,"link":"https://stackoverflow.com/users/7470253/m-prokhorov","reputation":3914,"display_name":"M. Prokhorov"},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"edited":false,"creation_date":1489406246,"comment_id":72641179,"body":"You didn&#39;t give one of the Semaphores any permits, which is probably why you can&#39;t aquire a permit from it and block indefinitely."},{"owner":{"profile_image":"https://i.stack.imgur.com/ndv13.jpg?s=256&g=1","account_id":4888356,"user_type":"registered","user_id":3940133,"link":"https://stackoverflow.com/users/3940133/hendrawd","reputation":2983,"display_name":"HendraWD","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":42762987,"edited":false,"creation_date":1489406161,"comment_id":72641126,"body":"isn&#39;t there any stacktrace?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42722195,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489393252,"comment_id":72633751,"body":"@Sotirios, marked topic is not duplicate."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42722195,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489391956,"comment_id":72633187,"body":"@Sotirios is it might be or it isguaranteed?"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":42757087,"edited":false,"creation_date":1489386121,"comment_id":72630842,"body":"consider making the variables <code>volatile</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/lLopV.png?s=256&g=1","account_id":7119515,"user_type":"registered","user_id":5444618,"link":"https://stackoverflow.com/users/5444618/guillaume-f","reputation":6055,"display_name":"Guillaume F.","accept_rate":83},"content_license":"CC BY-SA 3.0","score":0,"post_id":42756419,"edited":false,"creation_date":1489378920,"comment_id":72629035,"body":"I meant remove the test inside the synchronized block. Since you already do a test before the synchronized, the probability that your second test returns something else than null is very low. It will be more optimal to use putIfAbsent with a new instance of your object since it will fail very rarely. You can also remove the synchronized block completely."},{"owner":{"profile_image":"https://i.stack.imgur.com/I9DXX.jpg?s=256&g=1","account_id":940012,"user_type":"registered","user_id":968244,"link":"https://stackoverflow.com/users/968244/isapir","reputation":21855,"display_name":"isapir","accept_rate":58},"content_license":"CC BY-SA 3.0","score":0,"post_id":42756419,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/lLopV.png?s=256&g=1","account_id":7119515,"user_type":"registered","user_id":5444618,"link":"https://stackoverflow.com/users/5444618/guillaume-f","reputation":6055,"display_name":"Guillaume F.","accept_rate":83},"edited":false,"creation_date":1489378640,"comment_id":72628984,"body":"@GuillaumeF. Can you explain what you mean by more optimal? At that point I know for a fact that the key is absent since I check for it inside a synchronized block and I get a null value."},{"owner":{"profile_image":"https://i.stack.imgur.com/lLopV.png?s=256&g=1","account_id":7119515,"user_type":"registered","user_id":5444618,"link":"https://stackoverflow.com/users/5444618/guillaume-f","reputation":6055,"display_name":"Guillaume F.","accept_rate":83},"content_license":"CC BY-SA 3.0","score":0,"post_id":42756419,"edited":false,"creation_date":1489377840,"comment_id":72628816,"body":"The code is correct, but you could use putIfAbsent in your synchronized block. It will be more optimal."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":1,"post_id":42722195,"edited":false,"creation_date":1489164309,"comment_id":72566752,"body":"This says it best: <i>In other words, it is conceivable that one thread might be continuously starved because other threads always manage to arbitrarily get the lock instead of it.</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489159375,"comment_id":72563566,"body":"@Sotirios Delimanolis oops, Do you want to say that read and write can ocсure in parallel?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489159321,"comment_id":72563534,"body":"You&#39;re showing a <code>get</code> before a <code>put</code>. Obviously, the <code>get</code> won&#39;t retrieve a value that hasn&#39;t been <code>put</code> yet. Maybe I don&#39;t understand your confusion. <i>Retrievals reflect the results of the most recently completed update operations</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489158272,"comment_id":72562814,"body":"@Sotirios Delimanolis, I didn&#39;t find it"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489158002,"comment_id":72562636,"body":"Because that&#39;s the answer I would&#39;ve given."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489157850,"comment_id":72562522,"body":"@Sotirios Delimanolis, Why do you think that it is duplicate ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489157481,"comment_id":72562268,"body":"<a href=\"http://stackoverflow.com/questions/26352707/what-happens-when-two-threads-trying-to-put-the-same-key-value-in-concurrent-has\" title=\"what happens when two threads trying to put the same key value in concurrent has\">stackoverflow.com/questions/26352707/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489157237,"comment_id":72562097,"body":"@Sotirios Delimanolis I have added picture to the topic"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489157136,"comment_id":72562025,"body":"You said at <code>time_2</code> and <code>time_3</code>, I don&#39;t know how you control that, but there&#39;s your answer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489157123,"comment_id":72562017,"body":"Don&#39;t these sentences in the Javadoc explain it? &quot;Retrieval operations (including get) generally do not block, so may overlap with update operations (including put and remove). Retrievals reflect the results of the most recently completed update operations holding upon their onset.&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489157069,"comment_id":72561972,"body":"@Sotirios Delimanolis which operation will be executed first?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":1,"post_id":42720719,"edited":false,"creation_date":1489157023,"comment_id":72561936,"body":"What do you mean <i>win</i>? Win what?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/411d782b77899035a96abb71b64e062a?s=256&d=identicon&r=PG","account_id":3163862,"user_type":"registered","user_id":2674303,"link":"https://stackoverflow.com/users/2674303/gstackoverflow","reputation":36940,"display_name":"gstackoverflow","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"edited":false,"creation_date":1489157004,"comment_id":72561923,"body":"@Sotirios Delimanolis who will win thread_2 or thread_3 ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4ec21df1e55febf8deb2e3b24b9cb39b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":195331,"user_type":"registered","user_id":438154,"link":"https://stackoverflow.com/users/438154/sotirios-delimanolis","reputation":275428,"display_name":"Sotirios Delimanolis","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":42720719,"edited":false,"creation_date":1489156860,"comment_id":72561821,"body":"What do you mean by <i>ordering</i> and <i>happens before</i>? What does the javadoc of the class say and what don&#39;t you understand about it?"},{"owner":{"profile_image":"https://i.stack.imgur.com/NMBDq.jpg?s=256&g=1","account_id":1244574,"user_type":"registered","user_id":1206301,"link":"https://stackoverflow.com/users/1206301/alexei-kaigorodov","reputation":13277,"display_name":"Alexei Kaigorodov","accept_rate":10},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1489007952,"comment_id":72488304,"body":"most time-comsumung operation is RandomStringUtils.randomAlphanumeric(), and it is not parallelized."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":1,"post_id":42667412,"edited":false,"creation_date":1488967952,"comment_id":72461635,"body":"The code is slower with multiple threads because you are using a contended resource and the overhead of using that contended resource mean mean that N thread is N times slower or worse."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1488967873,"comment_id":72461583,"body":"@silent-box when you run the code for the second thread is it a little faster. Obviously running the program again is no warmer as the JVM re-compiles everything from scratch each time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 3.0","score":1,"post_id":42667412,"edited":false,"creation_date":1488967018,"comment_id":72460996,"body":"Your random character generator is going to be synchronized."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40f1c9cb269ab304832f99ac5c670ed3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4874343,"user_type":"registered","user_id":3929917,"link":"https://stackoverflow.com/users/3929917/silent-box","reputation":1659,"display_name":"silent-box","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"edited":false,"creation_date":1488966073,"comment_id":72460339,"body":"&gt; you are using a fixed size pool of 1. @PeterLawrey, again, please look at the question. Results for 1 and 10 threads are presented"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40f1c9cb269ab304832f99ac5c670ed3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4874343,"user_type":"registered","user_id":3929917,"link":"https://stackoverflow.com/users/3929917/silent-box","reputation":1659,"display_name":"silent-box","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1488965879,"comment_id":72460200,"body":"&gt; code is warmer the second time. Code is x10 times slower the second time i ran it, please look at the question"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40f1c9cb269ab304832f99ac5c670ed3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4874343,"user_type":"registered","user_id":3929917,"link":"https://stackoverflow.com/users/3929917/silent-box","reputation":1659,"display_name":"silent-box","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1488965661,"comment_id":72460055,"body":"I&#39;m familiar with JIT optimizations and microbenchmarking frameworks like JMH. As I said, it&#39;s just simplified example, our production code is 10 times slower with multimple threads, how it can be explained?"},{"owner":{"profile_image":"https://i.stack.imgur.com/AWsdT.png?s=256&g=1","account_id":60521,"user_type":"registered","user_id":180719,"link":"https://stackoverflow.com/users/180719/olivier-gr%c3%a9goire","reputation":34336,"display_name":"Olivier Gr&#233;goire","accept_rate":88},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1488965393,"comment_id":72459892,"body":"You should use a benchmark framework to test your code, if you test performance. Benchmarking is hard and you&#39;re doing it totally the wrong way."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":42667412,"edited":false,"creation_date":1488965284,"comment_id":72459816,"body":"It could run faster but you would  need to use multiple threads but you are using a fixed size pool of 1. The only reason for any speed up is the code is warmer the second time you run it (ie. some of it will be pre-compiled)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44c841338e1646af9a977f1fa0e23948?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":162699,"user_type":"registered","user_id":3788176,"link":"https://stackoverflow.com/users/3788176/andy-turner","reputation":138060,"display_name":"Andy Turner","accept_rate":54},"content_license":"CC BY-SA 3.0","score":1,"post_id":40774010,"edited":false,"creation_date":1479934616,"comment_id":68771873,"body":"The assignment of the result of <code>calculate()</code> to <code>emp</code> is atomic; the evaluation of the result of <code>calculate()</code> is not."},{"owner":{"profile_image":"https://i.stack.imgur.com/cX6oF.png?s=256&g=1","account_id":4870584,"user_type":"registered","user_id":3927264,"link":"https://stackoverflow.com/users/3927264/farhan-stands-with-palestine","reputation":13948,"display_name":"Farhan stands with Palestine","accept_rate":68},"content_license":"CC BY-SA 3.0","score":0,"post_id":16107683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/caa09b52f2616de4fd1a6ffcc65a5859?s=256&d=identicon&r=PG","account_id":65386,"user_type":"registered","user_id":192444,"link":"https://stackoverflow.com/users/192444/john-vint","reputation":39895,"display_name":"John Vint","accept_rate":100},"edited":false,"creation_date":1473071992,"comment_id":65988948,"body":"@JohnVint: I wanted to clarify your above comment, hence raised the question. PeterLawrey seems to disagree on this. <a href=\"http://stackoverflow.com/questions/39053429/a-little-clarification-on-the-volatile-keyword/39053472\" title=\"a little clarification on the volatile keyword\">stackoverflow.com/questions/39053429/&hellip;</a> . Would really request you to voice your opinion."},{"owner":{"profile_image":"https://i.stack.imgur.com/vRC08.png?s=256&g=1","account_id":1673966,"user_type":"registered","user_id":1539858,"link":"https://stackoverflow.com/users/1539858/arunmoezhi","reputation":3112,"display_name":"arunmoezhi","accept_rate":72},"content_license":"CC BY-SA 3.0","score":0,"post_id":17656373,"edited":false,"creation_date":1472893485,"comment_id":65943507,"body":"checkout <a href=\"https://github.com/arunmoezhi/ConcurrentTreeMap\" rel=\"nofollow noreferrer\">github.com/arunmoezhi/ConcurrentTreeMap</a> for a C++ implementation"},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39199593,"edited":false,"creation_date":1472453140,"comment_id":65739907,"body":"There are plenty of open source servlet engines with the source available for your examination."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/99aa91ad0a9466818c932bab1c6977fa?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6844168,"user_type":"registered","user_id":5263499,"link":"https://stackoverflow.com/users/5263499/gopidoss","reputation":264,"display_name":"Gopidoss"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39199593,"edited":false,"creation_date":1472451569,"comment_id":65739200,"body":"Check this link you will get better idea [How do servlets work ?] (<a href=\"http://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreadi\" title=\"how do servlets work instantiation sessions shared variables and multithreadi\">stackoverflow.com/questions/3106452/&hellip;</a>)"},{"owner":{"profile_image":"https://i.stack.imgur.com/e0VNy.jpg?s=256&g=1","account_id":1079173,"user_type":"registered","user_id":1076640,"link":"https://stackoverflow.com/users/1076640/yshavit","reputation":42590,"display_name":"yshavit"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39171534,"edited":false,"creation_date":1472233586,"comment_id":65686284,"body":"I think you&#39;re missing the bit of text right before that listing: &quot;(Like Collections.synchronizedList and other collections wrappers, ImprovedList assumes that once a list is passed to its constructor, the client will not use the underlying list directly again, accessing it only through the ImprovedList.)&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/27147a6679a4bfb6461ff1c0ae10473e?s=256&d=identicon&r=PG","account_id":216698,"user_type":"registered","user_id":472109,"link":"https://stackoverflow.com/users/472109/geoffrey-de-smet","reputation":26495,"display_name":"Geoffrey De Smet","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":39162994,"edited":false,"creation_date":1472215936,"comment_id":65675819,"body":"I &#39;ve got other threads in my process too (servlets threads to input/output calculation requests and intermediate responses). The container approach will still starve them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5daf38b9d6c6223faabb4196156d6806?s=256&d=identicon&r=PG","account_id":2934181,"user_type":"registered","user_id":2513573,"link":"https://stackoverflow.com/users/2513573/adamskywalker","reputation":11458,"display_name":"AdamSkywalker","accept_rate":76},"content_license":"CC BY-SA 3.0","score":0,"post_id":39162994,"edited":false,"creation_date":1472212795,"comment_id":65673841,"body":"you can use containers to limit core usage"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/27147a6679a4bfb6461ff1c0ae10473e?s=256&d=identicon&r=PG","account_id":216698,"user_type":"registered","user_id":472109,"link":"https://stackoverflow.com/users/472109/geoffrey-de-smet","reputation":26495,"display_name":"Geoffrey De Smet","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":39162994,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"edited":false,"creation_date":1472212026,"comment_id":65673393,"body":"It&#39;s non-blocking calculations (not web requests), no IO, so the CPU is full. So I need a way to have it only use 4 out of 8 cpu&#39;s and still handle infinite 10 jobs."},{"owner":{"profile_image":"https://i.stack.imgur.com/7H9TF.png?s=256&g=1","account_id":2994830,"user_type":"registered","user_id":2541560,"link":"https://stackoverflow.com/users/2541560/kayaman","reputation":1,"display_name":"Kayaman"},"content_license":"CC BY-SA 3.0","score":2,"post_id":39162994,"edited":false,"creation_date":1472204268,"comment_id":65669085,"body":"For 10 simultaneous jobs, have 10 threads. The CPU will schedule them, so you don&#39;t need to attempt to copy the behaviour (poorly) in your own code. You seem to mistakenly think that if you create 4 threads on a 4-core CPU, that the CPU is &quot;full&quot;. Well it&#39;s not."},{"owner":{"profile_image":"https://i.stack.imgur.com/RJgJM.png?s=256&g=1","account_id":261142,"user_type":"registered","user_id":545127,"link":"https://stackoverflow.com/users/545127/raedwald","reputation":47118,"display_name":"Raedwald","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39160706,"edited":false,"creation_date":1472201443,"comment_id":65667349,"body":"The same way you ensure visibility of any other writes. That it is an array makes no difference."},{"owner":{"profile_image":"https://i.stack.imgur.com/WQ1I9.jpg?s=256&g=1","account_id":192966,"user_type":"registered","user_id":434408,"link":"https://stackoverflow.com/users/434408/a3-14-infinity","reputation":5703,"display_name":"a3.14_Infinity","accept_rate":51},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472194546,"comment_id":65663565,"body":"@SHolmes: there could be a possibility, stretching a little bit.. not sure.. need to read up few things. surely people would have stumbled your scenario and might have found some alternative to do this.."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/WQ1I9.jpg?s=256&g=1","account_id":192966,"user_type":"registered","user_id":434408,"link":"https://stackoverflow.com/users/434408/a3-14-infinity","reputation":5703,"display_name":"a3.14_Infinity","accept_rate":51},"edited":false,"creation_date":1472194274,"comment_id":65663404,"body":"@a3.14_Infinity gets what I mean, so from what I&#39;m reading on this post it&#39;s pretty much out of the realms of possibility for my implementation, thanks for the help though this has certainly turned out to be a larger more intricate problem that I had hoped for!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1472194159,"comment_id":65663331,"body":"@matt Meaning every thread has to wait, unneccessarily, for that thread, which found the way, to be put back on the processor and mark the way out for every other thread to follow. How can I mark a thread as special and should not be taken off the processor for any reason?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1472194155,"comment_id":65663328,"body":"@matt Right I understand that but imagine a huge maze and I allow my program to generate 50 threads in order to explore it but the machine my program is running on only has 4 cores. It&#39;s an inefficient amount of overhead I know but I&#39;m just using it as an example. I can only have 4 threads running at one time so the operating system scheduler has to rotate the threads in a fair fashion so they each get a turn searching their respective paths. My issue is when a thread finds the exit it may get kicked off the processor for another thread before it can tell everyone it has found the way out."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472194060,"comment_id":65663264,"body":"The garbage collector thread has a very low priority and what he wants is just the opposite."},{"owner":{"profile_image":"https://i.stack.imgur.com/WQ1I9.jpg?s=256&g=1","account_id":192966,"user_type":"registered","user_id":434408,"link":"https://stackoverflow.com/users/434408/a3-14-infinity","reputation":5703,"display_name":"a3.14_Infinity","accept_rate":51},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472193747,"comment_id":65663088,"body":"what @SHolmes wants is that, the thread which reaches the exit, should have a priority similar to a garbage collector thread, become that special thread, so that it is not evicted out. I checked some questions on so. looks like you need a special platform to solve this problem - RTOS, specially designed VM that respects priorities - check this: <a href=\"http://stackoverflow.com/questions/21206655/how-to-change-garbage-collection-threads-priority\" title=\"how to change garbage collection threads priority\">stackoverflow.com/questions/21206655/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472193701,"comment_id":65663064,"body":"If you want your background thread(s) to complete without ever switching to the main thread, I think it&#39;s impossible. But you can control how your background threads execute."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472193327,"comment_id":65662864,"body":"Threads pretty much run to completion. It isn&#39;t clear why you think otherwise. You are using a lot of terms that aren&#39;t relevant/meaningful. A concrete example would be useful to see what you are actually having an issue with."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"edited":false,"creation_date":1472193314,"comment_id":65662858,"body":"@dsp_user I don&#39;t think you quite understand the extent of my issue, I&#39;m fine with the concurrency part of this problem, I&#39;m using semaphores to avoid key race conditions. I need to find a way to keep a thread on a processor core even if it&#39;s quantum is up."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"edited":false,"creation_date":1472193157,"comment_id":65662783,"body":"@dsp_user I&#39;m not a 100% sure of what you mean by starting my threads in a loop? It&#39;s not the starting I&#39;m having trouble with or managing my threads, I just need to, once a certain condition has been met, ensure it doesn&#39;t leave the processor until it finishes what it is doing completely."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472192934,"comment_id":65662666,"body":"Another solution would be to use the synchronized keyword. While this will not prevent threads from running simultaneously , it will prevent access to a particular method or a block of code marked as synchronized, which may be good enough for you."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"edited":false,"creation_date":1472192802,"comment_id":65662600,"body":"@ScaryWombat No this is just for the good old fasioned Java on a computer. If a thread spawned another thread it&#39;s not a problem, it&#39;ll get scheduled by the operating system like a normal thread would once it signals it is ready to run. This is actually what my threads are going to do, each thread has a limit to how many threads it can make, when it reaches a junction it splits off into multiple threads to explore. As long as it has available children left &#39;to spend&#39; of course."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"edited":false,"creation_date":1472192593,"comment_id":65662477,"body":"@matt I&#39;m not sure what code would be useful in this sense, there&#39;s no problem with the code per se, I&#39;m just forward thinking in terms of maximising the efficiency of what I&#39;m going to write. I&#39;ve only written half of it so far, but I like to plan ahead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4941b50fab94bddbe63b102f2c79d2da?s=256&d=identicon&r=PG","account_id":1133647,"user_type":"registered","user_id":1119161,"link":"https://stackoverflow.com/users/1119161/dsp-user","reputation":2061,"display_name":"dsp_user","accept_rate":31},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472192351,"comment_id":65662376,"body":"One simple solution would be to have a thread manager, which would start your threads in a while loop but only if a certain flag has been set. This thread could be set to true when a particular thread starts and to false when it ends (actually this would probably be the last line of code in the thread&#39;s execute method)."},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472192336,"comment_id":65662371,"body":"BTW, what would happen if the Thread spawned another Thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472192297,"comment_id":65662347,"body":"I guess you are meaning for <code>android</code> and not java in general"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/WQ1I9.jpg?s=256&g=1","account_id":192966,"user_type":"registered","user_id":434408,"link":"https://stackoverflow.com/users/434408/a3-14-infinity","reputation":5703,"display_name":"a3.14_Infinity","accept_rate":51},"edited":false,"creation_date":1472192281,"comment_id":65662339,"body":"@a3.14_Infinity That&#39;s what I&#39;m doing currently but the JavaDoc doesn&#39;t give any assurance to how long the process stays on the processor for. The JavaDoc for MAX_PRIORITY vaguely says &quot;The maximum priority that a thread can have.&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"edited":false,"creation_date":1472192081,"comment_id":65662244,"body":"@ScaryWombat As far as I am aware you cannot personally set how long a thread stays on the processor for at the software level, that&#39;s something that the operating system does and is quite fundamental to scheduling processes and such. It&#39;s an interesting read on a side note, I did a paper about it and it was great."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=256&d=identicon&r=PG","account_id":2360785,"user_type":"registered","user_id":2067492,"link":"https://stackoverflow.com/users/2067492/matt","reputation":11123,"display_name":"matt"},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472191958,"comment_id":65662187,"body":"You need to post some code."},{"owner":{"profile_image":"https://i.stack.imgur.com/WQ1I9.jpg?s=256&g=1","account_id":192966,"user_type":"registered","user_id":434408,"link":"https://stackoverflow.com/users/434408/a3-14-infinity","reputation":5703,"display_name":"a3.14_Infinity","accept_rate":51},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"edited":false,"creation_date":1472191572,"comment_id":65661993,"body":"can you increase the thread&#39;s priority, so that it ensures that this thread which keeps moving forward, actually gets scheduled immediately instead of others, preemptive?"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":1,"post_id":39159040,"edited":false,"creation_date":1472191435,"comment_id":65661922,"body":"Sorry maybe I am being naive, but can you not change your code so that if a thread finds the <code>exit</code>, then it sets its <code>quantum of time</code> so it does not get <code>booted off</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e40d1ae0a7322a9317de183441e4221a?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4152833,"user_type":"registered","user_id":3404779,"link":"https://stackoverflow.com/users/3404779/sholmes","reputation":178,"display_name":"SHolmes","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":39159040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"edited":false,"creation_date":1472191204,"comment_id":65661823,"body":"Oh hell sorry, didn&#39;t realise how vague that comment was, hopefully my edit clears up what I mean."},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":3,"post_id":39159040,"edited":false,"creation_date":1472190283,"comment_id":65661407,"body":"<code>when it gets booted off</code> - what on earth does this mean?"},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 3.0","score":1,"post_id":39131310,"edited":false,"creation_date":1472066664,"comment_id":65608340,"body":"And side note: the fact that you have one SwingWorker doesn&#39;t mean that you have push all your code into a single method. You might want to read about the &quot;single layer of abstraction principle&quot;."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/517e379279876a940b4e84200099d1d4?s=256&d=identicon&r=PG","account_id":2897269,"user_type":"registered","user_id":2484748,"link":"https://stackoverflow.com/users/2484748/sahil-gupta","reputation":2058,"display_name":"Sahil Gupta","accept_rate":30},"content_license":"CC BY-SA 3.0","score":0,"post_id":30129960,"edited":false,"creation_date":1468554723,"comment_id":64184559,"body":"Since thread safety is ensured by using locks, i believe there is no need of using concurrent version of map and queue. It is just an overhead"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ffbf4e85b8ffbae4e9039b9c0cf07bc8?s=256&d=identicon&r=PG","account_id":2496,"user_type":"registered","user_id":3474,"link":"https://stackoverflow.com/users/3474/erickson","reputation":266244,"display_name":"erickson","accept_rate":83},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"edited":false,"creation_date":1463634679,"comment_id":62149109,"body":"@AdrianShum Okay, I thought you were referring to example 1. I didn&#39;t notice he had synchronized the <code>set()</code> method in the second example."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f0aa6977c75f54ca9033d4f4d0244023?s=256&d=identicon&r=PG","account_id":39409,"user_type":"registered","user_id":113632,"link":"https://stackoverflow.com/users/113632/dimo414","reputation":47624,"display_name":"dimo414","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"edited":false,"creation_date":1463628325,"comment_id":62147506,"body":"In your second example <code>.set()</code> doesn&#39;t need to be <code>synchronized</code> either."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ffbf4e85b8ffbae4e9039b9c0cf07bc8?s=256&d=identicon&r=PG","account_id":2496,"user_type":"registered","user_id":3474,"link":"https://stackoverflow.com/users/3474/erickson","reputation":266244,"display_name":"erickson","accept_rate":83},"edited":false,"creation_date":1463626202,"comment_id":62147055,"body":"@erickson that&#39;s what I said in the comment: that&#39;s related to memory visibility/happens-before."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ffbf4e85b8ffbae4e9039b9c0cf07bc8?s=256&d=identicon&r=PG","account_id":2496,"user_type":"registered","user_id":3474,"link":"https://stackoverflow.com/users/3474/erickson","reputation":266244,"display_name":"erickson","accept_rate":83},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"edited":false,"creation_date":1463625837,"comment_id":62146971,"body":"@AdrianShum That&#39;s wrong. A write to an <code>int</code> is not guaranteed to be visible to other threads unless the writer <i>synchronizes-with</i> them."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"edited":false,"creation_date":1463624493,"comment_id":62146643,"body":"@SHRIN you may simply treat happens-before as an synonym for &quot;memory visibility&quot; you mentioned :P"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"edited":false,"creation_date":1463624453,"comment_id":62146639,"body":"@EJP: I think the <b>thread-safety</b> not because of <code>volatile</code>.  It is simply because he is getting value and assigning value which is an <code>int</code>, and such operation in <code>int</code> is atomic. <code>volatile</code> only helps for the happens-before/visibility part (well.... it is stilll kind of related to thread-safety... :P )"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":1,"post_id":37312655,"edited":false,"creation_date":1463623842,"comment_id":62146487,"body":"The question in your title is answered in the body of your question. Your <i>real</i> question is about <code>volatile</code>. Your second example would be thread-safe even without the synchronization. <code>volatile</code> does that."},{"owner":{"profile_image":"https://i.stack.imgur.com/m1OQX.jpg?s=256&g=1","account_id":3903578,"user_type":"registered","user_id":3230772,"link":"https://stackoverflow.com/users/3230772/shrin","reputation":318,"display_name":"SHRIN","accept_rate":57},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"edited":false,"creation_date":1463623599,"comment_id":62146413,"body":"@Adrian Shum, could i ask more detail for &quot;2. volatile guarantee for happen-before&quot;?"},{"owner":{"profile_image":"https://i.stack.imgur.com/m1OQX.jpg?s=256&g=1","account_id":3903578,"user_type":"registered","user_id":3230772,"link":"https://stackoverflow.com/users/3230772/shrin","reputation":318,"display_name":"SHRIN","accept_rate":57},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"edited":false,"creation_date":1463623380,"comment_id":62146353,"body":"we can use AtomicInteger but that is not the point of this question, i just want to know volatile can be used when read method, not synchronized."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c422b640dd62b019c125836b1059e231?s=256&d=identicon&r=PG","account_id":169237,"user_type":"registered","user_id":395202,"link":"https://stackoverflow.com/users/395202/adrian-shum","reputation":39170,"display_name":"Adrian Shum","accept_rate":59},"content_license":"CC BY-SA 3.0","score":1,"post_id":37312655,"edited":false,"creation_date":1463623087,"comment_id":62146267,"body":"In this specific case, I believe <code>synchronized</code> is not required: 1. read/write of <code>int</code> in Java is guaranteed to be atomic (which is not for long/double/reference) for which they are the only 2 ways you are accessing <code>value</code>. 2. <code>volatile</code> guarantee for happen-before (which is another reason for <code>synchronized</code>)"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"edited":false,"creation_date":1463622760,"comment_id":62146189,"body":"BTW, I do not think that your first class is necessarily Threadsafe, you should Lock on an external Object"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37312655,"edited":false,"creation_date":1463622724,"comment_id":62146177,"body":"How about using AtomicInteger"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fe382facfa5a2ce9bee75ae635b79fd0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5885766,"user_type":"registered","user_id":4633831,"link":"https://stackoverflow.com/users/4633831/danny-wilson","reputation":331,"display_name":"Danny Wilson","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=256&d=identicon&r=PG","account_id":33840,"user_type":"registered","user_id":95076,"link":"https://stackoverflow.com/users/95076/robert-horvick","reputation":4006,"display_name":"Robert Horvick"},"edited":false,"creation_date":1456412516,"comment_id":58943117,"body":"@Bubbafat The waitingtoref() method is essentially just a way of stopping the single referee jumping in to early which returns a &quot;queue empty&quot; error. All that method does is allows the referee to wait until he is notified that the queue has been added to and that there are more than 2 Players in the queue."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fe382facfa5a2ce9bee75ae635b79fd0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5885766,"user_type":"registered","user_id":4633831,"link":"https://stackoverflow.com/users/4633831/danny-wilson","reputation":331,"display_name":"Danny Wilson","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=256&d=identicon&r=PG","account_id":33840,"user_type":"registered","user_id":95076,"link":"https://stackoverflow.com/users/95076/robert-horvick","reputation":4006,"display_name":"Robert Horvick"},"edited":false,"creation_date":1456412376,"comment_id":58942989,"body":"@Bubbafat If you are talking about referee threads pulling multiple items out of the queue, then that won&#39;t happen, because there is only ever one referee thread."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=256&d=identicon&r=PG","account_id":33840,"user_type":"registered","user_id":95076,"link":"https://stackoverflow.com/users/95076/robert-horvick","reputation":4006,"display_name":"Robert Horvick"},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"edited":false,"creation_date":1456411994,"comment_id":58942646,"body":"waitingtoref is synchronized, but the caller isn&#39;t - so when it returns you are not thread safe any more.  This means that two threads could see 2 items in the queue, both say &quot;I&#39;m good!&quot; and then both attempt to dequeue at the same time - taking 4 ... giving nulls.  You can&#39;t do a synchronized test and trust the answer outside of the sync block.  What if the signature of your function was something like:  def waitingtoref(): (Player, Player)   ... think about how that would allow you to dequeue safely."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fe382facfa5a2ce9bee75ae635b79fd0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5885766,"user_type":"registered","user_id":4633831,"link":"https://stackoverflow.com/users/4633831/danny-wilson","reputation":331,"display_name":"Danny Wilson","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=256&d=identicon&r=PG","account_id":33840,"user_type":"registered","user_id":95076,"link":"https://stackoverflow.com/users/95076/robert-horvick","reputation":4006,"display_name":"Robert Horvick"},"edited":false,"creation_date":1456408063,"comment_id":58939522,"body":"@Bubbafat I&#39;ve spend all morning fiddling with it now and still have no clue, so help would be great!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/998a8344ea5412fcc0009faecb2e60dc?s=256&d=identicon&r=PG","account_id":1716952,"user_type":"registered","user_id":1573825,"link":"https://stackoverflow.com/users/1573825/vitalii","reputation":3345,"display_name":"vitalii"},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"edited":false,"creation_date":1456372999,"comment_id":58919057,"body":"Please, create a <a href=\"https://gist.github.com/\" rel=\"nofollow noreferrer\">gist.github.com</a> and put it in the question, if code is too large. It is impossible to reason about a code you haven&#39;t seen"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e5191e940e594c80451cef370c8c3f16?s=256&d=identicon&r=PG","account_id":33840,"user_type":"registered","user_id":95076,"link":"https://stackoverflow.com/users/95076/robert-horvick","reputation":4006,"display_name":"Robert Horvick"},"content_license":"CC BY-SA 3.0","score":3,"post_id":35616983,"edited":false,"creation_date":1456368905,"comment_id":58917902,"body":"You should probably edit your question to include the code, not paste it into a comment.  Hard to parse in comment format."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fe382facfa5a2ce9bee75ae635b79fd0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5885766,"user_type":"registered","user_id":4633831,"link":"https://stackoverflow.com/users/4633831/danny-wilson","reputation":331,"display_name":"Danny Wilson","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/b4e6b5a0670bc203c5dd18567a90fc71?s=256&d=identicon&r=PG","account_id":3120191,"user_type":"registered","user_id":2640121,"link":"https://stackoverflow.com/users/2640121/kondrak","reputation":436,"display_name":"kondrak"},"edited":false,"creation_date":1456367327,"comment_id":58917453,"body":"@kondrak   <code>var choice: String = &quot;Error 4: String not initliased correctly&quot;     var num: Int = 0     var winornot: MVar[Int] = new MVar[Int]()          def getChoice(): String = {       return choice     }</code>  That is a snippet from the class that contains getChoice()  <code>val wait: Playing = new Playing()       wait.setChoice(choice: String)       wait.setNum(i: Int)       println(wait.getChoice())       Referee.queue += wait</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4e6b5a0670bc203c5dd18567a90fc71?s=256&d=identicon&r=PG","account_id":3120191,"user_type":"registered","user_id":2640121,"link":"https://stackoverflow.com/users/2640121/kondrak","reputation":436,"display_name":"kondrak"},"content_license":"CC BY-SA 3.0","score":0,"post_id":35616983,"edited":false,"creation_date":1456367155,"comment_id":58917399,"body":"What does the object/class look like that has the getChoice() method and what does the block of code that instantiates &quot;wait&quot; look like?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 3.0","score":0,"post_id":35569637,"edited":false,"creation_date":1456254530,"comment_id":58858589,"body":"Somewhere there must be calls that create (one or several) ThreadPoolExecutor - either directly by invoking <code>new ThreadPoolExecutor(...)</code> or by calling <code>Executors.newXYThreadPool()</code>. Check the parameters of these calls, since they define how large the thread pools can grow."},{"owner":{"profile_image":"https://i.stack.imgur.com/PIsvW.jpg?s=256&g=1","account_id":7892626,"user_type":"registered","user_id":5962312,"link":"https://stackoverflow.com/users/5962312/agasthya-tadakamalla","reputation":84,"display_name":"agasthya_tadakamalla","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":35569637,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"edited":false,"creation_date":1456216870,"comment_id":58832159,"body":"@ThomasKl&#228;ger  even I thought of the same solution, but now I am trying to find out the point of instantiation of these threads, so I could optimize my program."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dab188c30e55616b418e19963ca4570d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7737658,"user_type":"registered","user_id":5858704,"link":"https://stackoverflow.com/users/5858704/martins","reputation":2769,"display_name":"MartinS"},"content_license":"CC BY-SA 3.0","score":2,"post_id":35569637,"edited":false,"creation_date":1456206525,"comment_id":58827253,"body":"<code>sun.misc.Unsafe.park</code> is used by the JVM to let waiting threads sleep. I do not think this is related to the <code>OutOfMemoryError</code> you are getting."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/950788cd150c2e596944181dfd8421af?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7423601,"user_type":"registered","user_id":5646962,"link":"https://stackoverflow.com/users/5646962/thomas-kl%c3%a4ger","reputation":18712,"display_name":"Thomas Kl&#228;ger"},"content_license":"CC BY-SA 3.0","score":2,"post_id":35569637,"edited":false,"creation_date":1456206485,"comment_id":58827241,"body":"According to the stack trace these are just worker threads from a ThreadPoolExecutor and won&#39;t consume that much memory. However the problem could be <a href=\"http://stackoverflow.com/questions/16789288/java-lang-outofmemoryerror-unable-to-create-new-native-thread\" title=\"java lang outofmemoryerror unable to create new native thread\">stackoverflow.com/questions/16789288/&hellip;</a>. So the question is how big the thread pool is?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=256&d=identicon&r=PG","account_id":1691630,"user_type":"registered","user_id":1553851,"link":"https://stackoverflow.com/users/1553851/shmosel","reputation":49583,"display_name":"shmosel","accept_rate":73},"content_license":"CC BY-SA 3.0","score":1,"post_id":35569637,"edited":false,"creation_date":1456206019,"comment_id":58827038,"body":"A deadlock wouldn&#39;t directly cause an OutOfMemoryError. Why don&#39;t you share some code?"},{"owner":{"profile_image":"https://i.stack.imgur.com/TgSNj.png?s=256&g=1","account_id":6756545,"user_type":"registered","user_id":5204741,"link":"https://stackoverflow.com/users/5204741/quento","reputation":1084,"display_name":"quento","accept_rate":81},"content_license":"CC BY-SA 3.0","score":0,"post_id":35559861,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"edited":false,"creation_date":1456163217,"comment_id":58809009,"body":"@nayuki, yeap, i will do that!"},{"owner":{"profile_image":"https://i.stack.imgur.com/nAGmt.png?s=256&g=1","account_id":6453072,"user_type":"registered","user_id":4999394,"link":"https://stackoverflow.com/users/4999394/ravindra-babu","reputation":37996,"display_name":"Ravindra babu","accept_rate":98},"content_license":"CC BY-SA 3.0","score":0,"post_id":35559861,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"edited":false,"creation_date":1456162903,"comment_id":58808827,"body":"@Nayuki, Since your comment is solution to the problem, can you please post it as answer?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"content_license":"CC BY-SA 3.0","score":2,"post_id":35559861,"edited":false,"creation_date":1456162529,"comment_id":58808610,"body":"Next time, please mention in the question what went wrong =)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"content_license":"CC BY-SA 3.0","score":0,"post_id":35559861,"edited":false,"creation_date":1456162322,"comment_id":58808452,"body":"Because with what you did in your code, <code>scheduleAtFixedRate(R, x, y, TU)</code> means &quot;run R after a delay of x, then afterward repeatedly run R after a delay of y&quot;."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"content_license":"CC BY-SA 3.0","score":2,"post_id":35559861,"edited":false,"creation_date":1456162247,"comment_id":58808407,"body":"In that case, simply use <code>schedule()</code>? See: <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/api/java/util/concurrent/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/TgSNj.png?s=256&g=1","account_id":6756545,"user_type":"registered","user_id":5204741,"link":"https://stackoverflow.com/users/5204741/quento","reputation":1084,"display_name":"quento","accept_rate":81},"content_license":"CC BY-SA 3.0","score":0,"post_id":35559861,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"edited":false,"creation_date":1456162174,"comment_id":58808347,"body":"i need to do that once, but this is looks like a loop"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/eed3ee2db841be15bdb120f3ff38f02e?s=256&d=identicon&r=PG","account_id":446566,"user_type":"registered","user_id":839689,"link":"https://stackoverflow.com/users/839689/nayuki","reputation":18084,"display_name":"Nayuki","accept_rate":71},"content_license":"CC BY-SA 3.0","score":0,"post_id":35559861,"edited":false,"creation_date":1456162126,"comment_id":58808318,"body":"I don&#39;t see any obvious problem here... assuming that the code runs correctly, is there any other concern you have?"},{"owner":{"profile_image":"https://i.stack.imgur.com/PO7Uz.jpg?s=256&g=1","account_id":2673407,"user_type":"registered","user_id":2310289,"link":"https://stackoverflow.com/users/2310289/scary-wombat","reputation":44640,"display_name":"Scary Wombat"},"content_license":"CC BY-SA 3.0","score":1,"post_id":35422541,"edited":false,"creation_date":1455589413,"comment_id":58545389,"body":"Of course - eventually"},{"owner":{"profile_image":"https://i.stack.imgur.com/wRgjT.jpg?s=256&g=1","account_id":460510,"user_type":"registered","user_id":861646,"link":"https://stackoverflow.com/users/861646/tobia","reputation":9305,"display_name":"Tobia","accept_rate":54},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"edited":false,"creation_date":1450162676,"comment_id":56307292,"body":"No, I will use a timer task to check new card availability or to remove not present smartcard. (the smartcard api has only bool method isCardIn()  so I don&#39;t have a real add / remove event)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/87e78129a18de3e7f831748c5dd2288f?s=256&d=identicon&r=PG","account_id":67756,"user_type":"registered","user_id":198087,"link":"https://stackoverflow.com/users/198087/archer","reputation":5083,"display_name":"Archer","accept_rate":70},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"edited":false,"creation_date":1450162267,"comment_id":56307109,"body":"@Tobia do you have some server API that invoke some method on increase/decrease number of smartcards available?"},{"owner":{"profile_image":"https://i.stack.imgur.com/wRgjT.jpg?s=256&g=1","account_id":460510,"user_type":"registered","user_id":861646,"link":"https://stackoverflow.com/users/861646/tobia","reputation":9305,"display_name":"Tobia","accept_rate":54},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/vJbKg.jpg?s=256&g=1","account_id":288696,"user_type":"registered","user_id":589259,"link":"https://stackoverflow.com/users/589259/maarten-bodewes","reputation":91230,"display_name":"Maarten Bodewes","accept_rate":82},"edited":false,"creation_date":1449561547,"comment_id":56048440,"body":"@MaartenBodewes do you mean a queue of threads? And when a thread finish its job it is queued again?"},{"owner":{"profile_image":"https://i.stack.imgur.com/wRgjT.jpg?s=256&g=1","account_id":460510,"user_type":"registered","user_id":861646,"link":"https://stackoverflow.com/users/861646/tobia","reputation":9305,"display_name":"Tobia","accept_rate":54},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"edited":false,"creation_date":1449561464,"comment_id":56048399,"body":"@WarrenDew this is a server side computation."},{"owner":{"profile_image":"https://i.stack.imgur.com/vJbKg.jpg?s=256&g=1","account_id":288696,"user_type":"registered","user_id":589259,"link":"https://stackoverflow.com/users/589259/maarten-bodewes","reputation":91230,"display_name":"Maarten Bodewes","accept_rate":82},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"edited":false,"creation_date":1449532145,"comment_id":56038983,"body":"Why not put the smart cards (the resources) in a Queue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e83e511e401770207ffbb0d31b8ffb4?s=256&d=identicon&r=PG","account_id":916980,"user_type":"registered","user_id":2580516,"link":"https://stackoverflow.com/users/2580516/warren-dew","reputation":8820,"display_name":"Warren Dew"},"content_license":"CC BY-SA 3.0","score":1,"post_id":34138795,"edited":false,"creation_date":1449527206,"comment_id":56037050,"body":"Are the smart cards on the server or on the client?  Is the computation taking place on the server or on the client?  If they are different places, can you clarify how the information is transmitted between the two?"},{"owner":{"profile_image":"https://i.stack.imgur.com/6oHM1.jpg?s=256&g=1","account_id":6174988,"user_type":"registered","user_id":4812170,"link":"https://stackoverflow.com/users/4812170/vaquar-khan","reputation":11040,"display_name":"vaquar khan","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":30129960,"edited":false,"creation_date":1444920625,"comment_id":54112837,"body":"You can find working solutions on following link: <a href=\"http://stackoverflow.com/questions/6398902/best-way-to-implement-lru-cache\" title=\"best way to implement lru cache\">stackoverflow.com/questions/6398902/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40895ef337d0a2eb7d538f5f8b3e6d58?s=256&d=identicon&r=PG","account_id":297814,"user_type":"registered","user_id":603516,"link":"https://stackoverflow.com/users/603516/vadzim","reputation":25324,"display_name":"Vadzim","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":8602466,"edited":false,"creation_date":1434027466,"comment_id":49612882,"body":"Similar question: <a href=\"http://stackoverflow.com/questions/6206472/what-is-the-best-way-to-write-to-a-file-in-a-parallel-thread-in-java\" title=\"what is the best way to write to a file in a parallel thread in java\">stackoverflow.com/questions/6206472/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4b4c5a9bdc040b214ee1c4a3846e181?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6351272,"user_type":"registered","user_id":4930257,"link":"https://stackoverflow.com/users/4930257/ameen","reputation":23,"display_name":"Ameen"},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"edited":false,"creation_date":1433202369,"comment_id":49239904,"body":"Created a new bug: <a href=\"https://jira.mongodb.org/browse/SERVER-18784\" rel=\"nofollow noreferrer\">jira.mongodb.org/browse/SERVER-18784</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4b4c5a9bdc040b214ee1c4a3846e181?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6351272,"user_type":"registered","user_id":4930257,"link":"https://stackoverflow.com/users/4930257/ameen","reputation":23,"display_name":"Ameen"},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8d8f06c0a8be909e3cd0218da28a5b73?s=256&d=identicon&r=PG","account_id":1463667,"user_type":"registered","user_id":1377224,"link":"https://stackoverflow.com/users/1377224/philnate","reputation":1506,"display_name":"philnate","accept_rate":50},"edited":false,"creation_date":1433030204,"comment_id":49177182,"body":"Thanks @philnate for trying. I justed tried it again with 3.0.3 and got the same issue. I will open a bug next week and keep this thread updated."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8d8f06c0a8be909e3cd0218da28a5b73?s=256&d=identicon&r=PG","account_id":1463667,"user_type":"registered","user_id":1377224,"link":"https://stackoverflow.com/users/1377224/philnate","reputation":1506,"display_name":"philnate","accept_rate":50},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"edited":false,"creation_date":1433021876,"comment_id":49175192,"body":"I couldn&#39;t reproduce this locally although I bumped it up high. But trusting that the code caused the issue for you, I would think you might enter a bug in the mongodb jira (<a href=\"https://jira.mongodb.org\" rel=\"nofollow noreferrer\">jira.mongodb.org</a>) . Might be related to this atomicity issues: <a href=\"https://jira.mongodb.org/browse/SERVER-12694\" rel=\"nofollow noreferrer\">jira.mongodb.org/browse/SERVER-12694</a> . Please make sure to provide us with the ticket created (and keep a status update)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8d8f06c0a8be909e3cd0218da28a5b73?s=256&d=identicon&r=PG","account_id":1463667,"user_type":"registered","user_id":1377224,"link":"https://stackoverflow.com/users/1377224/philnate","reputation":1506,"display_name":"philnate","accept_rate":50},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"edited":false,"creation_date":1433015886,"comment_id":49173506,"body":"You should make it explicit that your test is writing lots of data."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4b4c5a9bdc040b214ee1c4a3846e181?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6351272,"user_type":"registered","user_id":4930257,"link":"https://stackoverflow.com/users/4930257/ameen","reputation":23,"display_name":"Ameen"},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG","account_id":1358954,"user_type":"registered","user_id":1296707,"link":"https://stackoverflow.com/users/1296707/markus-w-mahlberg","reputation":19779,"display_name":"Markus W Mahlberg","accept_rate":50},"edited":false,"creation_date":1432866688,"comment_id":49114967,"body":"I added some code that can be used to reproduce the issue"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4b4c5a9bdc040b214ee1c4a3846e181?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6351272,"user_type":"registered","user_id":4930257,"link":"https://stackoverflow.com/users/4930257/ameen","reputation":23,"display_name":"Ameen"},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG","account_id":1358954,"user_type":"registered","user_id":1296707,"link":"https://stackoverflow.com/users/1296707/markus-w-mahlberg","reputation":19779,"display_name":"Markus W Mahlberg","accept_rate":50},"edited":false,"creation_date":1432411247,"comment_id":48919989,"body":"I am not quite sure what other information I am missing. Please let me know exactly what information would help. The query is exactly what I have in the question. I can add that the index size is 2MB. There are 53K documents, and the document size is between 1KB to 1MB. Collection size is 15GB and there is 4GB of RAM. There are many other collections, indexes, and DBs in the cluster, but there are not any direct interaction between them. I am hoping that someone familiar with how Mongo performs the update and whether or not there could be a flaw that would explain this issue?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG","account_id":1358954,"user_type":"registered","user_id":1296707,"link":"https://stackoverflow.com/users/1296707/markus-w-mahlberg","reputation":19779,"display_name":"Markus W Mahlberg","accept_rate":50},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"edited":false,"creation_date":1432393785,"comment_id":48914602,"body":"Please provide <i>all</i> information, including your queries, otherwise answering your question becomes a game of assumptions."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b4b4c5a9bdc040b214ee1c4a3846e181?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6351272,"user_type":"registered","user_id":4930257,"link":"https://stackoverflow.com/users/4930257/ameen","reputation":23,"display_name":"Ameen"},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG","account_id":1358954,"user_type":"registered","user_id":1296707,"link":"https://stackoverflow.com/users/1296707/markus-w-mahlberg","reputation":19779,"display_name":"Markus W Mahlberg","accept_rate":50},"edited":false,"creation_date":1432338039,"comment_id":48902215,"body":"It is an update query with upsert parameter set to true. I updated the query section to make that more explicit."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=256&d=identicon&r=PG","account_id":1358954,"user_type":"registered","user_id":1296707,"link":"https://stackoverflow.com/users/1296707/markus-w-mahlberg","reputation":19779,"display_name":"Markus W Mahlberg","accept_rate":50},"content_license":"CC BY-SA 3.0","score":0,"post_id":30404513,"edited":false,"creation_date":1432329604,"comment_id":48899728,"body":"I don&#39;t see an upsert here. You are trying to save two documents, which eventually will get different <code>_id</code>s since you didn&#39;t assign one. They happen to contain the same <code>docId</code>, which is illegal due to the unique constraint  of your index. So the first is inserted as expected, and the second can&#39;t, since this would violate the unique constraint."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40d9bb2e8df635f2f598b7577c5b3eb9?s=256&d=identicon&r=PG","account_id":10326,"user_type":"registered","user_id":19450,"link":"https://stackoverflow.com/users/19450/ben-manes","reputation":9293,"display_name":"Ben Manes"},"content_license":"CC BY-SA 3.0","score":1,"post_id":30129960,"edited":false,"creation_date":1431124758,"comment_id":48377763,"body":"fyi: <code>ConcurrentLinkedQueue#size</code> requires a full scan, whereas <code>ConcurrentHashMap#size</code> is tracked. Your implementation is O(n), whereas efficient implementations are O(1). You may be interested in reading the <a href=\"https://github.com/ben-manes/caffeine/wiki/Design\" rel=\"nofollow noreferrer\">design</a> of a concurrent LRU cache."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5192e7cbcf2f72a847d6fb0d1552f049?s=256&d=identicon&r=PG","account_id":1180113,"user_type":"registered","user_id":1155209,"link":"https://stackoverflow.com/users/1155209/jewelsea","reputation":152335,"display_name":"jewelsea"},"content_license":"CC BY-SA 3.0","score":0,"post_id":25224323,"edited":false,"creation_date":1407646598,"comment_id":39292209,"body":"This question seems pretty similar to: <a href=\"http://stackoverflow.com/questions/13784333/platform-runlater-and-task-javafx\">Platform.Runlater and Task Javafx</a> and <a href=\"http://stackoverflow.com/questions/18710039/javafx-difference-between-javafx-concurent-and-platform-runlater\">Javafx: Difference between javafx.concurent and Platform.runLater?</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f34ec2b22d4dddb6fb87eeaf5e61ddb2?s=256&d=identicon&r=PG","account_id":77142,"user_type":"registered","user_id":220381,"link":"https://stackoverflow.com/users/220381/ash","reputation":9356,"display_name":"Ash","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":20969486,"edited":false,"creation_date":1389102824,"comment_id":31509152,"body":"Yeah, my guess was wrong, Alexei&#39;s answer below seems to explain the symptoms."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f34ec2b22d4dddb6fb87eeaf5e61ddb2?s=256&d=identicon&r=PG","account_id":77142,"user_type":"registered","user_id":220381,"link":"https://stackoverflow.com/users/220381/ash","reputation":9356,"display_name":"Ash","accept_rate":75},"content_license":"CC BY-SA 3.0","score":1,"post_id":20969486,"edited":false,"creation_date":1389091739,"comment_id":31502293,"body":"Have you tried putting <code>sleep(1000)</code> <i>before</i> the call to consumerThread.interrupt()? Starting a thread is a native call, but I&#39;m not sure there&#39;s any guarantee that the thread has actually started running after the call to start completes."},{"owner":{"profile_image":"https://i.stack.imgur.com/ypJmY.gif?s=256&g=1","account_id":2296572,"user_type":"registered","user_id":2017866,"link":"https://stackoverflow.com/users/2017866/rollerball","reputation":12748,"display_name":"Rollerball","accept_rate":76},"content_license":"CC BY-SA 3.0","score":1,"post_id":17656373,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"edited":false,"creation_date":1373971715,"comment_id":25746249,"body":"I think even for the ones who said the question was unclear now should be quite clear and the question can be reopened. Thanks for your feedback."},{"owner":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"content_license":"CC BY-SA 3.0","score":0,"post_id":17656373,"edited":false,"creation_date":1373897978,"comment_id":25714339,"body":"I&#39;m still answering your inquiry."},{"owner":{"profile_image":"https://i.stack.imgur.com/ypJmY.gif?s=256&g=1","account_id":2296572,"user_type":"registered","user_id":2017866,"link":"https://stackoverflow.com/users/2017866/rollerball","reputation":12748,"display_name":"Rollerball","accept_rate":76},"content_license":"CC BY-SA 3.0","score":0,"post_id":17656373,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"edited":false,"creation_date":1373897953,"comment_id":25714320,"body":"@hexafraction I did not say it was you."},{"owner":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"content_license":"CC BY-SA 3.0","score":0,"post_id":17656373,"edited":false,"creation_date":1373897824,"comment_id":25714236,"body":"I never said it wasn&#39;t related. I just said it&#39;s completely unclear."},{"owner":{"profile_image":"https://i.stack.imgur.com/ypJmY.gif?s=256&g=1","account_id":2296572,"user_type":"registered","user_id":2017866,"link":"https://stackoverflow.com/users/2017866/rollerball","reputation":12748,"display_name":"Rollerball","accept_rate":76},"content_license":"CC BY-SA 3.0","score":2,"post_id":17656373,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"edited":false,"creation_date":1373897790,"comment_id":25714218,"body":"to whom says it&#39;s not related to programming. API are related to programming."},{"owner":{"profile_image":"https://i.stack.imgur.com/tSGzg.png?s=256&g=1","account_id":1394089,"user_type":"registered","user_id":1424875,"link":"https://stackoverflow.com/users/1424875/nanofarad","reputation":40460,"display_name":"nanofarad","accept_rate":86},"content_license":"CC BY-SA 3.0","score":0,"post_id":17656373,"edited":false,"creation_date":1373897740,"comment_id":25714185,"body":"Your question is not understandable. What about each object? Why it exists? What it does? How it smells?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/caa09b52f2616de4fd1a6ffcc65a5859?s=256&d=identicon&r=PG","account_id":65386,"user_type":"registered","user_id":192444,"link":"https://stackoverflow.com/users/192444/john-vint","reputation":39895,"display_name":"John Vint","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":16107683,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/lcPr5.png?s=256&g=1","account_id":113085,"user_type":"registered","user_id":298029,"link":"https://stackoverflow.com/users/298029/fgb","reputation":18448,"display_name":"fgb"},"edited":false,"creation_date":1366388777,"comment_id":23004569,"body":"@fgb Actually, declaring the member field volatile still doesnt guarantee publication prior to <code>holder</code> being visible.  You can look at ConcurrentHashMap&#39;s private method <code>readUnderLock</code> in which that takes this nuance into account.  Though declaring <code>holder</code> as volatile does."},{"owner":{"profile_image":"https://i.stack.imgur.com/lcPr5.png?s=256&g=1","account_id":113085,"user_type":"registered","user_id":298029,"link":"https://stackoverflow.com/users/298029/fgb","reputation":18448,"display_name":"fgb"},"content_license":"CC BY-SA 3.0","score":1,"post_id":16107683,"edited":false,"creation_date":1366388609,"comment_id":23004476,"body":"The fields would need to be final or volatile to guarantee that they are fully initialized after the constructor has returned."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=256&d=identicon&r=PG","account_id":284109,"user_type":"registered","user_id":581994,"link":"https://stackoverflow.com/users/581994/hot-licks","reputation":47153,"display_name":"Hot Licks","accept_rate":57},"content_license":"CC BY-SA 3.0","score":1,"post_id":16107683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/42004f72e3580acbad9bd8cc82b59d86?s=256&d=identicon&r=PG","account_id":124651,"user_type":"registered","user_id":319878,"link":"https://stackoverflow.com/users/319878/paul-grime","reputation":14990,"display_name":"Paul Grime","accept_rate":25},"edited":false,"creation_date":1366387880,"comment_id":23004041,"body":"@PaulGrime - The reference to the created object is not assigned to <code>holder</code> until after the constructor has returned (if the JITC is compliant)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/42004f72e3580acbad9bd8cc82b59d86?s=256&d=identicon&r=PG","account_id":124651,"user_type":"registered","user_id":319878,"link":"https://stackoverflow.com/users/319878/paul-grime","reputation":14990,"display_name":"Paul Grime","accept_rate":25},"content_license":"CC BY-SA 3.0","score":3,"post_id":16107683,"edited":false,"creation_date":1366385838,"comment_id":23002955,"body":"No, but <code>holder</code> is public, and another thread may call <code>assertSanity</code> on it before its constructor and field initialisation have completed - <a href=\"http://stackoverflow.com/a/4926812/319878\">stackoverflow.com/a/4926812/319878</a>. And maybe - <a href=\"http://stackoverflow.com/a/10528614/319878\">stackoverflow.com/a/10528614/319878</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=256&d=identicon&r=PG","account_id":284109,"user_type":"registered","user_id":581994,"link":"https://stackoverflow.com/users/581994/hot-licks","reputation":47153,"display_name":"Hot Licks","accept_rate":57},"content_license":"CC BY-SA 3.0","score":3,"post_id":16107683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/42004f72e3580acbad9bd8cc82b59d86?s=256&d=identicon&r=PG","account_id":124651,"user_type":"registered","user_id":319878,"link":"https://stackoverflow.com/users/319878/paul-grime","reputation":14990,"display_name":"Paul Grime","accept_rate":25},"edited":false,"creation_date":1366385686,"comment_id":23002871,"body":"@PaulGrime - After a brief review I didn&#39;t see anything there that addresses the above scenario.  The reference is not &quot;escaping&quot; before the object is constructed.  The int <code>n</code> is not public and cannot be viewed outside of the class."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/42004f72e3580acbad9bd8cc82b59d86?s=256&d=identicon&r=PG","account_id":124651,"user_type":"registered","user_id":319878,"link":"https://stackoverflow.com/users/319878/paul-grime","reputation":14990,"display_name":"Paul Grime","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":16107683,"edited":false,"creation_date":1366384839,"comment_id":23002429,"body":"<a href=\"http://www.ibm.com/developerworks/java/library/j-jtp0618/\" rel=\"nofollow noreferrer\">ibm.com/developerworks/java/library/j-jtp0618</a> might be useful."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=256&d=identicon&r=PG","account_id":284109,"user_type":"registered","user_id":581994,"link":"https://stackoverflow.com/users/581994/hot-licks","reputation":47153,"display_name":"Hot Licks","accept_rate":57},"content_license":"CC BY-SA 3.0","score":2,"post_id":16107683,"edited":false,"creation_date":1366384374,"comment_id":23002174,"body":"About all I can see is the possibility of inconsistent cache state between two processors in a multiprocessor situation.  That&#39;s always a possibility in a non-tightly-coupled MP environment, unless you take explicit steps to synchronize."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a96124f6c34c92429297b6a984150c5?s=256&d=identicon&r=PG","account_id":989922,"user_type":"registered","user_id":1719333,"link":"https://stackoverflow.com/users/1719333/veroslav","reputation":93,"display_name":"veroslav"},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"edited":false,"creation_date":1349350876,"comment_id":17187812,"body":"Peter, I like the idea of shared thread pools, I will definately look into it. Also, would you mind showing an example of a single scheduler passing tasks to a cached thread pool? I can&#39;t get my head around that at the moment."},{"owner":{"profile_image":"https://i.stack.imgur.com/W8X5E.jpg?s=256&g=1","account_id":395272,"user_type":"registered","user_id":758133,"link":"https://stackoverflow.com/users/758133/martin-james","reputation":24521,"display_name":"Martin James","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"edited":false,"creation_date":1349349309,"comment_id":17187124,"body":"If the tasks make any blocking calls, (eg. network stuff), you will need more idle threads, not less, to try an ensure that a new task gets scheduled onto a thread as soon as it&#39;s queued up.  If the tasks are CPU-intensive and do not block, you&#39;re stuffed anyway once all cores are running existing tasks.  I don&#39;t see much point in restricting the number of pool threads to less than the number of cores in any case, CPU-intensive or not."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"edited":false,"creation_date":1349347609,"comment_id":17186397,"body":"You could try sharing your thread pools or having one pass to another. e.g. have a single scheduler (globally) which passes all tasks to a single cached thread pool."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a96124f6c34c92429297b6a984150c5?s=256&d=identicon&r=PG","account_id":989922,"user_type":"registered","user_id":1719333,"link":"https://stackoverflow.com/users/1719333/veroslav","reputation":93,"display_name":"veroslav"},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"edited":false,"creation_date":1349346495,"comment_id":17185937,"body":"Yeah, I know that it might sound as I am applying premature optimization, but I will be using quite a lot of threads in the later stages of my project and I am trying to keep the thread count low if it is possible :)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"edited":false,"creation_date":1349345924,"comment_id":17185685,"body":"To give you some idea, you JVM can have about 20 threads just running HelloWorld. ;)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a96124f6c34c92429297b6a984150c5?s=256&d=identicon&r=PG","account_id":989922,"user_type":"registered","user_id":1719333,"link":"https://stackoverflow.com/users/1719333/veroslav","reputation":93,"display_name":"veroslav"},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"edited":false,"creation_date":1349345614,"comment_id":17185547,"body":"Thank you for you response. This sounds good, and I am leaning more and more towards using ScheduledExecutorService with a few threads in the pool (will have to research the optimum pool size). My main concern is to avoid a task having to wait to execute, due to another task being currently executed by the executor."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":2,"post_id":12723001,"edited":false,"creation_date":1349338996,"comment_id":17182625,"body":"Idle threads have next to no cost. If resources is you only concern I wouldn&#39;t worry about it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f54e86d83eea6143ecc70a485f4e6044?s=256&d=identicon&r=PG","account_id":1853886,"user_type":"registered","user_id":1679863,"link":"https://stackoverflow.com/users/1679863/rohit-jain","reputation":210617,"display_name":"Rohit Jain","accept_rate":77},"content_license":"CC BY-SA 3.0","score":0,"post_id":12723001,"edited":false,"creation_date":1349338577,"comment_id":17187854,"body":"You can see <a href=\"http://www.quartz-scheduler.org/documentation/quartz-2.x/tutorials/\" rel=\"nofollow noreferrer\">Quartz Scheduler API</a>."},{"owner":{"profile_image":"https://i.stack.imgur.com/upuLe.jpg?s=256&g=1","account_id":277279,"user_type":"registered","user_id":571189,"link":"https://stackoverflow.com/users/571189/prince-john-wesley","reputation":62850,"display_name":"Prince John Wesley"},"content_license":"CC BY-SA 3.0","score":0,"post_id":10528572,"edited":false,"creation_date":1336640666,"comment_id":13621594,"body":"@ben,@helloworld922,@trutheality: Lock is required. see my answer."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d82434b7558d87ca6d6054154bcd0443?s=256&d=identicon&r=PG","account_id":403847,"user_type":"registered","user_id":771837,"link":"https://stackoverflow.com/users/771837/trutheality","reputation":23234,"display_name":"trutheality"},"content_license":"CC BY-SA 3.0","score":1,"post_id":10528572,"edited":false,"creation_date":1336631701,"comment_id":13618585,"body":"I suspect it might be in order to comply with the <code>@GuardedBy</code> annotation."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/017645ede4e9307dffe51d902ee01a88?s=256&d=identicon&r=PG","account_id":269291,"user_type":"registered","user_id":558546,"link":"https://stackoverflow.com/users/558546/helloworld922","reputation":10831,"display_name":"helloworld922","accept_rate":91},"content_license":"CC BY-SA 3.0","score":1,"post_id":10528572,"edited":false,"creation_date":1336631529,"comment_id":13618537,"body":"I would agree, locking in the constructor seems unnecessary."},{"owner":{"profile_image":"https://i.stack.imgur.com/LR4iW.jpg?s=256&g=1","account_id":1114067,"user_type":"registered","user_id":1103872,"link":"https://stackoverflow.com/users/1103872/marko-topolnik","reputation":196801,"display_name":"Marko Topolnik","accept_rate":82},"content_license":"CC BY-SA 3.0","score":1,"post_id":10486413,"edited":false,"creation_date":1336412531,"comment_id":13552147,"body":"Be very careful about the semantics of that snippet in Javadoc -- it always returns the <b>previous</b> value under that key."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":10486413,"edited":false,"creation_date":1336412290,"comment_id":13552055,"body":"Oh I see, sorry.  You are using the word &quot;update&quot; to mean not create.  You are correct, sorry."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/de94ab4df68395bd59de5d6c9c95df39?s=256&d=identicon&r=PG","account_id":115344,"user_type":"registered","user_id":302916,"link":"https://stackoverflow.com/users/302916/brian-roach","reputation":76329,"display_name":"Brian Roach"},"content_license":"CC BY-SA 3.0","score":0,"post_id":10486413,"edited":false,"creation_date":1336412267,"comment_id":13552044,"body":"your logic is a bit hosed though. if <code>local</code> is equal to <code>value</code> then you just updated the map. Don&#39;t you mean if it&#39;s <i>not</i> equal to <code>value</code> ? Meaning there was something already in the map?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1e1f4dbb6e64ed8de79766168a3db197?s=256&d=identicon&r=PG","account_id":59449,"user_type":"registered","user_id":177883,"link":"https://stackoverflow.com/users/177883/darthvader","reputation":53532,"display_name":"DarthVader","accept_rate":96},"content_license":"CC BY-SA 3.0","score":0,"post_id":10486413,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"edited":false,"creation_date":1336412183,"comment_id":13552008,"body":"@Gray second line in the equiv. code saying  that if the key is not in the cache, then put it , otherwise just return the value. it doesnt update the value if key value pair is already in the cache."},{"owner":{"profile_image":"https://i.stack.imgur.com/ENkcp.jpg?s=256&g=1","account_id":426969,"user_type":"registered","user_id":808486,"link":"https://stackoverflow.com/users/808486/tudor","reputation":61751,"display_name":"Tudor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":8707215,"edited":false,"creation_date":1326789997,"comment_id":11117487,"body":"It&#39;s probably better to break it down. Then when you have a set of smaller questions, you can also use the search here on SO. I&#39;m pretty sure I&#39;ve seen the answers to at least some of them given before."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/60d521b116416499f763c75b8914f001?s=256&d=identicon&r=PG","account_id":103311,"user_type":"registered","user_id":276779,"link":"https://stackoverflow.com/users/276779/shane","reputation":2301,"display_name":"Shane","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":8707215,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ENkcp.jpg?s=256&g=1","account_id":426969,"user_type":"registered","user_id":808486,"link":"https://stackoverflow.com/users/808486/tudor","reputation":61751,"display_name":"Tudor","accept_rate":100},"edited":false,"creation_date":1326767502,"comment_id":11113604,"body":"@Tudor - The question is what I have put in the title. Admittedly, it’s a quite a big question with multiple parts.  What I am looking for is a set of simple rules off what is safe in .net – as I mentioned I don’t want to roll my own lock free code – I just want to leverage existing thread safe library code without employing unnecessary locking.  I’m happy to accept suggestions on how to improve the question – perhaps I should break it up into multiple questions?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ENkcp.jpg?s=256&g=1","account_id":426969,"user_type":"registered","user_id":808486,"link":"https://stackoverflow.com/users/808486/tudor","reputation":61751,"display_name":"Tudor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":8707215,"edited":false,"creation_date":1326701533,"comment_id":11095631,"body":"Ok, I understand your concerns, but I cannot discern any concrete question here. Or are you just starting a conversation about memory models and fences?"},{"owner":{"profile_image":"https://i.stack.imgur.com/5DblQ.png?s=256&g=1","account_id":8326,"user_type":"registered","user_id":14955,"link":"https://stackoverflow.com/users/14955/thilo","reputation":258555,"display_name":"Thilo","accept_rate":55},"content_license":"CC BY-SA 3.0","score":16,"post_id":8602466,"edited":false,"creation_date":1324549360,"comment_id":10673729,"body":"Yes, they can, but you really want to avoid them doing that at exactly the same time. There needs to be some coordination. If you are talking about Bittorrent, I think that works by assembling blocks of known offsets into a file of known size. That cannot be called sequentially or parallelly, it is more &quot;random access&quot;."},{"owner":{"profile_image":"https://i.stack.imgur.com/vJbKg.jpg?s=256&g=1","account_id":288696,"user_type":"registered","user_id":589259,"link":"https://stackoverflow.com/users/589259/maarten-bodewes","reputation":91230,"display_name":"Maarten Bodewes","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":8286472,"edited":false,"creation_date":1322610349,"comment_id":10254196,"body":"Have you read (e.g. on wikipedia) the definition of (binary) semaphore? Can you explain why the given answers (especially those of Vikas or the more extensive one of Alexander) are not sufficient? Otherwise you could try and explain the use case (for what <i>purpose</i> do you need the binary semaphore/mutex?)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0387e657fb93500d92de9fc8fbb60384?s=256&d=identicon&r=PG","account_id":414094,"user_type":"registered","user_id":788109,"link":"https://stackoverflow.com/users/788109/scorpion","reputation":3948,"display_name":"Scorpion","accept_rate":86},"content_license":"CC BY-SA 3.0","score":0,"post_id":8286472,"edited":false,"creation_date":1322407357,"comment_id":10205199,"body":"Have you tried something; drawing on the source code of existing semaphore class, of how it would behave if it were to just have a permit of 1."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d97fb3f93775ae7dcb70858cb528071d?s=256&d=identicon&r=PG","account_id":36594,"user_type":"registered","user_id":104422,"link":"https://stackoverflow.com/users/104422/victor","reputation":1665,"display_name":"Victor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":7948815,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/17636dab8a5895efa97273acad983c10?s=256&d=identicon&r=PG","account_id":310556,"user_type":"registered","user_id":623612,"link":"https://stackoverflow.com/users/623612/nico","reputation":2653,"display_name":"Nico"},"edited":false,"creation_date":1320019782,"comment_id":9715601,"body":"I saw that the solution &quot;conductor&quot; have a semaphore concept, but I don&#39;t know how to code that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d97fb3f93775ae7dcb70858cb528071d?s=256&d=identicon&r=PG","account_id":36594,"user_type":"registered","user_id":104422,"link":"https://stackoverflow.com/users/104422/victor","reputation":1665,"display_name":"Victor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":7948815,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/17636dab8a5895efa97273acad983c10?s=256&d=identicon&r=PG","account_id":310556,"user_type":"registered","user_id":623612,"link":"https://stackoverflow.com/users/623612/nico","reputation":2653,"display_name":"Nico"},"edited":false,"creation_date":1320019593,"comment_id":9715574,"body":"yes, but those solutions are not related to semaphores."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/17636dab8a5895efa97273acad983c10?s=256&d=identicon&r=PG","account_id":310556,"user_type":"registered","user_id":623612,"link":"https://stackoverflow.com/users/623612/nico","reputation":2653,"display_name":"Nico"},"content_license":"CC BY-SA 3.0","score":0,"post_id":7948815,"edited":false,"creation_date":1320019542,"comment_id":9715566,"body":"There are several solutions as well as commong pitfalls outlined on <a href=\"http://en.wikipedia.org/wiki/Dining_philosophers_problem#Solutions\" rel=\"nofollow noreferrer\">Wikipedia</a>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5798851c3e978a81889af3c2b85d3be2?s=256&d=identicon&r=PG","account_id":635999,"user_type":"unregistered","user_id":406227,"link":"https://stackoverflow.com/users/406227/mr-burgundy","reputation":361,"display_name":"Mr. Burgundy"},"content_license":"CC BY-SA 2.5","score":0,"post_id":3367192,"edited":false,"creation_date":1280442434,"comment_id":3498249,"body":"<code>Willi Sch&#246;nborn:</code> Then, what&#39;s the alternative?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/99a223da96298775aedc58a668c48a21?s=256&d=identicon&r=PG","account_id":82795,"user_type":"registered","user_id":232539,"link":"https://stackoverflow.com/users/232539/whiskeysierra","reputation":5050,"display_name":"whiskeysierra","accept_rate":88},"content_license":"CC BY-SA 2.5","score":0,"post_id":3367192,"edited":false,"creation_date":1280442078,"comment_id":3498210,"body":"The overhead of 10k threads will be extreme"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5798851c3e978a81889af3c2b85d3be2?s=256&d=identicon&r=PG","account_id":635999,"user_type":"unregistered","user_id":406227,"link":"https://stackoverflow.com/users/406227/mr-burgundy","reputation":361,"display_name":"Mr. Burgundy"},"content_license":"CC BY-SA 2.5","score":0,"post_id":3367192,"edited":false,"creation_date":1280441650,"comment_id":3498166,"body":"<code>@Colen:</code> Please see my new question, as I thought it was a bad idea too... What&#39;s the alternative? <a href=\"http://stackoverflow.com/questions/3367383/java-high-performance-message-passing-single-producer-single-consumer\" title=\"java high performance message passing single producer single consumer\">stackoverflow.com/questions/3367383/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dbd6e171ab0b4822895fee65d9a63571?s=256&d=identicon&r=PG","account_id":7733,"user_type":"registered","user_id":13500,"link":"https://stackoverflow.com/users/13500/colen","reputation":13518,"display_name":"Colen","accept_rate":75},"content_license":"CC BY-SA 2.5","score":2,"post_id":3367192,"edited":false,"creation_date":1280441034,"comment_id":3498094,"body":"10000 threads seems like a bad idea, since there may be overhead associated with each thread..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5798851c3e978a81889af3c2b85d3be2?s=256&d=identicon&r=PG","account_id":635999,"user_type":"unregistered","user_id":406227,"link":"https://stackoverflow.com/users/406227/mr-burgundy","reputation":361,"display_name":"Mr. Burgundy"},"content_license":"CC BY-SA 2.5","score":0,"post_id":3367192,"edited":false,"creation_date":1280440574,"comment_id":3498035,"body":"<code>@Ryan:</code> Updated; please take a look!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/002755a4b9512eefa862835dd7323ad7?s=256&d=identicon&r=PG","account_id":110346,"user_type":"registered","user_id":292023,"link":"https://stackoverflow.com/users/292023/ryan","reputation":3589,"display_name":"Ryan","accept_rate":95},"content_license":"CC BY-SA 2.5","score":0,"post_id":3367192,"edited":false,"creation_date":1280440140,"comment_id":3497970,"body":"Why don&#39;t you give more detail about what you are trying to achieve and we will tell you if there&#39;s a better way to do it."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d214ec644177666dd4a0d075526d8749?s=256&d=identicon&r=PG","account_id":23611,"user_type":"registered","user_id":59279,"link":"https://stackoverflow.com/users/59279/joonas-pulakka","reputation":36322,"display_name":"Joonas Pulakka","accept_rate":85},"content_license":"CC BY-SA 2.5","score":0,"post_id":1687977,"edited":false,"creation_date":1257519631,"comment_id":1562723,"body":"Umm, actually I hadn&#39;t thought about it this far. I was just curious about how, in general, to approach this problem. But people seem to have something cool to say about <code>submit()</code> and <code>Future</code> below :-)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c53d539b59c19087182f0b1c53bb52de?s=256&d=identicon&r=PG","account_id":7450,"user_type":"registered","user_id":12960,"link":"https://stackoverflow.com/users/12960/brian-agnew","reputation":269220,"display_name":"Brian Agnew"},"content_license":"CC BY-SA 2.5","score":2,"post_id":1687977,"edited":false,"creation_date":1257519625,"comment_id":1562722,"body":"It&#39;s a common requirement. Thread 1 generates some work, executes it via thread 2, but needs to understand if it&#39;s succeeded or not (i.e. thrown an exception). The Executor framework helps you with this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6cd776da01e915df274276084eb9858b?s=256&d=identicon&r=PG","account_id":43577,"user_type":"registered","user_id":127479,"link":"https://stackoverflow.com/users/127479/adamski","reputation":54129,"display_name":"Adamski","accept_rate":95},"content_license":"CC BY-SA 2.5","score":2,"post_id":1687977,"edited":false,"creation_date":1257519606,"comment_id":1562717,"body":"@BalusC: Marshalling an exception from a worker thread back onto a calling thread is a common requirement of many applications.  For example, a UI application may invoke a SwingWorker thread to do some background processing.  If the processing fails the exception needs to be passed back to the Event Dispatch thread."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/89927e2f4bde24991649b353a37678b9?s=256&d=identicon&r=PG","account_id":52822,"user_type":"registered","user_id":157882,"link":"https://stackoverflow.com/users/157882/balusc","reputation":1089035,"display_name":"BalusC","accept_rate":93},"content_license":"CC BY-SA 2.5","score":1,"post_id":1687977,"edited":false,"creation_date":1257519191,"comment_id":1562682,"body":"Honestly I question the sense of catching an exception thrown in a <i>different</i> thread. Does the current thread have to <code>join</code> the thread and wait for the exception to be thrown? You didn&#39;t cover that in the question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b2307ec2e0242d08e7b7236223a47fe7?s=256&d=identicon&r=PG","account_id":22836830,"user_type":"registered","user_id":16984466,"link":"https://stackoverflow.com/users/16984466/lucas-grugru","reputation":1684,"display_name":"Lucas Grugru"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676557170,"comment_id":133163825,"body":"Who is Paul Samsotha ? What answer ?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AEdFTp61CUpQI3VbC_PLq34lGLauPTVC9VC23rZkIOSpZw=k-s256","account_id":27772393,"user_type":"registered","user_id":21202467,"link":"https://stackoverflow.com/users/21202467/nasir-mushtaq","reputation":1,"display_name":"Nasir Mushtaq"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676279155,"comment_id":133098101,"body":"Create only one client and reuse that"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676124260,"comment_id":133076706,"body":"Ah, ok. Interesting. I stumbled across this question while researching a related issue and thought I would add this piece of information for future readers. Did not consider it might not have been true at the time the question was asked."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676123885,"comment_id":133076652,"body":"Hmm ... yes I see it.  But it is not in Java 8.  It is only implemented in Java 9+.  Prior to that the Linux implementation of <code>os::set_native_thread_name</code> is a noop."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122544,"comment_id":133076447,"body":"My java version: <code>$ java -version openjdk version &quot;11.0.11&quot; 2021-04-20 OpenJDK Runtime Environment AdoptOpenJDK-11.0.11+9 (build 11.0.11+9) OpenJDK 64-Bit Server VM AdoptOpenJDK-11.0.11+9 (build 11.0.11+9, mixed mode) </code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122525,"comment_id":133076445,"body":"I assume the libc function is <code>pthread_setname_np</code> which is used quite often in jdk code. This seems to call prctl: <a href=\"https://android.googlesource.com/platform/bionic/+/master/libc/bionic/pthread_setname_np.cpp#94\" rel=\"nofollow noreferrer\">android.googlesource.com/platform/bionic/+/master/libc/bioni&zwnj;&#8203;c/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122346,"comment_id":133076411,"body":"Which version of Java are you testing?  Which vendor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122085,"comment_id":133076378,"body":"@StephenC Evidence is Strace output. I created a runnable jar with the line <code>Thread.currentThread().setName(&quot;test-name-123456789&quot;);</code> and ran it under strace <code>strace -e &#39;trace=!futex&#39; -tt -r -f -o name-trial.txt java -jar run.jar</code>. Output contains this line <code>948729 14:22:19.789325 (+     0.000238) prctl(PR_SET_NAME, &quot;test-name-12345&quot;...) = 0</code>. You also see the system calls, when other threads are named, such as <code>948730 14:22:19.440447 (+     0.000084) prctl(PR_SET_NAME, &quot;GC Thread#0&quot; &lt;unfinished ...&gt;</code>. I assume you did not find the call in the sources, because it is invoked through a c stdlib."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"edited":false,"creation_date":1675984424,"comment_id":133051112,"body":"@Joe23 - Really?  Evidence?  According to (<code>grep</code> search of) the OpenJDK 8u &amp; 17u source code there are no calls to <code>prctl(PR_SET_NAME, ...)</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1675963126,"comment_id":133045477,"body":"It leads to a system call though: <code>prctl(PR_SET_NAME, &quot;new-name&quot;)</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/SEQOn.jpg?s=256&g=1","account_id":10611364,"user_type":"registered","user_id":7815223,"link":"https://stackoverflow.com/users/7815223/shagun-verma","reputation":163,"display_name":"Shagun Verma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"reply_to_user":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"edited":false,"creation_date":1675946402,"comment_id":133039335,"body":"To know the difference, you can see <a href=\"https://javarevisited.blogspot.com/2016/12/difference-between-thread-and-executor.html?m=1\" rel=\"nofollow noreferrer\">javarevisited.blogspot.com/2016/12/&hellip;</a>"},{"owner":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"edited":false,"creation_date":1675921816,"comment_id":133032776,"body":"Thanks a lot Shagun Verma,  I&#39;d like to make a question: &#191;What would be the difference between this executor and a thread?  I appreciate a lot your answer, it is helping me to move foward. My code is partially working at this moment, I still need to make additional modifications... I&#39;m gonna continue tomorrow and update this post with additional feedback/comments.  Thanks again!!!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86172,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"edited":false,"creation_date":1665070421,"comment_id":130618251,"body":"Without SupervisorJob, if any of the jobs launched with the scope fail, the rest of them are canceled and it can never launch another job again. There are potentially cases where that would be the behavior you might want though. I haven&#39;t personally ever had any though."},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"edited":false,"creation_date":1665068670,"comment_id":130617492,"body":"Please note: this community wants quality answers. Telling people &quot;go read some documentation about X&quot; isn&#39;t that. Seriously: if you dont want to spend the time to write a proper answer, then write a comment. Otherwise, invest a few minutes and write an answer that deserves to be called &quot;answer&quot;."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"edited":false,"creation_date":1665067927,"comment_id":130617196,"body":"Thanks ! Could you explain how SupervisorJob is useful and what happens when it is not used, please ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e34d0dd755c1ca59cd89d4a4e566439a?s=256&d=identicon&r=PG","account_id":2226374,"user_type":"registered","user_id":1965042,"link":"https://stackoverflow.com/users/1965042/vcg","reputation":106,"display_name":"vcg"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"edited":false,"creation_date":1665065857,"comment_id":130616325,"body":"Sorry misunderstood the question, I guess you are using <code>lastEdit</code> as static var, you may want to add <code>volatile</code> keyword to the var, so that the threads will access to the real value of your var.. take a look at <a href=\"https://www.baeldung.com/java-volatile\" rel=\"nofollow noreferrer\">volatile keyword</a>"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73968534,"edited":false,"creation_date":1665029066,"comment_id":130604574,"body":"I have searched about scheduleAtFixedRate. But what I want to do is initially delay execution for 10 seconds. And if I do something else in another program, it will restart the timer and execute the code after 10s."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664731012,"comment_id":130534053,"body":"@john16384, <code>InterruptedException</code> is not intended to stop a thread. It is intended to get a thread&#39;s attention. If <i>you</i> want it to stop <i>your</i> thread, then it&#39;s up to you to write a handler so that the thread can catch the exception and then <i>cleanly</i> stop itself."},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664718111,"comment_id":130531264,"body":"certainly not, I&#39;m highly in favor of checked exceptions, just missing why an exception intended to interrupt / stop a thread isn&#39;t part of the declaration of the <code>run</code> method which serves as the entry points for many threads; been looking through the JBS is something was proposed like this, and this is the most similar ticket I could find: <a href=\"https://bugs.openjdk.org/browse/JDK-8150342\" rel=\"nofollow noreferrer\">bugs.openjdk.org/browse/JDK-8150342</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664717869,"comment_id":130531209,"body":"@john16384: i think this is just another argument against checked exceptions, let the exception be thrown and kill the thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664717553,"comment_id":130531125,"body":"Thanks, but I&#39;m not trying to catch an exception from a thread in another thread. The uncaught handler will log it, I know, I&#39;m just asking why would <code>run</code> not have been declared to throw <code>InterruptedException</code> to make it easier to terminate threads with out having to go through the <code>try...catch</code> boilerplate.  Any runtime exception terminates the thread, but an <code>InterruptedException</code> should for some reason be disallowed?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3383e4fd807a451772e79e0f5ccca51c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7413926,"user_type":"registered","user_id":11374957,"link":"https://stackoverflow.com/users/11374957/kaan","reputation":5474,"display_name":"Kaan"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73220736,"edited":false,"creation_date":1659917762,"comment_id":129402173,"body":"<i>&quot;the Callable/Future is much better to catch and log errors&quot;</i> – this doesn&#39;t make sense.. any thread or runnable can catch exceptions and log errors."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2dbd48d7460f4e598ad5142d154055e9?s=256&d=identicon&r=PG","account_id":2898508,"user_type":"registered","user_id":2485774,"link":"https://stackoverflow.com/users/2485774/chazz1","reputation":133,"display_name":"Chazz1","accept_rate":87},"content_license":"CC BY-SA 4.0","score":0,"post_id":73220736,"edited":false,"creation_date":1659525531,"comment_id":129314469,"body":"I had something like that. But something went wrong on the production site, and the runnable stopped and nobody noticed it until some days later. For what I&#39;ve read, the Callable/Future is much better to catch and log errors. I was trying to implement a callable so I could relaunch it when something like this happens."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"edited":false,"creation_date":1658862721,"comment_id":129156352,"body":"Hi @Dinesh... I had used Inmemory map to store authorization related data. Can you please help me explain your issue more."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1658234434,"comment_id":128996582,"body":"@DeepikaSwarup - I am also having a similar approach of calling a Remote Service using Spring HTTPInvoker from Kafka Consumer and getting the same above error. i am stuck with no ways to get further, can you explain a bit more on how and what you did with inmemory map ? Related question here:  <a href=\"https://stackoverflow.com/q/72999102/1764587\">stackoverflow.com/q/72999102/1764587</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654936471,"comment_id":128214757,"body":"Sure Stanislav, I will try."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654933365,"comment_id":128214350,"body":"@ShubhamChaurasia, that&#39;s interesting.. Maybe it&#39;s the ThreadPoolExecutor which has issues with threads constantly fighting for tasks. Could you increase the number of operations? If the trend improves, that again would point to the fact that the culprit is somewhere in the thread pool. If that&#39;s the case, try ForkJoinPool. It&#39;s supposed to be more performant in such scenarios."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654932827,"comment_id":128214278,"body":"No worries and thanks for updating again. Actually I did that earlier and I understand what you are measuring is the total time to complete the program with overlapping threads being run concurrently. For the same purpose I was calculating the average time.  Anyways, I ran it with your implementation of runBenchmark() and I am seeing similar results -  1. On 8 cores - =====runBenchmark() FINISHED in 171217 2. On 16 cores - =====runBenchmark() FINISHED in 186911 3. On 32 cores - =====runBenchmark() FINISHED in 267623   As we can see, the time is increasing with number of cores."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654931031,"comment_id":128214042,"body":"@ShubhamChaurasia, take a look now. Hopefully it answers the question now :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930625,"comment_id":128213978,"body":"@ShubhamChaurasia, I think now I see the problem and my answer is not far off. Let me update it :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930204,"comment_id":128213938,"body":"@ShubhamChaurasia, ah, so you&#39;re not increasing the number of threads - it&#39;s always 100 regardless of whether you&#39;re running on the machine with 8 or 32 cores? If that&#39;s the case, then sorry for the confusion."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929824,"comment_id":128213893,"body":"I clarified it a bit more in the question - &quot;1000000 is number of floating point divisions that each thread does, 100 is number of threads.&quot;"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929495,"comment_id":128213849,"body":"The amount of work is constant in all the setups. All 8, 16, and 32 cores systems are getting to process 100 threads and 1M operations in each thread. Then we can expect a perf gain, is that right ?"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654929307,"comment_id":128213823,"body":"@ShubhamChaurasia, in your question you stated that you expect the time to decrease. Which doesn&#39;t make sense. If you&#39;re adding x2 cores but also add x2 work, then why would that finish faster?"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929067,"comment_id":128213792,"body":"I get your point about dividing total number of operations among threads. But here I think we are more concerned about the number of these threads that cores can service and there we are seeing lesser number of cores winning due to some reason."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654928808,"comment_id":128213769,"body":"Updated in &quot;EDIT 1:&quot; with ThreadLocalRandom observations."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654927880,"comment_id":128213654,"body":"Thanks for pointing out, sure will try."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72570061,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"edited":false,"creation_date":1654883240,"comment_id":128206982,"body":"Both implementing <code>Step</code> or extending <code>AbstractStep</code> should work. It is up to you. In regards to how to set the commit-interval dynamically with a job parameter, you can take a look at this: <a href=\"https://stackoverflow.com/questions/26041550/spring-batch-dynamic-commit-interval-or-a-custom-completion-policy\" title=\"spring batch dynamic commit interval or a custom completion policy\">stackoverflow.com/questions/26041550/&hellip;</a>."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570061,"edited":false,"creation_date":1654873120,"comment_id":128203604,"body":"Awesome thank you for this answer. So for dynamic steps I would implement the Step Interface or should I use the AbstractStep class? What classes should I extend for the dynamic commit interval?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849677,"comment_id":128194958,"body":"Yeah I will take a look and see if I can find something I can use"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654849625,"comment_id":128194933,"body":"There are lots of simple socket server examples out there on the interwebz for java, C#, C++, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849288,"comment_id":128194819,"body":"I did extend the class and implemented the accept in the new class though am afraid it will not create sessions as per your advice, an answer in android java is welcome as I can convert it to C#, updating my code"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654848834,"comment_id":128194682,"body":"As step 1 above says, this blocking call needs to be on a separate thread (the &quot;Accept&quot; thread) which does nothing but this blocking call and spawns other threads for clients."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654848710,"comment_id":128194655,"body":"Hello sir from your reputation I can see you are advanced, I needed help with this, since the blocking call will not execute code below it as  it listens on connections forever, how to avoid that but still get the message from the source device?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"edited":false,"creation_date":1654790801,"comment_id":128181712,"body":"@BlueRyse: If you can provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> you may get better answers. I understand you want to make the post short but that discourages people from helping when they don&#39;t have something they can run. And even if the suggested code doesn&#39;t work make sure you understand the point of avoiding races and not waiting if a notification isn&#39;t coming."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"edited":false,"creation_date":1654786982,"comment_id":128180183,"body":"Unfortunately, this solution doesn&#39;t work. At this point, I guess there&#39;s something wrong with my OS, Eclipse, or the JVM."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551685,"edited":false,"creation_date":1654719975,"comment_id":128161955,"body":"This answer worked perfectly, thank you so so so much! I can&#39;t believe I didn&#39;t catch this one myself."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71327704,"edited":false,"creation_date":1649934361,"comment_id":127002672,"body":"Thanks Gray for the pointers... It helped me in getting more insight and fixing it. Since there was no controller involved and Kafka was calling PUT method directly, I was unable to get HTTP context... In order to resolve my issue, I created an inmemory map..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1646333964,"comment_id":126103570,"body":"Sorry @DeepikaSwarup.  I don&#39;t know enough about your application to answer appropriately."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"edited":false,"creation_date":1646331272,"comment_id":126102702,"body":"Thanks Gray for the pointers. Yes putData() is directly being called by my consumer and not through controller. Will it be correct if I call my controller API through consumer in the same project? And then through controller I will call putData()."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1646248410,"comment_id":126078767,"body":"@pveentjer right, but isn&#39;t a data race a result of a missing happens before chain? I mean the phrase: &quot;... are not ordered by a happens-before relationship, it is said to contain a data race&quot; from chapter 17 of JLS. My point being that, unless there is HB for all actions, yes, a data race can happen. Was that your point? thank you."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"edited":false,"creation_date":1646241445,"comment_id":126076367,"body":"Small correction: Happens-before consistent is a relaxation of happens-before. Happens-before consistent also deals when a read and write are concurrent (so not ordered by happens-before; so in data race)."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646233765,"comment_id":126073067,"body":"@Holger you&#39;re right, I&#39;ve edited."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645697231,"comment_id":125942829,"body":"In other words, the fact that the volatile write and read (to the same variable) have a “synchronizes-with” relation is the <i>prerequisite</i> to have a <i>happens-before</i> relationship. As &#167;17.4.5. says at the beginning “<i>If an action x synchronizes-with a following action y, then we also have hb(x, y).</i>” It than proceeds to say “<b>It follows from the above definitions that:</b> <i>A write to a volatile field (&#167;8.3.1.4) happens-before every subsequent read of that field.</i>” This conclusion is what we want; since it has been spelled out explicitly, there is no need to discuss “synchronizes-with” at all."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645680815,"comment_id":125938156,"body":"The happens-before order is the transitive closure of the union of the synchronizes-with order and the program order. So if you have established that 2 actions are ordered by the synchronizes-with order, it is automatically implied that they are ordered by the happens-before order."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71212240,"edited":false,"creation_date":1645611395,"comment_id":125915941,"body":"good answer, simple, yet very good."},{"owner":{"profile_image":"https://i.stack.imgur.com/Poqe8.png?s=256&g=1","account_id":10898797,"user_type":"registered","user_id":8011734,"link":"https://stackoverflow.com/users/8011734/marwa-eltayeb","reputation":1961,"display_name":"Marwa Eltayeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1637332712,"comment_id":123805434,"body":"You are very welcome. I am so glad that my answer is helpful for you."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"edited":false,"creation_date":1637222866,"comment_id":123769689,"body":"Thank you very much for your detailed and involved answer."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJzLkOQelMMXYxAJxRKLvxqRtrmM6VXMlnw9PvD0=k-s256","account_id":23184907,"user_type":"registered","user_id":17282180,"link":"https://stackoverflow.com/users/17282180/iosiv","reputation":25,"display_name":"Iosiv"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967575,"edited":false,"creation_date":1637095160,"comment_id":123733467,"body":"Thanks! Great explanation. I understand your point. Actually, I suspected that was the issue from the very beginning, but unfortunately I&#39;m not allowed to modify the Player classes (for learning/suffering purposes), so I&#39;m actually looking for a solution that involves only the Ball class. I tried, for instance, to  get the name of the current thread and use this to lock the methods for each of them every time. Or to use two booleans instead of one. No success so far, but I&#39;ll keep trying."},{"owner":{"profile_image":"https://i.stack.imgur.com/5ovO7.png?s=256&g=1","account_id":9713597,"user_type":"registered","user_id":7204683,"link":"https://stackoverflow.com/users/7204683/umair","reputation":615,"display_name":"Umair","accept_rate":38},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"edited":false,"creation_date":1636997613,"comment_id":123701661,"body":"you are welcome @TanmayMandaogane"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636975020,"comment_id":123692464,"body":"It is possible, but at that point there are no other threads. If there were any, they&#39;d run. Every thread has its own code. This is not magic, code cannot jump between threads. Code still must be executed sequentially by a single thread. Therefore, you need to wait for client connections in one thread, and start clients in another thread. The server needs to have its own thread which will handle the connections. The infinite loop will hog the thread forever and the code after Server.start() never runs."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636974720,"comment_id":123692369,"body":"It can. This is not about other threads. Other threads will run the <code>GameClientHandler.run()</code> code, but not anything else. What&#39;s happening, is this: Thread1: &quot;I&#39;ll wait for a client to connect. When it connects, I&#39;ll start a thread to handle it, then wait for another connection, and another, and another, and another. When infinite connections are done (never), only then will I move on and actually start two clients.&quot; This thread gets stuck at step 1, waiting for a client to connect. There are no clients. There are no other (handler) threads because you only start them after a client connects."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"edited":false,"creation_date":1636974674,"comment_id":123692353,"body":"@PetrJaneček Regarding the latter part of your comment, If a thread is looping forever, it is impossible to switch to another thread?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973382,"edited":false,"creation_date":1636974467,"comment_id":123692266,"body":"Exactly. Just to make it a little more clear, the code will wait forever at the <code>serverSocket.accept()</code> call (which is called before the <code>new Thread(...)</code> part) and will never move on from there."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636974240,"comment_id":123692177,"body":"You never get to <code>client1.startConnection()</code>. Your code is stuck forever at <code>serverSocket.accept()</code> which waits forever. It will not move from that point. Even if that was not the case, the then there&#39;s the infinite loop. Again, the code would loop forever, never actually getting to <code>client1.startConnection()</code>."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636973999,"comment_id":123692082,"body":"But I also have client1.startConnection()?"},{"owner":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"edited":false,"creation_date":1636926068,"comment_id":123682000,"body":"thank you so much brother I got It  everything."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636896634,"comment_id":123674561,"body":"If you are trying to demonstrate that the code is not thread-safe, be aware that the <code>println</code> <i>could</i> be altering the way that things are working.  Also, be aware that thread non-safe behavior may actually occur on particular platforms under particular circumstances that are hard to reproduce.  They may depend on hardware behavior, numbers of cores, specific code sequences generated by specific JIT compilers, etc.   (The fact that you are not able to show thread non-safety does NOT mean that code is thread-safe.  You have to carefully analyze the code against what the JLS says.)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895965,"comment_id":123674410,"body":"I modifed code a bit <code>new _Thread(new Dummy()).start()</code>, but didn&#39;t achieved expected result. Every time it prints that list has all 10_000 elements. Does it happens because <code>start()</code> methods triggers <code>happens-before</code> and all values from constructor in main thread will be visible in <code>_Thread</code> or it is just hard to reproduce?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":1,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636895558,"comment_id":123674310,"body":"1) Yes.  If you satisfy <b>all</b> of the prerequisites. 2) Yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895045,"comment_id":123674169,"body":"Does it mean that if I will used <code>final</code> on unsynchronized collection, values put in during construction won&#39;t be cached inside of thread but will be commited in main memory despite there is no synchronization and collection isn&#39;t thread-safe, and if there will be no <code>final</code> modifier there is possibility that values put in will be visible only to thread which executed code in constructor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894805,"comment_id":123674109,"body":"<code>final fields also allow programmers to implement thread-safe immutable objects without synchronization</code> why do I even have to use synchronization inside of constructor if only single thread can execute code in it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894676,"comment_id":123674091,"body":"As for example int this question - <a href=\"https://stackoverflow.com/questions/6457109/java-concurrency-is-final-field-initialized-in-constructor-thread-safe\" title=\"java concurrency is final field initialized in constructor thread safe\">stackoverflow.com/questions/6457109/&hellip;</a> was used <code>final</code> <code>HashMap</code>, and all values were put in constructor. I wonder what will be the difference if there was no <code>final</code> modifier. As for me, I see no difference bcs anyway thread won&#39;t return object until constructor finishes his work, he didn&#39;t pass out <code>this</code> out of constructor. Or bcs it is not synchronized <code>Map</code> thread can cache values which he put into <code>Map</code> and other threads won&#39;t see fully populated map but only part of it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa0490fa29da8a5d40dd219d9f13dccb?s=256&d=identicon&r=PG","account_id":49729,"user_type":"registered","user_id":148208,"link":"https://stackoverflow.com/users/148208/justin-kredible","reputation":8364,"display_name":"Justin Kredible","accept_rate":74},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955150,"edited":false,"creation_date":1636815008,"comment_id":123660346,"body":"This approach requires the thread to poll the queue with a timeout. For this application, how often the producer places a new object in the queue is indeterminate. It could be as little as a few milliseconds to as much as a few minutes. This means choosing a suitable timeout for the consumers is almost impossible. The goal is to prevent the consumer threads from needlessly consuming CPU time as well as needlessly blocking. The consumer threads should only block while the producer is active. If the producer has exited, the consumers should exit once the queue is empty."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":68788509,"edited":false,"creation_date":1631416285,"comment_id":122214241,"body":"a &quot;fairy tale&quot; answer got accepted agains this. of course."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629711786,"comment_id":121749897,"body":"It did not help"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629222254,"comment_id":121628473,"body":"If they are not static, then each thread has their own separate copy of those variables..  Each thread will wait for the other thread to change their copy of turn and notify their copy of monitor, but that will never happen, because the other thread is doing that to the other copy."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"edited":false,"creation_date":1629209876,"comment_id":121623256,"body":"Hey, I&#39;m pretty sure it&#39;s a dumb question but why does the program not work if monitor and turn are not static?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629175752,"comment_id":121610331,"body":"Glad it helped. Just remember that <code>synchronized</code> always works upon any object. Means threads will compete to access the <code>synchronized</code> object. You cannot sync the threads, but need to make them access common <code>synchronized</code> object, to make them run in sync."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1629128619,"comment_id":121599510,"body":"I expressed myself pretty badly, I was talking about the first Output but because the run method is synchronized at the time when t1 creates t2, t2 can&#39;t use the run Method yet because it&#39;s already in use, correct?. I think I understood the concept itself now and just have to code it a couple times to get it into my brain. I can&#39;t express how much I appreciate the time you put into your answer, it really helped a lot! (and sorry for the late answer)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124cda7f0e8d259e69d49ed43868639e?s=256&d=identicon&r=PG","account_id":99786,"user_type":"registered","user_id":269361,"link":"https://stackoverflow.com/users/269361/fool4jesus","reputation":2155,"display_name":"fool4jesus","accept_rate":79},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"edited":false,"creation_date":1629126606,"comment_id":121598571,"body":"@TomDibble Yeah, that&#39;s true; of course, depending on how often this happens, we might not want to pay the stack trace overhead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629122491,"comment_id":121596460,"body":"What you could try is to use saveAndFlush() instead of save() on the repository. It instantly brings the changes to the database."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629122329,"comment_id":121596389,"body":"In the subclass-Thread approach, can&#39;t we just override <code>interrupt()</code> itself, and capture thread state of the interrupter from <code>Thread.currentThread()</code>, at least thread id and name, likely also the current stack trace?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629114483,"comment_id":121593048,"body":"I am using the DB interface to validate the logic, i see that using transaction, money don’t edit"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68793486,"edited":false,"creation_date":1629110199,"comment_id":121591447,"body":"It’s not really encapsulation when you’re still dealing with threads directly. Nothing prevents other threads from calling the original <code>interrupt()</code> method without a name here. Generally, code should not depend on names in that form anyway. See for example, <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html\" rel=\"nofollow noreferrer\"><code>FutureTask</code></a> and how it nowhere deals with threads in the API. You may <code>cancel</code> it with interruption and it will interrupt the processing thread if there is one and it is still processing this very task."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629109610,"comment_id":121591219,"body":"@Saintka I saw in your edited question that for a withdrawal you are doing money += value. Is this right? Usually on withdrawal you remove money from your account.  Further question, what is your test assertion? From your code I currently can&#39;t see what you are validating to see if your logic worked or not. Something like account.getMoney().equals(1000); or so."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629102820,"comment_id":121588455,"body":"The cost of a context switch is not only the context switch itself, but also running into cold caches. And depending on the microarchitecture and the OS, a context switch can also lead to TLB evictions to prevent security problem as those caused by meltdown and others."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629102621,"comment_id":121588383,"body":"How can a method return a different object one by one id? Yes, sthat synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629093754,"comment_id":121585425,"body":"@Saintka I&#39;m not sure which part you don&#39;t understand: that <code>findById</code> may return a different object for the same id, or that synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a97334841a1e42ce096e1e220116af2?s=256&d=identicon&r=PG","account_id":931371,"user_type":"registered","user_id":961204,"link":"https://stackoverflow.com/users/961204/jobless91","reputation":33,"display_name":"jobless91"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629087452,"comment_id":121584297,"body":"@fool4jesus yes, that&#39;s a mistake in question. I forgot to add an <code>if(Thread.interrupted())</code> condition. I will update the question but I got your point. Key motivation for this question is, I have a blocking queue which is getting interrupted while waiting for memory(it is reaching it&#39;s size limit we have defined). I wanted to look for that interrupting thread. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629086477,"comment_id":121584175,"body":"Interesting reasoning, but i don&#39;t understand, how is this related in this situation, please give an example"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081187,"comment_id":121583556,"body":"Thanks, I will avoid the CompletableFuture for now, I never a fan of callback anyway. I am not a CS grad, so I tried my best to understand the server-client. Thanks for the clarification."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081037,"comment_id":121583538,"body":"That makes so much sense! I only use that <code>CompletableFuture</code> there, assuming there are only 4 threads from the ForkJoinPool.commonPool, I can imagine the Opening Handshake will do Redis select to determine if it&#39;s a valid request and it will block the async code."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080594,"comment_id":121583489,"body":"Also, I think you&#39;re lacking a sense of perspective. Your CPU can run literally billions of ops a second. That 500 feels expensive, but in context, we&#39;re talking about a nanosecond. Just write the simplest code you can, make lots of threads, call blocking code, don&#39;t worry about accidentally blocking, and worry about inefficient algorithms instead. You can handle hundreds of simultaneous connections on the cheapest AWS virtual server that way, no problem."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080418,"comment_id":121583465,"body":"The reason async makes it easier: If you block <i>anywhere</i> in an async block, that means the thread is twiddling its thumbs. If I figure out you forgot (e.g. you do a sync DB call somewhere), I just need to get into the &#39;block&#39; mode on 10 simultaneous connections and your server&#39;s CPU is 100% frozen out, not responding to anything else. It is much, MUCH harder to loop a thread using a malicious request, and it&#39;s much easier to realize that&#39;s happening (as CPU load would jump to 100%)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080336,"comment_id":121583454,"body":"500+ cycles, as in: The CPU could be doing 500 simple calculations. <b>But it is what it is</b>, you cannot avoid this cost no matter how hard you try. runAsync won&#39;t do it either. The point is: If you read a blogpost that says async avoids it, they are misunderstanding how CPUs work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080291,"comment_id":121583450,"body":"async makes it much <i>easier</i> to DDOS a server, not harder. That runAsync trick does mostly nothing. It certainly doesn&#39;t prevent DDoS attacks. You can&#39;t avoid the context switching. Period. Nothing can."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629079915,"comment_id":121583411,"body":"Does this mean <code>CompletableFuture.runAsync( () - &gt; { WebSocket websocket = new WebSocket(socket, listener); es.execute(websocket); });</code>, I use this after <code>final Socket socket = serverSocket.accept();</code> in case the server is under DDoS with very long http message body during the handshake, so other client trying to connect will not be affectted. Does using CompletableFuture will make the Java application suffers from context switching cost? And, could you please explain about the magnitude of the <code>500+ cycles worth</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/65d747d7ca1ea7c6fae309cce663236c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14357,"user_type":"registered","user_id":29470,"link":"https://stackoverflow.com/users/29470/tim-moore","reputation":9128,"display_name":"Tim Moore"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629077466,"comment_id":121583076,"body":"Nice answer. I wondered whether <code>interrupter</code> would need to be <code>volatile</code> or otherwise synchronized in order to be reliably visible to the interrupted thread. After some quick research, it looks to me like that is not required, and this code is reliable as is. This is discussed at <a href=\"https://stackoverflow.com/q/45269123/29470\">stackoverflow.com/q/45269123/29470</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628948146,"comment_id":121559775,"body":"The code which you have written in question contains 2 mistakes: 1) You have assumed that <code>t1</code> will always run before <code>t2</code>, but this is wrong assumption. 2) You have entered delay of <code>500ms</code> via <code>Thread.sleep</code>, but you never know how much exact delay is needed to make both the treads sync. It totally depends on the processor. It may work on some processor, but not on other. In my code, I haven&#39;t entered any delay. But using <code>wait</code> and <code>notify</code> to run threads in sync. In this case I am not worried about how much delay is needed. They will work in sync by waiting and notifying the other."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628947550,"comment_id":121559647,"body":"No your imagination is not correct. When you start 2 threads one after the other, they will be submitted to the tread scheduler. Now its up to the thread scheduler to run whichever thread first. In most of the cases, thread scheduler will run first submitted thread first, but not in every case. In my updated version, I have created and ran 2nd thread from 1st thread itself, thus I am assured that 1st thread is running and then only 2nd thread will come into existence. It will just delay the 2nd thread a bit, but once both are in execution, they will run in sync (with <code>wait</code> and <code>notify</code>)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628941390,"comment_id":121558331,"body":"Can I imagine it like this: If you just start 2 Threads one after another the thread you started first is starting a bit earlier than the 2nd one but the &#39;time difference&#39; is smaller than the potential inconsistency (and that&#39;s what happenes in my code on the top). But your programs, especially the updated version, give some buffer between the 2 Threads and that buffer is bigger than the potential inconsistency which makes it consistent. Thread 2 is always gonna be slower because Thread 1 creates and starts it (With slower I mean that Thread 1 is further advanced in the run function than T1 is"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628930979,"comment_id":121556085,"body":"I am impressed with how you are debugging this concept. You are somewhat correct that it may lead to inconsistencies (not always, it depends on the thread schedular) in the above two approaches. Check my updated answer, it will guarantee that <code>t1</code> is executed before <code>t2</code> in every case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761559,"edited":false,"creation_date":1628896464,"comment_id":121551703,"body":"I see, I understand it now. Thank you so much!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893069,"comment_id":121551138,"body":"Can&#39;t this lead to mistakes because Threads are inconsistent? Or did I get something wrong? Sorry if it&#39;s a dumb question and thank you so much for the time you put into your answer!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893000,"comment_id":121551129,"body":"First of All thank you so much for this answer, I really appreciate it a lot. I hope I got how it works: The synchronized oponent variable lets a Thread wait if another Thread is already using it (just like join does). So the Thread t1 goes into the first if statement and prints out c and then goes into wait state while the Thread t2 goes into the else statement, also prints c and then notifys t1 and goes into wait state and then both go into the next for loop? So basicly t1 is always a bit faster than t2 because they execute at the same time but t2 has the longer path?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b46fd0a429838cd67ea0650e953899be?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22447688,"user_type":"registered","user_id":16651360,"link":"https://stackoverflow.com/users/16651360/marco","reputation":54,"display_name":"Marco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"edited":false,"creation_date":1628833721,"comment_id":121531019,"body":"That is why the synchronizer is static."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"edited":false,"creation_date":1628787809,"comment_id":121521292,"body":"In order to protect access to the shared variable, both threads need to synchronize on the  <i>same</i> object."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785660,"comment_id":121520574,"body":"similar <a href=\"https://stackoverflow.com/questions/52949210/printing-alphabets-and-numbers-using-multi-threading\" title=\"printing alphabets and numbers using multi threading\">stackoverflow.com/questions/52949210/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785475,"comment_id":121520494,"body":"maybe they want you to know about atomic variables"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"edited":false,"creation_date":1628785271,"comment_id":121520408,"body":"Well it&#39;s an uni exercise and I don&#39;t think it&#39;s supposed to be that hard because we just started with Threads. It wants us to solve it with a global boolean variable so maybe that makes it easier?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760859,"edited":false,"creation_date":1628784688,"comment_id":121520186,"body":"What I meant is that I want the first Thread to print out the first char and the right after the second Thread his first char. What happens right now is that sometimes the first Thread starts first and sometimes the second One so the Output can be something like : aABb but I always want it to be aAbB"},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67831727,"edited":false,"creation_date":1623175910,"comment_id":120002308,"body":"I don&#39;t know where you decided in the first paragraph that it is going to <i>replace</i> the value and that no mutations are allowed, which is still replace, if you ask me. Then simply highlighting the words <i>happens-before</i> is not what I was after, by far. I don&#39;t think this answers my question. I will may be revise my opinion after some time when I re-read it, but currently I can&#39;t accept this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1621500701,"comment_id":119516539,"body":"@pveentjer right, this is a good illustration of how risky is to don&#39;t follow JMM literally) I&#39;d say, we just get &quot;undefined behaviour&quot; without appropriate HB edges"},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621492098,"comment_id":119512957,"body":"If you don&#39;t have a synchronized getter, the JIT can also cause problems. E.g. if the value is used in a loop, it could hoist the read out of the loop. So this will fail on CPUs with strong memory models as well."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621348442,"comment_id":119465495,"body":"@kidfrom then you may be interested in an example of using jcstress lib, which is an official tool for testing Java standard library, like <a href=\"https://vimeo.com/131395566\" rel=\"nofollow noreferrer\">vimeo.com/131395566</a> This is a good example why we need volatile"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621347500,"comment_id":119464960,"body":"@AnatolG if I use <code>thread.join</code>, the count value will be 20k because it will wait until all threads have been terminated before invoking <code>Counter.getCount()</code>. I am writing a study material for bootcamp to show that &quot;even thread safe code can fail because it takes time to get the most updated value although it is a volatile attribute, just make sure you understand the volatile and the synchronized keyword&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346909,"comment_id":119464633,"body":"@kidfrom BTW, why do you need 20k threads and each one increments the counter only once? I&#39;d say that it isn&#39;t a good idea to have so many threads in your application (you need much memory for stacks, a lot of CPU spent on context switching etc) In the real life you have 10x active threads, if most of them are parked/waiting for IO-1000x threads are OK.If you test multithreaded code,it&#39;s enough to use up to...10 threads, but each of them should live long enough to make 100K-100M operations to produce highly concurrent scenarious with higher calls/per sec ratio than in case of 100K-100M threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346214,"comment_id":119464248,"body":"@kidfrom I hope you do something like  for (Thread t : threads) { t.join(); }  to make sure all incrementers have their work finished completely and only then you call getCount() ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621345772,"comment_id":119463997,"body":"@Anatolgy I will mark this as answer. However, when I test the increment() method <code>without the Object.wait();</code> with 20k of threads, the count value always between 19990 - 19999, i double check with <code>while (counter.getCount() != 20000) {}</code> to wait until the count value 20k before testing, resulting in failed test. In short, I should learn more about the JMM requirements you mention."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621345326,"comment_id":119463757,"body":"@kidfrom right. JLS has specific part to describe how to write/save and read/load values/references in multithreaded environment to have updates visible to readers. To have the value written and read under the same lock (in our case - in a block synchronized on the same monitor) OR to do both write and read to/from a volatile field are 2 simplest ways to satisfy JMM requirements (there are some other ways to get Happens-before edge, but these 2 are the most simple/obvious/pragmatic ones)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621344294,"comment_id":119463207,"body":"For problem 2. (after removing the <code>Object.wait()</code>) Do you mean that both the setter and getter needs to have <code>synchronized</code> in order to prevent data race because the setter method is accessed by multiple thread?, currently if I only use <code>synchronized</code> in the setter method, the test never fails, but I do use Intel chips, so I am not sure whether the code is thread safe even if the <code>Object.wait()</code> is removed."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621343778,"comment_id":119462897,"body":"@kidfrom again :) in this particular code we have 2 different problems: 1 - a race condition - broken (by .wait()) atomicity. To fix it, you have to get rid of the wait(), which releases the monitor. If we need to simulate some workload, use, for example, Thread.sleep() instead. 2 - a data race. The updated counter may not be visible outside by a reader via getCount(). To fix this problem, declare the counter as a volatile field or add synchronized on the getter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621341708,"comment_id":119461847,"body":"I tested it, it seems concurrent logic can&#39;t work with <code>Object.wait()</code> which causes the lock to be released."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621340416,"comment_id":119461241,"body":"So if I have a <code>synchronized</code> setter, but the <code>count</code> attribute does not have <code>volatile</code>, it will cause problem in ARM, are the solutions 1: to use <code>synchronized</code> getter e.g. <code>synchronized void increment() {int temp = getCount(); wait(100); count = temp + 1; }</code> 2. to use <code>volatile</code> keyword to the <code>count</code> attribute?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621333614,"comment_id":119458251,"body":"@Argun cannot reproduce the problem, add a complete <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mimimal reproducible example</a> demonstrating the problem if you want some hint about a possible solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621328813,"comment_id":119456005,"body":"Added Client Class"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621285252,"comment_id":119445065,"body":"@Argun the added part does not tell from where these message are coming from, bottlenecks are possible on the client itself, on the connection, on the datagram processor, please clarify"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621271693,"comment_id":119440006,"body":"Added this part to the question"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621265049,"comment_id":119437061,"body":"@Argun sorry, I cannot understand what you mean, is the server too slow?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621263243,"comment_id":119436204,"body":"I have a simple client that sends messages once per millisecond, but I receive messages about once every 15 milliseconds"},{"owner":{"profile_image":"https://lh4.googleusercontent.com/-qppNtT-hLks/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pK5M5owjrXVau33ScI3xdldvJyNw/mo/photo.jpg?sz=256","account_id":13982631,"user_type":"registered","user_id":10098446,"link":"https://stackoverflow.com/users/10098446/mohendra-amatya","reputation":381,"display_name":"Mohendra Amatya"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67556264,"edited":false,"creation_date":1621169911,"comment_id":119408724,"body":"So, is there a way to test whether the variable f is 0 (i.e partially initialized), I removed the final from the class A. I only get 42."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dec37b21723a50cb3d4d415149d22fe8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5240687,"user_type":"registered","user_id":4187837,"link":"https://stackoverflow.com/users/4187837/gavin","reputation":1727,"display_name":"Gavin","accept_rate":86},"content_license":"CC BY-SA 4.0","score":1,"post_id":66471075,"edited":false,"creation_date":1614848320,"comment_id":117511806,"body":"I think in this instance it would be great if you could provide a link to the issue in the appropriate bug tracker"},{"owner":{"profile_image":"https://i.stack.imgur.com/xfXW3.png?s=256&g=1","account_id":8824128,"user_type":"registered","user_id":6592881,"link":"https://stackoverflow.com/users/6592881/sfili-81","reputation":2378,"display_name":"Sfili_81"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66468855,"edited":false,"creation_date":1614845105,"comment_id":117510321,"body":"Add some explanation to your answer"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":66458166,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"edited":false,"creation_date":1614784040,"comment_id":117491240,"body":"You are setting a value on a <i>thread local</i> variable. The value will be associated with the thread executing the <code>tl.set(bar);</code> statement. When the main thread executes the statement, the value is associated with the main thread which is still alive afterwards (as it is the thread calling <code>System.gc()</code> in a loop). When a different thread executes the statement, the value will be associated with that particular thread and can be removed when that thread terminates."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"content_license":"CC BY-SA 4.0","score":0,"post_id":66458166,"edited":false,"creation_date":1614783119,"comment_id":117490713,"body":"Thanks for the details, could you please explain &quot;to stop the value from being associated with the main thread&quot;, is this because New Thread does not have a reference on Main thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/OWvGv.jpg?s=256&g=1","account_id":14035474,"user_type":"registered","user_id":10138295,"link":"https://stackoverflow.com/users/10138295/thenameisviru","reputation":13,"display_name":"TheNameIsViRu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65396071,"edited":false,"creation_date":1609153489,"comment_id":115759699,"body":"Thank you @emandt for your reply. I used recursion concept for API request call."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"edited":false,"creation_date":1608579497,"comment_id":115622058,"body":"No problem, always glad to help!"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65395539,"edited":false,"creation_date":1608575148,"comment_id":115620417,"body":"Thanks for your time, I&#39;ll definitely try it out tomorrow"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"edited":false,"creation_date":1608557328,"comment_id":115612203,"body":"Omg, I&#39;ve been busy solving this problem for so long. Your help me with &#39;Platform.runLater (new Runnable ()&#39; a lot and it works now. I have added this to my run() in the MyTask Class <code>Platform.runLater (new Runnable () { @Override public void run () { text.set (Integer.toString (counter)); }});</code>                                          Thank you very much"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711094,"comment_id":84626646,"body":"@JeffG actually answered this in the answer below!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711049,"comment_id":84626612,"body":"I actually liked this last example quite well. Reminds me of using a closure in JS to reference variables in the outer scope. But is the <code>this.myParam</code> then really necessary? Couldn&#39;t you just drop the private variables and refer to the variable from the outer scope? I understand (of course) that this has some implications, such as the variable being open to change after starting the thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465383993,"comment_id":62875576,"body":"That&#39;s how I&#39;ve always developed my apps, however if you don&#39;t wish to make all those changes, other answers might help you get around your issue using the application class. For your future reference, I recommend using the one activity class immediately, and then many fragments. Hope this helps :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465383688,"comment_id":62875407,"body":"Okay, so you mean I should abandon the <code>Application</code> object altogether and move all the initialization code to the first <code>Activity</code> ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465382792,"comment_id":62874882,"body":"Why are you extending the application class and not the activity one?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465277621,"comment_id":62820071,"body":"Thank you for your answer, it was very interesting. However, I believe you misunderstood my question. The problem is not caused by the initializations in the first <code>Activity</code>, but those in the global <code>Application</code> object. And I don&#39;t believe I can apply such a separation of concerns there, because unlike an <code>Activity</code> it only has an <code>onCreate()</code> method."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364292853,"comment_id":22180658,"body":"@Ovidiu Latcu agreed. what if the user wants to interact button on the screen, other than publishing update say to the progress bar.This method publishProgress is used to display any form of progress in the user interface while the background computation is still executing. For instance, it can be used to animate a progress bar or show logs in a text field."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364292322,"comment_id":22180396,"body":"you can use <code>publishProgress</code> to update the <code>UI</code> when using an <code>AsyncTask</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364290742,"comment_id":22179483,"body":"you will be running long operations in doInBackground() andu cannot update ui untill doInBackground finishes, keep the user waiting to interact with ui. Only in onPostExecute() ui is updated and user can interact with ui."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364285020,"comment_id":22177118,"body":"IDK why you say that AsyncTask should be used for &quot;a few seconds at most&quot;... nevertheless for very long operations it is recommended to use <code>Services</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/add6146aeae299f7241d7733b850e717?s=256&d=identicon&r=PG","account_id":347517,"user_type":"registered","user_id":681671,"link":"https://stackoverflow.com/users/681671/dojo","reputation":5454,"display_name":"Dojo","accept_rate":59},"content_license":"CC BY-SA 2.5","score":0,"post_id":5533219,"edited":false,"creation_date":1301924639,"comment_id":6295543,"body":"Yeah, i did not notice any significant overhead while testing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53f721a451a1c68caf8316cefcde3083?s=256&d=identicon&r=PG","account_id":2017134,"user_type":"registered","user_id":1804173,"link":"https://stackoverflow.com/users/1804173/bluenote10","reputation":24247,"display_name":"bluenote10","accept_rate":77},"content_license":"CC BY-SA 4.0","score":0,"post_id":817926,"edited":false,"creation_date":1691781839,"comment_id":135543258,"body":"I don&#39;t really understand this example: My understanding is that access to an instance only has to be synchronized if mutability is involved. As long as things are immutable, everything is thread safe. Giving each thread its own instance &quot;solves&quot; the problem in the sense that each thread can happily mutate their own instance. But what&#39;s the use case for that? I mainly see use cases for <b>pure immutability</b> or <b>synchronized mutability</b>, and would be curious to understand under which circumstances &quot;diverging mutability&quot; is helpful."},{"owner":{"profile_image":"https://i.stack.imgur.com/DzDIR.jpg?s=256&g=1","account_id":140189,"user_type":"registered","user_id":346309,"link":"https://stackoverflow.com/users/346309/jpm","reputation":9145,"display_name":"JPM","accept_rate":92},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1685024577,"comment_id":134606015,"body":"White window still shows even with this."},{"owner":{"profile_image":"https://i.stack.imgur.com/riCsa.jpg?s=256&g=1","account_id":4675848,"user_type":"registered","user_id":3786226,"link":"https://stackoverflow.com/users/3786226/mc-topaz","reputation":607,"display_name":"Mc_Topaz","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1675268093,"comment_id":132892992,"body":"This worked for me. I created a drawable with a blue background. In my theme in the /res/valyes/themes.xml i added the <code>&lt;item name=&quot;android:windowBackground&quot;&gt;@drawable&#47;my_drawable&lt;&#47;item&gt; line.</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53e2e1f2b1c0d69f29505aeb9dfe1832?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15744638,"user_type":"registered","user_id":11360924,"link":"https://stackoverflow.com/users/11360924/landnbloc","reputation":1028,"display_name":"landnbloc"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1649960919,"comment_id":127012263,"body":"This delayed any screen from opening for the app for around 4 seconds for me. Felt like the app icon was never touched. Run on cheap Samsung Galaxy A02s"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJz0y1sMaJYi2GG8YJ1jEkEE1KHBRcruM2LGurMB=k-s256","account_id":24305399,"user_type":"registered","user_id":18248235,"link":"https://stackoverflow.com/users/18248235/cflowe-visit","reputation":341,"display_name":"Cflowe Visit"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877113,"edited":false,"creation_date":1649098333,"comment_id":126785570,"body":"so it means java didn&#39;t support it normally?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-TmRHUaNDjGI/AAAAAAAAAAI/AAAAAAAABpg/WUC4cyxANRI/photo.jpg?sz=256","account_id":8987793,"user_type":"registered","user_id":6700830,"link":"https://stackoverflow.com/users/6700830/codesinthedark","reputation":151,"display_name":"CodesInTheDark"},"content_license":"CC BY-SA 4.0","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"edited":false,"creation_date":1630084728,"comment_id":121868293,"body":"@KonstantinMilyutin The problem is that Thread does not use WeakReference for values, only for the keys. If a value uses a custom class it will prevent its ClassLoader to be gc-ed and in turn, it will prevent the whole application and its ThreadLocals to be gc-ed because you get a circular reference."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-_DP3LTfLMXw/AAAAAAAAAAI/AAAAAAAAAHk/dzYHVVdXUnE/photo.jpg?sz=256","account_id":5826102,"user_type":"registered","user_id":4592448,"link":"https://stackoverflow.com/users/4592448/fortran","reputation":2248,"display_name":"Fortran","accept_rate":100},"content_license":"CC BY-SA 4.0","score":2,"post_id":37681189,"edited":false,"creation_date":1624386021,"comment_id":120343518,"body":"best answer, dont foget add to black theme, not only white)"},{"owner":{"profile_image":"https://i.stack.imgur.com/SsTc7.jpg?s=256&g=1","account_id":2305297,"user_type":"registered","user_id":2024692,"link":"https://stackoverflow.com/users/2024692/cromax","reputation":1882,"display_name":"Cromax","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":54241038,"edited":false,"creation_date":1615620045,"comment_id":117752140,"body":"But you actually made a new class — it&#39;s just anonymous class. :-) On the other hand it&#39;s exactly the same approach as in solution no.1 in <a href=\"https://stackoverflow.com/a/39214833/2024692\">stackoverflow.com/a/39214833/2024692</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/LXMHI.png?s=256&g=1","account_id":15515017,"user_type":"registered","user_id":11192811,"link":"https://stackoverflow.com/users/11192811/rajnish-sharma","reputation":390,"display_name":"Rajnish Sharma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1611765220,"comment_id":116557330,"body":"Just remove the bitmap and use this instead : <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layer-list xmlns:android=&quot;http:&#47;&#47;schemas.android.com&#47;apk&#47;res&#47;android&quot;&gt;     &lt;item         android:drawable=&quot;@color&#47;black&quot;&#47;&gt;     &lt;item         android:drawable=&quot;@mipmap&#47;ic_launcher_round&quot;         android:gravity=&quot;center&quot;&#47;&gt; &lt;&#47;layer-list&gt;</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44288d0ab21eb3318b526a6c50028685?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7900776,"user_type":"registered","user_id":5967872,"link":"https://stackoverflow.com/users/5967872/kyl3r","reputation":3946,"display_name":"KYL3R"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"reply_to_user":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"edited":false,"creation_date":1609595487,"comment_id":115873214,"body":"Hey @JeremLachkar - I got the same error, but solved it. &lt;bitmap&gt; cannot load xml icons / vectors (at that time?) but using PNGs worked for me!"},{"owner":{"profile_image":"https://i.stack.imgur.com/QIkTb.png?s=256&g=1","account_id":4366153,"user_type":"registered","user_id":3561889,"link":"https://stackoverflow.com/users/3561889/ucdemir","reputation":2931,"display_name":"Ucdemir","accept_rate":59},"content_license":"CC BY-SA 4.0","score":3,"post_id":57090517,"edited":false,"creation_date":1609260073,"comment_id":115793457,"body":"I test and still white screen there"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bffea7de598020c514bdca3b0239d865?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8509289,"user_type":"registered","user_id":6379785,"link":"https://stackoverflow.com/users/6379785/gmetal","reputation":2918,"display_name":"gmetal"},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1608648341,"comment_id":115643334,"body":"Setting <code>android:windowDisablePreview</code> will remove the white screen on startup by not showing anything. Therefore, if during your app initialisation you are doing a lot of things (e.g. initialising external services) then your app will appear to hang (which it does not). The most appropriate solution is setting a custom <code>android:windowBackground</code>. In reality, the white screen at startup is just the default windowBackground that you are seeing."},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"edited":false,"creation_date":1608349885,"comment_id":115563769,"body":"@Rafay You accepted an answer, which is the Stack Overflow version of marking it resolved. You don&#39;t need to do anything more."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333585,"comment_id":115561235,"body":"Can I close the question if i don&#39;t need the answer anymore? Or mark it resolved/answered?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333542,"comment_id":115561217,"body":"I read more about happens-before and find out I don&#39;t need AtomicReference in my code. Also in my real code, i am using ExecutorService to assign tasks. I reorg&#39;d my code and gotten rid of AtomicReference all-together. Thanks for explanation."},{"owner":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"content_license":"CC BY-SA 4.0","score":1,"post_id":49254344,"edited":false,"creation_date":1604422253,"comment_id":114340412,"body":"looks promising, but Android says at runtime &quot;Binary XML file line #7: &lt;bitmap&gt; requires a valid &#39;src&#39; attribute&quot;. Maybe the drawables are not loaded so early in the app launch process ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b3c046745a2523e02497f69fae887460?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10453530,"user_type":"registered","user_id":7706354,"link":"https://stackoverflow.com/users/7706354/lava","reputation":6345,"display_name":"lava"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1603808538,"comment_id":114150018,"body":"nice solution .I saw a app .but it was a loading screen . i thought .how they achieve it .i look it into youtube .they also white screen with youtube icon.now i found it this it"},{"owner":{"profile_image":"https://i.stack.imgur.com/eMjQ1.jpg?s=256&g=1","account_id":1482742,"user_type":"registered","user_id":6680585,"link":"https://stackoverflow.com/users/6680585/tom-taylor","reputation":3434,"display_name":"Tom Taylor","accept_rate":84},"content_license":"CC BY-SA 4.0","score":0,"post_id":64406380,"edited":false,"creation_date":1603002786,"comment_id":113894433,"body":"If possible attach the geeksforgeeks link too."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4287ab180a9b6483865a60e4b68ca9d8?s=256&d=identicon&r=PG","account_id":143382,"user_type":"registered","user_id":351688,"link":"https://stackoverflow.com/users/351688/a-w","reputation":2912,"display_name":"A.W.","accept_rate":91},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1602913733,"comment_id":113875884,"body":"This works for me in Android Studio 4.1, tested on a real device"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8bea1f01a8f41b0714de4eddc3c93ce8?s=256&d=identicon&r=PG","account_id":11180480,"user_type":"registered","user_id":8207228,"link":"https://stackoverflow.com/users/8207228/ralf-kleberhoff","reputation":7021,"display_name":"Ralf Kleberhoff"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601534733,"comment_id":113439134,"body":"At Stackoverflow we can&#39;t replace a good tutorial. Threads are covered e.g. in <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/procthread.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/essential/concurrency/&hellip;</a>. Work through that tutorial, and if things are still unclear after that, you&#39;re welcome to come back to us."},{"owner":{"user_type":"does_not_exist","display_name":"user11473537"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601487800,"comment_id":113426579,"body":"How should I go about creating a thread? And when I do this, do I just plug it in to the parenthesis of ColumnCalculator()?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f914cd02166793195d9d950503f8f739?s=256&d=identicon&r=PG","account_id":1352170,"user_type":"registered","user_id":1291492,"link":"https://stackoverflow.com/users/1291492/controlaltdel","reputation":34246,"display_name":"ControlAltDel","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141533,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1601486881,"comment_id":113426160,"body":"@SolomonSlow Good point."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"edited":false,"creation_date":1601466476,"comment_id":113415837,"body":"That is not possible as it will only print from 0 to 2. My output was: 0,2,1,1,0,2. And the second time: 0,2,1,0,1,2"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"edited":false,"creation_date":1601463501,"comment_id":113414430,"body":"This program also printing the same <code>01230123</code> is the output, means it is not executing simultaneously"},{"owner":{"profile_image":"https://i.stack.imgur.com/av9Qt.jpg?s=256&g=1","account_id":13442905,"user_type":"registered","user_id":9699634,"link":"https://stackoverflow.com/users/9699634/vikas-gutte","reputation":1666,"display_name":"VikaS GuttE"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1600614412,"comment_id":113136923,"body":"Prefect solution working for me (<code>compileSdkVersion 30</code>). Thank you!"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-Toy7JJFRdP8/AAAAAAAAAAI/AAAAAAAAAro/14UEMAKHESo/photo.jpg?sz=256","account_id":13406308,"user_type":"registered","user_id":9674249,"link":"https://stackoverflow.com/users/9674249/i30mb1","reputation":4142,"display_name":"i30mb1"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1600254943,"comment_id":113028146,"body":"nice value <code>animationStarted</code> that you never change"},{"owner":{"profile_image":"https://i.stack.imgur.com/QEyD7.jpg?s=256&g=1","account_id":3806533,"user_type":"registered","user_id":3158802,"link":"https://stackoverflow.com/users/3158802/rupam-das","reputation":403,"display_name":"Rupam Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"edited":false,"creation_date":1597069443,"comment_id":112005701,"body":"@Faakhir So did you find any solution? I am still looking a solution, which remove this white screen and also there&#39;s no delay at launching time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/de979476f21ed488c4be02f10dd8e2cc?s=256&d=identicon&r=PG","account_id":134590,"user_type":"registered","user_id":336827,"link":"https://stackoverflow.com/users/336827/freedev","reputation":26825,"display_name":"freedev","accept_rate":61},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1593511507,"comment_id":110800726,"body":"the parameter -Djdk.tls.disabledAlgorithms=TLSv1.3 does not work"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e21783a690b300752aceb0db57946012?s=256&d=identicon&r=PG","account_id":493787,"user_type":"registered","user_id":905640,"link":"https://stackoverflow.com/users/905640/markus","reputation":6348,"display_name":"markus","accept_rate":78},"content_license":"CC BY-SA 4.0","score":3,"post_id":54655885,"edited":false,"creation_date":1591261970,"comment_id":109990571,"body":"I see the same problem also with OpenJDK 11.0.6"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197569,"edited":false,"creation_date":1588241389,"comment_id":108825786,"body":"This code will spin mindlessly if the condition is false At least add a sleep into it. The point of having two tests escapes me."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61520614,"edited":false,"creation_date":1588241320,"comment_id":108825750,"body":"Doesn&#39;t answer the question that was asked in any way. Do read the question before answering."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/99266f63196c82aaeb18e36727424c07?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3869264,"user_type":"registered","user_id":3204950,"link":"https://stackoverflow.com/users/3204950/rameshvanka","reputation":51,"display_name":"rameshvanka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":36420786,"edited":false,"creation_date":1583690106,"comment_id":107193590,"body":"please refer my blog: <a href=\"https://rameshvanka.blogspot.com/2020/03/excel-with-multi-threaded-way.html\" rel=\"nofollow noreferrer\">rameshvanka.blogspot.com/2020/03/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=256&d=identicon&r=PG","account_id":18868,"user_type":"registered","user_id":43681,"link":"https://stackoverflow.com/users/43681/sleske","reputation":82004,"display_name":"sleske","accept_rate":70},"content_license":"CC BY-SA 4.0","score":3,"post_id":33116773,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"edited":false,"creation_date":1579880483,"comment_id":105926418,"body":"@SaptarshiBasu: As discussed in the linked question <a href=\"http://stackoverflow.com/questions/24700798/is-jax-rs-client-thread-safe\">Is JAX-RS Client Thread Safe</a>, unfortunately the spec does not require <code>Client</code> to be thread safe. In some implementations it is (e.g. in Jersey, I believe), in others it is not (e.g. Apache CXF)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/83b2bbbdc0f34ed6148dab188c6bb987?s=256&d=identicon&r=PG","account_id":367746,"user_type":"registered","user_id":714112,"link":"https://stackoverflow.com/users/714112/sridhar-sarnobat","reputation":24129,"display_name":"Sridhar Sarnobat","accept_rate":80},"content_license":"CC BY-SA 4.0","score":1,"post_id":48020642,"edited":false,"creation_date":1568405101,"comment_id":102276985,"body":"Finally a way to do it without those annoying fields. Now I just need to wait for my product to upgrade to Java 8."},{"owner":{"profile_image":"https://i.stack.imgur.com/ncQ0v.jpg?s=256&g=1","account_id":3023551,"user_type":"registered","user_id":2564032,"link":"https://stackoverflow.com/users/2564032/vasif","reputation":688,"display_name":"Vasif"},"content_license":"CC BY-SA 4.0","score":1,"post_id":817926,"edited":false,"creation_date":1565716109,"comment_id":101436153,"body":"but this solution has own problem like your objects are still exist on ThreadPool and it can cause OOM issue if you are going to store different objects in ThreadLocal and your application get a lot of requests.  I saw it as a solution for passing object to other methods without passing it as a parameter. So u can pu object in ThreadLocal and then remove it in finally to clear it up."},{"owner":{"profile_image":"https://i.stack.imgur.com/XpMUU.jpg?s=256&g=1","account_id":1431364,"user_type":"registered","user_id":1353722,"link":"https://stackoverflow.com/users/1353722/lefloh","reputation":10713,"display_name":"lefloh","accept_rate":81},"content_license":"CC BY-SA 4.0","score":0,"post_id":33116773,"edited":false,"creation_date":1563874533,"comment_id":100836191,"body":"Could you please prove this with e.g. a link to the documentation?"},{"owner":{"profile_image":"https://i.stack.imgur.com/kKvXH.gif?s=256&g=1","account_id":31180,"user_type":"registered","user_id":85421,"link":"https://stackoverflow.com/users/85421/user85421","reputation":29173,"display_name":"user85421"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877115,"edited":false,"creation_date":1560196246,"comment_id":99648680,"body":"<code>final</code> is not that important any more; it&#39;s enough if the variable is <i>effectively final</i> (despite it does no harm having it)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7654f9d9e0ffaa1d4972cccb20861377?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5847132,"user_type":"registered","user_id":4606939,"link":"https://stackoverflow.com/users/4606939/prnjn","reputation":386,"display_name":"prnjn","accept_rate":92},"content_license":"CC BY-SA 4.0","score":3,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1559122084,"comment_id":99318469,"body":"@Robin answer doesn&#39;t have to be exactly what the other person said, if something is already said then additional information is more valuable than writing the same thing over again. And here the answer holds quality and important information."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9da43a7cb4f685c3db616ad144f5de69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5428620,"user_type":"registered","user_id":4320184,"link":"https://stackoverflow.com/users/4320184/dashenswen","reputation":560,"display_name":"dashenswen","accept_rate":12},"content_license":"CC BY-SA 4.0","score":0,"post_id":32122972,"edited":false,"creation_date":1556167088,"comment_id":98346639,"body":"I still didn&#39;t see the benefit of using ThreadLocal to generate the unique id in example one if all your purpose is to return an incremental unique integer value.   ```  public class ThreadId {      // Atomic integer containing the next thread ID to be assigned      private static final AtomicInteger nextId = new AtomicInteger(0);       // Returns the current thread&#39;s unique ID, assigning it if necessary      public static int get() {          return nextId..getAndIncrement();      }  } ```"},{"owner":{"profile_image":"https://i.stack.imgur.com/FbWEX.png?s=256&g=1","account_id":2616549,"user_type":"registered","user_id":2265497,"link":"https://stackoverflow.com/users/2265497/slesh","reputation":1922,"display_name":"slesh","accept_rate":41},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1553257457,"comment_id":97327392,"body":"Disabling TLS 1.3 doesn&#39;t work - <a href=\"https://stackoverflow.com/questions/55298459/java-11-httpclient-leads-to-endless-ssl-loop-even-with-disabled-tlsv-1-3\" title=\"java 11 httpclient leads to endless ssl loop even with disabled tlsv 1 3\">stackoverflow.com/questions/55298459/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/RDWxl.png?s=256&g=1","account_id":4342327,"user_type":"registered","user_id":3545273,"link":"https://stackoverflow.com/users/3545273/serge-ballesta","reputation":145474,"display_name":"Serge Ballesta","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":24721873,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1551106477,"comment_id":96508170,"body":"It is a rather old question, but I could remember what it was about. I said it should never be done again, because it is a recipe for building deadlocks..."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":2,"post_id":54485918,"edited":false,"creation_date":1549987007,"comment_id":96099623,"body":"Just found out that even with <code>-Djdk.tls.disabledAlgorithms=TLSv1.3</code> the client still uses TLS v1.3"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549676532,"comment_id":96000901,"body":"Oh interesting Zarathustra."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":1,"post_id":54485918,"edited":false,"creation_date":1549620385,"comment_id":95976355,"body":"Disabling TLS 1.3 did not help :/"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549051688,"comment_id":95779683,"body":"Interesting link. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1549051585,"comment_id":95779623,"body":"Thought about TLS 1.3 issues too ... maybe its this bug here <a href=\"https://bugs.openjdk.java.net/browse/JDK-8207009\" rel=\"nofollow noreferrer\">bugs.openjdk.java.net/browse/JDK-8207009</a> - not sure if it is fixed in my version"},{"owner":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"content_license":"CC BY-SA 4.0","score":7,"post_id":33116773,"edited":false,"creation_date":1547577262,"comment_id":95236529,"body":"This is incorrect. <code>Client</code> is meant to be shared. That&#39;s why the client implementation class have volatile variables. <code>WebTarget</code> is not thread safe."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":26803040,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/KcrPN.jpg?s=256&g=1","account_id":1146772,"user_type":"registered","user_id":1129332,"link":"https://stackoverflow.com/users/1129332/ilya-gazman","reputation":31458,"display_name":"Ilya Gazman","accept_rate":61},"edited":false,"creation_date":1538172480,"comment_id":92064842,"body":"@IlyaGazman, The javadoc for <code>Thread.yield()</code> makes it quite clear that it is not required to do anything at all. You can&#39;t rely on it for any purpose whatsoever because it might literally do <i>nothing</i> when you call it."},{"owner":{"profile_image":"https://i.stack.imgur.com/KcrPN.jpg?s=256&g=1","account_id":1146772,"user_type":"registered","user_id":1129332,"link":"https://stackoverflow.com/users/1129332/ilya-gazman","reputation":31458,"display_name":"Ilya Gazman","accept_rate":61},"content_license":"CC BY-SA 4.0","score":0,"post_id":26803040,"edited":false,"creation_date":1538146077,"comment_id":92054153,"body":"100 times a second might seem like a lot, but if you have two threads that are highly depended on each other, yielding can potentially save you the 1/100 of a second over each cycle.  For example, let&#39;s say that you are trying to mark all the even numbers in an array while the other threads do the same for the odd numbers, and you can&#39;t allow them to have a gap bigger than a 100. With such extreme dependency, wait() may cause a significant performance decrease, while yielding not so much."},{"owner":{"profile_image":"https://i.stack.imgur.com/cE9IP.png?s=256&g=1","account_id":4928931,"user_type":"registered","user_id":3969362,"link":"https://stackoverflow.com/users/3969362/slion","reputation":2728,"display_name":"Slion"},"content_license":"CC BY-SA 4.0","score":2,"post_id":44430166,"edited":false,"creation_date":1533239999,"comment_id":90285977,"body":"That works great for me on a NativeActivity OpenGL application. I&#39;m not sure why this is not higher up in the answers as it is the most complete and expedient answer. No Java involved just a couple of XML file changes."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/--S24vwJjcPU/AAAAAAAAAAI/AAAAAAAAAdA/ZMh1tx27y1A/photo.jpg?sz=256","account_id":5910560,"user_type":"registered","user_id":4650969,"link":"https://stackoverflow.com/users/4650969/midhilaj","reputation":4935,"display_name":"Midhilaj","accept_rate":0},"content_license":"CC BY-SA 4.0","score":4,"post_id":37718830,"edited":false,"creation_date":1531757857,"comment_id":89704563,"body":"grate now it is not showing #ffffff color but it is now showing #000000"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51310395,"edited":false,"creation_date":1531458661,"comment_id":89611864,"body":"Exactly the same issue: jstack without the mixed mode flag is running fine. But i&#39;m using Oracle jdk 1.8.0_172."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51305417,"edited":false,"creation_date":1531399936,"comment_id":89588974,"body":"Thank you for the hint. I&#39;m using the jstack of the jvm which runs the process."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530084564,"comment_id":89104213,"body":"@DavidStuder Hmmm. I would say that in your example both threads are properly terminated. In that case the application (the Java VM) should also terminate."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083998,"comment_id":89103907,"body":"@daniu Well did not understand it that way. But I am sure that the <code>OwnThread#run</code> is terminated properly and that the <code>main</code> thread causes the issue."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530083680,"comment_id":89103744,"body":"@DavidStuder He&#39;s saying your <code>OwnThread#run</code> method doesn&#39;t finish IIUC."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083527,"comment_id":89103659,"body":"@Seelenvirtuose I think you are right, the <b>main thread</b> is still running and doing something, but I don&#39;t know what or why. There is simply no other code than calling the self-made thread and as already mentioned, debugging the <code>main</code> method leads to this <code>exit()</code>-method, which really should <b>terminate</b> the main thread as I see it."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083365,"comment_id":89103583,"body":"@Seelenvirtuose Thank you very much for your explanation. It really helps to understand it a little bit better, but still I do not understand my case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":2,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083123,"comment_id":89103454,"body":"@daniu Well ... This is because one thread is terminated: the main thread! I still speak about my example. I think, OPs problem is vice versa. The main thread is still running but the other thread terminated. That means that the main thread is still doing something."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082995,"comment_id":89103380,"body":"OP does state he found out that &quot;the last called method is the exit()-method of the Thread-class&quot; when debugging though."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530082688,"comment_id":89103245,"body":"@daniu It is running because it is <i>not</i> terminated (or exited as you say)."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082601,"comment_id":89103190,"body":"But why is the other thread still running if it has been <code>exit</code>ed?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ce01465deb2032903f0c1b86bc3f431e?s=256&d=identicon&r=PG","account_id":1085180,"user_type":"registered","user_id":1081043,"link":"https://stackoverflow.com/users/1081043/wisbucky","reputation":34249,"display_name":"wisbucky","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":877115,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f1b044b33c5d5ee61e223aac39761f43?s=256&d=identicon&r=PG","account_id":947019,"user_type":"registered","user_id":974063,"link":"https://stackoverflow.com/users/974063/randall-cook","reputation":6758,"display_name":"Randall Cook","accept_rate":100},"edited":false,"creation_date":1526608818,"comment_id":87821232,"body":"I had the same experience as @RandallCook for Anonymous class. As long as I had the <code>final X parameter</code> before the <code>new Runnable()</code> line, then I could access <code>parameter</code> inside <code>run()</code>. I didn&#39;t need to need to do the extra <code>p = parameter</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/GAem5.jpg?s=256&g=1","account_id":6960621,"user_type":"registered","user_id":5340181,"link":"https://stackoverflow.com/users/5340181/jmess","reputation":623,"display_name":"JMess"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817864,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"edited":false,"creation_date":1524610168,"comment_id":87039878,"body":"@sudeepdino008 you don&#39;t always have control of the creation of those threads (webapp frameworks, threadpool libraries)"},{"owner":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"content_license":"CC BY-SA 3.0","score":43,"post_id":37718830,"edited":false,"creation_date":1521288616,"comment_id":85673078,"body":"It hang application for 2 sec and then application launch, not useful for me!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2e814c6b5e0dd56c34931b48c5621269?s=256&d=identicon&r=PG","account_id":2080635,"user_type":"registered","user_id":1852693,"link":"https://stackoverflow.com/users/1852693/dexter","reputation":4105,"display_name":"Dexter","accept_rate":71},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1521135579,"comment_id":85614052,"body":"This is the best explanation of the use of TL."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40e56e654d3ff1a9a228a00d4f5b1d05?s=256&d=identicon&r=PG","account_id":344283,"user_type":"registered","user_id":676506,"link":"https://stackoverflow.com/users/676506/rick-rainer-ludwig","reputation":2371,"display_name":"Rick-Rainer Ludwig","accept_rate":74},"content_license":"CC BY-SA 3.0","score":2,"post_id":47562423,"edited":false,"creation_date":1517999648,"comment_id":84320427,"body":"In this example is a major issue: Who is responsible for the closing the connection? Instead of creating this connection as initiali value, let the consumer of the connection create the connection explicitly and bind it to the thread via ThreadLocal. The creator of the connection is then also responsbible for closing. This is not clear in this example. Creating and binding the connection can also be hidden in a simple framework by something like Transaction.begin() and Transaction.end()."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505906040,"comment_id":79601684,"body":"You&#39;re right. I&#39;ve probably stumbled upon several misuses of <code>ThreadLocal</code>, where it was accessible globally. As you said, it can still be used as a class field limiting the visibility."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505904944,"comment_id":79601012,"body":"It can simply be a part of object state, doesn&#39;t have to be used globally. Sure, you get little bit overhead, but if multiple objects have to have different state per thread, you can use <code>ThreadLocal</code> as object field..."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505897515,"comment_id":79596152,"body":"It is a form of global state, in the sense that it&#39;s accessible from anywhere in the code (in the same thread&#39;s context). This comes with all the repercussions, such as not being able to reason about who reads and writes this value. Using a function parameter is not a retarded thing, it&#39;s a good practice promoting clean interfaces. However, I agree with you that passing a parameter across the whole depth of your codebase is a code smell. But, I also believe that in many occasions the use of ThreadLocal is a code smell in the first place which led you here, so this what one should reconsider."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505893607,"comment_id":79593705,"body":"ThreadLocals are NOT global state unless you make it global state. They are practically always accessible stack resource. You can simulate thread local with simply passing that variable in all your methods (which is retarded); that doesn&#39;t make it global state..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893375,"comment_id":79593571,"body":"@Pacerier why would you need any synchronization with <code>ThreadLocal</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":2,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893190,"comment_id":79593462,"body":"@Pacerier how is member variable related? He was talking about local variable, which means every method call, new <code>SimpleDateFormat</code> would be created, which is a waste. Thread local is much better because it is flexible and memory &quot;leak&quot; is hardly noticeable and can be managed when thread is destroyed anyways. Member variable <code>SimpleDateFormat</code> is bad because it is not thread safe!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":13037170,"edited":false,"creation_date":1505849224,"comment_id":79578629,"body":"@Jeff, Dude, that&#39;s true of every code you write, not just <code>ThreadLocal</code> pattern. If you do <code>F(){    member=random(); F2(); write(member);     }</code> and F2 overrides member with a new value, then obviously <code>write(member)</code> will no longer write the number you have <code>random()</code>ed. This is literally just common sense. Similarly, if you do <code>F(){   F();   }</code>, then gd luck with your infinite loop! This is true everywhere and is not specific to <code>ThreadLocal</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":2,"post_id":820131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"edited":false,"creation_date":1505847274,"comment_id":79577539,"body":"@JeremyStein, The better answers are at <a href=\"https://stackoverflow.com/a/817911/632951\">stackoverflow.com/a/817911/632951</a> and <a href=\"https://stackoverflow.com/a/17398338/632951\">stackoverflow.com/a/17398338/632951</a> and <a href=\"https://stackoverflow.com/a/818364/632951\">stackoverflow.com/a/818364/632951</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1505845648,"comment_id":79576630,"body":"@Esko, In your project, your use of ThreadLocal in hashcode and equals is unneeded. A better approach is to create or pass a reference to a hashcode/equals function whenever it is needed. This way, you can completely avoid the need for ThreadLocal hack."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505839955,"comment_id":79573846,"body":"@Enerccio, Dude, a member variable in the context of each object instance. It can be accessible from all method calls."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"edited":false,"creation_date":1505839879,"comment_id":79573796,"body":"@AlexanderRyzhov, A thread-safe alternative is an even higher price to pay since you need to pay synchronization overhead on every method call. Use a local variable instead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":1,"post_id":37679026,"edited":false,"creation_date":1494668971,"comment_id":74934880,"body":"I solved this issue by animating between themes and changing the theme with no drawable but just the back color same and then on onWindowFocusChanged() mad the content visible and the animated it other wise my whited down between the transition as well. animation of themes helped alot"},{"owner":{"profile_image":"https://i.stack.imgur.com/GGyFL.jpg?s=256&g=1","account_id":7201903,"user_type":"registered","user_id":5498855,"link":"https://stackoverflow.com/users/5498855/ivan-milisavljevic","reputation":2058,"display_name":"Ivan Milisavljevic"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37679026,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"edited":false,"creation_date":1494533092,"comment_id":74882435,"body":"This is straight forward implementation. There could be some other parts of your code that  causing the issue. Please open another question and il be there to help you:)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":5,"post_id":37679026,"edited":false,"creation_date":1494501426,"comment_id":74860894,"body":"it didnt help still white screen and animation at end"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-zysTsphgh80/AAAAAAAAAAI/AAAAAAAAACM/Q2h-OaaX0mA/photo.jpg?sz=256","account_id":8179843,"user_type":"registered","user_id":6157415,"link":"https://stackoverflow.com/users/6157415/mike-d3vid-tyson","reputation":1731,"display_name":"Mike D3ViD Tyson"},"content_license":"CC BY-SA 3.0","score":0,"post_id":43630459,"edited":false,"creation_date":1493203026,"comment_id":74311442,"body":"probably the error is here :  \t\t[...]<code>List&lt;?&gt; results = List.class.cast(payload.get(&quot;result&quot;)); \t\t \t\tresults.remove(0); \t\tresults.remove(0); \t\tresults.remove(results.size()-1); \t\tresults.remove(results.size()-1); </code>[...]"},{"owner":{"profile_image":"https://i.stack.imgur.com/n93hU.png?s=256&g=1","account_id":281630,"user_type":"registered","user_id":578046,"link":"https://stackoverflow.com/users/578046/saurabh-patil","reputation":4230,"display_name":"Saurabh Patil","accept_rate":45},"content_license":"CC BY-SA 3.0","score":20,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1485415179,"comment_id":70919029,"body":"@Robin: I disagree. The question is about how to use ThreadLocal correctly, to get a complete understanding of any concept (ThreadLocal here) it&#39;s also important to understand how not to use it and the risks of using it carelessly, and that is what Phil&#39;s answer is about. I&#39;m glad he covered that point which isn&#39;t covered in any other answers. All those votes are well deserved. I believe SO should build understanding of concepts rather than just being a QA site."},{"owner":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"content_license":"CC BY-SA 3.0","score":4,"post_id":818120,"edited":false,"creation_date":1477492859,"comment_id":67790858,"body":"I believe the answer is not relevant anymore, because <code>Thread</code> uses <code>WeakReference&lt;ThreadLocal&gt;</code>. So when the associated <code>ThreadLocal</code> is <code>gc</code>&#39;ed, the Map will also remove stale values during next rehashing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477175443,"comment_id":67661162,"body":"Solution provided by me also stops the ServerSocket from .accept()ing incoming connections. <b>The point is that the socket on the <i>client side</i> is still created without any exception. Why does it happen, when the ServerSocket didn&#39;t accept the connection?</b>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4301e2847b861058706df775f913e02d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8829249,"user_type":"registered","user_id":6596346,"link":"https://stackoverflow.com/users/6596346/paul","reputation":96,"display_name":"paul","accept_rate":40},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"edited":false,"creation_date":1477174745,"comment_id":67661022,"body":"If you read the loop condition after the maximum number of clients is reached the server will simply stop listening for further connections and ultimately clients will not be able to connect"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477174528,"comment_id":67660965,"body":"Okay, but the problem still remains the same. The socket on the client side is still created without any problems, even despite the fact that the connection was not accepted by the server. I&#39;m looking for a method to check if the server commited server.accept() action."},{"owner":{"profile_image":"https://i.stack.imgur.com/U7HAo.png?s=256&g=1","account_id":4426354,"user_type":"registered","user_id":3604745,"link":"https://stackoverflow.com/users/3604745/hack-r","reputation":22622,"display_name":"Hack-R","accept_rate":84},"content_license":"CC BY-SA 3.0","score":0,"post_id":877115,"edited":false,"creation_date":1473173400,"comment_id":66033727,"body":"I think you&#39;re missing a <code>)</code> in the first example"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/26fcfa6386864df2897f9bcb8b47f190?s=256&d=identicon&r=PG","account_id":2199682,"user_type":"registered","user_id":1944408,"link":"https://stackoverflow.com/users/1944408/user1944408","reputation":569,"display_name":"user1944408","accept_rate":67},"content_license":"CC BY-SA 3.0","score":4,"post_id":817926,"edited":false,"creation_date":1469632844,"comment_id":64620156,"body":"Just be careful not to use double brace initialization for your SimpleDateFormat because that would create an anonymous class so your class loader could not be garbage collected. memory leak: return new SimpleDateFormat(){{applyPattern(&quot;yyyyMMdd HHmm&quot;)}};"},{"owner":{"profile_image":"https://i.stack.imgur.com/XiFZh.jpg?s=256&g=1","account_id":1542133,"user_type":"registered","user_id":1955871,"link":"https://stackoverflow.com/users/1955871/rob","reputation":6317,"display_name":"Rob","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"edited":false,"creation_date":1469544726,"comment_id":64574551,"body":"@YordanBoev As I mentioned in the answer, you should figure out what the Finalizer thread is doing. Taking a series of thread dumps (or pausing that thread in the debugger) and seeing what that particular thread is doing, whether it is making progress, usually observed running a particular class&#39; finalize method, waiting for a lock, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"edited":false,"creation_date":1469527755,"comment_id":64562168,"body":"Hey Rob, I am thankful for your interest in my problem. I am familiar how Finalizer and GC work in a JVM. The problem is that the Objects that reside in the Finalizer queue are not mine and not directly created from me, but though Jersey. I am simply following Jersey&#39;s examples and best practices in a multi-threaded environment and it is not working. The starvation of the Finalizer thread is very unlikely to be the problem, because CPU usage stays under 100% for a good amount of time and even the lowest priority threads should get execution time. Nevertheless, I will look more into it. Thanks!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"edited":false,"creation_date":1467365186,"comment_id":63713362,"body":"@sudeepdino008 no because new SimpleDateFormat would have to be created each call to the method, which is silly"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"content_license":"CC BY-SA 3.0","score":8,"post_id":817926,"edited":false,"creation_date":1466758440,"comment_id":63461690,"body":"The ThreadLocal.get() method will call ThreadLocal.initialValue() (once) for each thread, which means that a SimpleDateFormat object is created for each thread. Isn&#39;t it better then just to have SimpleDateFormat as local variables(since we don&#39;t have to deal with garbage collection issues) ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"content_license":"CC BY-SA 3.0","score":4,"post_id":817864,"edited":false,"creation_date":1466757574,"comment_id":63461215,"body":"If each thread wants to have its own copy of something, why can&#39;t it simply be declared local( which is always thread safe)?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1YZhh.png?s=256&g=1","account_id":996598,"user_type":"registered","user_id":1012372,"link":"https://stackoverflow.com/users/1012372/jayesh","reputation":6067,"display_name":"Jayesh","accept_rate":49},"content_license":"CC BY-SA 3.0","score":0,"post_id":817864,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f671bc1d0b48c1b03402cd6fe2c369c6?s=256&d=identicon&r=PG","account_id":16974,"user_type":"registered","user_id":37539,"link":"https://stackoverflow.com/users/37539/ian-varley","reputation":9287,"display_name":"Ian Varley","accept_rate":75},"edited":false,"creation_date":1465875462,"comment_id":63070300,"body":"@IanVarley: Thanks for pointing that. So if we have variable that is declared and used in MyThread class, then do we need ThreadLocal in that case? Example: class MyThread extends Thread{ String var1;, int var2; } in this case var1 and var2 will be part of Thread own stack and is not shared, so do we require ThreadLocal in this case? I might be totally wrong in my understanding, please guide."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fb0bdbf18101aa257fb3613b07058d7b?s=256&d=identicon&r=PG","account_id":57501,"user_type":"registered","user_id":172272,"link":"https://stackoverflow.com/users/172272/didier-a","reputation":4679,"display_name":"Didier A.","accept_rate":83},"content_license":"CC BY-SA 3.0","score":3,"post_id":818120,"edited":false,"creation_date":1465597151,"comment_id":62985101,"body":"If the ThreadPool keeps the Threads alive, then their ThreadLocals will too, but they will be overwritten by the new values when the thread in the pool is allocated again no? Why would it leak? It just seems to me that you&#39;d have a fix increase of memory maybe, equal to num thread * size of threadlocal value, but your ThreadPool should manage itself to a reasonable size, so this isn&#39;t really a memory leak, increasing MaxPermSize should in fact be a good solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"edited":false,"creation_date":1456391754,"comment_id":58927903,"body":"@NullPointerException if you want to wait until the process has finished, yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"edited":false,"creation_date":1456391048,"comment_id":58927457,"body":"so it is enought to add p.waitFor(); after Helpers.asynchOutputWrite ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 3.0","score":5,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446036704,"comment_id":54574459,"body":"@jayendrabhatt, Read locks and write locks come in pairs:  If thread R holds a read lock, it blocks thread W from obtaining the corresponding write lock, but it does <i>not</i> block thread S from getting the same read lock.  A reader/writer lock pair allows any number of readers to &quot;own&quot; the read lock at the same time, <i>OR</i> it allows <i>one</i> writer to own the write lock, but it never allows a reader and a writer at the same time, and it never allows more than one writer at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=256&d=identicon&r=PG","account_id":372293,"user_type":"registered","user_id":721269,"link":"https://stackoverflow.com/users/721269/david-schwartz","reputation":180467,"display_name":"David Schwartz","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446017305,"comment_id":54563020,"body":"@jayendrabhatt It&#39;s very hard to understand your questions. What do you think it means for a lock to be atomic?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"content_license":"CC BY-SA 3.0","score":0,"post_id":33384952,"edited":false,"creation_date":1446017055,"comment_id":54562912,"body":"That implies the read lock is atomic . And you mean there is  no obstruction for the read lock acquired thread to do a write operation  ? correct me if am wrong"},{"owner":{"profile_image":"https://i.stack.imgur.com/6Pkuc.jpg?s=256&g=1","account_id":1420137,"user_type":"registered","user_id":1344935,"link":"https://stackoverflow.com/users/1344935/evil-washing-machine","reputation":1323,"display_name":"Evil Washing Machine","accept_rate":69},"content_license":"CC BY-SA 3.0","score":8,"post_id":818120,"edited":false,"creation_date":1442266494,"comment_id":53003727,"body":"Now that PermGen is killed by Java 8, does this change this answer in any way?"},{"owner":{"profile_image":"https://i.stack.imgur.com/wGrow.png?s=256&g=1","account_id":1806558,"user_type":"registered","user_id":1643558,"link":"https://stackoverflow.com/users/1643558/tgkprog","reputation":4512,"display_name":"tgkprog","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":818120,"edited":false,"creation_date":1439412174,"comment_id":51856671,"body":"Or just restart your node instead of a hot deploy. (for most cases, I&#39;m sure there are others where you just need to wrap around a soft reference). But you see a big drop in objects used and time if you use thread locals or spring thread scope (reused across users as the thread pool for web requests is long living) instead of stuffing every service in a session scope."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"edited":false,"creation_date":1439315757,"comment_id":51806957,"body":"Singletons doesn&#39;t are &quot;good&quot; or &quot;bad&quot; on all situations. On a nutshell:  The main objective of a Singleton is keep the creation of expensible objects at minimum, preferably only one.  On multiple classloading environments (like web application containers) they are almost useless.  They are hard to unit test or use on testing. Do you need a strategy to deal with."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"edited":false,"creation_date":1439315069,"comment_id":51806609,"body":"@SachinGorade is just to enforce just one formatter instance for each classloader.  On environment that have just one main classloader, that works like a Singleton."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"content_license":"CC BY-SA 3.0","score":5,"post_id":817926,"edited":false,"creation_date":1438670329,"comment_id":51531090,"body":"@overthink Is there any reason to declare ThreadLocal static and final, I mean performance or something?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=256&d=identicon&r=PG","account_id":37136,"user_type":"registered","user_id":106104,"link":"https://stackoverflow.com/users/106104/user253751","reputation":57822,"display_name":"user253751","accept_rate":62},"content_license":"CC BY-SA 3.0","score":2,"post_id":877113,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"edited":false,"creation_date":1431138587,"comment_id":48380540,"body":"@IsaacKleinman well, you have to do that anyway, unless you extend Thread. And this solution still works in that case - just change &quot;implements Runnable&quot; to &quot;extends Thread&quot;, &quot;Runnable&quot; to &quot;Thread&quot;, and &quot;new Thread(r)&quot; to &quot;r&quot;."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27739235,"edited":false,"creation_date":1420329606,"comment_id":43932892,"body":"I think this would work. However, it doesn&#39;t address priorities."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420327815,"comment_id":43932436,"body":"Also, your solution has a separate priority queue for each producer, when I need a higher priorities to apply across messages of different producers. You have LinkedHashMap&lt;Producer,PriorityQueue&gt;; I ended up doing essentially Map&lt;Priority,LinkedHashMap&lt;Producer,PriorityQueue&gt;&gt;. I&#39;m accepting your answer since it got me thinking on the right track and is the closest to what I ended up actually doing."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":1,"post_id":27738182,"edited":false,"creation_date":1420327792,"comment_id":43932435,"body":"Since you&#39;ve got a ReentrantLock on the outside, you don&#39;t need a PriorityBlockingQueue on the inside, a PriorityQueue will be fine - double locking would give worse performance and greater risk of deadlocks (not with your current code, but possible with future changes)."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420287732,"comment_id":43920240,"body":"I like this idea (in particular use of ReenterantLock and Condition). I&#39;m going to try something similar."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420264486,"comment_id":43915347,"body":"Suppose producer #1 submits 100 messages. So far 50 of them have been processed. Now producer #2 submits 100 messages. Due to incrementing the underlying ID, won&#39;t all of producer #2&#39;s messages have higher ID numbers than producer #1&#39;s, so none of them will be processed until producer #1&#39;s are done? That isn&#39;t round-robin."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184978,"comment_id":43888897,"body":"I haven&#39;t thought out the details of the bookkeeping, and that&#39;s not necessarily the only way to do it, but the sequence I gave is the one you wanted, yes?"},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420184902,"comment_id":43888883,"body":"So you would have a counter, which increments by N (where N is current producer count), and an array sized N of boolean flags, initially all false. When producer x requests an ID, if flags[x] is false, set flags[x]=true; if flags[x] is true, increment counter by N, set all flags to false, set flags[x]=true; then, in either case, return counter+x? I assume also a synchronised block to protect the counter and the array. Also, to change producer count dynamically, would need to resize array, setting all its values to false, incrementing counter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184125,"comment_id":43888686,"body":"No. You would have incremented the underlying ID as per my last sentence, so in your example the IDs would run 0,2,4,6,8,10,12,14,16,18,19, ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420183492,"comment_id":43888525,"body":"With two producers, are you saying to allocate even IDs to the first producer, odd IDs to the second? Suppose producer #1 submits 10 messages, which are fully processed - it consumes the first ten odd IDs. Some time later, producer #1 submits 10 messages, which get the next ten odd IDs. Simultaneously, producer #2 submits 10 messages, which consume the first ten even IDs. Won&#39;t this result in producer #2&#39;s first batch being processed before producer #1&#39;s second batch? That&#39;s not round robin of outstanding messages."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416481671,"comment_id":42595773,"body":"There is last option, with combined CountDownLatches. Using while countdown loop costs nothing, so it&#39;s not a problem doing while release."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416481064,"comment_id":42595419,"body":"If you look at the question, I wanted to avoid countDown in loop."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":2,"post_id":27035047,"edited":false,"creation_date":1416477391,"comment_id":42593392,"body":"I dont need timeout, I need to explicitly release()"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416477256,"comment_id":42593307,"body":"You specify max timeout for operations, and go from there. You&#39;ll need to have some kind of completion timeout anyway, regardless of desired implementation."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416477238,"comment_id":42593296,"body":"I am pointing to that release() method would be very useful, like in Semaphore"},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416477055,"comment_id":42593178,"body":"but in case I dont the time know what all operations consume, its useless."},{"owner":{"profile_image":"https://i.stack.imgur.com/LdDoZ.png?s=256&g=1","account_id":957028,"user_type":"registered","user_id":982149,"link":"https://stackoverflow.com/users/982149/fildor","reputation":15143,"display_name":"Fildor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416472826,"comment_id":42590762,"body":"&quot;but if something fails&quot; - wouldn&#39;t interrupting be more appropriate here?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7df9b99b5d8ac9eda9330768ca1acf09?s=256&d=identicon&r=PG","account_id":266709,"user_type":"registered","user_id":554431,"link":"https://stackoverflow.com/users/554431/bestsss","reputation":11856,"display_name":"bestsss"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415382041,"comment_id":42186813,"body":"@VictorSorokin, while <code>notifyAll</code> seems the go-to solution it has a pretty terribly performance impact when more than a single thread is involved. All threads have to acquire the monitor effectively causing a lot of coherency traffic and CPU wastage. That being said if there are different conditions for the same lock, you probably want to refactor the code and use more locks."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415356943,"comment_id":42172481,"body":"@Victor Sorokin: in that case you <i>have</i> different conditions, as you are not waiting for “nonempty condition” but “Foo available” and “Bar available” then. In that case you need either the consumer doing a re-<code>notify</code> if it didn’t consume or the producer using <code>notifyAll</code> whereas the former may soon become even more inefficient as the latter. So right, if in doubt, just use <code>notifyAll</code>…"},{"owner":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"edited":false,"creation_date":1415356575,"comment_id":42172261,"body":"Well, you right there&#39;s explicit <code>Condition</code> for this, but one can&#39;t say it&#39;s safe to use <code>notify</code> in case of multiple consumers, <i>in a general case</i> (e.g., what if different consumers consume differnt type of items?)."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"edited":false,"creation_date":1415356378,"comment_id":42172135,"body":"@Victor Sorokin: it obviously depends on the condition. E.g. if you put exactly one item into an empty queue there is no reason to wake up more than one consumer. If you have multiple different conditions you may consider using a <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Lock.html\" rel=\"nofollow noreferrer\"><code>Lock</code></a> as that API supports defining distinct <a href=\"http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html\" rel=\"nofollow noreferrer\">conditions</a> you may <code>await</code> and <code>signal</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/tpqof.jpg?s=256&g=1","account_id":54362,"user_type":"registered","user_id":162634,"link":"https://stackoverflow.com/users/162634/victor-sorokin","reputation":11938,"display_name":"Victor Sorokin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":0,"post_id":26798737,"edited":false,"creation_date":1415356023,"comment_id":42171936,"body":"More often than not, it&#39;s better to use <code>notifyAll()</code> instead of <code>notify</code>, since different threads can wait for different conditions to occur, and if you use <code>notify</code> it may go to wrong thread, and this notification is lost for thread it really belongs to. If you know that there&#39;s no more than one waiting thread, using <code>notify</code> is fine."},{"owner":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"content_license":"CC BY-SA 3.0","score":39,"post_id":820131,"edited":false,"creation_date":1415140486,"comment_id":42077909,"body":"Why did I have to scroll down so far to find this essential answer!?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f1b044b33c5d5ee61e223aac39761f43?s=256&d=identicon&r=PG","account_id":947019,"user_type":"registered","user_id":974063,"link":"https://stackoverflow.com/users/974063/randall-cook","reputation":6758,"display_name":"Randall Cook","accept_rate":100},"content_license":"CC BY-SA 3.0","score":2,"post_id":877115,"edited":false,"creation_date":1402094056,"comment_id":37157734,"body":"I have code similar to your anonymous class example, except I access <code>parameter</code> directly from the <code>run()</code> method without using a field like <code>p</code> at all. It seems to work. Is there some subtle multithreading thing I am missing by not copying <code>parameter</code> to <code>p</code> beforehand?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":32,"post_id":818120,"edited":false,"creation_date":1397668086,"comment_id":35337070,"body":"This is an awful lot of upvotes for an answer that, while informative, does not in any way actually answer the question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=256&d=identicon&r=PG","account_id":150501,"user_type":"registered","user_id":363751,"link":"https://stackoverflow.com/users/363751/supercat","reputation":78480,"display_name":"supercat","accept_rate":35},"content_license":"CC BY-SA 3.0","score":2,"post_id":13037170,"edited":false,"creation_date":1395096280,"comment_id":34174699,"body":"Re-entrancy isn&#39;t a problem if code is prepared to deal with it.  On entry, make note of whether the variable is already set, and on exit, restore its previous value (if there was any), or remove it (if not)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":877113,"edited":false,"creation_date":1381871974,"comment_id":28740620,"body":"This means that each Thread constructed using <code>r</code> will have the same argument, so if we want to pass different arguments to multiple Threads running <code>MyThread</code> we&#39;d need to create a new <code>MyThread</code> instance using the desired argument for each Thread. In other words, to get a thread up and running we need to create two objects: Thread and MyThread. Is this considered bad, performance-wise?"},{"owner":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"content_license":"CC BY-SA 3.0","score":22,"post_id":817926,"edited":false,"creation_date":1372354343,"comment_id":25173897,"body":"This is high price to pay for hacking <code>SimpleDateFormat</code>. Perhaps it&#39;s better to use <a href=\"http://stackoverflow.com/questions/10411944/java-text-simpledateformat-not-thread-safe\">a thread-safe alternative</a>. If you agree that <a href=\"http://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons\">singletons are bad</a> then <code>ThreadLocal</code> is even worse."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=256&d=identicon&r=PG","account_id":114848,"user_type":"registered","user_id":301832,"link":"https://stackoverflow.com/users/301832/donal-fellows","reputation":134189,"display_name":"Donal Fellows","accept_rate":60},"content_license":"CC BY-SA 3.0","score":12,"post_id":818120,"edited":false,"creation_date":1370953796,"comment_id":24640175,"body":"The thread that Julien links to has moved to <a href=\"http://jsr166-concurrency.10961.n7.nabble.com/Threadlocals-and-memory-leaks-in-J2EE-td3960.html\" rel=\"nofollow noreferrer\">here</a> it seems, and is <i>well worth reading…</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd01dd06eefc977f4746b1ff55799c2b?s=256&d=identicon&r=PG","account_id":94225,"user_type":"registered","user_id":257364,"link":"https://stackoverflow.com/users/257364/volksman","reputation":2029,"display_name":"Volksman","accept_rate":0},"content_license":"CC BY-SA 3.0","score":4,"post_id":820131,"edited":false,"creation_date":1367029500,"comment_id":23246108,"body":"That&#39;s exactly how the exPOJO framework (www.expojo.com) allows access to ORM Session/PersistenceManager without needing the overhead of annotations and injection. It is kind of like &#39;thread injection&#39; instead of &#39;object injection&#39;. It provides access to dependencies without the requirement (and overhead) of having them embedded in every object that might need those dependencies. It&#39;s amazing how &#39;light weight&#39; you can make a DI framework when you use thread injection instead of classic DI (eg., Spring etc.,)"},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282504,"comment_id":22176134,"body":"No tens seconds is not too long."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e7f50c8aa281d791b4d5be24d2c2961?s=256&d=identicon&r=PG","account_id":1778663,"user_type":"registered","user_id":1621913,"link":"https://stackoverflow.com/users/1621913/joeyl","reputation":1295,"display_name":"JoeyL","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"edited":false,"creation_date":1364282415,"comment_id":22176102,"body":"@Raghunandan I would say the task could last ~10 seconds.  Would that be too long for asynctask?"},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282217,"comment_id":22176010,"body":"it also depends how long will it take to get data from database. don&#39;t want the user to keep waiting to interact with the ui. For long Running operations asynctask is not good."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e7f50c8aa281d791b4d5be24d2c2961?s=256&d=identicon&r=PG","account_id":1778663,"user_type":"registered","user_id":1621913,"link":"https://stackoverflow.com/users/1621913/joeyl","reputation":1295,"display_name":"JoeyL","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631381,"edited":false,"creation_date":1364282115,"comment_id":22175970,"body":"Thank you Nirali for the response &lt;3 :)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1c9d8c24df8646c416ef0fbf2177c848?s=256&d=identicon&r=PG","account_id":416223,"user_type":"registered","user_id":791486,"link":"https://stackoverflow.com/users/791486/friedryk","reputation":376,"display_name":"Friedryk"},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1357923042,"comment_id":19832107,"body":"I&#39;ve just being hit the face with date/calendar/format concurrency problems. Though I understood quickly what was going on, your post made it plain and simple to solve my problems without major overhaul of my code. Thanks!  Personnally I made a point in calling ThreadLocal remove after each get(), idealy in a finally clause. Any thoughts if it is overkill ? I wanted to make sure memory could be reclaimed after execution of enclosing Thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/cIuFJ.jpg?s=256&g=1","account_id":887421,"user_type":"registered","user_id":926520,"link":"https://stackoverflow.com/users/926520/pankaj","reputation":5160,"display_name":"Pankaj","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1356923862,"comment_id":19500485,"body":"Here is a complete example showing different threads have their own copy. <a href=\"http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables\" rel=\"nofollow noreferrer\">journaldev.com/1076/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/hlWHy.jpg?s=256&g=1","account_id":1151383,"user_type":"registered","user_id":1133011,"link":"https://stackoverflow.com/users/1133011/david-kroukamp","reputation":36217,"display_name":"David Kroukamp","accept_rate":96},"content_license":"CC BY-SA 3.0","score":0,"post_id":14072987,"edited":false,"creation_date":1356716429,"comment_id":19456095,"body":"@NickHaughton Also see this similar answer which uses a single Swing Timer, to move a ball and repaint its container afterwards to refelect changes: <a href=\"http://stackoverflow.com/questions/14068472/java-mouselistener-action-event-in-paintcomponent/14070147#14070147\" title=\"java mouselistener action event in paintcomponent\">stackoverflow.com/questions/14068472/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=256&d=identicon&r=PG","account_id":4495,"user_type":"registered","user_id":6782,"link":"https://stackoverflow.com/users/6782/alnitak","reputation":335863,"display_name":"Alnitak","accept_rate":78},"content_license":"CC BY-SA 3.0","score":7,"post_id":877113,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/7CZNr.png?s=256&g=1","account_id":148793,"user_type":"registered","user_id":360826,"link":"https://stackoverflow.com/users/360826/jason-m","reputation":6615,"display_name":"jason m","accept_rate":73},"edited":false,"creation_date":1353601838,"comment_id":18503246,"body":"@jasonm no, it&#39;s a constructor - constructors don&#39;t have a return type."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=256&d=identicon&r=PG","account_id":7639,"user_type":"registered","user_id":13317,"link":"https://stackoverflow.com/users/13317/kenster","reputation":23810,"display_name":"Kenster","accept_rate":85},"content_license":"CC BY-SA 3.0","score":11,"post_id":818120,"edited":false,"creation_date":1335905541,"comment_id":13420747,"body":"Alex Vasseur moved his blog. <a href=\"http://avasseur.blogspot.com/2003/11/threadlocal-and-memory-leaks.html\" rel=\"nofollow noreferrer\">Here</a> is a current link to the memory leak article."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/63f1d837b7123c72135da37e2f0042de?s=256&d=identicon&r=PG","account_id":283806,"user_type":"registered","user_id":581528,"link":"https://stackoverflow.com/users/581528/ray","reputation":4839,"display_name":"Ray","accept_rate":84},"content_license":"CC BY-SA 2.5","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7ccd45f17734f7d050a186468bdc38eb?s=256&d=identicon&r=PG","account_id":25274,"user_type":"registered","user_id":64881,"link":"https://stackoverflow.com/users/64881/phil-m","reputation":6653,"display_name":"Phil M"},"edited":false,"creation_date":1297682605,"comment_id":5577062,"body":"do you think this could be avoided by using a SoftReference?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f671bc1d0b48c1b03402cd6fe2c369c6?s=256&d=identicon&r=PG","account_id":16974,"user_type":"registered","user_id":37539,"link":"https://stackoverflow.com/users/37539/ian-varley","reputation":9287,"display_name":"Ian Varley","accept_rate":75},"content_license":"CC BY-SA 2.5","score":21,"post_id":817864,"edited":false,"creation_date":1274889994,"comment_id":2966244,"body":"By default, static objects, or objects explicitly passed between threads where both threads posses a reference to the same object, are shared. Objects declared locally in a thread are not shared (they&#39;re local to the thread&#39;s stack). Just wanted to clarify that."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ec3b4d2db3e6e33b498deb38592e862d?s=256&d=identicon&r=PG","account_id":15307,"user_type":"registered","user_id":32174,"link":"https://stackoverflow.com/users/32174/julien-chastang","reputation":17620,"display_name":"Julien Chastang","accept_rate":71},"content_license":"CC BY-SA 2.5","score":173,"post_id":817926,"edited":false,"creation_date":1241408353,"comment_id":627914,"body":"Another alternative to synchronization or threadlocal is to make the variable a local variable. Local vars are always thread safe. I assume that it is bad practice to make DateFormats local because they are expensive to create, but I have never seen solid metrics on this topic."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b2307ec2e0242d08e7b7236223a47fe7?s=256&d=identicon&r=PG","account_id":22836830,"user_type":"registered","user_id":16984466,"link":"https://stackoverflow.com/users/16984466/lucas-grugru","reputation":1684,"display_name":"Lucas Grugru"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676557170,"comment_id":133163825,"body":"Who is Paul Samsotha ? What answer ?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AEdFTp61CUpQI3VbC_PLq34lGLauPTVC9VC23rZkIOSpZw=k-s256","account_id":27772393,"user_type":"registered","user_id":21202467,"link":"https://stackoverflow.com/users/21202467/nasir-mushtaq","reputation":1,"display_name":"Nasir Mushtaq"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75433827,"edited":false,"creation_date":1676279155,"comment_id":133098101,"body":"Create only one client and reuse that"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676124260,"comment_id":133076706,"body":"Ah, ok. Interesting. I stumbled across this question while researching a related issue and thought I would add this piece of information for future readers. Did not consider it might not have been true at the time the question was asked."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676123885,"comment_id":133076652,"body":"Hmm ... yes I see it.  But it is not in Java 8.  It is only implemented in Java 9+.  Prior to that the Linux implementation of <code>os::set_native_thread_name</code> is a noop."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122544,"comment_id":133076447,"body":"My java version: <code>$ java -version openjdk version &quot;11.0.11&quot; 2021-04-20 OpenJDK Runtime Environment AdoptOpenJDK-11.0.11+9 (build 11.0.11+9) OpenJDK 64-Bit Server VM AdoptOpenJDK-11.0.11+9 (build 11.0.11+9, mixed mode) </code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122525,"comment_id":133076445,"body":"I assume the libc function is <code>pthread_setname_np</code> which is used quite often in jdk code. This seems to call prctl: <a href=\"https://android.googlesource.com/platform/bionic/+/master/libc/bionic/pthread_setname_np.cpp#94\" rel=\"nofollow noreferrer\">android.googlesource.com/platform/bionic/+/master/libc/bioni&zwnj;&#8203;c/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122346,"comment_id":133076411,"body":"Which version of Java are you testing?  Which vendor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1676122085,"comment_id":133076378,"body":"@StephenC Evidence is Strace output. I created a runnable jar with the line <code>Thread.currentThread().setName(&quot;test-name-123456789&quot;);</code> and ran it under strace <code>strace -e &#39;trace=!futex&#39; -tt -r -f -o name-trial.txt java -jar run.jar</code>. Output contains this line <code>948729 14:22:19.789325 (+     0.000238) prctl(PR_SET_NAME, &quot;test-name-12345&quot;...) = 0</code>. You also see the system calls, when other threads are named, such as <code>948730 14:22:19.440447 (+     0.000084) prctl(PR_SET_NAME, &quot;GC Thread#0&quot; &lt;unfinished ...&gt;</code>. I assume you did not find the call in the sources, because it is invoked through a c stdlib."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"edited":false,"creation_date":1675984424,"comment_id":133051112,"body":"@Joe23 - Really?  Evidence?  According to (<code>grep</code> search of) the OpenJDK 8u &amp; 17u source code there are no calls to <code>prctl(PR_SET_NAME, ...)</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6ba1265547399e551bc5fc249abd88b6?s=256&d=identicon&r=PG","account_id":46143,"user_type":"registered","user_id":136247,"link":"https://stackoverflow.com/users/136247/joe23","reputation":5703,"display_name":"Joe23","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":5533219,"edited":false,"creation_date":1675963126,"comment_id":133045477,"body":"It leads to a system call though: <code>prctl(PR_SET_NAME, &quot;new-name&quot;)</code>"},{"owner":{"profile_image":"https://i.stack.imgur.com/SEQOn.jpg?s=256&g=1","account_id":10611364,"user_type":"registered","user_id":7815223,"link":"https://stackoverflow.com/users/7815223/shagun-verma","reputation":163,"display_name":"Shagun Verma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"reply_to_user":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"edited":false,"creation_date":1675946402,"comment_id":133039335,"body":"To know the difference, you can see <a href=\"https://javarevisited.blogspot.com/2016/12/difference-between-thread-and-executor.html?m=1\" rel=\"nofollow noreferrer\">javarevisited.blogspot.com/2016/12/&hellip;</a>"},{"owner":{"profile_image":"https://graph.facebook.com/2224058381009628/picture?type=large","account_id":16040627,"user_type":"registered","user_id":11577121,"link":"https://stackoverflow.com/users/11577121/marco-jacobo","reputation":31,"display_name":"Marco Jacobo"},"content_license":"CC BY-SA 4.0","score":0,"post_id":75393592,"edited":false,"creation_date":1675921816,"comment_id":133032776,"body":"Thanks a lot Shagun Verma,  I&#39;d like to make a question: &#191;What would be the difference between this executor and a thread?  I appreciate a lot your answer, it is helping me to move foward. My code is partially working at this moment, I still need to make additional modifications... I&#39;m gonna continue tomorrow and update this post with additional feedback/comments.  Thanks again!!!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e648659dd573c1161a370efa0f5e10d6?s=256&d=identicon&r=PG","account_id":238127,"user_type":"registered","user_id":506796,"link":"https://stackoverflow.com/users/506796/tenfour04","reputation":86172,"display_name":"Tenfour04","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"edited":false,"creation_date":1665070421,"comment_id":130618251,"body":"Without SupervisorJob, if any of the jobs launched with the scope fail, the rest of them are canceled and it can never launch another job again. There are potentially cases where that would be the behavior you might want though. I haven&#39;t personally ever had any though."},{"owner":{"profile_image":"https://i.stack.imgur.com/zw18i.png?s=256&g=1","account_id":1663234,"user_type":"registered","user_id":1531124,"link":"https://stackoverflow.com/users/1531124/ghostcat","reputation":138406,"display_name":"GhostCat","accept_rate":96},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"edited":false,"creation_date":1665068670,"comment_id":130617492,"body":"Please note: this community wants quality answers. Telling people &quot;go read some documentation about X&quot; isn&#39;t that. Seriously: if you dont want to spend the time to write a proper answer, then write a comment. Otherwise, invest a few minutes and write an answer that deserves to be called &quot;answer&quot;."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f947ba0438d76ee69a779510f60a1a56?s=256&d=identicon&r=PG","account_id":16231683,"user_type":"registered","user_id":11720290,"link":"https://stackoverflow.com/users/11720290/bananasmoothii","reputation":144,"display_name":"Bananasmoothii"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73974282,"edited":false,"creation_date":1665067927,"comment_id":130617196,"body":"Thanks ! Could you explain how SupervisorJob is useful and what happens when it is not used, please ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e34d0dd755c1ca59cd89d4a4e566439a?s=256&d=identicon&r=PG","account_id":2226374,"user_type":"registered","user_id":1965042,"link":"https://stackoverflow.com/users/1965042/vcg","reputation":106,"display_name":"vcg"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73968534,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"edited":false,"creation_date":1665065857,"comment_id":130616325,"body":"Sorry misunderstood the question, I guess you are using <code>lastEdit</code> as static var, you may want to add <code>volatile</code> keyword to the var, so that the threads will access to the real value of your var.. take a look at <a href=\"https://www.baeldung.com/java-volatile\" rel=\"nofollow noreferrer\">volatile keyword</a>"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/ALm5wu1RNyCKNLitd3s_Cqyh_-XMWgd1S1zzPXsmpmPslw=k-s256","account_id":26498771,"user_type":"registered","user_id":20136046,"link":"https://stackoverflow.com/users/20136046/cecil","reputation":21,"display_name":"Cecil"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73968534,"edited":false,"creation_date":1665029066,"comment_id":130604574,"body":"I have searched about scheduleAtFixedRate. But what I want to do is initially delay execution for 10 seconds. And if I do something else in another program, it will restart the timer and execute the code after 10s."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664731012,"comment_id":130534053,"body":"@john16384, <code>InterruptedException</code> is not intended to stop a thread. It is intended to get a thread&#39;s attention. If <i>you</i> want it to stop <i>your</i> thread, then it&#39;s up to you to write a handler so that the thread can catch the exception and then <i>cleanly</i> stop itself."},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664718111,"comment_id":130531264,"body":"certainly not, I&#39;m highly in favor of checked exceptions, just missing why an exception intended to interrupt / stop a thread isn&#39;t part of the declaration of the <code>run</code> method which serves as the entry points for many threads; been looking through the JBS is something was proposed like this, and this is the most similar ticket I could find: <a href=\"https://bugs.openjdk.org/browse/JDK-8150342\" rel=\"nofollow noreferrer\">bugs.openjdk.org/browse/JDK-8150342</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"edited":false,"creation_date":1664717869,"comment_id":130531209,"body":"@john16384: i think this is just another argument against checked exceptions, let the exception be thrown and kill the thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ojvZh.jpg?s=256&g=1","account_id":1316033,"user_type":"registered","user_id":1262865,"link":"https://stackoverflow.com/users/1262865/john16384","reputation":7855,"display_name":"john16384","accept_rate":50},"content_license":"CC BY-SA 4.0","score":0,"post_id":73926210,"edited":false,"creation_date":1664717553,"comment_id":130531125,"body":"Thanks, but I&#39;m not trying to catch an exception from a thread in another thread. The uncaught handler will log it, I know, I&#39;m just asking why would <code>run</code> not have been declared to throw <code>InterruptedException</code> to make it easier to terminate threads with out having to go through the <code>try...catch</code> boilerplate.  Any runtime exception terminates the thread, but an <code>InterruptedException</code> should for some reason be disallowed?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3383e4fd807a451772e79e0f5ccca51c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7413926,"user_type":"registered","user_id":11374957,"link":"https://stackoverflow.com/users/11374957/kaan","reputation":5474,"display_name":"Kaan"},"content_license":"CC BY-SA 4.0","score":1,"post_id":73220736,"edited":false,"creation_date":1659917762,"comment_id":129402173,"body":"<i>&quot;the Callable/Future is much better to catch and log errors&quot;</i> – this doesn&#39;t make sense.. any thread or runnable can catch exceptions and log errors."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2dbd48d7460f4e598ad5142d154055e9?s=256&d=identicon&r=PG","account_id":2898508,"user_type":"registered","user_id":2485774,"link":"https://stackoverflow.com/users/2485774/chazz1","reputation":133,"display_name":"Chazz1","accept_rate":87},"content_license":"CC BY-SA 4.0","score":0,"post_id":73220736,"edited":false,"creation_date":1659525531,"comment_id":129314469,"body":"I had something like that. But something went wrong on the production site, and the runnable stopped and nobody noticed it until some days later. For what I&#39;ve read, the Callable/Future is much better to catch and log errors. I was trying to implement a callable so I could relaunch it when something like this happens."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"edited":false,"creation_date":1658862721,"comment_id":129156352,"body":"Hi @Dinesh... I had used Inmemory map to store authorization related data. Can you please help me explain your issue more."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a841a1df6573bb73868262222fc81b01?s=256&d=identicon&r=PG","account_id":1963842,"user_type":"registered","user_id":1764587,"link":"https://stackoverflow.com/users/1764587/dinesh","reputation":53,"display_name":"Dinesh"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1658234434,"comment_id":128996582,"body":"@DeepikaSwarup - I am also having a similar approach of calling a Remote Service using Spring HTTPInvoker from Kafka Consumer and getting the same above error. i am stuck with no ways to get further, can you explain a bit more on how and what you did with inmemory map ? Related question here:  <a href=\"https://stackoverflow.com/q/72999102/1764587\">stackoverflow.com/q/72999102/1764587</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654936471,"comment_id":128214757,"body":"Sure Stanislav, I will try."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654933365,"comment_id":128214350,"body":"@ShubhamChaurasia, that&#39;s interesting.. Maybe it&#39;s the ThreadPoolExecutor which has issues with threads constantly fighting for tasks. Could you increase the number of operations? If the trend improves, that again would point to the fact that the culprit is somewhere in the thread pool. If that&#39;s the case, try ForkJoinPool. It&#39;s supposed to be more performant in such scenarios."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654932827,"comment_id":128214278,"body":"No worries and thanks for updating again. Actually I did that earlier and I understand what you are measuring is the total time to complete the program with overlapping threads being run concurrently. For the same purpose I was calculating the average time.  Anyways, I ran it with your implementation of runBenchmark() and I am seeing similar results -  1. On 8 cores - =====runBenchmark() FINISHED in 171217 2. On 16 cores - =====runBenchmark() FINISHED in 186911 3. On 32 cores - =====runBenchmark() FINISHED in 267623   As we can see, the time is increasing with number of cores."},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654931031,"comment_id":128214042,"body":"@ShubhamChaurasia, take a look now. Hopefully it answers the question now :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930625,"comment_id":128213978,"body":"@ShubhamChaurasia, I think now I see the problem and my answer is not far off. Let me update it :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654930204,"comment_id":128213938,"body":"@ShubhamChaurasia, ah, so you&#39;re not increasing the number of threads - it&#39;s always 100 regardless of whether you&#39;re running on the machine with 8 or 32 cores? If that&#39;s the case, then sorry for the confusion."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929824,"comment_id":128213893,"body":"I clarified it a bit more in the question - &quot;1000000 is number of floating point divisions that each thread does, 100 is number of threads.&quot;"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929495,"comment_id":128213849,"body":"The amount of work is constant in all the setups. All 8, 16, and 32 cores systems are getting to process 100 threads and 1M operations in each thread. Then we can expect a perf gain, is that right ?"},{"owner":{"profile_image":"https://i.stack.imgur.com/b5Dq4.jpg?s=256&g=1","account_id":476019,"user_type":"registered","user_id":886697,"link":"https://stackoverflow.com/users/886697/stanislav-bashkyrtsev","reputation":14699,"display_name":"Stanislav Bashkyrtsev","accept_rate":92},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"edited":false,"creation_date":1654929307,"comment_id":128213823,"body":"@ShubhamChaurasia, in your question you stated that you expect the time to decrease. Which doesn&#39;t make sense. If you&#39;re adding x2 cores but also add x2 work, then why would that finish faster?"},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582182,"edited":false,"creation_date":1654929067,"comment_id":128213792,"body":"I get your point about dividing total number of operations among threads. But here I think we are more concerned about the number of these threads that cores can service and there we are seeing lesser number of cores winning due to some reason."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654928808,"comment_id":128213769,"body":"Updated in &quot;EDIT 1:&quot; with ThreadLocalRandom observations."},{"owner":{"profile_image":"https://i.stack.imgur.com/FAvIB.jpg?s=256&g=1","account_id":5031739,"user_type":"registered","user_id":4041711,"link":"https://stackoverflow.com/users/4041711/shubham-chaurasia","reputation":2502,"display_name":"Shubham Chaurasia","accept_rate":53},"content_license":"CC BY-SA 4.0","score":0,"post_id":72582123,"edited":false,"creation_date":1654927880,"comment_id":128213654,"body":"Thanks for pointing out, sure will try."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/18b9001fd20c1e089d19f4a1e994bcdc?s=256&d=identicon&r=PG","account_id":6482932,"user_type":"registered","user_id":5019386,"link":"https://stackoverflow.com/users/5019386/mahmoud-ben-hassine","reputation":29552,"display_name":"Mahmoud Ben Hassine"},"content_license":"CC BY-SA 4.0","score":1,"post_id":72570061,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"edited":false,"creation_date":1654883240,"comment_id":128206982,"body":"Both implementing <code>Step</code> or extending <code>AbstractStep</code> should work. It is up to you. In regards to how to set the commit-interval dynamically with a job parameter, you can take a look at this: <a href=\"https://stackoverflow.com/questions/26041550/spring-batch-dynamic-commit-interval-or-a-custom-completion-policy\" title=\"spring batch dynamic commit interval or a custom completion policy\">stackoverflow.com/questions/26041550/&hellip;</a>."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-gzazL12Nyf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfDMa-wgbKRz71aMyczgKnKB5Opw/mo/photo.jpg?sz=256","account_id":16108109,"user_type":"registered","user_id":11627119,"link":"https://stackoverflow.com/users/11627119/jacob-goldverg","reputation":47,"display_name":"Jacob Goldverg"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570061,"edited":false,"creation_date":1654873120,"comment_id":128203604,"body":"Awesome thank you for this answer. So for dynamic steps I would implement the Step Interface or should I use the AbstractStep class? What classes should I extend for the dynamic commit interval?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849677,"comment_id":128194958,"body":"Yeah I will take a look and see if I can find something I can use"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654849625,"comment_id":128194933,"body":"There are lots of simple socket server examples out there on the interwebz for java, C#, C++, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654849288,"comment_id":128194819,"body":"I did extend the class and implemented the accept in the new class though am afraid it will not create sessions as per your advice, an answer in android java is welcome as I can convert it to C#, updating my code"},{"owner":{"profile_image":"https://i.stack.imgur.com/FKKLW.jpg?s=256&g=1","account_id":404649,"user_type":"registered","user_id":773113,"link":"https://stackoverflow.com/users/773113/mike-nakis","reputation":57192,"display_name":"Mike Nakis","accept_rate":72},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"edited":false,"creation_date":1654848834,"comment_id":128194682,"body":"As step 1 above says, this blocking call needs to be on a separate thread (the &quot;Accept&quot; thread) which does nothing but this blocking call and spawns other threads for clients."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3b860d47d80fc72f0e8264b7613186bb?s=256&d=identicon&r=PG","account_id":25073739,"user_type":"registered","user_id":18972846,"link":"https://stackoverflow.com/users/18972846/techgeek","reputation":316,"display_name":"TechGeek"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72570970,"edited":false,"creation_date":1654848710,"comment_id":128194655,"body":"Hello sir from your reputation I can see you are advanced, I needed help with this, since the blocking call will not execute code below it as  it listens on connections forever, how to avoid that but still get the message from the source device?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"edited":false,"creation_date":1654790801,"comment_id":128181712,"body":"@BlueRyse: If you can provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> you may get better answers. I understand you want to make the post short but that discourages people from helping when they don&#39;t have something they can run. And even if the suggested code doesn&#39;t work make sure you understand the point of avoiding races and not waiting if a notification isn&#39;t coming."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9e9ee1e1f1b74a7909d5b65d0626f6ea?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":16264338,"user_type":"registered","user_id":11744870,"link":"https://stackoverflow.com/users/11744870/blueryse","reputation":29,"display_name":"BlueRyse"},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551003,"edited":false,"creation_date":1654786982,"comment_id":128180183,"body":"Unfortunately, this solution doesn&#39;t work. At this point, I guess there&#39;s something wrong with my OS, Eclipse, or the JVM."},{"owner":{"profile_image":"https://i.stack.imgur.com/KCuvK.jpg?s=256&g=1","account_id":8705495,"user_type":"registered","user_id":6513683,"link":"https://stackoverflow.com/users/6513683/wubbalubbadubbdubb","reputation":151,"display_name":"WubbaLubbaDubbDubb","accept_rate":80},"content_license":"CC BY-SA 4.0","score":0,"post_id":72551685,"edited":false,"creation_date":1654719975,"comment_id":128161955,"body":"This answer worked perfectly, thank you so so so much! I can&#39;t believe I didn&#39;t catch this one myself."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71327704,"edited":false,"creation_date":1649934361,"comment_id":127002672,"body":"Thanks Gray for the pointers... It helped me in getting more insight and fixing it. Since there was no controller involved and Kafka was calling PUT method directly, I was unable to get HTTP context... In order to resolve my issue, I created an inmemory map..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6b2c535fac79e482b71f15de561f55ca?s=256&d=identicon&r=PG","account_id":60171,"user_type":"registered","user_id":179850,"link":"https://stackoverflow.com/users/179850/gray","reputation":115485,"display_name":"Gray","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"edited":false,"creation_date":1646333964,"comment_id":126103570,"body":"Sorry @DeepikaSwarup.  I don&#39;t know enough about your application to answer appropriately."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ca28b66512a728493d8e339dfbfdf0f0?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":11951921,"user_type":"registered","user_id":8745360,"link":"https://stackoverflow.com/users/8745360/deepika-swarup","reputation":67,"display_name":"Deepika Swarup"},"content_license":"CC BY-SA 4.0","score":0,"post_id":71327704,"edited":false,"creation_date":1646331272,"comment_id":126102702,"body":"Thanks Gray for the pointers. Yes putData() is directly being called by my consumer and not through controller. Will it be correct if I call my controller API through consumer in the same project? And then through controller I will call putData()."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1646248410,"comment_id":126078767,"body":"@pveentjer right, but isn&#39;t a data race a result of a missing happens before chain? I mean the phrase: &quot;... are not ordered by a happens-before relationship, it is said to contain a data race&quot; from chapter 17 of JLS. My point being that, unless there is HB for all actions, yes, a data race can happen. Was that your point? thank you."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"edited":false,"creation_date":1646241445,"comment_id":126076367,"body":"Small correction: Happens-before consistent is a relaxation of happens-before. Happens-before consistent also deals when a read and write are concurrent (so not ordered by happens-before; so in data race)."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71234632,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"edited":false,"creation_date":1646233765,"comment_id":126073067,"body":"@Holger you&#39;re right, I&#39;ve edited."},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645697231,"comment_id":125942829,"body":"In other words, the fact that the volatile write and read (to the same variable) have a “synchronizes-with” relation is the <i>prerequisite</i> to have a <i>happens-before</i> relationship. As &#167;17.4.5. says at the beginning “<i>If an action x synchronizes-with a following action y, then we also have hb(x, y).</i>” It than proceeds to say “<b>It follows from the above definitions that:</b> <i>A write to a volatile field (&#167;8.3.1.4) happens-before every subsequent read of that field.</i>” This conclusion is what we want; since it has been spelled out explicitly, there is no need to discuss “synchronizes-with” at all."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":1,"post_id":71234632,"edited":false,"creation_date":1645680815,"comment_id":125938156,"body":"The happens-before order is the transitive closure of the union of the synchronizes-with order and the program order. So if you have established that 2 actions are ordered by the synchronizes-with order, it is automatically implied that they are ordered by the happens-before order."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":71212240,"edited":false,"creation_date":1645611395,"comment_id":125915941,"body":"good answer, simple, yet very good."},{"owner":{"profile_image":"https://i.stack.imgur.com/Poqe8.png?s=256&g=1","account_id":10898797,"user_type":"registered","user_id":8011734,"link":"https://stackoverflow.com/users/8011734/marwa-eltayeb","reputation":1961,"display_name":"Marwa Eltayeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1637332712,"comment_id":123805434,"body":"You are very welcome. I am so glad that my answer is helpful for you."},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 4.0","score":0,"post_id":69655199,"edited":false,"creation_date":1637222866,"comment_id":123769689,"body":"Thank you very much for your detailed and involved answer."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJzLkOQelMMXYxAJxRKLvxqRtrmM6VXMlnw9PvD0=k-s256","account_id":23184907,"user_type":"registered","user_id":17282180,"link":"https://stackoverflow.com/users/17282180/iosiv","reputation":25,"display_name":"Iosiv"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69967575,"edited":false,"creation_date":1637095160,"comment_id":123733467,"body":"Thanks! Great explanation. I understand your point. Actually, I suspected that was the issue from the very beginning, but unfortunately I&#39;m not allowed to modify the Player classes (for learning/suffering purposes), so I&#39;m actually looking for a solution that involves only the Ball class. I tried, for instance, to  get the name of the current thread and use this to lock the methods for each of them every time. Or to use two booleans instead of one. No success so far, but I&#39;ll keep trying."},{"owner":{"profile_image":"https://i.stack.imgur.com/5ovO7.png?s=256&g=1","account_id":9713597,"user_type":"registered","user_id":7204683,"link":"https://stackoverflow.com/users/7204683/umair","reputation":615,"display_name":"Umair","accept_rate":38},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"edited":false,"creation_date":1636997613,"comment_id":123701661,"body":"you are welcome @TanmayMandaogane"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636975020,"comment_id":123692464,"body":"It is possible, but at that point there are no other threads. If there were any, they&#39;d run. Every thread has its own code. This is not magic, code cannot jump between threads. Code still must be executed sequentially by a single thread. Therefore, you need to wait for client connections in one thread, and start clients in another thread. The server needs to have its own thread which will handle the connections. The infinite loop will hog the thread forever and the code after Server.start() never runs."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973143,"edited":false,"creation_date":1636974720,"comment_id":123692369,"body":"It can. This is not about other threads. Other threads will run the <code>GameClientHandler.run()</code> code, but not anything else. What&#39;s happening, is this: Thread1: &quot;I&#39;ll wait for a client to connect. When it connects, I&#39;ll start a thread to handle it, then wait for another connection, and another, and another, and another. When infinite connections are done (never), only then will I move on and actually start two clients.&quot; This thread gets stuck at step 1, waiting for a client to connect. There are no clients. There are no other (handler) threads because you only start them after a client connects."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"edited":false,"creation_date":1636974674,"comment_id":123692353,"body":"@PetrJaneček Regarding the latter part of your comment, If a thread is looping forever, it is impossible to switch to another thread?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":1,"post_id":69973382,"edited":false,"creation_date":1636974467,"comment_id":123692266,"body":"Exactly. Just to make it a little more clear, the code will wait forever at the <code>serverSocket.accept()</code> call (which is called before the <code>new Thread(...)</code> part) and will never move on from there."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4cf74649b70fc946650115e0d5067ebe?s=256&d=identicon&r=PG","account_id":1328773,"user_type":"registered","user_id":1273080,"link":"https://stackoverflow.com/users/1273080/petr-jane%c4%8dek","reputation":37883,"display_name":"Petr Janeček","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636974240,"comment_id":123692177,"body":"You never get to <code>client1.startConnection()</code>. Your code is stuck forever at <code>serverSocket.accept()</code> which waits forever. It will not move from that point. Even if that was not the case, the then there&#39;s the infinite loop. Again, the code would loop forever, never actually getting to <code>client1.startConnection()</code>."},{"owner":{"user_type":"does_not_exist","display_name":"user16037629"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69973143,"edited":false,"creation_date":1636973999,"comment_id":123692082,"body":"But I also have client1.startConnection()?"},{"owner":{"profile_image":"https://i.stack.imgur.com/17qiv.jpg?s=256&g=1","account_id":23051250,"user_type":"registered","user_id":17168037,"link":"https://stackoverflow.com/users/17168037/tanmay-mandaogane","reputation":5,"display_name":"Tanmay Mandaogane"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69957970,"edited":false,"creation_date":1636926068,"comment_id":123682000,"body":"thank you so much brother I got It  everything."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636896634,"comment_id":123674561,"body":"If you are trying to demonstrate that the code is not thread-safe, be aware that the <code>println</code> <i>could</i> be altering the way that things are working.  Also, be aware that thread non-safe behavior may actually occur on particular platforms under particular circumstances that are hard to reproduce.  They may depend on hardware behavior, numbers of cores, specific code sequences generated by specific JIT compilers, etc.   (The fact that you are not able to show thread non-safety does NOT mean that code is thread-safe.  You have to carefully analyze the code against what the JLS says.)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895965,"comment_id":123674410,"body":"I modifed code a bit <code>new _Thread(new Dummy()).start()</code>, but didn&#39;t achieved expected result. Every time it prints that list has all 10_000 elements. Does it happens because <code>start()</code> methods triggers <code>happens-before</code> and all values from constructor in main thread will be visible in <code>_Thread</code> or it is just hard to reproduce?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/147c5a9cc1feec049c50da791ac7d144?s=256&d=identicon&r=PG","account_id":47283,"user_type":"registered","user_id":139985,"link":"https://stackoverflow.com/users/139985/stephen-c","reputation":703927,"display_name":"Stephen C","accept_rate":69},"content_license":"CC BY-SA 4.0","score":1,"post_id":69960265,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"edited":false,"creation_date":1636895558,"comment_id":123674310,"body":"1) Yes.  If you satisfy <b>all</b> of the prerequisites. 2) Yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636895045,"comment_id":123674169,"body":"Does it mean that if I will used <code>final</code> on unsynchronized collection, values put in during construction won&#39;t be cached inside of thread but will be commited in main memory despite there is no synchronization and collection isn&#39;t thread-safe, and if there will be no <code>final</code> modifier there is possibility that values put in will be visible only to thread which executed code in constructor?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894805,"comment_id":123674109,"body":"<code>final fields also allow programmers to implement thread-safe immutable objects without synchronization</code> why do I even have to use synchronization inside of constructor if only single thread can execute code in it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bfe77bf1a0c97d310396079b2c85a7e3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":20262549,"user_type":"registered","user_id":14860590,"link":"https://stackoverflow.com/users/14860590/zexed640","reputation":167,"display_name":"zexed640"},"content_license":"CC BY-SA 4.0","score":0,"post_id":69960265,"edited":false,"creation_date":1636894676,"comment_id":123674091,"body":"As for example int this question - <a href=\"https://stackoverflow.com/questions/6457109/java-concurrency-is-final-field-initialized-in-constructor-thread-safe\" title=\"java concurrency is final field initialized in constructor thread safe\">stackoverflow.com/questions/6457109/&hellip;</a> was used <code>final</code> <code>HashMap</code>, and all values were put in constructor. I wonder what will be the difference if there was no <code>final</code> modifier. As for me, I see no difference bcs anyway thread won&#39;t return object until constructor finishes his work, he didn&#39;t pass out <code>this</code> out of constructor. Or bcs it is not synchronized <code>Map</code> thread can cache values which he put into <code>Map</code> and other threads won&#39;t see fully populated map but only part of it?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/aa0490fa29da8a5d40dd219d9f13dccb?s=256&d=identicon&r=PG","account_id":49729,"user_type":"registered","user_id":148208,"link":"https://stackoverflow.com/users/148208/justin-kredible","reputation":8364,"display_name":"Justin Kredible","accept_rate":74},"content_license":"CC BY-SA 4.0","score":0,"post_id":69955150,"edited":false,"creation_date":1636815008,"comment_id":123660346,"body":"This approach requires the thread to poll the queue with a timeout. For this application, how often the producer places a new object in the queue is indeterminate. It could be as little as a few milliseconds to as much as a few minutes. This means choosing a suitable timeout for the consumers is almost impossible. The goal is to prevent the consumer threads from needlessly consuming CPU time as well as needlessly blocking. The consumer threads should only block while the producer is active. If the producer has exited, the consumers should exit once the queue is empty."},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":68788509,"edited":false,"creation_date":1631416285,"comment_id":122214241,"body":"a &quot;fairy tale&quot; answer got accepted agains this. of course."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629711786,"comment_id":121749897,"body":"It did not help"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629222254,"comment_id":121628473,"body":"If they are not static, then each thread has their own separate copy of those variables..  Each thread will wait for the other thread to change their copy of turn and notify their copy of monitor, but that will never happen, because the other thread is doing that to the other copy."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761547,"edited":false,"creation_date":1629209876,"comment_id":121623256,"body":"Hey, I&#39;m pretty sure it&#39;s a dumb question but why does the program not work if monitor and turn are not static?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1629175752,"comment_id":121610331,"body":"Glad it helped. Just remember that <code>synchronized</code> always works upon any object. Means threads will compete to access the <code>synchronized</code> object. You cannot sync the threads, but need to make them access common <code>synchronized</code> object, to make them run in sync."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1629128619,"comment_id":121599510,"body":"I expressed myself pretty badly, I was talking about the first Output but because the run method is synchronized at the time when t1 creates t2, t2 can&#39;t use the run Method yet because it&#39;s already in use, correct?. I think I understood the concept itself now and just have to code it a couple times to get it into my brain. I can&#39;t express how much I appreciate the time you put into your answer, it really helped a lot! (and sorry for the late answer)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/124cda7f0e8d259e69d49ed43868639e?s=256&d=identicon&r=PG","account_id":99786,"user_type":"registered","user_id":269361,"link":"https://stackoverflow.com/users/269361/fool4jesus","reputation":2155,"display_name":"fool4jesus","accept_rate":79},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"edited":false,"creation_date":1629126606,"comment_id":121598571,"body":"@TomDibble Yeah, that&#39;s true; of course, depending on how often this happens, we might not want to pay the stack trace overhead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629122491,"comment_id":121596460,"body":"What you could try is to use saveAndFlush() instead of save() on the repository. It instantly brings the changes to the database."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9d96b0ca59496098053647f2317d0be8?s=256&d=identicon&r=PG","account_id":20410,"user_type":"registered","user_id":48770,"link":"https://stackoverflow.com/users/48770/tom-dibble","reputation":167,"display_name":"Tom Dibble"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629122329,"comment_id":121596389,"body":"In the subclass-Thread approach, can&#39;t we just override <code>interrupt()</code> itself, and capture thread state of the interrupter from <code>Thread.currentThread()</code>, at least thread id and name, likely also the current stack trace?"},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"edited":false,"creation_date":1629114483,"comment_id":121593048,"body":"I am using the DB interface to validate the logic, i see that using transaction, money don’t edit"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68793486,"edited":false,"creation_date":1629110199,"comment_id":121591447,"body":"It’s not really encapsulation when you’re still dealing with threads directly. Nothing prevents other threads from calling the original <code>interrupt()</code> method without a name here. Generally, code should not depend on names in that form anyway. See for example, <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html\" rel=\"nofollow noreferrer\"><code>FutureTask</code></a> and how it nowhere deals with threads in the API. You may <code>cancel</code> it with interruption and it will interrupt the processing thread if there is one and it is still processing this very task."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3c5fa52b5efec6532a8f33a920789d6d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":6089387,"user_type":"registered","user_id":4752240,"link":"https://stackoverflow.com/users/4752240/tuda224","reputation":1,"display_name":"tuda224"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68798496,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629109610,"comment_id":121591219,"body":"@Saintka I saw in your edited question that for a withdrawal you are doing money += value. Is this right? Usually on withdrawal you remove money from your account.  Further question, what is your test assertion? From your code I currently can&#39;t see what you are validating to see if your logic worked or not. Something like account.getMoney().equals(1000); or so."},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629102820,"comment_id":121588455,"body":"The cost of a context switch is not only the context switch itself, but also running into cold caches. And depending on the microarchitecture and the OS, a context switch can also lead to TLB evictions to prevent security problem as those caused by meltdown and others."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629102621,"comment_id":121588383,"body":"How can a method return a different object one by one id? Yes, sthat synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e442a53d36f9351aee11b5ecb8369691?s=256&d=identicon&r=PG","account_id":6520,"user_type":"registered","user_id":11002,"link":"https://stackoverflow.com/users/11002/tgdavies","reputation":10523,"display_name":"tgdavies","accept_rate":75},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"edited":false,"creation_date":1629093754,"comment_id":121585425,"body":"@Saintka I&#39;m not sure which part you don&#39;t understand: that <code>findById</code> may return a different object for the same id, or that synchronising on the same object for the same id is important."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3a97334841a1e42ce096e1e220116af2?s=256&d=identicon&r=PG","account_id":931371,"user_type":"registered","user_id":961204,"link":"https://stackoverflow.com/users/961204/jobless91","reputation":33,"display_name":"jobless91"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629087452,"comment_id":121584297,"body":"@fool4jesus yes, that&#39;s a mistake in question. I forgot to add an <code>if(Thread.interrupted())</code> condition. I will update the question but I got your point. Key motivation for this question is, I have a blocking queue which is getting interrupted while waiting for memory(it is reaching it&#39;s size limit we have defined). I wanted to look for that interrupting thread. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/1fiLn.jpg?s=256&g=1","account_id":19582383,"user_type":"registered","user_id":14331146,"link":"https://stackoverflow.com/users/14331146/saintka","reputation":33,"display_name":"Saintka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68795395,"edited":false,"creation_date":1629086477,"comment_id":121584175,"body":"Interesting reasoning, but i don&#39;t understand, how is this related in this situation, please give an example"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081187,"comment_id":121583556,"body":"Thanks, I will avoid the CompletableFuture for now, I never a fan of callback anyway. I am not a CS grad, so I tried my best to understand the server-client. Thanks for the clarification."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629081037,"comment_id":121583538,"body":"That makes so much sense! I only use that <code>CompletableFuture</code> there, assuming there are only 4 threads from the ForkJoinPool.commonPool, I can imagine the Opening Handshake will do Redis select to determine if it&#39;s a valid request and it will block the async code."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":1,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080594,"comment_id":121583489,"body":"Also, I think you&#39;re lacking a sense of perspective. Your CPU can run literally billions of ops a second. That 500 feels expensive, but in context, we&#39;re talking about a nanosecond. Just write the simplest code you can, make lots of threads, call blocking code, don&#39;t worry about accidentally blocking, and worry about inefficient algorithms instead. You can handle hundreds of simultaneous connections on the cheapest AWS virtual server that way, no problem."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080418,"comment_id":121583465,"body":"The reason async makes it easier: If you block <i>anywhere</i> in an async block, that means the thread is twiddling its thumbs. If I figure out you forgot (e.g. you do a sync DB call somewhere), I just need to get into the &#39;block&#39; mode on 10 simultaneous connections and your server&#39;s CPU is 100% frozen out, not responding to anything else. It is much, MUCH harder to loop a thread using a malicious request, and it&#39;s much easier to realize that&#39;s happening (as CPU load would jump to 100%)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080336,"comment_id":121583454,"body":"500+ cycles, as in: The CPU could be doing 500 simple calculations. <b>But it is what it is</b>, you cannot avoid this cost no matter how hard you try. runAsync won&#39;t do it either. The point is: If you read a blogpost that says async avoids it, they are misunderstanding how CPUs work."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b13bedc5215730fbce5edff6c130988a?s=256&d=identicon&r=PG","account_id":401843,"user_type":"registered","user_id":768644,"link":"https://stackoverflow.com/users/768644/rzwitserloot","reputation":89863,"display_name":"rzwitserloot"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1629080291,"comment_id":121583450,"body":"async makes it much <i>easier</i> to DDOS a server, not harder. That runAsync trick does mostly nothing. It certainly doesn&#39;t prevent DDoS attacks. You can&#39;t avoid the context switching. Period. Nothing can."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68796545,"edited":false,"creation_date":1629079915,"comment_id":121583411,"body":"Does this mean <code>CompletableFuture.runAsync( () - &gt; { WebSocket websocket = new WebSocket(socket, listener); es.execute(websocket); });</code>, I use this after <code>final Socket socket = serverSocket.accept();</code> in case the server is under DDoS with very long http message body during the handshake, so other client trying to connect will not be affectted. Does using CompletableFuture will make the Java application suffers from context switching cost? And, could you please explain about the magnitude of the <code>500+ cycles worth</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/65d747d7ca1ea7c6fae309cce663236c?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14357,"user_type":"registered","user_id":29470,"link":"https://stackoverflow.com/users/29470/tim-moore","reputation":9128,"display_name":"Tim Moore"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68793486,"edited":false,"creation_date":1629077466,"comment_id":121583076,"body":"Nice answer. I wondered whether <code>interrupter</code> would need to be <code>volatile</code> or otherwise synchronized in order to be reliably visible to the interrupted thread. After some quick research, it looks to me like that is not required, and this code is reliable as is. This is discussed at <a href=\"https://stackoverflow.com/q/45269123/29470\">stackoverflow.com/q/45269123/29470</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628948146,"comment_id":121559775,"body":"The code which you have written in question contains 2 mistakes: 1) You have assumed that <code>t1</code> will always run before <code>t2</code>, but this is wrong assumption. 2) You have entered delay of <code>500ms</code> via <code>Thread.sleep</code>, but you never know how much exact delay is needed to make both the treads sync. It totally depends on the processor. It may work on some processor, but not on other. In my code, I haven&#39;t entered any delay. But using <code>wait</code> and <code>notify</code> to run threads in sync. In this case I am not worried about how much delay is needed. They will work in sync by waiting and notifying the other."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628947550,"comment_id":121559647,"body":"No your imagination is not correct. When you start 2 threads one after the other, they will be submitted to the tread scheduler. Now its up to the thread scheduler to run whichever thread first. In most of the cases, thread scheduler will run first submitted thread first, but not in every case. In my updated version, I have created and ran 2nd thread from 1st thread itself, thus I am assured that 1st thread is running and then only 2nd thread will come into existence. It will just delay the 2nd thread a bit, but once both are in execution, they will run in sync (with <code>wait</code> and <code>notify</code>)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628941390,"comment_id":121558331,"body":"Can I imagine it like this: If you just start 2 Threads one after another the thread you started first is starting a bit earlier than the 2nd one but the &#39;time difference&#39; is smaller than the potential inconsistency (and that&#39;s what happenes in my code on the top). But your programs, especially the updated version, give some buffer between the 2 Threads and that buffer is bigger than the potential inconsistency which makes it consistent. Thread 2 is always gonna be slower because Thread 1 creates and starts it (With slower I mean that Thread 1 is further advanced in the run function than T1 is"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d6d4c4b8d52a51d9f7f64c1e5f2de0b3?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4569994,"user_type":"registered","user_id":3709922,"link":"https://stackoverflow.com/users/3709922/jignesh-m-khatri","reputation":1447,"display_name":"Jignesh M. Khatri","accept_rate":33},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628930979,"comment_id":121556085,"body":"I am impressed with how you are debugging this concept. You are somewhat correct that it may lead to inconsistencies (not always, it depends on the thread schedular) in the above two approaches. Check my updated answer, it will guarantee that <code>t1</code> is executed before <code>t2</code> in every case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761559,"edited":false,"creation_date":1628896464,"comment_id":121551703,"body":"I see, I understand it now. Thank you so much!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893069,"comment_id":121551138,"body":"Can&#39;t this lead to mistakes because Threads are inconsistent? Or did I get something wrong? Sorry if it&#39;s a dumb question and thank you so much for the time you put into your answer!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761907,"edited":false,"creation_date":1628893000,"comment_id":121551129,"body":"First of All thank you so much for this answer, I really appreciate it a lot. I hope I got how it works: The synchronized oponent variable lets a Thread wait if another Thread is already using it (just like join does). So the Thread t1 goes into the first if statement and prints out c and then goes into wait state while the Thread t2 goes into the else statement, also prints c and then notifys t1 and goes into wait state and then both go into the next for loop? So basicly t1 is always a bit faster than t2 because they execute at the same time but t2 has the longer path?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b46fd0a429838cd67ea0650e953899be?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22447688,"user_type":"registered","user_id":16651360,"link":"https://stackoverflow.com/users/16651360/marco","reputation":54,"display_name":"Marco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"edited":false,"creation_date":1628833721,"comment_id":121531019,"body":"That is why the synchronizer is static."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/780a651189f64a2cbf4b7f62cf852005?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7178634,"user_type":"registered","user_id":5483526,"link":"https://stackoverflow.com/users/5483526/matt-timmermans","reputation":55168,"display_name":"Matt Timmermans"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68761029,"edited":false,"creation_date":1628787809,"comment_id":121521292,"body":"In order to protect access to the shared variable, both threads need to synchronize on the  <i>same</i> object."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785660,"comment_id":121520574,"body":"similar <a href=\"https://stackoverflow.com/questions/52949210/printing-alphabets-and-numbers-using-multi-threading\" title=\"printing alphabets and numbers using multi threading\">stackoverflow.com/questions/52949210/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3e4be83fe4b3ea871e3595d80172f118?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19042414,"user_type":"registered","user_id":13902217,"link":"https://stackoverflow.com/users/13902217/jeka-fri","reputation":71,"display_name":"Jeka_FRI"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"edited":false,"creation_date":1628785475,"comment_id":121520494,"body":"maybe they want you to know about atomic variables"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760956,"edited":false,"creation_date":1628785271,"comment_id":121520408,"body":"Well it&#39;s an uni exercise and I don&#39;t think it&#39;s supposed to be that hard because we just started with Threads. It wants us to solve it with a global boolean variable so maybe that makes it easier?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fef318f74b7cd37638a80805bb3dd836?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":22439943,"user_type":"registered","user_id":16644640,"link":"https://stackoverflow.com/users/16644640/44ly","reputation":5,"display_name":"44ly"},"content_license":"CC BY-SA 4.0","score":0,"post_id":68760859,"edited":false,"creation_date":1628784688,"comment_id":121520186,"body":"What I meant is that I want the first Thread to print out the first char and the right after the second Thread his first char. What happens right now is that sometimes the first Thread starts first and sometimes the second One so the Output can be something like : aABb but I always want it to be aAbB"},{"owner":{"profile_image":"https://i.stack.imgur.com/W6OMC.png?s=256&g=1","account_id":1056871,"user_type":"registered","user_id":1059372,"link":"https://stackoverflow.com/users/1059372/eugene","reputation":117749,"display_name":"Eugene","accept_rate":97},"content_license":"CC BY-SA 4.0","score":0,"post_id":67831727,"edited":false,"creation_date":1623175910,"comment_id":120002308,"body":"I don&#39;t know where you decided in the first paragraph that it is going to <i>replace</i> the value and that no mutations are allowed, which is still replace, if you ask me. Then simply highlighting the words <i>happens-before</i> is not what I was after, by far. I don&#39;t think this answers my question. I will may be revise my opinion after some time when I re-read it, but currently I can&#39;t accept this."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"edited":false,"creation_date":1621500701,"comment_id":119516539,"body":"@pveentjer right, this is a good illustration of how risky is to don&#39;t follow JMM literally) I&#39;d say, we just get &quot;undefined behaviour&quot; without appropriate HB edges"},{"owner":{"profile_image":"https://i.stack.imgur.com/Klcqr.gif?s=256&g=1","account_id":292208,"user_type":"registered","user_id":2245707,"link":"https://stackoverflow.com/users/2245707/pveentjer","reputation":10665,"display_name":"pveentjer","accept_rate":17},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621492098,"comment_id":119512957,"body":"If you don&#39;t have a synchronized getter, the JIT can also cause problems. E.g. if the value is used in a loop, it could hoist the read out of the loop. So this will fail on CPUs with strong memory models as well."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621348442,"comment_id":119465495,"body":"@kidfrom then you may be interested in an example of using jcstress lib, which is an official tool for testing Java standard library, like <a href=\"https://vimeo.com/131395566\" rel=\"nofollow noreferrer\">vimeo.com/131395566</a> This is a good example why we need volatile"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621347500,"comment_id":119464960,"body":"@AnatolG if I use <code>thread.join</code>, the count value will be 20k because it will wait until all threads have been terminated before invoking <code>Counter.getCount()</code>. I am writing a study material for bootcamp to show that &quot;even thread safe code can fail because it takes time to get the most updated value although it is a volatile attribute, just make sure you understand the volatile and the synchronized keyword&quot;"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346909,"comment_id":119464633,"body":"@kidfrom BTW, why do you need 20k threads and each one increments the counter only once? I&#39;d say that it isn&#39;t a good idea to have so many threads in your application (you need much memory for stacks, a lot of CPU spent on context switching etc) In the real life you have 10x active threads, if most of them are parked/waiting for IO-1000x threads are OK.If you test multithreaded code,it&#39;s enough to use up to...10 threads, but each of them should live long enough to make 100K-100M operations to produce highly concurrent scenarious with higher calls/per sec ratio than in case of 100K-100M threads"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621346214,"comment_id":119464248,"body":"@kidfrom I hope you do something like  for (Thread t : threads) { t.join(); }  to make sure all incrementers have their work finished completely and only then you call getCount() ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621345772,"comment_id":119463997,"body":"@Anatolgy I will mark this as answer. However, when I test the increment() method <code>without the Object.wait();</code> with 20k of threads, the count value always between 19990 - 19999, i double check with <code>while (counter.getCount() != 20000) {}</code> to wait until the count value 20k before testing, resulting in failed test. In short, I should learn more about the JMM requirements you mention."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621345326,"comment_id":119463757,"body":"@kidfrom right. JLS has specific part to describe how to write/save and read/load values/references in multithreaded environment to have updates visible to readers. To have the value written and read under the same lock (in our case - in a block synchronized on the same monitor) OR to do both write and read to/from a volatile field are 2 simplest ways to satisfy JMM requirements (there are some other ways to get Happens-before edge, but these 2 are the most simple/obvious/pragmatic ones)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621344294,"comment_id":119463207,"body":"For problem 2. (after removing the <code>Object.wait()</code>) Do you mean that both the setter and getter needs to have <code>synchronized</code> in order to prevent data race because the setter method is accessed by multiple thread?, currently if I only use <code>synchronized</code> in the setter method, the test never fails, but I do use Intel chips, so I am not sure whether the code is thread safe even if the <code>Object.wait()</code> is removed."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8cf8627c2f497949547cadc02c52b95f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4034876,"user_type":"registered","user_id":3319725,"link":"https://stackoverflow.com/users/3319725/anatolyg","reputation":1557,"display_name":"AnatolyG"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"edited":false,"creation_date":1621343778,"comment_id":119462897,"body":"@kidfrom again :) in this particular code we have 2 different problems: 1 - a race condition - broken (by .wait()) atomicity. To fix it, you have to get rid of the wait(), which releases the monitor. If we need to simulate some workload, use, for example, Thread.sleep() instead. 2 - a data race. The updated counter may not be visible outside by a reader via getCount(). To fix this problem, declare the counter as a volatile field or add synchronized on the getter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621341708,"comment_id":119461847,"body":"I tested it, it seems concurrent logic can&#39;t work with <code>Object.wait()</code> which causes the lock to be released."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1498ae2e1f631e9b3c6a6c2ea8e65f8f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":18250480,"user_type":"registered","user_id":13285583,"link":"https://stackoverflow.com/users/13285583/jason-rich-darmawan","reputation":1691,"display_name":"Jason Rich Darmawan"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67583683,"edited":false,"creation_date":1621340416,"comment_id":119461241,"body":"So if I have a <code>synchronized</code> setter, but the <code>count</code> attribute does not have <code>volatile</code>, it will cause problem in ARM, are the solutions 1: to use <code>synchronized</code> getter e.g. <code>synchronized void increment() {int temp = getCount(); wait(100); count = temp + 1; }</code> 2. to use <code>volatile</code> keyword to the <code>count</code> attribute?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621333614,"comment_id":119458251,"body":"@Argun cannot reproduce the problem, add a complete <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mimimal reproducible example</a> demonstrating the problem if you want some hint about a possible solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621328813,"comment_id":119456005,"body":"Added Client Class"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621285252,"comment_id":119445065,"body":"@Argun the added part does not tell from where these message are coming from, bottlenecks are possible on the client itself, on the connection, on the datagram processor, please clarify"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621271693,"comment_id":119440006,"body":"Added this part to the question"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/45e3a1431bd08d4f8b1ce609c7924531?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21225504,"user_type":"registered","user_id":15611270,"link":"https://stackoverflow.com/users/15611270/rocco","reputation":1108,"display_name":"Rocco"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"edited":false,"creation_date":1621265049,"comment_id":119437061,"body":"@Argun sorry, I cannot understand what you mean, is the server too slow?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/a7262084269a8efdceb3d74c040bf177?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":21624444,"user_type":"registered","user_id":15948953,"link":"https://stackoverflow.com/users/15948953/argun","reputation":51,"display_name":"Argun"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67569728,"edited":false,"creation_date":1621263243,"comment_id":119436204,"body":"I have a simple client that sends messages once per millisecond, but I receive messages about once every 15 milliseconds"},{"owner":{"profile_image":"https://lh4.googleusercontent.com/-qppNtT-hLks/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pK5M5owjrXVau33ScI3xdldvJyNw/mo/photo.jpg?sz=256","account_id":13982631,"user_type":"registered","user_id":10098446,"link":"https://stackoverflow.com/users/10098446/mohendra-amatya","reputation":381,"display_name":"Mohendra Amatya"},"content_license":"CC BY-SA 4.0","score":0,"post_id":67556264,"edited":false,"creation_date":1621169911,"comment_id":119408724,"body":"So, is there a way to test whether the variable f is 0 (i.e partially initialized), I removed the final from the class A. I only get 42."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dec37b21723a50cb3d4d415149d22fe8?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5240687,"user_type":"registered","user_id":4187837,"link":"https://stackoverflow.com/users/4187837/gavin","reputation":1727,"display_name":"Gavin","accept_rate":86},"content_license":"CC BY-SA 4.0","score":1,"post_id":66471075,"edited":false,"creation_date":1614848320,"comment_id":117511806,"body":"I think in this instance it would be great if you could provide a link to the issue in the appropriate bug tracker"},{"owner":{"profile_image":"https://i.stack.imgur.com/xfXW3.png?s=256&g=1","account_id":8824128,"user_type":"registered","user_id":6592881,"link":"https://stackoverflow.com/users/6592881/sfili-81","reputation":2378,"display_name":"Sfili_81"},"content_license":"CC BY-SA 4.0","score":0,"post_id":66468855,"edited":false,"creation_date":1614845105,"comment_id":117510321,"body":"Add some explanation to your answer"},{"owner":{"profile_image":"https://i.stack.imgur.com/t2hoD.jpg?s=256&g=1","account_id":3211603,"user_type":"registered","user_id":2711488,"link":"https://stackoverflow.com/users/2711488/holger","reputation":289317,"display_name":"Holger"},"content_license":"CC BY-SA 4.0","score":1,"post_id":66458166,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"edited":false,"creation_date":1614784040,"comment_id":117491240,"body":"You are setting a value on a <i>thread local</i> variable. The value will be associated with the thread executing the <code>tl.set(bar);</code> statement. When the main thread executes the statement, the value is associated with the main thread which is still alive afterwards (as it is the thread calling <code>System.gc()</code> in a loop). When a different thread executes the statement, the value will be associated with that particular thread and can be removed when that thread terminates."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2271eda4ebce1e2c9c42a4f705e339c7?s=256&d=identicon&r=PG","account_id":2521751,"user_type":"registered","user_id":2191979,"link":"https://stackoverflow.com/users/2191979/pakira","reputation":1991,"display_name":"Pakira","accept_rate":37},"content_license":"CC BY-SA 4.0","score":0,"post_id":66458166,"edited":false,"creation_date":1614783119,"comment_id":117490713,"body":"Thanks for the details, could you please explain &quot;to stop the value from being associated with the main thread&quot;, is this because New Thread does not have a reference on Main thread?"},{"owner":{"profile_image":"https://i.stack.imgur.com/Gr7qI.jpg?s=256&g=1","account_id":416701,"user_type":"registered","user_id":792238,"link":"https://stackoverflow.com/users/792238/siddhartha","reputation":4306,"display_name":"Siddhartha","accept_rate":87},"content_license":"CC BY-SA 4.0","score":1,"post_id":817911,"edited":false,"creation_date":1591165314,"comment_id":109947697,"body":"This made me curious. <code>&#39;datum&#39; is the singular form and &#39;data&#39; is the plural form. </code>"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-MZrFtPI_zTY/AAAAAAAAAAI/AAAAAAAABq4/bnw-OB7pSQc/photo.jpg?sz=256","account_id":9963171,"user_type":"registered","user_id":8503883,"link":"https://stackoverflow.com/users/8503883/wyskoj","reputation":378,"display_name":"wyskoj"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877104,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/M2hPC.gif?s=256&g=1","account_id":7030407,"user_type":"registered","user_id":6032016,"link":"https://stackoverflow.com/users/6032016/snow","reputation":1058,"display_name":"Snow","accept_rate":69},"edited":false,"creation_date":1552610241,"comment_id":97086864,"body":"@Snow the <code>@Override</code> explicitly states that it is overriding the abstract method in the Thread class."},{"owner":{"profile_image":"https://i.stack.imgur.com/M2hPC.gif?s=256&g=1","account_id":7030407,"user_type":"registered","user_id":6032016,"link":"https://stackoverflow.com/users/6032016/snow","reputation":1058,"display_name":"Snow","accept_rate":69},"content_license":"CC BY-SA 4.0","score":1,"post_id":877104,"edited":false,"creation_date":1525382471,"comment_id":87346018,"body":"why do we need the <code>@Override</code> for?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711094,"comment_id":84626646,"body":"@JeffG actually answered this in the answer below!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1cdd96f59bb81a26d81870ba244215bc?s=256&d=identicon&r=PG","account_id":68986,"user_type":"registered","user_id":200987,"link":"https://stackoverflow.com/users/200987/oligofren","reputation":21295,"display_name":"oligofren","accept_rate":69},"content_license":"CC BY-SA 3.0","score":0,"post_id":39214833,"edited":false,"creation_date":1518711049,"comment_id":84626612,"body":"I actually liked this last example quite well. Reminds me of using a closure in JS to reference variables in the outer scope. But is the <code>this.myParam</code> then really necessary? Couldn&#39;t you just drop the private variables and refer to the variable from the outer scope? I understand (of course) that this has some implications, such as the variable being open to change after starting the thread."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/48c0da7b99e8558e7180f5621573eac2?s=256&d=identicon&r=PG","account_id":37202,"user_type":"registered","user_id":106315,"link":"https://stackoverflow.com/users/106315/jwoolard","reputation":6114,"display_name":"jwoolard","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":877118,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0dd38a06cfe5d6c484b1170461b560e6?s=256&d=identicon&r=PG","account_id":285969,"user_type":"registered","user_id":584947,"link":"https://stackoverflow.com/users/584947/fiwjlxszaphezil","reputation":12256,"display_name":"fIwJlxSzApHEZIl","accept_rate":92},"edited":false,"creation_date":1513705261,"comment_id":82751370,"body":"True, the setter and all access to the parameter should be synchronised."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0dd38a06cfe5d6c484b1170461b560e6?s=256&d=identicon&r=PG","account_id":285969,"user_type":"registered","user_id":584947,"link":"https://stackoverflow.com/users/584947/fiwjlxszaphezil","reputation":12256,"display_name":"fIwJlxSzApHEZIl","accept_rate":92},"content_license":"CC BY-SA 3.0","score":1,"post_id":877118,"edited":false,"creation_date":1507848475,"comment_id":80386674,"body":"Doesn&#39;t adding a setter create potential race conditions? If the thread starts with the variable as one value but the setter changes it mid-execution wouldn&#39;t that be problematic?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6aa466372eb9032019cc31650bf43b44?s=256&d=identicon&r=PG","account_id":1733652,"user_type":"registered","user_id":1586687,"link":"https://stackoverflow.com/users/1586687/deep","reputation":1606,"display_name":"deep","accept_rate":50},"content_license":"CC BY-SA 3.0","score":7,"post_id":817911,"edited":false,"creation_date":1466527059,"comment_id":63348733,"body":"Kudos for using datum instead of data."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465383993,"comment_id":62875576,"body":"That&#39;s how I&#39;ve always developed my apps, however if you don&#39;t wish to make all those changes, other answers might help you get around your issue using the application class. For your future reference, I recommend using the one activity class immediately, and then many fragments. Hope this helps :)"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465383688,"comment_id":62875407,"body":"Okay, so you mean I should abandon the <code>Application</code> object altogether and move all the initialization code to the first <code>Activity</code> ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/WAhD8.png?s=256&g=1","account_id":1129864,"user_type":"registered","user_id":1116216,"link":"https://stackoverflow.com/users/1116216/michele-la-ferla","reputation":6795,"display_name":"Michele La Ferla","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"edited":false,"creation_date":1465382792,"comment_id":62874882,"body":"Why are you extending the application class and not the activity one?"},{"owner":{"profile_image":"https://i.stack.imgur.com/cMTdX.png?s=256&g=1","account_id":3986910,"user_type":"registered","user_id":3287204,"link":"https://stackoverflow.com/users/3287204/yash-sampat","reputation":30181,"display_name":"Yash Sampat","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":37594546,"edited":false,"creation_date":1465277621,"comment_id":62820071,"body":"Thank you for your answer, it was very interesting. However, I believe you misunderstood my question. The problem is not caused by the initializations in the first <code>Activity</code>, but those in the global <code>Application</code> object. And I don&#39;t believe I can apply such a separation of concerns there, because unlike an <code>Activity</code> it only has an <code>onCreate()</code> method."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/422a99817d5df8fce3ed70457ffbe79d?s=256&d=identicon&r=PG","account_id":2409048,"user_type":"registered","user_id":2104648,"link":"https://stackoverflow.com/users/2104648/caelum","reputation":811,"display_name":"Caelum","accept_rate":86},"content_license":"CC BY-SA 3.0","score":11,"post_id":877104,"edited":false,"creation_date":1415297483,"comment_id":42149467,"body":"+1 for showing how to do it extending Thread instead of implementing Runnable."},{"owner":{"profile_image":"https://i.stack.imgur.com/3kCnW.jpg?s=256&g=1","account_id":83658,"user_type":"registered","user_id":234391,"link":"https://stackoverflow.com/users/234391/cornel-masson","reputation":1362,"display_name":"Cornel Masson","accept_rate":57},"content_license":"CC BY-SA 3.0","score":11,"post_id":817911,"edited":false,"creation_date":1406108801,"comment_id":38695149,"body":"Perhaps... It can be useful, though, if you have a huge, existing codebase to which you have to add a new datum that has to be passed around <i>everywhere</i>, e.g. a session context, db transaction, logged-in user, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6483c2f0fcf64b578c55ca0df7e01096?s=256&d=identicon&r=PG","account_id":80364,"user_type":"registered","user_id":227299,"link":"https://stackoverflow.com/users/227299/ruan-mendes","reputation":90939,"display_name":"Ruan Mendes","accept_rate":72},"content_license":"CC BY-SA 3.0","score":13,"post_id":817911,"edited":false,"creation_date":1373580275,"comment_id":25622695,"body":"So you should avoid thread locals the same way you avoid globals. I cannot possibly accept that it&#39;s OK to create globals (thread locals) instead of passing values around, people don&#39;t like because it often reveals architecture problems that they don&#39;t want to fix."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364292853,"comment_id":22180658,"body":"@Ovidiu Latcu agreed. what if the user wants to interact button on the screen, other than publishing update say to the progress bar.This method publishProgress is used to display any form of progress in the user interface while the background computation is still executing. For instance, it can be used to animate a progress bar or show logs in a text field."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364292322,"comment_id":22180396,"body":"you can use <code>publishProgress</code> to update the <code>UI</code> when using an <code>AsyncTask</code>."},{"owner":{"profile_image":"https://i.stack.imgur.com/6qIEl.png?s=256&g=1","account_id":330005,"user_type":"registered","user_id":653856,"link":"https://stackoverflow.com/users/653856/raghunandan","reputation":132780,"display_name":"Raghunandan","accept_rate":100},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"edited":false,"creation_date":1364290742,"comment_id":22179483,"body":"you will be running long operations in doInBackground() andu cannot update ui untill doInBackground finishes, keep the user waiting to interact with ui. Only in onPostExecute() ui is updated and user can interact with ui."},{"owner":{"profile_image":"https://i.stack.imgur.com/Y985l.jpg?s=256&g=1","account_id":259304,"user_type":"registered","user_id":542091,"link":"https://stackoverflow.com/users/542091/ovidiu-latcu","reputation":71887,"display_name":"Ovidiu Latcu","accept_rate":92},"content_license":"CC BY-SA 3.0","score":0,"post_id":15631479,"edited":false,"creation_date":1364285020,"comment_id":22177118,"body":"IDK why you say that AsyncTask should be used for &quot;a few seconds at most&quot;... nevertheless for very long operations it is recommended to use <code>Services</code>."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/add6146aeae299f7241d7733b850e717?s=256&d=identicon&r=PG","account_id":347517,"user_type":"registered","user_id":681671,"link":"https://stackoverflow.com/users/681671/dojo","reputation":5454,"display_name":"Dojo","accept_rate":59},"content_license":"CC BY-SA 2.5","score":0,"post_id":5533219,"edited":false,"creation_date":1301924639,"comment_id":6295543,"body":"Yeah, i did not notice any significant overhead while testing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53f721a451a1c68caf8316cefcde3083?s=256&d=identicon&r=PG","account_id":2017134,"user_type":"registered","user_id":1804173,"link":"https://stackoverflow.com/users/1804173/bluenote10","reputation":24247,"display_name":"bluenote10","accept_rate":77},"content_license":"CC BY-SA 4.0","score":0,"post_id":817926,"edited":false,"creation_date":1691781839,"comment_id":135543258,"body":"I don&#39;t really understand this example: My understanding is that access to an instance only has to be synchronized if mutability is involved. As long as things are immutable, everything is thread safe. Giving each thread its own instance &quot;solves&quot; the problem in the sense that each thread can happily mutate their own instance. But what&#39;s the use case for that? I mainly see use cases for <b>pure immutability</b> or <b>synchronized mutability</b>, and would be curious to understand under which circumstances &quot;diverging mutability&quot; is helpful."},{"owner":{"profile_image":"https://i.stack.imgur.com/DzDIR.jpg?s=256&g=1","account_id":140189,"user_type":"registered","user_id":346309,"link":"https://stackoverflow.com/users/346309/jpm","reputation":9145,"display_name":"JPM","accept_rate":92},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1685024577,"comment_id":134606015,"body":"White window still shows even with this."},{"owner":{"profile_image":"https://i.stack.imgur.com/riCsa.jpg?s=256&g=1","account_id":4675848,"user_type":"registered","user_id":3786226,"link":"https://stackoverflow.com/users/3786226/mc-topaz","reputation":607,"display_name":"Mc_Topaz","accept_rate":83},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1675268093,"comment_id":132892992,"body":"This worked for me. I created a drawable with a blue background. In my theme in the /res/valyes/themes.xml i added the <code>&lt;item name=&quot;android:windowBackground&quot;&gt;@drawable&#47;my_drawable&lt;&#47;item&gt; line.</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53e2e1f2b1c0d69f29505aeb9dfe1832?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":15744638,"user_type":"registered","user_id":11360924,"link":"https://stackoverflow.com/users/11360924/landnbloc","reputation":1028,"display_name":"landnbloc"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1649960919,"comment_id":127012263,"body":"This delayed any screen from opening for the app for around 4 seconds for me. Felt like the app icon was never touched. Run on cheap Samsung Galaxy A02s"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a/AATXAJz0y1sMaJYi2GG8YJ1jEkEE1KHBRcruM2LGurMB=k-s256","account_id":24305399,"user_type":"registered","user_id":18248235,"link":"https://stackoverflow.com/users/18248235/cflowe-visit","reputation":341,"display_name":"Cflowe Visit"},"content_license":"CC BY-SA 4.0","score":0,"post_id":877113,"edited":false,"creation_date":1649098333,"comment_id":126785570,"body":"so it means java didn&#39;t support it normally?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-TmRHUaNDjGI/AAAAAAAAAAI/AAAAAAAABpg/WUC4cyxANRI/photo.jpg?sz=256","account_id":8987793,"user_type":"registered","user_id":6700830,"link":"https://stackoverflow.com/users/6700830/codesinthedark","reputation":151,"display_name":"CodesInTheDark"},"content_license":"CC BY-SA 4.0","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"edited":false,"creation_date":1630084728,"comment_id":121868293,"body":"@KonstantinMilyutin The problem is that Thread does not use WeakReference for values, only for the keys. If a value uses a custom class it will prevent its ClassLoader to be gc-ed and in turn, it will prevent the whole application and its ThreadLocals to be gc-ed because you get a circular reference."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/-_DP3LTfLMXw/AAAAAAAAAAI/AAAAAAAAAHk/dzYHVVdXUnE/photo.jpg?sz=256","account_id":5826102,"user_type":"registered","user_id":4592448,"link":"https://stackoverflow.com/users/4592448/fortran","reputation":2248,"display_name":"Fortran","accept_rate":100},"content_license":"CC BY-SA 4.0","score":2,"post_id":37681189,"edited":false,"creation_date":1624386021,"comment_id":120343518,"body":"best answer, dont foget add to black theme, not only white)"},{"owner":{"profile_image":"https://i.stack.imgur.com/SsTc7.jpg?s=256&g=1","account_id":2305297,"user_type":"registered","user_id":2024692,"link":"https://stackoverflow.com/users/2024692/cromax","reputation":1882,"display_name":"Cromax","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":54241038,"edited":false,"creation_date":1615620045,"comment_id":117752140,"body":"But you actually made a new class — it&#39;s just anonymous class. :-) On the other hand it&#39;s exactly the same approach as in solution no.1 in <a href=\"https://stackoverflow.com/a/39214833/2024692\">stackoverflow.com/a/39214833/2024692</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/LXMHI.png?s=256&g=1","account_id":15515017,"user_type":"registered","user_id":11192811,"link":"https://stackoverflow.com/users/11192811/rajnish-sharma","reputation":390,"display_name":"Rajnish Sharma"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"edited":false,"creation_date":1611765220,"comment_id":116557330,"body":"Just remove the bitmap and use this instead : <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;layer-list xmlns:android=&quot;http:&#47;&#47;schemas.android.com&#47;apk&#47;res&#47;android&quot;&gt;     &lt;item         android:drawable=&quot;@color&#47;black&quot;&#47;&gt;     &lt;item         android:drawable=&quot;@mipmap&#47;ic_launcher_round&quot;         android:gravity=&quot;center&quot;&#47;&gt; &lt;&#47;layer-list&gt;</code>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/44288d0ab21eb3318b526a6c50028685?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":7900776,"user_type":"registered","user_id":5967872,"link":"https://stackoverflow.com/users/5967872/kyl3r","reputation":3946,"display_name":"KYL3R"},"content_license":"CC BY-SA 4.0","score":0,"post_id":49254344,"reply_to_user":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"edited":false,"creation_date":1609595487,"comment_id":115873214,"body":"Hey @JeremLachkar - I got the same error, but solved it. &lt;bitmap&gt; cannot load xml icons / vectors (at that time?) but using PNGs worked for me!"},{"owner":{"profile_image":"https://i.stack.imgur.com/QIkTb.png?s=256&g=1","account_id":4366153,"user_type":"registered","user_id":3561889,"link":"https://stackoverflow.com/users/3561889/ucdemir","reputation":2931,"display_name":"Ucdemir","accept_rate":59},"content_license":"CC BY-SA 4.0","score":3,"post_id":57090517,"edited":false,"creation_date":1609260073,"comment_id":115793457,"body":"I test and still white screen there"},{"owner":{"profile_image":"https://i.stack.imgur.com/OWvGv.jpg?s=256&g=1","account_id":14035474,"user_type":"registered","user_id":10138295,"link":"https://stackoverflow.com/users/10138295/thenameisviru","reputation":13,"display_name":"TheNameIsViRu"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65396071,"edited":false,"creation_date":1609153489,"comment_id":115759699,"body":"Thank you @emandt for your reply. I used recursion concept for API request call."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/bffea7de598020c514bdca3b0239d865?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8509289,"user_type":"registered","user_id":6379785,"link":"https://stackoverflow.com/users/6379785/gmetal","reputation":2918,"display_name":"gmetal"},"content_license":"CC BY-SA 4.0","score":1,"post_id":37718830,"edited":false,"creation_date":1608648341,"comment_id":115643334,"body":"Setting <code>android:windowDisablePreview</code> will remove the white screen on startup by not showing anything. Therefore, if during your app initialisation you are doing a lot of things (e.g. initialising external services) then your app will appear to hang (which it does not). The most appropriate solution is setting a custom <code>android:windowBackground</code>. In reality, the white screen at startup is just the default windowBackground that you are seeing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/166994c436c6a1d69ee7af86f727d57f?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":14704600,"user_type":"registered","user_id":10619713,"link":"https://stackoverflow.com/users/10619713/jakob-tinhofer","reputation":345,"display_name":"Jakob Tinhofer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"edited":false,"creation_date":1608579497,"comment_id":115622058,"body":"No problem, always glad to help!"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65395539,"edited":false,"creation_date":1608575148,"comment_id":115620417,"body":"Thanks for your time, I&#39;ll definitely try it out tomorrow"},{"owner":{"profile_image":"https://i.stack.imgur.com/Sotq0.jpg?s=256&g=1","account_id":15358913,"user_type":"registered","user_id":11080429,"link":"https://stackoverflow.com/users/11080429/jens","reputation":17,"display_name":"Jens"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65391726,"edited":false,"creation_date":1608557328,"comment_id":115612203,"body":"Omg, I&#39;ve been busy solving this problem for so long. Your help me with &#39;Platform.runLater (new Runnable ()&#39; a lot and it works now. I have added this to my run() in the MyTask Class <code>Platform.runLater (new Runnable () { @Override public void run () { text.set (Integer.toString (counter)); }});</code>                                          Thank you very much"},{"owner":{"profile_image":"https://i.stack.imgur.com/DLHqU.png?s=256&g=1","account_id":1223835,"user_type":"registered","user_id":1189885,"link":"https://stackoverflow.com/users/1189885/chrylis-cautiouslyoptimistic","reputation":75888,"display_name":"chrylis -cautiouslyoptimistic-","accept_rate":43},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"reply_to_user":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"edited":false,"creation_date":1608349885,"comment_id":115563769,"body":"@Rafay You accepted an answer, which is the Stack Overflow version of marking it resolved. You don&#39;t need to do anything more."},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333585,"comment_id":115561235,"body":"Can I close the question if i don&#39;t need the answer anymore? Or mark it resolved/answered?"},{"owner":{"profile_image":"https://lh3.googleusercontent.com/a-/AOh14GgmDcOPe-PSi6MlH5RQWtXSMao69bzFfbn6ipupXSY=k-s256","account_id":18432688,"user_type":"registered","user_id":13427401,"link":"https://stackoverflow.com/users/13427401/rafay","reputation":92,"display_name":"Rafay"},"content_license":"CC BY-SA 4.0","score":0,"post_id":65363616,"edited":false,"creation_date":1608333542,"comment_id":115561217,"body":"I read more about happens-before and find out I don&#39;t need AtomicReference in my code. Also in my real code, i am using ExecutorService to assign tasks. I reorg&#39;d my code and gotten rid of AtomicReference all-together. Thanks for explanation."},{"owner":{"profile_image":"https://graph.facebook.com/1257600928/picture?type=large","account_id":5705147,"user_type":"registered","user_id":4508962,"link":"https://stackoverflow.com/users/4508962/jerem-lachkar","reputation":1019,"display_name":"Jerem Lachkar"},"content_license":"CC BY-SA 4.0","score":1,"post_id":49254344,"edited":false,"creation_date":1604422253,"comment_id":114340412,"body":"looks promising, but Android says at runtime &quot;Binary XML file line #7: &lt;bitmap&gt; requires a valid &#39;src&#39; attribute&quot;. Maybe the drawables are not loaded so early in the app launch process ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b3c046745a2523e02497f69fae887460?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":10453530,"user_type":"registered","user_id":7706354,"link":"https://stackoverflow.com/users/7706354/lava","reputation":6345,"display_name":"lava"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1603808538,"comment_id":114150018,"body":"nice solution .I saw a app .but it was a loading screen . i thought .how they achieve it .i look it into youtube .they also white screen with youtube icon.now i found it this it"},{"owner":{"profile_image":"https://i.stack.imgur.com/eMjQ1.jpg?s=256&g=1","account_id":1482742,"user_type":"registered","user_id":6680585,"link":"https://stackoverflow.com/users/6680585/tom-taylor","reputation":3434,"display_name":"Tom Taylor","accept_rate":84},"content_license":"CC BY-SA 4.0","score":0,"post_id":64406380,"edited":false,"creation_date":1603002786,"comment_id":113894433,"body":"If possible attach the geeksforgeeks link too."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4287ab180a9b6483865a60e4b68ca9d8?s=256&d=identicon&r=PG","account_id":143382,"user_type":"registered","user_id":351688,"link":"https://stackoverflow.com/users/351688/a-w","reputation":2912,"display_name":"A.W.","accept_rate":91},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1602913733,"comment_id":113875884,"body":"This works for me in Android Studio 4.1, tested on a real device"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8bea1f01a8f41b0714de4eddc3c93ce8?s=256&d=identicon&r=PG","account_id":11180480,"user_type":"registered","user_id":8207228,"link":"https://stackoverflow.com/users/8207228/ralf-kleberhoff","reputation":7021,"display_name":"Ralf Kleberhoff"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601534733,"comment_id":113439134,"body":"At Stackoverflow we can&#39;t replace a good tutorial. Threads are covered e.g. in <a href=\"https://docs.oracle.com/javase/tutorial/essential/concurrency/procthread.html\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/tutorial/essential/concurrency/&hellip;</a>. Work through that tutorial, and if things are still unclear after that, you&#39;re welcome to come back to us."},{"owner":{"user_type":"does_not_exist","display_name":"user11473537"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141295,"edited":false,"creation_date":1601487800,"comment_id":113426579,"body":"How should I go about creating a thread? And when I do this, do I just plug it in to the parenthesis of ColumnCalculator()?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/f914cd02166793195d9d950503f8f739?s=256&d=identicon&r=PG","account_id":1352170,"user_type":"registered","user_id":1291492,"link":"https://stackoverflow.com/users/1291492/controlaltdel","reputation":34246,"display_name":"ControlAltDel","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":64141533,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"edited":false,"creation_date":1601486881,"comment_id":113426160,"body":"@SolomonSlow Good point."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/964b3f08a9f4f4b76d14b5eb33190038?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":4501201,"user_type":"registered","user_id":3659670,"link":"https://stackoverflow.com/users/3659670/conffusion","reputation":4375,"display_name":"Conffusion"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"edited":false,"creation_date":1601466476,"comment_id":113415837,"body":"That is not possible as it will only print from 0 to 2. My output was: 0,2,1,1,0,2. And the second time: 0,2,1,0,1,2"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/d401b677f03e93a3766597a08ef9e098?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":19098043,"user_type":"registered","user_id":13946904,"link":"https://stackoverflow.com/users/13946904/jeb","reputation":447,"display_name":"Jeb"},"content_license":"CC BY-SA 4.0","score":0,"post_id":64135639,"edited":false,"creation_date":1601463501,"comment_id":113414430,"body":"This program also printing the same <code>01230123</code> is the output, means it is not executing simultaneously"},{"owner":{"profile_image":"https://i.stack.imgur.com/av9Qt.jpg?s=256&g=1","account_id":13442905,"user_type":"registered","user_id":9699634,"link":"https://stackoverflow.com/users/9699634/vikas-gutte","reputation":1666,"display_name":"VikaS GuttE"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"edited":false,"creation_date":1600614412,"comment_id":113136923,"body":"Prefect solution working for me (<code>compileSdkVersion 30</code>). Thank you!"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-Toy7JJFRdP8/AAAAAAAAAAI/AAAAAAAAAro/14UEMAKHESo/photo.jpg?sz=256","account_id":13406308,"user_type":"registered","user_id":9674249,"link":"https://stackoverflow.com/users/9674249/i30mb1","reputation":4142,"display_name":"i30mb1"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37679026,"edited":false,"creation_date":1600254943,"comment_id":113028146,"body":"nice value <code>animationStarted</code> that you never change"},{"owner":{"profile_image":"https://i.stack.imgur.com/QEyD7.jpg?s=256&g=1","account_id":3806533,"user_type":"registered","user_id":3158802,"link":"https://stackoverflow.com/users/3158802/rupam-das","reputation":403,"display_name":"Rupam Das"},"content_license":"CC BY-SA 4.0","score":0,"post_id":37718830,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"edited":false,"creation_date":1597069443,"comment_id":112005701,"body":"@Faakhir So did you find any solution? I am still looking a solution, which remove this white screen and also there&#39;s no delay at launching time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/de979476f21ed488c4be02f10dd8e2cc?s=256&d=identicon&r=PG","account_id":134590,"user_type":"registered","user_id":336827,"link":"https://stackoverflow.com/users/336827/freedev","reputation":26825,"display_name":"freedev","accept_rate":61},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1593511507,"comment_id":110800726,"body":"the parameter -Djdk.tls.disabledAlgorithms=TLSv1.3 does not work"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/e21783a690b300752aceb0db57946012?s=256&d=identicon&r=PG","account_id":493787,"user_type":"registered","user_id":905640,"link":"https://stackoverflow.com/users/905640/markus","reputation":6348,"display_name":"markus","accept_rate":78},"content_license":"CC BY-SA 4.0","score":3,"post_id":54655885,"edited":false,"creation_date":1591261970,"comment_id":109990571,"body":"I see the same problem also with OpenJDK 11.0.6"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":40197569,"edited":false,"creation_date":1588241389,"comment_id":108825786,"body":"This code will spin mindlessly if the condition is false At least add a sleep into it. The point of having two tests escapes me."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 4.0","score":0,"post_id":61520614,"edited":false,"creation_date":1588241320,"comment_id":108825750,"body":"Doesn&#39;t answer the question that was asked in any way. Do read the question before answering."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/99266f63196c82aaeb18e36727424c07?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3869264,"user_type":"registered","user_id":3204950,"link":"https://stackoverflow.com/users/3204950/rameshvanka","reputation":51,"display_name":"rameshvanka"},"content_license":"CC BY-SA 4.0","score":0,"post_id":36420786,"edited":false,"creation_date":1583690106,"comment_id":107193590,"body":"please refer my blog: <a href=\"https://rameshvanka.blogspot.com/2020/03/excel-with-multi-threaded-way.html\" rel=\"nofollow noreferrer\">rameshvanka.blogspot.com/2020/03/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/6c2dd6a39d3f38f1bb47a8c1fe8325e2?s=256&d=identicon&r=PG","account_id":18868,"user_type":"registered","user_id":43681,"link":"https://stackoverflow.com/users/43681/sleske","reputation":82004,"display_name":"sleske","accept_rate":70},"content_license":"CC BY-SA 4.0","score":3,"post_id":33116773,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"edited":false,"creation_date":1579880483,"comment_id":105926418,"body":"@SaptarshiBasu: As discussed in the linked question <a href=\"http://stackoverflow.com/questions/24700798/is-jax-rs-client-thread-safe\">Is JAX-RS Client Thread Safe</a>, unfortunately the spec does not require <code>Client</code> to be thread safe. In some implementations it is (e.g. in Jersey, I believe), in others it is not (e.g. Apache CXF)."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/83b2bbbdc0f34ed6148dab188c6bb987?s=256&d=identicon&r=PG","account_id":367746,"user_type":"registered","user_id":714112,"link":"https://stackoverflow.com/users/714112/sridhar-sarnobat","reputation":24129,"display_name":"Sridhar Sarnobat","accept_rate":80},"content_license":"CC BY-SA 4.0","score":1,"post_id":48020642,"edited":false,"creation_date":1568405101,"comment_id":102276985,"body":"Finally a way to do it without those annoying fields. Now I just need to wait for my product to upgrade to Java 8."},{"owner":{"profile_image":"https://i.stack.imgur.com/ncQ0v.jpg?s=256&g=1","account_id":3023551,"user_type":"registered","user_id":2564032,"link":"https://stackoverflow.com/users/2564032/vasif","reputation":688,"display_name":"Vasif"},"content_license":"CC BY-SA 4.0","score":1,"post_id":817926,"edited":false,"creation_date":1565716109,"comment_id":101436153,"body":"but this solution has own problem like your objects are still exist on ThreadPool and it can cause OOM issue if you are going to store different objects in ThreadLocal and your application get a lot of requests.  I saw it as a solution for passing object to other methods without passing it as a parameter. So u can pu object in ThreadLocal and then remove it in finally to clear it up."},{"owner":{"profile_image":"https://i.stack.imgur.com/XpMUU.jpg?s=256&g=1","account_id":1431364,"user_type":"registered","user_id":1353722,"link":"https://stackoverflow.com/users/1353722/lefloh","reputation":10713,"display_name":"lefloh","accept_rate":81},"content_license":"CC BY-SA 4.0","score":0,"post_id":33116773,"edited":false,"creation_date":1563874533,"comment_id":100836191,"body":"Could you please prove this with e.g. a link to the documentation?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7654f9d9e0ffaa1d4972cccb20861377?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5847132,"user_type":"registered","user_id":4606939,"link":"https://stackoverflow.com/users/4606939/prnjn","reputation":386,"display_name":"prnjn","accept_rate":92},"content_license":"CC BY-SA 4.0","score":3,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1559122084,"comment_id":99318469,"body":"@Robin answer doesn&#39;t have to be exactly what the other person said, if something is already said then additional information is more valuable than writing the same thing over again. And here the answer holds quality and important information."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9da43a7cb4f685c3db616ad144f5de69?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":5428620,"user_type":"registered","user_id":4320184,"link":"https://stackoverflow.com/users/4320184/dashenswen","reputation":560,"display_name":"dashenswen","accept_rate":12},"content_license":"CC BY-SA 4.0","score":0,"post_id":32122972,"edited":false,"creation_date":1556167088,"comment_id":98346639,"body":"I still didn&#39;t see the benefit of using ThreadLocal to generate the unique id in example one if all your purpose is to return an incremental unique integer value.   ```  public class ThreadId {      // Atomic integer containing the next thread ID to be assigned      private static final AtomicInteger nextId = new AtomicInteger(0);       // Returns the current thread&#39;s unique ID, assigning it if necessary      public static int get() {          return nextId..getAndIncrement();      }  } ```"},{"owner":{"profile_image":"https://i.stack.imgur.com/FbWEX.png?s=256&g=1","account_id":2616549,"user_type":"registered","user_id":2265497,"link":"https://stackoverflow.com/users/2265497/slesh","reputation":1922,"display_name":"slesh","accept_rate":41},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1553257457,"comment_id":97327392,"body":"Disabling TLS 1.3 doesn&#39;t work - <a href=\"https://stackoverflow.com/questions/55298459/java-11-httpclient-leads-to-endless-ssl-loop-even-with-disabled-tlsv-1-3\" title=\"java 11 httpclient leads to endless ssl loop even with disabled tlsv 1 3\">stackoverflow.com/questions/55298459/&hellip;</a>"},{"owner":{"profile_image":"https://i.stack.imgur.com/RDWxl.png?s=256&g=1","account_id":4342327,"user_type":"registered","user_id":3545273,"link":"https://stackoverflow.com/users/3545273/serge-ballesta","reputation":145474,"display_name":"Serge Ballesta","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":24721873,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/dc91a8e29fedbd6a6d7e03a8394009ab?s=256&d=identicon&r=PG","account_id":75804,"user_type":"registered","user_id":217324,"link":"https://stackoverflow.com/users/217324/nathan-hughes","reputation":94840,"display_name":"Nathan Hughes","accept_rate":96},"edited":false,"creation_date":1551106477,"comment_id":96508170,"body":"It is a rather old question, but I could remember what it was about. I said it should never be done again, because it is a recipe for building deadlocks..."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":2,"post_id":54485918,"edited":false,"creation_date":1549987007,"comment_id":96099623,"body":"Just found out that even with <code>-Djdk.tls.disabledAlgorithms=TLSv1.3</code> the client still uses TLS v1.3"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549676532,"comment_id":96000901,"body":"Oh interesting Zarathustra."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":1,"post_id":54485918,"edited":false,"creation_date":1549620385,"comment_id":95976355,"body":"Disabling TLS 1.3 did not help :/"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=256&d=identicon&r=PG","account_id":84127,"user_type":"registered","user_id":235354,"link":"https://stackoverflow.com/users/235354/jspcal","reputation":51115,"display_name":"jspcal"},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"edited":false,"creation_date":1549051688,"comment_id":95779683,"body":"Interesting link. Thanks."},{"owner":{"profile_image":"https://i.stack.imgur.com/K5WPD.jpg?s=256&g=1","account_id":1298254,"user_type":"registered","user_id":1248724,"link":"https://stackoverflow.com/users/1248724/zarathustra","reputation":2903,"display_name":"Zarathustra","accept_rate":67},"content_license":"CC BY-SA 4.0","score":0,"post_id":54485918,"edited":false,"creation_date":1549051585,"comment_id":95779623,"body":"Thought about TLS 1.3 issues too ... maybe its this bug here <a href=\"https://bugs.openjdk.java.net/browse/JDK-8207009\" rel=\"nofollow noreferrer\">bugs.openjdk.java.net/browse/JDK-8207009</a> - not sure if it is fixed in my version"},{"owner":{"profile_image":"https://i.stack.imgur.com/VEUms.jpg?s=256&g=1","account_id":1282025,"user_type":"registered","user_id":1235935,"link":"https://stackoverflow.com/users/1235935/saptarshi-basu","reputation":8760,"display_name":"Saptarshi Basu","accept_rate":88},"content_license":"CC BY-SA 4.0","score":7,"post_id":33116773,"edited":false,"creation_date":1547577262,"comment_id":95236529,"body":"This is incorrect. <code>Client</code> is meant to be shared. That&#39;s why the client implementation class have volatile variables. <code>WebTarget</code> is not thread safe."},{"owner":{"profile_image":"https://i.stack.imgur.com/cE9IP.png?s=256&g=1","account_id":4928931,"user_type":"registered","user_id":3969362,"link":"https://stackoverflow.com/users/3969362/slion","reputation":2728,"display_name":"Slion"},"content_license":"CC BY-SA 4.0","score":2,"post_id":44430166,"edited":false,"creation_date":1533239999,"comment_id":90285977,"body":"That works great for me on a NativeActivity OpenGL application. I&#39;m not sure why this is not higher up in the answers as it is the most complete and expedient answer. No Java involved just a couple of XML file changes."},{"owner":{"profile_image":"https://lh6.googleusercontent.com/--S24vwJjcPU/AAAAAAAAAAI/AAAAAAAAAdA/ZMh1tx27y1A/photo.jpg?sz=256","account_id":5910560,"user_type":"registered","user_id":4650969,"link":"https://stackoverflow.com/users/4650969/midhilaj","reputation":4935,"display_name":"Midhilaj","accept_rate":0},"content_license":"CC BY-SA 4.0","score":4,"post_id":37718830,"edited":false,"creation_date":1531757857,"comment_id":89704563,"body":"grate now it is not showing #ffffff color but it is now showing #000000"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51310395,"edited":false,"creation_date":1531458661,"comment_id":89611864,"body":"Exactly the same issue: jstack without the mixed mode flag is running fine. But i&#39;m using Oracle jdk 1.8.0_172."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/b94f53a1a380088d443c247a40760efb?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":13234323,"user_type":"registered","user_id":9556897,"link":"https://stackoverflow.com/users/9556897/chrempl","reputation":91,"display_name":"chrempl"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51305417,"edited":false,"creation_date":1531399936,"comment_id":89588974,"body":"Thank you for the hint. I&#39;m using the jstack of the jvm which runs the process."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":1,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530084564,"comment_id":89104213,"body":"@DavidStuder Hmmm. I would say that in your example both threads are properly terminated. In that case the application (the Java VM) should also terminate."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083998,"comment_id":89103907,"body":"@daniu Well did not understand it that way. But I am sure that the <code>OwnThread#run</code> is terminated properly and that the <code>main</code> thread causes the issue."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"edited":false,"creation_date":1530083680,"comment_id":89103744,"body":"@DavidStuder He&#39;s saying your <code>OwnThread#run</code> method doesn&#39;t finish IIUC."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083527,"comment_id":89103659,"body":"@Seelenvirtuose I think you are right, the <b>main thread</b> is still running and doing something, but I don&#39;t know what or why. There is simply no other code than calling the self-made thread and as already mentioned, debugging the <code>main</code> method leads to this <code>exit()</code>-method, which really should <b>terminate</b> the main thread as I see it."},{"owner":{"profile_image":"https://i.stack.imgur.com/f4hTe.jpg?s=256&g=1","account_id":13723126,"user_type":"registered","user_id":9902575,"link":"https://stackoverflow.com/users/9902575/david-studer","reputation":105,"display_name":"David Studer"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530083365,"comment_id":89103583,"body":"@Seelenvirtuose Thank you very much for your explanation. It really helps to understand it a little bit better, but still I do not understand my case."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":2,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530083123,"comment_id":89103454,"body":"@daniu Well ... This is because one thread is terminated: the main thread! I still speak about my example. I think, OPs problem is vice versa. The main thread is still running but the other thread terminated. That means that the main thread is still doing something."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082995,"comment_id":89103380,"body":"OP does state he found out that &quot;the last called method is the exit()-method of the Thread-class&quot; when debugging though."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/7d4357beb6de2712b6b2171ebe4c499b?s=256&d=identicon&r=PG","account_id":3023214,"user_type":"registered","user_id":2563754,"link":"https://stackoverflow.com/users/2563754/seelenvirtuose","reputation":20361,"display_name":"Seelenvirtuose"},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"edited":false,"creation_date":1530082688,"comment_id":89103245,"body":"@daniu It is running because it is <i>not</i> terminated (or exited as you say)."},{"owner":{"profile_image":"https://i.stack.imgur.com/AEHnE.png?s=256&g=1","account_id":3380632,"user_type":"registered","user_id":2837741,"link":"https://stackoverflow.com/users/2837741/daniu","reputation":14294,"display_name":"daniu","accept_rate":100},"content_license":"CC BY-SA 4.0","score":0,"post_id":51056168,"edited":false,"creation_date":1530082601,"comment_id":89103190,"body":"But why is the other thread still running if it has been <code>exit</code>ed?"},{"owner":{"profile_image":"https://i.stack.imgur.com/N4fsQ.jpg?s=256&g=1","account_id":1430389,"user_type":"registered","user_id":1352919,"link":"https://stackoverflow.com/users/1352919/fakhar","reputation":3996,"display_name":"Fakhar"},"content_license":"CC BY-SA 3.0","score":43,"post_id":37718830,"edited":false,"creation_date":1521288616,"comment_id":85673078,"body":"It hang application for 2 sec and then application launch, not useful for me!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2e814c6b5e0dd56c34931b48c5621269?s=256&d=identicon&r=PG","account_id":2080635,"user_type":"registered","user_id":1852693,"link":"https://stackoverflow.com/users/1852693/dexter","reputation":4105,"display_name":"Dexter","accept_rate":71},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1521135579,"comment_id":85614052,"body":"This is the best explanation of the use of TL."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/40e56e654d3ff1a9a228a00d4f5b1d05?s=256&d=identicon&r=PG","account_id":344283,"user_type":"registered","user_id":676506,"link":"https://stackoverflow.com/users/676506/rick-rainer-ludwig","reputation":2371,"display_name":"Rick-Rainer Ludwig","accept_rate":74},"content_license":"CC BY-SA 3.0","score":2,"post_id":47562423,"edited":false,"creation_date":1517999648,"comment_id":84320427,"body":"In this example is a major issue: Who is responsible for the closing the connection? Instead of creating this connection as initiali value, let the consumer of the connection create the connection explicitly and bind it to the thread via ThreadLocal. The creator of the connection is then also responsbible for closing. This is not clear in this example. Creating and binding the connection can also be hidden in a simple framework by something like Transaction.begin() and Transaction.end()."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505906040,"comment_id":79601684,"body":"You&#39;re right. I&#39;ve probably stumbled upon several misuses of <code>ThreadLocal</code>, where it was accessible globally. As you said, it can still be used as a class field limiting the visibility."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505904944,"comment_id":79601012,"body":"It can simply be a part of object state, doesn&#39;t have to be used globally. Sure, you get little bit overhead, but if multiple objects have to have different state per thread, you can use <code>ThreadLocal</code> as object field..."},{"owner":{"profile_image":"https://i.stack.imgur.com/miNqr.jpg?s=256&g=1","account_id":4324639,"user_type":"registered","user_id":3531794,"link":"https://stackoverflow.com/users/3531794/dimos","reputation":8470,"display_name":"Dimos"},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505897515,"comment_id":79596152,"body":"It is a form of global state, in the sense that it&#39;s accessible from anywhere in the code (in the same thread&#39;s context). This comes with all the repercussions, such as not being able to reason about who reads and writes this value. Using a function parameter is not a retarded thing, it&#39;s a good practice promoting clean interfaces. However, I agree with you that passing a parameter across the whole depth of your codebase is a code smell. But, I also believe that in many occasions the use of ThreadLocal is a code smell in the first place which led you here, so this what one should reconsider."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":0,"post_id":46253405,"edited":false,"creation_date":1505893607,"comment_id":79593705,"body":"ThreadLocals are NOT global state unless you make it global state. They are practically always accessible stack resource. You can simulate thread local with simply passing that variable in all your methods (which is retarded); that doesn&#39;t make it global state..."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893375,"comment_id":79593571,"body":"@Pacerier why would you need any synchronization with <code>ThreadLocal</code>?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":2,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"edited":false,"creation_date":1505893190,"comment_id":79593462,"body":"@Pacerier how is member variable related? He was talking about local variable, which means every method call, new <code>SimpleDateFormat</code> would be created, which is a waste. Thread local is much better because it is flexible and memory &quot;leak&quot; is hardly noticeable and can be managed when thread is destroyed anyways. Member variable <code>SimpleDateFormat</code> is bad because it is not thread safe!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":2,"post_id":820131,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"edited":false,"creation_date":1505847274,"comment_id":79577539,"body":"@JeremyStein, The better answers are at <a href=\"https://stackoverflow.com/a/817911/632951\">stackoverflow.com/a/817911/632951</a> and <a href=\"https://stackoverflow.com/a/17398338/632951\">stackoverflow.com/a/17398338/632951</a> and <a href=\"https://stackoverflow.com/a/818364/632951\">stackoverflow.com/a/818364/632951</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":820131,"edited":false,"creation_date":1505845648,"comment_id":79576630,"body":"@Esko, In your project, your use of ThreadLocal in hashcode and equals is unneeded. A better approach is to create or pass a reference to a hashcode/equals function whenever it is needed. This way, you can completely avoid the need for ThreadLocal hack."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"edited":false,"creation_date":1505839955,"comment_id":79573846,"body":"@Enerccio, Dude, a member variable in the context of each object instance. It can be accessible from all method calls."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/77f196f4d3b4b89fc179071f3aa21e1e?s=256&d=identicon&r=PG","account_id":316665,"user_type":"registered","user_id":632951,"link":"https://stackoverflow.com/users/632951/pacerier","reputation":87011,"display_name":"Pacerier","accept_rate":83},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"edited":false,"creation_date":1505839879,"comment_id":79573796,"body":"@AlexanderRyzhov, A thread-safe alternative is an even higher price to pay since you need to pay synchronization overhead on every method call. Use a local variable instead."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":1,"post_id":37679026,"edited":false,"creation_date":1494668971,"comment_id":74934880,"body":"I solved this issue by animating between themes and changing the theme with no drawable but just the back color same and then on onWindowFocusChanged() mad the content visible and the animated it other wise my whited down between the transition as well. animation of themes helped alot"},{"owner":{"profile_image":"https://i.stack.imgur.com/GGyFL.jpg?s=256&g=1","account_id":7201903,"user_type":"registered","user_id":5498855,"link":"https://stackoverflow.com/users/5498855/ivan-milisavljevic","reputation":2058,"display_name":"Ivan Milisavljevic"},"content_license":"CC BY-SA 3.0","score":0,"post_id":37679026,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"edited":false,"creation_date":1494533092,"comment_id":74882435,"body":"This is straight forward implementation. There could be some other parts of your code that  causing the issue. Please open another question and il be there to help you:)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c672d1c210c7973f988c33fd7903beac?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8677847,"user_type":"registered","user_id":6494749,"link":"https://stackoverflow.com/users/6494749/mehvish-ali","reputation":732,"display_name":"Mehvish Ali","accept_rate":42},"content_license":"CC BY-SA 3.0","score":5,"post_id":37679026,"edited":false,"creation_date":1494501426,"comment_id":74860894,"body":"it didnt help still white screen and animation at end"},{"owner":{"profile_image":"https://lh6.googleusercontent.com/-zysTsphgh80/AAAAAAAAAAI/AAAAAAAAACM/Q2h-OaaX0mA/photo.jpg?sz=256","account_id":8179843,"user_type":"registered","user_id":6157415,"link":"https://stackoverflow.com/users/6157415/mike-d3vid-tyson","reputation":1731,"display_name":"Mike D3ViD Tyson"},"content_license":"CC BY-SA 3.0","score":0,"post_id":43630459,"edited":false,"creation_date":1493203026,"comment_id":74311442,"body":"probably the error is here :  \t\t[...]<code>List&lt;?&gt; results = List.class.cast(payload.get(&quot;result&quot;)); \t\t \t\tresults.remove(0); \t\tresults.remove(0); \t\tresults.remove(results.size()-1); \t\tresults.remove(results.size()-1); </code>[...]"},{"owner":{"profile_image":"https://i.stack.imgur.com/n93hU.png?s=256&g=1","account_id":281630,"user_type":"registered","user_id":578046,"link":"https://stackoverflow.com/users/578046/saurabh-patil","reputation":4230,"display_name":"Saurabh Patil","accept_rate":45},"content_license":"CC BY-SA 3.0","score":20,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"edited":false,"creation_date":1485415179,"comment_id":70919029,"body":"@Robin: I disagree. The question is about how to use ThreadLocal correctly, to get a complete understanding of any concept (ThreadLocal here) it&#39;s also important to understand how not to use it and the risks of using it carelessly, and that is what Phil&#39;s answer is about. I&#39;m glad he covered that point which isn&#39;t covered in any other answers. All those votes are well deserved. I believe SO should build understanding of concepts rather than just being a QA site."},{"owner":{"profile_image":"https://i.stack.imgur.com/Fq5PZ.jpg?s=256&g=1","account_id":188706,"user_type":"registered","user_id":427598,"link":"https://stackoverflow.com/users/427598/konstantin-milyutin","reputation":12106,"display_name":"Konstantin Milyutin","accept_rate":65},"content_license":"CC BY-SA 3.0","score":4,"post_id":818120,"edited":false,"creation_date":1477492859,"comment_id":67790858,"body":"I believe the answer is not relevant anymore, because <code>Thread</code> uses <code>WeakReference&lt;ThreadLocal&gt;</code>. So when the associated <code>ThreadLocal</code> is <code>gc</code>&#39;ed, the Map will also remove stale values during next rehashing."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477175443,"comment_id":67661162,"body":"Solution provided by me also stops the ServerSocket from .accept()ing incoming connections. <b>The point is that the socket on the <i>client side</i> is still created without any exception. Why does it happen, when the ServerSocket didn&#39;t accept the connection?</b>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/4301e2847b861058706df775f913e02d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8829249,"user_type":"registered","user_id":6596346,"link":"https://stackoverflow.com/users/6596346/paul","reputation":96,"display_name":"paul","accept_rate":40},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"edited":false,"creation_date":1477174745,"comment_id":67661022,"body":"If you read the loop condition after the maximum number of clients is reached the server will simply stop listening for further connections and ultimately clients will not be able to connect"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c551b230c2f77d087c7bda85d8b20736?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":8851961,"user_type":"registered","user_id":6637207,"link":"https://stackoverflow.com/users/6637207/mordowiciel","reputation":91,"display_name":"mordowiciel","accept_rate":25},"content_license":"CC BY-SA 3.0","score":0,"post_id":40197569,"edited":false,"creation_date":1477174528,"comment_id":67660965,"body":"Okay, but the problem still remains the same. The socket on the client side is still created without any problems, even despite the fact that the connection was not accepted by the server. I&#39;m looking for a method to check if the server commited server.accept() action."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/26fcfa6386864df2897f9bcb8b47f190?s=256&d=identicon&r=PG","account_id":2199682,"user_type":"registered","user_id":1944408,"link":"https://stackoverflow.com/users/1944408/user1944408","reputation":569,"display_name":"user1944408","accept_rate":67},"content_license":"CC BY-SA 3.0","score":4,"post_id":817926,"edited":false,"creation_date":1469632844,"comment_id":64620156,"body":"Just be careful not to use double brace initialization for your SimpleDateFormat because that would create an anonymous class so your class loader could not be garbage collected. memory leak: return new SimpleDateFormat(){{applyPattern(&quot;yyyyMMdd HHmm&quot;)}};"},{"owner":{"profile_image":"https://i.stack.imgur.com/XiFZh.jpg?s=256&g=1","account_id":1542133,"user_type":"registered","user_id":1955871,"link":"https://stackoverflow.com/users/1955871/rob","reputation":6317,"display_name":"Rob","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"edited":false,"creation_date":1469544726,"comment_id":64574551,"body":"@YordanBoev As I mentioned in the answer, you should figure out what the Finalizer thread is doing. Taking a series of thread dumps (or pausing that thread in the debugger) and seeing what that particular thread is doing, whether it is making progress, usually observed running a particular class&#39; finalize method, waiting for a lock, etc."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/13b795c9e892a69081296d7c2a08a77f?s=256&d=identicon&r=PG","account_id":3216824,"user_type":"registered","user_id":2715285,"link":"https://stackoverflow.com/users/2715285/yordan-boev","reputation":311,"display_name":"Yordan Boev"},"content_license":"CC BY-SA 3.0","score":0,"post_id":38571742,"edited":false,"creation_date":1469527755,"comment_id":64562168,"body":"Hey Rob, I am thankful for your interest in my problem. I am familiar how Finalizer and GC work in a JVM. The problem is that the Objects that reside in the Finalizer queue are not mine and not directly created from me, but though Jersey. I am simply following Jersey&#39;s examples and best practices in a multi-threaded environment and it is not working. The starvation of the Finalizer thread is very unlikely to be the problem, because CPU usage stays under 100% for a good amount of time and even the lowest priority threads should get execution time. Nevertheless, I will look more into it. Thanks!"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/391491f792dede1c39a89c21139ff87b?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":3453445,"user_type":"registered","user_id":2892515,"link":"https://stackoverflow.com/users/2892515/enerccio","reputation":240,"display_name":"Enerccio","accept_rate":93},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"edited":false,"creation_date":1467365186,"comment_id":63713362,"body":"@sudeepdino008 no because new SimpleDateFormat would have to be created each call to the method, which is silly"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=256&d=identicon&r=PG","account_id":1242531,"user_type":"registered","user_id":1204781,"link":"https://stackoverflow.com/users/1204781/sudeepdino008","reputation":3284,"display_name":"sudeepdino008","accept_rate":63},"content_license":"CC BY-SA 3.0","score":8,"post_id":817926,"edited":false,"creation_date":1466758440,"comment_id":63461690,"body":"The ThreadLocal.get() method will call ThreadLocal.initialValue() (once) for each thread, which means that a SimpleDateFormat object is created for each thread. Isn&#39;t it better then just to have SimpleDateFormat as local variables(since we don&#39;t have to deal with garbage collection issues) ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fb0bdbf18101aa257fb3613b07058d7b?s=256&d=identicon&r=PG","account_id":57501,"user_type":"registered","user_id":172272,"link":"https://stackoverflow.com/users/172272/didier-a","reputation":4679,"display_name":"Didier A.","accept_rate":83},"content_license":"CC BY-SA 3.0","score":3,"post_id":818120,"edited":false,"creation_date":1465597151,"comment_id":62985101,"body":"If the ThreadPool keeps the Threads alive, then their ThreadLocals will too, but they will be overwritten by the new values when the thread in the pool is allocated again no? Why would it leak? It just seems to me that you&#39;d have a fix increase of memory maybe, equal to num thread * size of threadlocal value, but your ThreadPool should manage itself to a reasonable size, so this isn&#39;t really a memory leak, increasing MaxPermSize should in fact be a good solution."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=256&d=identicon&r=PG","account_id":23121,"user_type":"registered","user_id":57695,"link":"https://stackoverflow.com/users/57695/peter-lawrey","reputation":527376,"display_name":"Peter Lawrey","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"edited":false,"creation_date":1456391754,"comment_id":58927903,"body":"@NullPointerException if you want to wait until the process has finished, yes."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/9579d46f3906911c55cfbe5c7087789d?s=256&d=identicon&r=PG&f=y&so-version=2","account_id":221733,"user_type":"registered","user_id":479886,"link":"https://stackoverflow.com/users/479886/nullpointerexception","reputation":36369,"display_name":"NullPointerException","accept_rate":61},"content_license":"CC BY-SA 3.0","score":0,"post_id":35622631,"edited":false,"creation_date":1456391048,"comment_id":58927457,"body":"so it is enought to add p.waitFor(); after Helpers.asynchOutputWrite ?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=256&d=identicon&r=PG","account_id":422870,"user_type":"registered","user_id":801894,"link":"https://stackoverflow.com/users/801894/solomon-slow","reputation":25925,"display_name":"Solomon Slow"},"content_license":"CC BY-SA 3.0","score":5,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446036704,"comment_id":54574459,"body":"@jayendrabhatt, Read locks and write locks come in pairs:  If thread R holds a read lock, it blocks thread W from obtaining the corresponding write lock, but it does <i>not</i> block thread S from getting the same read lock.  A reader/writer lock pair allows any number of readers to &quot;own&quot; the read lock at the same time, <i>OR</i> it allows <i>one</i> writer to own the write lock, but it never allows a reader and a writer at the same time, and it never allows more than one writer at the same time."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=256&d=identicon&r=PG","account_id":372293,"user_type":"registered","user_id":721269,"link":"https://stackoverflow.com/users/721269/david-schwartz","reputation":180467,"display_name":"David Schwartz","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":33384952,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"edited":false,"creation_date":1446017305,"comment_id":54563020,"body":"@jayendrabhatt It&#39;s very hard to understand your questions. What do you think it means for a lock to be atomic?"},{"owner":{"profile_image":"https://i.stack.imgur.com/ixvj4.png?s=256&g=1","account_id":4890996,"user_type":"registered","user_id":3942142,"link":"https://stackoverflow.com/users/3942142/jayendra-bhatt","reputation":1347,"display_name":"jayendra bhatt","accept_rate":36},"content_license":"CC BY-SA 3.0","score":0,"post_id":33384952,"edited":false,"creation_date":1446017055,"comment_id":54562912,"body":"That implies the read lock is atomic . And you mean there is  no obstruction for the read lock acquired thread to do a write operation  ? correct me if am wrong"},{"owner":{"profile_image":"https://i.stack.imgur.com/6Pkuc.jpg?s=256&g=1","account_id":1420137,"user_type":"registered","user_id":1344935,"link":"https://stackoverflow.com/users/1344935/evil-washing-machine","reputation":1323,"display_name":"Evil Washing Machine","accept_rate":69},"content_license":"CC BY-SA 3.0","score":8,"post_id":818120,"edited":false,"creation_date":1442266494,"comment_id":53003727,"body":"Now that PermGen is killed by Java 8, does this change this answer in any way?"},{"owner":{"profile_image":"https://i.stack.imgur.com/wGrow.png?s=256&g=1","account_id":1806558,"user_type":"registered","user_id":1643558,"link":"https://stackoverflow.com/users/1643558/tgkprog","reputation":4512,"display_name":"tgkprog","accept_rate":73},"content_license":"CC BY-SA 3.0","score":0,"post_id":818120,"edited":false,"creation_date":1439412174,"comment_id":51856671,"body":"Or just restart your node instead of a hot deploy. (for most cases, I&#39;m sure there are others where you just need to wrap around a soft reference). But you see a big drop in objects used and time if you use thread locals or spring thread scope (reused across users as the thread pool for web requests is long living) instead of stuffing every service in a session scope."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"edited":false,"creation_date":1439315757,"comment_id":51806957,"body":"Singletons doesn&#39;t are &quot;good&quot; or &quot;bad&quot; on all situations. On a nutshell:  The main objective of a Singleton is keep the creation of expensible objects at minimum, preferably only one.  On multiple classloading environments (like web application containers) they are almost useless.  They are hard to unit test or use on testing. Do you need a strategy to deal with."},{"owner":{"profile_image":"https://i.stack.imgur.com/TTR2y.png?s=256&g=1","account_id":3721597,"user_type":"registered","user_id":3096537,"link":"https://stackoverflow.com/users/3096537/renascienza","reputation":1647,"display_name":"Renascienza"},"content_license":"CC BY-SA 3.0","score":1,"post_id":817926,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"edited":false,"creation_date":1439315069,"comment_id":51806609,"body":"@SachinGorade is just to enforce just one formatter instance for each classloader.  On environment that have just one main classloader, that works like a Singleton."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/2d5f41cb0013e5ddcd6590a65d8de5ba?s=256&d=identicon&r=PG","account_id":448055,"user_type":"registered","user_id":842056,"link":"https://stackoverflow.com/users/842056/sachin-gorade","reputation":1447,"display_name":"Sachin Gorade","accept_rate":62},"content_license":"CC BY-SA 3.0","score":5,"post_id":817926,"edited":false,"creation_date":1438670329,"comment_id":51531090,"body":"@overthink Is there any reason to declare ThreadLocal static and final, I mean performance or something?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=256&d=identicon&r=PG","account_id":37136,"user_type":"registered","user_id":106104,"link":"https://stackoverflow.com/users/106104/user253751","reputation":57822,"display_name":"user253751","accept_rate":62},"content_license":"CC BY-SA 3.0","score":2,"post_id":877113,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"edited":false,"creation_date":1431138587,"comment_id":48380540,"body":"@IsaacKleinman well, you have to do that anyway, unless you extend Thread. And this solution still works in that case - just change &quot;implements Runnable&quot; to &quot;extends Thread&quot;, &quot;Runnable&quot; to &quot;Thread&quot;, and &quot;new Thread(r)&quot; to &quot;r&quot;."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27739235,"edited":false,"creation_date":1420329606,"comment_id":43932892,"body":"I think this would work. However, it doesn&#39;t address priorities."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420327815,"comment_id":43932436,"body":"Also, your solution has a separate priority queue for each producer, when I need a higher priorities to apply across messages of different producers. You have LinkedHashMap&lt;Producer,PriorityQueue&gt;; I ended up doing essentially Map&lt;Priority,LinkedHashMap&lt;Producer,PriorityQueue&gt;&gt;. I&#39;m accepting your answer since it got me thinking on the right track and is the closest to what I ended up actually doing."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":1,"post_id":27738182,"edited":false,"creation_date":1420327792,"comment_id":43932435,"body":"Since you&#39;ve got a ReentrantLock on the outside, you don&#39;t need a PriorityBlockingQueue on the inside, a PriorityQueue will be fine - double locking would give worse performance and greater risk of deadlocks (not with your current code, but possible with future changes)."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738182,"edited":false,"creation_date":1420287732,"comment_id":43920240,"body":"I like this idea (in particular use of ReenterantLock and Condition). I&#39;m going to try something similar."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420264486,"comment_id":43915347,"body":"Suppose producer #1 submits 100 messages. So far 50 of them have been processed. Now producer #2 submits 100 messages. Due to incrementing the underlying ID, won&#39;t all of producer #2&#39;s messages have higher ID numbers than producer #1&#39;s, so none of them will be processed until producer #1&#39;s are done? That isn&#39;t round-robin."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184978,"comment_id":43888897,"body":"I haven&#39;t thought out the details of the bookkeeping, and that&#39;s not necessarily the only way to do it, but the sequence I gave is the one you wanted, yes?"},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420184902,"comment_id":43888883,"body":"So you would have a counter, which increments by N (where N is current producer count), and an array sized N of boolean flags, initially all false. When producer x requests an ID, if flags[x] is false, set flags[x]=true; if flags[x] is true, increment counter by N, set all flags to false, set flags[x]=true; then, in either case, return counter+x? I assume also a synchronised block to protect the counter and the array. Also, to change producer count dynamically, would need to resize array, setting all its values to false, incrementing counter."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=256&d=identicon&r=PG","account_id":71739,"user_type":"registered","user_id":207421,"link":"https://stackoverflow.com/users/207421/user207421","reputation":307163,"display_name":"user207421","accept_rate":82},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"edited":false,"creation_date":1420184125,"comment_id":43888686,"body":"No. You would have incremented the underlying ID as per my last sentence, so in your example the IDs would run 0,2,4,6,8,10,12,14,16,18,19, ..."},{"owner":{"profile_image":"https://i.stack.imgur.com/jhjWO.jpg?s=256&g=1","account_id":2463632,"user_type":"registered","user_id":2147204,"link":"https://stackoverflow.com/users/2147204/simon-kissane","reputation":4432,"display_name":"Simon Kissane","accept_rate":85},"content_license":"CC BY-SA 3.0","score":0,"post_id":27738534,"edited":false,"creation_date":1420183492,"comment_id":43888525,"body":"With two producers, are you saying to allocate even IDs to the first producer, odd IDs to the second? Suppose producer #1 submits 10 messages, which are fully processed - it consumes the first ten odd IDs. Some time later, producer #1 submits 10 messages, which get the next ten odd IDs. Simultaneously, producer #2 submits 10 messages, which consume the first ten even IDs. Won&#39;t this result in producer #2&#39;s first batch being processed before producer #1&#39;s second batch? That&#39;s not round robin of outstanding messages."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416481671,"comment_id":42595773,"body":"There is last option, with combined CountDownLatches. Using while countdown loop costs nothing, so it&#39;s not a problem doing while release."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416481064,"comment_id":42595419,"body":"If you look at the question, I wanted to avoid countDown in loop."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":2,"post_id":27035047,"edited":false,"creation_date":1416477391,"comment_id":42593392,"body":"I dont need timeout, I need to explicitly release()"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/293f86043bc0fb6dba1190ad388c9d27?s=256&d=identicon&r=PG","account_id":279913,"user_type":"registered","user_id":575338,"link":"https://stackoverflow.com/users/575338/mavarazy","reputation":7622,"display_name":"mavarazy","accept_rate":59},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"edited":false,"creation_date":1416477256,"comment_id":42593307,"body":"You specify max timeout for operations, and go from there. You&#39;ll need to have some kind of completion timeout anyway, regardless of desired implementation."},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416477238,"comment_id":42593296,"body":"I am pointing to that release() method would be very useful, like in Semaphore"},{"owner":{"profile_image":"https://i.stack.imgur.com/EXXAH.jpg?s=256&g=1","account_id":1749879,"user_type":"registered","user_id":1599213,"link":"https://stackoverflow.com/users/1599213/to-kra","reputation":3381,"display_name":"To Kra","accept_rate":33},"content_license":"CC BY-SA 3.0","score":0,"post_id":27035047,"edited":false,"creation_date":1416477055,"comment_id":42593178,"body":"but in case I dont the time know what all operations consume, its useless."},{"owner":{"profile_image":"https://i.stack.imgur.com/LdDoZ.png?s=256&g=1","account_id":957028,"user_type":"registered","user_id":982149,"link":"https://stackoverflow.com/users/982149/fildor","reputation":15143,"display_name":"Fildor","accept_rate":100},"content_license":"CC BY-SA 3.0","score":1,"post_id":27034988,"edited":false,"creation_date":1416472826,"comment_id":42590762,"body":"&quot;but if something fails&quot; - wouldn&#39;t interrupting be more appropriate here?"},{"owner":{"profile_image":"https://i.stack.imgur.com/yz1vF.jpg?s=256&g=1","account_id":5894,"user_type":"registered","user_id":9702,"link":"https://stackoverflow.com/users/9702/jeremy-stein","reputation":19311,"display_name":"Jeremy Stein","accept_rate":91},"content_license":"CC BY-SA 3.0","score":39,"post_id":820131,"edited":false,"creation_date":1415140486,"comment_id":42077909,"body":"Why did I have to scroll down so far to find this essential answer!?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/8be4691d697474170946184567d36814?s=256&d=identicon&r=PG","account_id":11385,"user_type":"registered","user_id":21925,"link":"https://stackoverflow.com/users/21925/robin","reputation":24062,"display_name":"Robin","accept_rate":62},"content_license":"CC BY-SA 3.0","score":32,"post_id":818120,"edited":false,"creation_date":1397668086,"comment_id":35337070,"body":"This is an awful lot of upvotes for an answer that, while informative, does not in any way actually answer the question."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/0a60a9c9c5193d41019fa3e09b2696f3?s=256&d=identicon&r=PG","account_id":395504,"user_type":"registered","user_id":758494,"link":"https://stackoverflow.com/users/758494/isaac-kleinman","reputation":4064,"display_name":"Isaac Kleinman","accept_rate":56},"content_license":"CC BY-SA 3.0","score":0,"post_id":877113,"edited":false,"creation_date":1381871974,"comment_id":28740620,"body":"This means that each Thread constructed using <code>r</code> will have the same argument, so if we want to pass different arguments to multiple Threads running <code>MyThread</code> we&#39;d need to create a new <code>MyThread</code> instance using the desired argument for each Thread. In other words, to get a thread up and running we need to create two objects: Thread and MyThread. Is this considered bad, performance-wise?"},{"owner":{"profile_image":"https://i.stack.imgur.com/c63KV.png?s=256&g=1","account_id":1896959,"user_type":"registered","user_id":1713695,"link":"https://stackoverflow.com/users/1713695/alexander-ryzhov","reputation":2752,"display_name":"Alexander Ryzhov"},"content_license":"CC BY-SA 3.0","score":22,"post_id":817926,"edited":false,"creation_date":1372354343,"comment_id":25173897,"body":"This is high price to pay for hacking <code>SimpleDateFormat</code>. Perhaps it&#39;s better to use <a href=\"http://stackoverflow.com/questions/10411944/java-text-simpledateformat-not-thread-safe\">a thread-safe alternative</a>. If you agree that <a href=\"http://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons\">singletons are bad</a> then <code>ThreadLocal</code> is even worse."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=256&d=identicon&r=PG","account_id":114848,"user_type":"registered","user_id":301832,"link":"https://stackoverflow.com/users/301832/donal-fellows","reputation":134189,"display_name":"Donal Fellows","accept_rate":60},"content_license":"CC BY-SA 3.0","score":12,"post_id":818120,"edited":false,"creation_date":1370953796,"comment_id":24640175,"body":"The thread that Julien links to has moved to <a href=\"http://jsr166-concurrency.10961.n7.nabble.com/Threadlocals-and-memory-leaks-in-J2EE-td3960.html\" rel=\"nofollow noreferrer\">here</a> it seems, and is <i>well worth reading…</i>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/fd01dd06eefc977f4746b1ff55799c2b?s=256&d=identicon&r=PG","account_id":94225,"user_type":"registered","user_id":257364,"link":"https://stackoverflow.com/users/257364/volksman","reputation":2029,"display_name":"Volksman","accept_rate":0},"content_license":"CC BY-SA 3.0","score":4,"post_id":820131,"edited":false,"creation_date":1367029500,"comment_id":23246108,"body":"That&#39;s exactly how the exPOJO framework (www.expojo.com) allows access to ORM Session/PersistenceManager without needing the overhead of annotations and injection. It is kind of like &#39;thread injection&#39; instead of &#39;object injection&#39;. It provides access to dependencies without the requirement (and overhead) of having them embedded in every object that might need those dependencies. It&#39;s amazing how &#39;light weight&#39; you can make a DI framework when you use thread injection instead of classic DI (eg., Spring etc.,)"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/1c9d8c24df8646c416ef0fbf2177c848?s=256&d=identicon&r=PG","account_id":416223,"user_type":"registered","user_id":791486,"link":"https://stackoverflow.com/users/791486/friedryk","reputation":376,"display_name":"Friedryk"},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1357923042,"comment_id":19832107,"body":"I&#39;ve just being hit the face with date/calendar/format concurrency problems. Though I understood quickly what was going on, your post made it plain and simple to solve my problems without major overhaul of my code. Thanks!  Personnally I made a point in calling ThreadLocal remove after each get(), idealy in a finally clause. Any thoughts if it is overkill ? I wanted to make sure memory could be reclaimed after execution of enclosing Thread."},{"owner":{"profile_image":"https://i.stack.imgur.com/cIuFJ.jpg?s=256&g=1","account_id":887421,"user_type":"registered","user_id":926520,"link":"https://stackoverflow.com/users/926520/pankaj","reputation":5160,"display_name":"Pankaj","accept_rate":75},"content_license":"CC BY-SA 3.0","score":0,"post_id":817926,"edited":false,"creation_date":1356923862,"comment_id":19500485,"body":"Here is a complete example showing different threads have their own copy. <a href=\"http://www.journaldev.com/1076/java-threadlocal-example-to-create-thread-local-variables\" rel=\"nofollow noreferrer\">journaldev.com/1076/&hellip;</a>"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/dc8c4ddd99b446c28d2e1546c457e508?s=256&d=identicon&r=PG","account_id":4495,"user_type":"registered","user_id":6782,"link":"https://stackoverflow.com/users/6782/alnitak","reputation":335863,"display_name":"Alnitak","accept_rate":78},"content_license":"CC BY-SA 3.0","score":7,"post_id":877113,"reply_to_user":{"profile_image":"https://i.stack.imgur.com/7CZNr.png?s=256&g=1","account_id":148793,"user_type":"registered","user_id":360826,"link":"https://stackoverflow.com/users/360826/jason-m","reputation":6615,"display_name":"jason m","accept_rate":73},"edited":false,"creation_date":1353601838,"comment_id":18503246,"body":"@jasonm no, it&#39;s a constructor - constructors don&#39;t have a return type."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/47a9a5b4589057085336011863d2ee9a?s=256&d=identicon&r=PG","account_id":7639,"user_type":"registered","user_id":13317,"link":"https://stackoverflow.com/users/13317/kenster","reputation":23810,"display_name":"Kenster","accept_rate":85},"content_license":"CC BY-SA 3.0","score":11,"post_id":818120,"edited":false,"creation_date":1335905541,"comment_id":13420747,"body":"Alex Vasseur moved his blog. <a href=\"http://avasseur.blogspot.com/2003/11/threadlocal-and-memory-leaks.html\" rel=\"nofollow noreferrer\">Here</a> is a current link to the memory leak article."},{"owner":{"profile_image":"https://www.gravatar.com/avatar/63f1d837b7123c72135da37e2f0042de?s=256&d=identicon&r=PG","account_id":283806,"user_type":"registered","user_id":581528,"link":"https://stackoverflow.com/users/581528/ray","reputation":4839,"display_name":"Ray","accept_rate":84},"content_license":"CC BY-SA 2.5","score":1,"post_id":818120,"reply_to_user":{"profile_image":"https://www.gravatar.com/avatar/7ccd45f17734f7d050a186468bdc38eb?s=256&d=identicon&r=PG","account_id":25274,"user_type":"registered","user_id":64881,"link":"https://stackoverflow.com/users/64881/phil-m","reputation":6653,"display_name":"Phil M"},"edited":false,"creation_date":1297682605,"comment_id":5577062,"body":"do you think this could be avoided by using a SoftReference?"},{"owner":{"profile_image":"https://www.gravatar.com/avatar/ec3b4d2db3e6e33b498deb38592e862d?s=256&d=identicon&r=PG","account_id":15307,"user_type":"registered","user_id":32174,"link":"https://stackoverflow.com/users/32174/julien-chastang","reputation":17620,"display_name":"Julien Chastang","accept_rate":71},"content_license":"CC BY-SA 2.5","score":173,"post_id":817926,"edited":false,"creation_date":1241408353,"comment_id":627914,"body":"Another alternative to synchronization or threadlocal is to make the variable a local variable. Local vars are always thread safe. I assume that it is bad practice to make DateFormats local because they are expensive to create, but I have never seen solid metrics on this topic."}]